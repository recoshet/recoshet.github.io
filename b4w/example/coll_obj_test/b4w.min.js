var b4w=function(a){var p={};a.module=p;var b={};a.register=function(a,b){if(p[a])throw Error('Module "'+a+'" already registered');p[a]=b};a.require=function(a,c){if(!p[a])throw Error('Module "'+a+'" not found');c=c||"__B4W_DEF_NS";b[c]||(b[c]=function(a){return function(c){var d=p[c];if(!d)throw Error('Module "'+c+'" not found');d.Rh||(d.Rh={});d.Rh[a]||(d.Rh[a]={},d(d.Rh[a],b[a]));return d.Rh[a]}}(c));return b[c](a)};a.module_check=function(a){return p[a]?!0:!1};return a}({});"object"==typeof module&&module.hm&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function p(){var a=b,d=a.getDate(),d=10>d?"0"+String(d):String(d),f=a.getMonth()+1,f=10>f?"0"+String(f):String(f),g=String(a.getFullYear()),k=a.getHours(),k=10>k?"0"+String(k):String(k),q=a.getMinutes(),q=10>q?"0"+String(q):String(q),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return d+"."+f+"."+g+" "+k+":"+q+":"+a}var b=new Date(2015,6,24,18,50,14),d=[15,6];a.version=function(){return d};a.version_str=function(){for(var a="",b=0;b<d.length;b++)a=1==b?a+(10>d[b]?
"0"+d[b]:d[b]):a+d[b],b!=d.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.date=function(){return b};a.date_str=p;a.timestamp=function(){var a=p(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.hm&&b4w.module.__version(exports);b4w.module.__config=function(a,p){function b(){return b4w.module_check(a.Tb.Aj)}function d(){for(var b=a.Tb,d=null,e=document.getElementsByTagName("script"),q=0;q<e.length;q++){for(var h=e[q].src,m=0;m<b.ar.length;m++)if(0<=h.indexOf(b.ar[m])){d=h;break}if(null!==d)break}d||(c.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),d=document.location.href);b=d.indexOf("?");0<=b&&(d=d.substring(0,b));return d.substring(0,d.lastIndexOf("/")+1)}var c=p("__print"),
e=p("__util");a.P_LOW=1;a.P_HIGH=2;a.P_ULTRA=3;a.P_CUSTOM=4;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.hw=e.qa(a.context);a.o={alpha_sort:!0,alpha_sort_threshold:.1,Ci:[5,4],Zc:1E4,console_verbose:!1,do_not_load_resources:!1,Uk:!1,fq:1.5,vx:10,background_color:[0,0,0,0],$f:.01,render_resolution_factor:1,canvas_resolution_factor:1,Ok:3,allow_cors:!1,pm:!1,rj:!0,show_hud_debug_info:!1,lD:!0,Vi:!0,anaglyph_use:!1,Ek:!0,Pi:.5,fc:!0,ff:!0,Qg:!0,Xg:!0,Ig:!0,jh:!0,Mg:!0,antialiasing:!0,smaa:!1,
wireframe_debug:!1,rt:!1,Tg:!0,Hi:!0,mb:!0,zk:!0,water_dynamic:!0,shore_smoothing:!0,sh:!0,Kb:1024,Bi:512,et:!0,precision:"highp",quality:a.P_HIGH,il:!0,kz:!1,rs:!1,Qp:!1,lt:!1,Sf:!1,Hl:!1,Qq:!1,Il:!1,FE:!1,Sc:!1,allow_hidpi:!1,gyro_use:!1,bq:!1,Om:!1,enable_selectable:!0,enable_outlining:!0,Le:!0,mr:128,Lm:!1,cn:[0,0]};a.Ww=e.qa(a.o);a.Nd={Ha:-1,gq:!1,Lf:1};a.controls={iz:1/120};a.Od={dir:"ASSETS=../../assets/",dz:15,Vr:!0,hn:!1,Yl:!1};a.qv=e.qa(a.Od);a.Tb={shaders_dir:"",BA:"include/",Aj:"built_in_data",
ar:["b4w.min.js","b4w.full.min.js","src/b4w.js","USER_DEFINED_MODULE"],gs:"./",smaa_search_texture_path:"",smaa_area_texture_path:""};a.Sa={enabled:!0,Zc:60,$i:"",Bl:!1};a.vz=e.qa(a.Sa);a.Ti={Uj:1024,Ee:384};a.aA=e.qa(a.Ti);a.cd={to:!0,jk:!1,Yo:!1,vp:!1,Rp:!1};a.AA=e.qa(a.cd);a.Fb={outlining_overview_mode:!1,Ue:[1,.4,.05],$c:1,pk:.2,qk:3.8,rk:1};a.Zl={enabled:!1,eB:"MAIN_OPAQUE",dB:0,EA:"COLOR"};a.Sw=e.qa(a.Zl);a.lv=function(){var b=a.o,c=a.Sa,d=a.Ti;switch(b.quality){case a.P_ULTRA:b.Vi=!0;b.shore_smoothing=
!0;b.ff=!0;b.Qg=!0;b.Xg=!0;b.Ig=!0;b.Ek=!0;b.Pi=1;b.fc=!0;b.Tg=!0;b.Hi=!0;b.mb=!0;b.zk=!0;b.render_resolution_factor=1.75;d.Uj=2048;b.Ok=3;b.rj=!0;b.Uk=!1;b.precision="highp";b.water_dynamic=!0;b.sh=!0;b.antialiasing=!0;b.smaa=!0;b.Mg=!0;b.jh=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.Le=!0;c.Zc=120;break;case a.P_HIGH:b.Vi=!0;b.shore_smoothing=!0;b.ff=!0;b.Qg=!0;b.Xg=!0;b.Ig=!0;b.Ek=!0;b.Pi=.5;b.fc=!0;b.Tg=!0;b.Hi=!0;b.mb=!0;b.zk=!0;b.render_resolution_factor=1;d.Uj=1024;b.Ok=3;b.rj=!0;b.Uk=!1;
b.precision="highp";b.water_dynamic=!0;b.sh=!0;b.antialiasing=!0;b.smaa=!1;b.Mg=!0;b.jh=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.Le=!0;c.Zc=60;break;case a.P_LOW:b.Vi=!1,b.shore_smoothing=!1,b.ff=!1,b.Qg=!1,b.Xg=!1,b.Ig=!1,b.Ek=!1,b.Pi=.5,b.fc=!1,b.Tg=!1,b.Hi=!1,b.mb=!1,b.zk=!1,b.render_resolution_factor=1,d.Uj=512,b.Ok=2,b.rj=!1,b.Uk=!0,b.precision="mediump",b.water_dynamic=!1,b.sh=!1,b.antialiasing=!1,b.smaa=!1,b.Mg=!1,b.jh=!1,b.allow_hidpi=!1,b.enable_outlining=!1,b.Le=!1,c.Zc=60}};a.set=function(b,
d){switch(b){case "allow_cors":a.o.allow_cors=d;break;case "allow_hidpi":a.o.allow_hidpi=d;break;case "alpha":a.context.alpha=d;break;case "alpha_sort":a.o.alpha_sort=d;break;case "alpha_sort_threshold":a.o.alpha_sort_threshold=d;break;case "anaglyph_use":a.o.anaglyph_use=d;break;case "animation_framerate":a.Nd.Ha=d;break;case "antialiasing":a.o.antialiasing=d;break;case "assets_dds_available":a.Od.Yl=d;break;case "assets_min50_available":a.Od.hn=d;break;case "audio":a.cd.to=d;break;case "background_color":a.o.background_color=
d;break;case "built_in_module_name":a.Tb.Aj=d;break;case "canvas_resolution_factor":a.o.canvas_resolution_factor=d;break;case "console_verbose":a.o.console_verbose=d;break;case "do_not_load_resources":a.o.do_not_load_resources=d;break;case "gyro_use":a.o.gyro_use=d;break;case "physics_enabled":a.Sa.enabled=d;break;case "physics_uranium_path":a.Sa.$i=d;break;case "physics_calc_fps":a.Sa.Bl=d;break;case "precision":a.o.precision=d;break;case "quality":a.o.quality=d;break;case "render_resolution_factor":a.o.render_resolution_factor=
d;break;case "sfx_mix_mode":a.cd.jk=d;break;case "shaders_dir":a.Tb.shaders_dir=d;break;case "show_hud_debug_info":a.o.show_hud_debug_info=d;break;case "smaa":a.o.smaa=d;break;case "smaa_search_texture_path":a.Tb.smaa_search_texture_path=d;break;case "smaa_area_texture_path":a.Tb.smaa_area_texture_path=d;break;case "wireframe_debug":a.o.wireframe_debug=d;break;case "enable_selectable":a.o.enable_selectable=d;break;case "enable_outlining":a.o.enable_outlining=d;break;case "outlining_overview_mode":a.Fb.outlining_overview_mode=
d;break;case "glow_materials":a.o.Le=d;break;default:c.error("Unknown config property: "+b)}};a.get=function(b){switch(b){case "allow_cors":return a.o.allow_cors;case "allow_hidpi":return a.o.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.o.alpha_sort;case "alpha_sort_threshold":return a.o.alpha_sort_threshold;case "anaglyph_use":return a.o.anaglyph_use;case "animation_framerate":return a.Nd.Ha;case "antialiasing":return a.o.antialiasing;case "assets_dds_available":return a.Od.Yl;
case "assets_min50_available":return a.Od.hn;case "audio":return a.cd.to;case "background_color":return a.o.background_color;case "built_in_module_name":return a.Tb.Aj;case "canvas_resolution_factor":return a.o.canvas_resolution_factor;case "console_verbose":return a.o.console_verbose;case "do_not_load_resources":return a.o.do_not_load_resources;case "gyro_use":return a.o.gyro_use;case "physics_enabled":return a.Sa.enabled;case "physics_uranium_path":return a.Sa.$i;case "physics_calc_fps":return a.Sa.Bl;
case "precision":return a.o.precision;case "quality":return a.o.quality;case "render_resolution_factor":return a.o.render_resolution_factor;case "sfx_mix_mode":return a.cd.jk;case "shaders_dir":return a.Tb.shaders_dir;case "show_hud_debug_info":return a.o.show_hud_debug_info;case "smaa":return a.o.smaa;case "smaa_search_texture_path":return a.Tb.smaa_search_texture_path;case "smaa_area_texture_path":return a.Tb.smaa_area_texture_path;case "wireframe_debug":return a.o.wireframe_debug;case "enable_selectable":return a.o.enable_selectable;
case "enable_outlining":return a.o.enable_outlining;case "outlining_overview_mode":return a.Fb.outlining_overview_mode;case "glow_materials":return a.o.Le;default:c.error("Unknown config property: "+b)}};a.reset=function(){a.context=e.qa(a.hw);a.o=e.qa(a.Ww);a.Od=e.qa(a.qv);a.Sa=e.qa(a.vz);a.Ti=e.qa(a.aA);a.cd=e.qa(a.AA);a.Zl=e.qa(a.Sw)};a.Iy=b;a.qA=function(){var c=a.Tb,e=a.Sa;b()||""!=c.shaders_dir||(c.shaders_dir=d()+"../shaders/");if(b())c.smaa_search_texture_path="smaa_search_texture.png",c.smaa_area_texture_path=
"smaa_area_texture.png";else if(""==c.smaa_search_texture_path||""==c.smaa_area_texture_path){var k=d()+c.gs;c.smaa_search_texture_path=c.smaa_search_texture_path||k+"smaa_search_texture.png";c.smaa_area_texture_path=c.smaa_area_texture_path||k+"smaa_area_texture.png"}e.enabled&&""==e.$i&&(k=d()+c.gs,e.$i=k+"uranium.js")};a.get_std_assets_path=function(){return a.Od.dir.replace("ASSETS=","")}};b4w.module.__anchors=function(a,p){function b(a,b){var l=document.createElement("div"),f=l.style;f.position="absolute";f.backgroundColor="black";f.borderRadius="20px 20px 20px 0px";f.boxShadow="0px 0px 10px rgb(180, 180, 200)";f.opacity=1;f.padding="8px 12px";f.lineHeight="15px";f.visibility="hidden";f.fontSize="12px";var k=q.get_container();k.appendChild(l);var g=h.get_meta_tags(a),n=document.createElement("span"),m=n.style;n.innerHTML=g.title||a.name;m.fontWeight="bold";m.fontSize="12px";m.lineHeight=
"15px";m.color="#fff";m.fontFamily="Arial";e(n);l.appendChild(n);var z=g.description;if(z){var g=document.createElement("div"),N=g.style;N.position="absolute";N.bottom="0px";N.left="0px";N.backgroundColor="#000";N.borderRadius="20px 20px 20px 0px";N.boxShadow="0px 0px 10px rgb(180, 180, 200)";N.visibility="hidden";N.padding="8px 12px";N.overflow="hidden";N.lineHeight="15px";N.fontSize="12px";N.zIndex="2";l.appendChild(g);var G=document.createElement("span"),L=G.style;G.innerHTML=z;L.fontSize="12px";
L.fontFamily="Arial";L.fontWeight="bold";L.lineHeight="15px";L.color="#fff";L.visibility="hidden";g.appendChild(G);var t=!1,W=!1;k.addEventListener("click",function(a){if(!(t||W||x))if(a.target!=n&&a.target!=l||"hidden"!=N.visibility||1!=f.opacity)"visible"==N.visibility&&(f.visibility="visible",m.visibility="visible",N.visibility="hidden",L.visibility="hidden");else{f.visibility="hidden";m.visibility="hidden";N.visibility="visible";t=W=!0;a=l.offsetWidth-24;var G=l.offsetHeight-16,e=Math.min(b,d(z)),
h=c(z,e);h==G&&(N.height=h+"px");e!=a?w.animate(a,e,200,function(a){a==e&&("visible"==N.visibility&&(L.visibility="visible"),t=!1);N.width=a+"px"}):t=!1;h!=G?w.animate(G,h,200,function(a){a==h&&("visible"==N.visibility&&(L.visibility="visible"),W=!1);N.height=a+"px"}):W=!1;W||t||(L.visibility="visible")}},!1)}return l}function d(a){var b=document.createElement("div"),c=document.createElement("span"),d=b.style;c.innerHTML=a;c.style.fontSize="12px";c.style.fontFamily="Arial";c.style.fontWeight="bold";
c.style.color="#fff";c.style.visibility="hidden";d.lineHeight="15px";b.appendChild(c);d.position="absolute";d.visibility="hidden";d.fontSize="12px";d.display="inline-block";d.lineHeight="15px";document.body.appendChild(b);a=b.offsetWidth+1;document.body.removeChild(b);return a}function c(a,b){var c=document.createElement("div"),d=document.createElement("span"),e=c.style;d.innerHTML=a;d.style.fontSize="12px";d.style.fontFamily="Arial";d.style.fontWeight="bold";d.style.color="#fff";d.style.visibility=
"hidden";e.lineHeight="15px";c.appendChild(d);e.position="absolute";e.visibility="hidden";e.fontSize="12px";e.display="inline-block";e.width=b+"px";e.lineHeight="15px";document.body.appendChild(c);d=c.offsetHeight;document.body.removeChild(c);return d}function e(a){a.style["-webkit-touch-callout"]="none";a.style["-webkit-user-select"]="none";a.style["-khtml-user-select"]="none";a.style["-moz-user-select"]="none";a.style["-ms-user-select"]="none";a.style["user-select"]="none";a.style.cursor="default"}
function f(){for(var a=0,b=0;b<B.length;b++)B[b].am&&a++;y=new Float32Array(3*a)}var g=p("__batch"),k=p("__camera"),q=p("__container"),h=p("__objects"),m=p("__print"),u=p("__renderer"),n=p("__scenes"),w=p("__time");p("__util");p("__config");var x=!1,B=[],y=new Float32Array(0),r=new Uint8Array(16),A=new Float32Array(2),t=new Float32Array(3);a.append=function(a){var c;a:{for(c=0;c<B.length;c++)if(B[c].obj==a){c=!0;break a}c=!1}if(!c){c=a.b4w_anchor.detect_visibility&&Boolean(n.ca(n.Wg(),"ANCHOR_VISIBILITY"));
c={type:a.b4w_anchor.type,obj:a,x:0,y:0,depth:0,Gg:"out",am:c,element:null,kh:null,Tu:a.b4w_anchor.max_width,Ro:0};switch(c.type){case "ANNOTATION":c.element=b(a,c.Tu);c.Ro=c.element.offsetHeight;break;case "ELEMENT":c.element=document.getElementById(a.b4w_anchor.element_id),c.element||(m.warn("Anchor HTML element was not found, making it generic"),c.type="GENERIC")}B.push(c);f()}};a.remove=function(a){for(var b=0;b<B.length;b++){var c=B[b];if(c.obj==a){"ANNOTATION"==c.type&&(a=c,q.get_container().removeChild(a.element));
B.splice(b,1);f();break}}};a.update=function(){for(var a=0,b=0,c=B.length;b<c;b++){var d=B[b];d.am&&(y.set(d.obj.d.h,3*a),a++);var e,h=d,f=t;e=n.Rj(n.Wg());e=f=k.project_point(e,h.obj.d.h,f);h=e[0];f=e[1];e=e[2];if(h!=d.x||f!=d.y||e!=d.depth){switch(d.type){case "ANNOTATION":var m=d.element;m.style.left=Math.floor(h)+"px";m.style.top=Math.floor(f-d.Ro)+"px";break;case "ELEMENT":m=d.element,m.style.left=Math.floor(h-m.offsetWidth/2)+"px",m.style.top=Math.floor(f-m.offsetHeight/2)+"px"}d.x=h;d.y=f;
d.depth=e;d.kh&&d.kh(h,f,d.Gg,d.obj,m)}}0<a&&(a=n.ca(n.Wg(),"ANCHOR_VISIBILITY").p[0].B,g.sB(a,y))};a.NB=function(){for(var a=q.get_container(),b=0;b<B.length;b++){var c=B[b],d=c.obj,e=c.x,h=c.y,f=c.depth,f=0>e||0>h||0>f||1<f||n.is_hidden(d)||e>=a.clientWidth||h>=a.clientHeight?"out":"visible";if(c.am&&"out"!=f){var f=c,g=n.ca(n.Wg(),"ANCHOR_VISIBILITY").i,z=q.El(f.x,f.y,A,g);u.cs(g.be,z[0],g.height-z[1],2,2,r);f=1020==r[0]+r[4]+r[8]+r[12]?"visible":"out"==f.Gg||0==r[0]+r[4]+r[8]+r[12]?"covered":
f.Gg}if(f!=c.Gg){switch(c.type){case "ANNOTATION":case "ELEMENT":var N=c.element;if(!N)break;"out"==f?(N.style.visibility="hidden",N.children.length&&(N.children[0].style.visibility="hidden"),"ANNOTATION"==c.type&&1<N.children.length&&(g=N.children[1],g.style.visibility="hidden",g.children.length&&(g.children[0].style.visibility="hidden"))):"visible"==f?(N.style.visibility="visible",N.children.length&&(N.children[0].style.visibility="visible"),N.style.opacity=1):(N.style.visibility="visible",N.style.opacity=
.1,N.children.length&&(N.children[0].style.visibility="visible"),"ANNOTATION"==c.type&&1<N.children.length&&(g=N.children[1],g.style.visibility="hidden",g.children.length&&(g.children[0].style.visibility="hidden")))}c.Gg=f;c.kh&&c.kh(e,h,c.Gg,d,N)}}};a.attach_move_cb=function(a,b){for(var c=0;c<B.length;c++)B[c].obj==a&&(B[c].kh=b)};a.detach_move_cb=function(a){for(var b=0;b<B.length;b++)B[b].obj==a&&(B[b].kh=null)};a.cleanup=function(){for(var a=0;a<B.length;a++){var b=B[a];"ANNOTATION"==b.type&&
q.get_container().removeChild(b.element)}B.length=0};a.is_anchor=function(a){return a.b4w_anchor?!0:!1};a.get_element_id=function(a){return a.b4w_anchor&&a.b4w_anchor.element_id?a.b4w_anchor.element_id:!1};a.pause=function(){x=!0};a.resume=function(){x=!1}};b4w.module.__boundings=function(a,p){function b(a,b){for(var c=a[0],d=a[1],e=a[2],h=a[0],f=a[1],g=a[2],k=3;k<a.length;k+=3)var m=a[k],l=a[k+1],u=a[k+2],c=Math.max(c,m),d=Math.max(d,l),e=Math.max(e,u),h=Math.min(h,m),f=Math.min(f,l),g=Math.min(g,u);b.max_x=c;b.max_y=d;b.max_z=e;b.min_x=h;b.min_y=f;b.min_z=g;return b}function d(a,b){b||(b=new Float32Array(24));var c=a.max_x,d=a.max_y,e=a.max_z,h=a.min_x,f=a.min_y,g=a.min_z;b[0]=h;b[1]=f;b[2]=g;b[3]=c;b[4]=f;b[5]=g;b[6]=c;b[7]=d;b[8]=g;b[9]=h;b[10]=
d;b[11]=g;b[12]=h;b[13]=f;b[14]=e;b[15]=c;b[16]=f;b[17]=e;b[18]=c;b[19]=d;b[20]=e;b[21]=h;b[22]=d;b[23]=e;return b}function c(a,b,c){k.add(b,c,a.F);k.scale(a.F,.5,a.F);a.Da=k.distance(a.F,b);return a}var e=p("__geometry"),f=p("__util"),g=p("__tsr"),k=p("vec3"),q=new Float32Array(24),h=new Float32Array(3),m=new Float32Array(3),u=new Float32Array(3);a.Dp=function(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z};a.UC=function(){return{max_x:1E12,min_x:-1E12,
max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12}};a.Gd=function(a){a||(a={});a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0;return a};a.Vp=function(a,b){var c=a.max_y,d=a.max_z,e=a.min_x,h=a.min_y,f=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,d);a.min_x=Math.min(b.min_x,e);a.min_y=Math.min(b.min_y,h);a.min_z=Math.min(b.min_z,f)};a.xv=b;a.xl=function(c,e,h){h||(h=a.Gd());c=d(c,q);f.We(c,e,c);return b(c,h)};a.ox=d;a.EE=function(b,c,d){d||
(d=a.Gd());var e=c.min_x,h=c.max_x,f=c.min_y,g=c.max_y,k=c.min_z;c=c.max_z;if(e>=b.max_x||h<=b.min_x||f>=b.max_y||g<=b.min_y||k>=b.max_z||c<=b.min_z)return d.min_x=-.1,d.max_x=.1,d.min_y=-.1,d.max_y=.1,d.min_z=-.2,d.max_z=-.1,d;d.min_x=Math.max(b.min_x,e);d.max_x=Math.min(b.max_x,h);d.min_y=Math.max(b.min_y,f);d.max_y=Math.min(b.max_y,g);d.min_z=Math.max(b.min_z,k);d.max_z=Math.min(b.max_z,c);return d};a.IE=function(b,c,d){d||(d=a.Gd());var e=b.max_x-b.min_x,h=b.max_y-b.min_y,f=b.max_z-b.min_z;d.min_x=
b.min_x-.5*(c-1)*e;d.max_x=b.max_x+.5*(c-1)*e;d.min_y=b.min_y-.5*(c-1)*h;d.max_y=b.max_y+.5*(c-1)*h;d.min_z=b.min_z-.5*(c-1)*f;d.max_z=b.max_z+.5*(c-1)*f;return d};a.zl=function(b,c,d){d||(d=a.fj());k.transformMat4(b.F,c,d.F);d.Da=b.Da*f.fn(c);return d};a.yl=function(a,b,c){c||(c={vf:new Float32Array(3),wf:new Float32Array(3),xf:new Float32Array(3),F:new Float32Array([0,0,0])});g.transform_vec3(a.F,b,c.F);k.copy(a.vf,c.vf);k.copy(a.wf,c.wf);k.copy(a.xf,c.xf);g.transform_dir_vec3(c.vf,b,c.vf);g.transform_dir_vec3(c.wf,
b,c.wf);g.transform_dir_vec3(c.xf,b,c.xf);return c};a.Rl=function(a,b){return{Da:a,F:new Float32Array(b)}};a.fj=function(){return{F:new Float32Array([0,0,0]),Da:0}};a.Ql=function(a,b,c,d){return{vf:new Float32Array(a),wf:new Float32Array(b),xf:new Float32Array(c),F:new Float32Array([d[0],d[1],d[2]])}};a.zv=function(){return{F:new Float32Array([0,0,0]),Da:1E12}};a.kx=function(a,b){var c=k.subtract(b.F,a.F,k.create());0==k.length(c)&&k.set(1,0,0,c);var d=k.normalize(c,k.create()),c=k.scale(d,a.Da,k.create());
k.add(c,a.F,c);var e=k.scale(d,-a.Da,k.create());k.add(e,a.F,e);var h=k.scale(d,b.Da,k.create());k.add(h,b.F,h);var f=k.scale(d,-b.Da,k.create());k.add(f,b.F,f);c=[c,e,h,f];d=k.normalize(d,k.create());e=c[0];h=c[0];for(f=1;f<c.length;f++){var g=k.dot(c[f],d);g<k.dot(e,d)&&(e=c[f]);g>k.dot(h,d)&&(h=c[f])}d=[e,h];c=d[0];d=d[1];a.F=k.scale(k.add(c,d,k.create()),.5,k.create());a.Da=k.length(k.subtract(d,c,k.create()))/2};a.Ep=function(a,b){var c=b.max_y,d=b.min_y,e=Math.max(0,c-d-2*a);return{Da:a,height:e,
F:new Float32Array([0,(c+d)/2,0])}};a.Gp=function(a,b){var c=b.max_y,d=b.min_y,e=Math.max(0,c-d);return{Da:a,height:e,F:new Float32Array([0,(c+d)/2,0])}};a.Fp=function(a,b){var c=b.max_y,d=b.min_y,e=Math.max(0,c-d);return{Da:a,height:e,F:new Float32Array([0,(c+d)/2,0])}};a.YC=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.Hz=function(a){for(var b=0,c=0,d=0,e=0,h=0,f=0,g=0,k=0,m=0;m<a.submeshes.length;m++){var l=
a.submeshes[m];if(l.position.length){b=e=l.position[0];c=h=l.position[1];d=f=l.position[2];break}}for(m=0;m<a.submeshes.length;m++)for(var l=a.submeshes[m],l=l.position,u=0;u<l.length/3;u++)var q=l[3*u],K=l[3*u+1],I=l[3*u+2],b=Math.max(q,b),c=Math.max(K,c),d=Math.max(I,d),e=Math.min(q,e),h=Math.min(K,h),f=Math.min(I,f),g=Math.max(Math.sqrt(q*q+K*K+I*I),g),k=Math.max(Math.sqrt(q*q+I*I),k);a.b4w_bounding_box.max_x=b;a.b4w_bounding_box.min_x=e;a.b4w_bounding_box.max_y=c;a.b4w_bounding_box.min_y=h;a.b4w_bounding_box.max_z=
d;a.b4w_bounding_box.min_z=f;a.b4w_bounding_box_source.max_x=b;a.b4w_bounding_box_source.min_x=e;a.b4w_bounding_box_source.max_y=c;a.b4w_bounding_box_source.min_y=h;a.b4w_bounding_box_source.max_z=d;a.b4w_bounding_box_source.min_z=f;a.b4w_bounding_sphere_radius=g;a.b4w_bounding_cylinder_radius=k};a.ey=function(b){var d=b.subarray(0,3),f=b.subarray(6,9),g=b.subarray(12,15),q=b.subarray(18,21);b=k.subtract(f,d,h);k.normalize(b,b);var r=e.gy(d,f,g,m),r=k.cross(r,b,r);k.normalize(r,r);var A=k.create(),
t=k.create();k.subtract(f,d,u);t[0]=k.dot(u,b);t[1]=k.dot(u,r);f=k.create();k.subtract(g,d,u);f[0]=k.dot(u,b);f[1]=k.dot(u,r);g=k.create();k.subtract(q,d,u);g[0]=k.dot(u,b);g[1]=k.dot(u,r);q=a.fj();g=[A,t,f,g];A=c(q,g[0],g[1]);for(q=2;q<g.length;q++)if(k.distance(A.F,g[q])>A.Da){for(var F=A,A=g,t=g[q],f=q-1,F=c(F,t,A[0]),C=1;C<=f;C++)if(k.distance(F.F,A[C])>F.Da){for(var l=F,F=A,H=t,J=A[C],K=C-1,l=c(l,H,J),I=0;I<=K;I++)if(k.distance(l.F,F[I])>l.Da){var P=H,z=J,N=F[I],G=k.subtract(z,N,u),G=k.squaredLength(G),
L=k.subtract(P,N,u),O=k.squaredLength(L),L=k.subtract(P,z,u),W=k.squaredLength(L),L=G*(O+W-G),X=O*(W+G-O),G=W*(G+O-W),O=L+X+G;k.copy(P,l.F);k.scale(l.F,L/O,l.F);k.scaleAndAdd(l.F,z,X/O,l.F);k.scaleAndAdd(l.F,N,G/O,l.F);l.Da=k.distance(l.F,P)}F=l}A=F}q=A;b=k.scale(b,q.F[0],u);k.scaleAndAdd(b,r,q.F[1],b);k.add(b,d,q.F);return q}};b4w.module.__compat=function(a,p){function b(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function d(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}function c(){return!window.ActiveXObject&&"ActiveXObject"in window}var e=p("__config"),f=p("__extensions"),g=p("__print");
p("__util");a.kA=function(a){var q=e.Nd,h=e.o,m=e.context,u=e.Ti,n=e.cd;h.mr=a.MAX_VERTEX_UNIFORM_VECTORS;h.Kb=a.getParameter(a.MAX_TEXTURE_SIZE);h.Bi=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE);var w=Boolean(f.$x());b("Firefox/28.0")&&(b("Linux")||b("Macintosh"))&&(g.warn("Firefox 28 detected, applying depth hack"),w=!1);b("iPad")||b("iPhone")?(g.warn("iOS detected, applying alpha hack, applying vertex animation mix normals hack and disable smaa. Disable ssao for performance. Disable video textures. Initialize WebAudio context with empty sound."),
m.alpha||(h.background_color[3]=1),h.lt=!0,h.smaa=!1,h.ff=!1,h.precision="highp",h.Qq=!0):b("Mac OS X")&&b("Safari")&&!b("Chrome")&&(g.warn("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures."),n.Yo=!0,n.vp=!0);b("Windows")&&(b("Chrome/40")||b("Firefox/33")||b("Firefox/34")||b("Firefox/35")||b("Firefox/36"))&&(g.warn("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),h.Il=!0);d()&&(g.warn("Mobile detected, applying various hacks for video textures."),
h.Sf=!0,b("iPad")||b("iPhone")||(g.warn("Mobile (not iOS) detected, disable playback rate for video textures."),n.Rp=!0));(b("Firefox/35.0")||b("Firefox/36.0"))&&b("Windows")&&(g.warn("Windows/Firefox 35/36 detected, applying shadows slink hack"),h.bq=!0);if(b("iPhone")||c())g.warn("iPhone or IE11 detected. Enable sequential video fallback for video textures."),h.Sc=!0;10>a.getParameter(a.MAX_VARYING_VECTORS)&&(g.warn("Not enough varyings, disable shadows on blend objects"),h.Qp=!0);if(m=f.wq())b("Macintosh")&&
-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("Intel HD Graphics 3000")&&(g.warn("OS X / Intel HD 3000 detected, applying depth hack"),w=!1),b("Windows")&&b("Chrome")&&-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("Intel")&&(g.warn("Chrome / Windows / Intel GPU detected, applying cubemap mipmap/rgb hack"),h.Om=!0),-1<a.getParameter(m.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("Mali-400")&&(g.warn("ARM Mali-400 detected, applying depth and frames blending hacks"),
w=!1,q.gq=!0),-1<a.getParameter(m.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("Mali-T604")&&(g.warn('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),h.precision="highp",h.Vi=!1),-1<a.getParameter(m.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("Mali-T760")&&(g.warn('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),h.precision="highp",h.ff=!1),-1<a.getParameter(m.UNMASKED_VENDOR_WEBGL).indexOf("Qualcomm")&&
-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("Adreno")&&(g.warn("Qualcomm Adreno detected, applying shader constants hack."),h.rs=!0,-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("305")&&(g.warn('Qualcomm Adreno305 detected, set "highp" precision.'),h.precision="highp"),-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("330")&&(g.warn('Qualcomm Adreno330 detected, set "highp" precision.'),h.precision="highp")),-1<a.getParameter(m.UNMASKED_VENDOR_WEBGL).indexOf("NVIDIA")&&-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("Tegra 3")&&
(g.warn("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),h.pm=!0);0==a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS)&&(g.warn("Vertex textures are not allowed. Disabling vertex textures"),h.il=!1);h.allow_hidpi&&1<window.devicePixelRatio&&(g.log("%cENABLE HIDPI MODE","color: #00a"),h.render_resolution_factor=1,h.smaa=!1);w||(h.Tg=!1,h.Hi=!1,h.mb=!1,h.water_dynamic=!1,h.shore_smoothing=!1,h.sh=!1,h.smaa=!1);h.et=Boolean(f.xq());h.gi=w;0===a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,
a.HIGH_FLOAT).precision&&(h.precision="mediump");c()&&(g.warn("IE11 detected. Set sky cubemap texture size to 512 (power of two)."),u.Ee=512);c()&&b("Touch")&&(g.warn("IE11 and touchscreen detected. Behaviour of the mouse move sensor will be changed."),h.Lm=!0);128>=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS)&&(g.warn("Not enough fragment uniforms, force low quality for B4W_LEVELS_OF_QUALITY nodes."),h.pm=!0);b("Chrome")&&(g.log("Chrome detected. Some of deprecated functions related to the Doppler effect won't be called."),
h.Hl=!0)};a.detect_mobile=d;a.jv=function(){b("Firefox/35.0")&&b("Windows")&&(g.warn("Windows/Firefox 35 detected, forcing context's alpha"),e.context.alpha=!0)};a.Qm=c};b4w.module.__constraints=function(a,p){function b(a){var b={};b.type=a;return b}function d(a,b){a.Wa&&a.Wa.N&&e(a.Wa.N,a);b.N&&c(b.N,a);a.Wa=b}function c(a,b){if(-1==a.Ic.indexOf(b))a.Ic.push(b);else throw"Descendant object override is forbidden";}function e(a,b){var c=a.Ic.indexOf(b);if(-1!=c)a.Ic.splice(c,1);else throw"No descendant object";}function f(a,b,c){switch(b.type){case 1:var d=a.d.quat,l=b.N.d.T;c=b.N.d.quat;b.gc?(w.copy(b.gc,d),w.multiply(c,d,d)):w.copy(c,d);n.transformMat4(b.offset,
l,a.d.h);a.d.scale=b.Fk*b.N.d.scale;break;case 9:var e=a.d.h,d=a.d.quat,l=b.N.d.T;c=b.N.d.quat;w.multiply(w.invert(b.lg,b.lg),d,d);w.multiply(c,d,d);n.transformMat4(b.offset,l,e);w.copy(c,b.lg);break;case 10:e=a.d.h;d=a.d.quat;l=b.N.d.T;c=b.N.d.quat;w.multiply(w.invert(b.lg,b.lg),d,d);w.multiply(c,d,d);n.transformMat4(b.offset,l,e);w.copy(c,b.lg);e=a.d.quat;d=w.multiply(b.N.d.quat,b.gc,C);d=u.oq(d,B);e=u.oq(e,y);u.rotate_eye_camera(a,m.Ce(e[0],d[0]+b.Yv,d[0]+b.Xv),m.Ce(e[1],d[1]+b.Wv,d[1]+b.Zv));
break;case 12:var e=a.d.h,d=a.d.quat,l=b.N.d.T,f=b.N.d.h,t=b.GA,A=r,J=C;n.transformMat4(b.offset,l,A);m.smooth_v(A,e,c,t,e);l=r;n.sub(f,e,l);n.normalize(l,l);var p=d,e=K,f=e.subarray(0,3),A=e.subarray(3,6),qa=e.subarray(6,9);n.copy(l,A);n.negate(A,A);n.normalize(A,A);Boolean(.999999<Math.abs(n.dot(l,m.AXIS_Y)))?(l=x.fromQuat(w.normalize(p,J),I),n.copy(l.subarray(0,3),f)):n.cross(m.AXIS_Y,A,f);n.normalize(f,f);n.cross(f,A,qa);n.normalize(qa,qa);w.fromMat3(e,J);w.normalize(J,J);m.As(J,d,c,.16*t,d);
break;case 2:d=a.d.quat;e=F;c=C;q(b.N,b.Ev,!0,e,c);b.gc?(w.copy(b.gc,d),w.multiply(c,d,d)):w.copy(c,d);a.d.scale=b.Fk*e[3];m.transform_vec3(b.offset,e[3],c,e,a.d.h);break;case 3:e=a.d.h;d=a.d.quat;c=b.N.d.h;g(e,d,c);break;case 4:e=a.d.h;d=a.d.quat;c=b.target;g(e,d,c);break;case 5:e=a.d.h;d=a.d.quat;c=b.N.d.h;g(e,d,c);d=n.dist(e,c);if(d=d>b.dist_max?d-b.dist_max:d<b.hi?d-b.hi:0)n.sub(c,e,r),n.normalize(r,r),n.scale(r,d,r),n.add(e,r,e);break;case 6:e=a.d.h;d=a.d.quat;c=b.target;g(e,d,c);d=n.dist(e,
c);if(d=d>b.dist_max?d-b.dist_max:d<b.hi?d-b.hi:0)n.sub(c,e,r),n.normalize(r,r),n.scale(r,d,r),n.add(e,r,e);break;case 7:l=b.N.d.T;n.transformMat4(b.offset,l,a.d.h);break;case 8:f=b.N.d.h;e=a.d.h;n.add(f,b.offset,e);break;case 13:d=a.d.quat;l=b.N.d.T;c=b.N.d.quat;b.gc?(w.copy(b.gc,d),w.multiply(c,d,d)):w.copy(c,d);n.transformMat4(b.offset,l,a.d.h);break;case 11:e=b.N.d;c=h.create_sep(e.h,e.scale,e.quat,H);h.multiply(c,b.Xs,c);e=a.d.h;e[0]=c[0];e[1]=c[1];e[2]=c[2];a.d.scale=c[3];d=a.d.quat;d[0]=c[4];
d[1]=c[5];d[2]=c[6];d[3]=c[7];break;case 14:c=b.N,d=u.cy(c),e=a.d.h,t=u.Sj(d,"TOP"),J=u.Sj(d,"BOTTOM"),l=t-J,b.gr?(f=u.Sj(d,"LEFT"),e[0]=f+l*b.Ym):(f=u.Sj(d,"RIGHT"),e[0]=f-l*b.Ym),e[2]=b.Vs?-(t-l*b.ao):-(J+l*b.ao),u.Qy(d)?e[1]=-b.distance:(e[1]=-1,n.normalize(e,e),n.scale(e,b.distance/Math.abs(e[1]),e)),h.transform_dir_vec3(e,c.d.Ab,e),n.add(c.d.h,e,e),d=a.d.quat,b.gc?(w.copy(b.gc,d),w.multiply(c.d.quat,d,d)):w.copy(c.d.quat,d)}"CAMERA"==a.d.type&&(e=m.AXIS_Y,10==b.type&&(c=b.N.d.quat,e=n.transformQuat(e,
c,P)),u.io(a),k(a,e))}function g(a,b,c){var d=r;m.quat_to_dir(b,m.AXIS_MY,d);n.normalize(d,d);var e=A;n.subtract(c,a,e);n.normalize(e,e);a=m.Xz(d,e,F);w.multiply(a,b,b);w.normalize(b,b)}function k(a,b){var c=a.d,d=c.quat,e=m.quat_to_dir(c.quat,m.AXIS_Y,r);n.normalize(e,e);if(.999999<Math.abs(n.dot(b,e)))e=w.identity(C);else{var l=n.cross(b,e,A);n.normalize(l,l);if(c.ua==u.MS_TARGET_CONTROLS)c.Xn&&n.negate(l,l);else{var f=m.quat_to_dir(c.quat,m.AXIS_Z,t);0<n.dot(f,b)&&n.negate(l,l)}c=m.quat_to_dir(c.quat,
m.AXIS_X,t);n.normalize(c,c);var f=m.clamp(n.dot(c,l),-1,1),h=Math.acos(f),e=-.999999>=f?w.setAxisAngle(e,h,C):w.rotationTo(c,l,C);w.normalize(e,e)}w.multiply(e,d,d);u.io(a)}function q(a,b,c,d,e){var f=a.d,g=f.Kf,k=f.Kc[b];b=k.fi;a=a.pose.bones[k.un];var k=a.Ko,m=F,t=f.Fc,P=f.Ec,u=f.xc,r=f.wc,q=t[4*b+1],n=t[4*b+2],I=t[4*b+3],y=P[4*b+1],K=P[4*b+2],A=P[4*b+3];m[0]=(1-g)*t[4*b]+g*P[4*b];m[1]=(1-g)*q+g*y;m[2]=(1-g)*n+g*K;m[3]=(1-g)*I+g*A;t=C;P=l;t[0]=u[4*b];t[1]=u[4*b+1];t[2]=u[4*b+2];t[3]=u[4*b+3];P[0]=
r[4*b];P[1]=r[4*b+1];P[2]=r[4*b+2];P[3]=r[4*b+3];w.slerp(t,P,g,t);g=H;h.set_transcale(m,g);h.set_quat(t,g);c?(c=J,h.translate(k,a.Ru,c),h.multiply(g,c,g)):h.multiply(g,k,g);h.multiply(f.Ab,g,g);d[0]=g[0];d[1]=g[1];d[2]=g[2];d[3]=g[3];e&&(e[0]=g[4],e[1]=g[5],e[2]=g[6],e[3]=g[7])}var h=p("__tsr"),m=p("__util"),u=p("__camera"),n=p("vec3");p("vec4");var w=p("quat"),x=p("mat3");p("mat4");a.uC=1;a.tC=2;a.yC=3;a.zC=4;a.oC=5;a.pC=6;a.vC=7;a.nC=8;a.sC=9;a.rC=10;a.Hd=11;a.qC=12;a.wC=13;a.xC=14;var B=new Float32Array(2),
y=new Float32Array(2),r=new Float32Array(3),A=new Float32Array(3),t=new Float32Array(3),F=new Float32Array(4),C=new Float32Array(4),l=new Float32Array(4),H=new Float32Array(16),J=new Float32Array(16),K=new Float32Array(9),I=new Float32Array(9),H=new Float32Array(8),P=new Float32Array(3);a.To=function(a,c,e,l,h){var g=b(1);g.N=c;g.offset=new Float32Array(e);g.gc=l?new Float32Array(l):null;g.Fk=h;d(a,g);f(a,g,0)};a.So=function(a,c,e,l,h,g){var k=b(2);k.N=c;k.Ev=e;k.offset=new Float32Array(l);k.gc=h?
new Float32Array(h):null;k.Fk=g;d(a,k);f(a,k,0)};a.bv=function(a,c,e,l){var h=b(9),g=a.d.quat,k=c.d.quat;h.N=c;h.offset=new Float32Array(e);h.lg=new Float32Array(k);l&&(w.copy(l,g),w.multiply(k,g,g));d(a,h);f(a,h,0)};a.av=function(a,c,e,l,h,g,k,t){var P=b(10),u=a.d.quat,r=c.d.quat;P.N=c;P.offset=new Float32Array(e);P.lg=new Float32Array(r);P.Xv=m.angle_wrap_0_2pi(h);P.Yv=m.angle_wrap_0_2pi(g);P.Zv=m.angle_wrap_periodic(k,-Math.PI,Math.PI);P.Wv=m.angle_wrap_periodic(t,-Math.PI,Math.PI);l?(P.gc=new Float32Array(l),
w.copy(l,u),w.multiply(r,u,u)):P.gc=w.create();d(a,P);f(a,P,0)};a.$u=function(a,c,e,l){var h=b(12);h.N=c;h.offset=new Float32Array(e);h.GA=l;d(a,h);f(a,h,0)};a.dv=function(a,c,e,l){var h=b(13);h.N=c;h.offset=new Float32Array(e);h.Fk=1;h.gc=l?new Float32Array(l):null;d(a,h);f(a,h,0)};a.QC=c;a.xE=e;a.fv=function(a,c){var e=b(3);e.N=c;d(a,e);f(a,e,0)};a.gv=function(a,c){var e=b(4);e.target=new Float32Array(c);d(a,e);f(a,e,0)};a.Xu=function(a,c,e,l){var h=b(5);h.N=c;h.hi=e;h.dist_max=l;d(a,h);f(a,h,0)};
a.Yu=function(a,c,e,l){var h=b(6);h.target=new Float32Array(c);h.hi=e;h.dist_max=l;d(a,h);f(a,h,0)};a.cv=function(a,c,e){var l=b(7);l.N=c;l.offset=new Float32Array(e);d(a,l);f(a,l,0)};a.Wu=function(a,c,e){var l=b(8);l.N=c;l.offset=new Float32Array(e);d(a,l);f(a,l,0)};a.Vu=function(a,c,e){var l=b(11);l.N=c;l.Xs=new Float32Array(e);d(a,l);f(a,l,0)};a.append_stiff_viewport=function(a,c,e){var l=b(14);l.N=c;if("left"in e)l.gr=!0,l.Ym=e.left;else if("right"in e)l.gr=!1,l.Ym=e.right;else{m_print.error("append_stiff_viewport: Wrong positioning params");
return}if("top"in e)l.Vs=!0,l.ao=e.top;else if("bottom"in e)l.Vs=!1,l.ao=e.bottom;else{m_print.error("append_stiff_viewport: Wrong positioning params");return}"distance"in e?(l.distance=e.distance,l.gc="rotation"in e?new Float32Array(e.rotation):null,d(a,l),f(a,l,0)):m_print.error("append_stiff_viewport: Wrong positioning params")};a.BB=function(a,b){a.Wa&&f(a,a.Wa,b)};a.Wz=g;a.correct_up=k;a.Ov=function(a){return a.Wa?!0:!1};a.remove=function(a){a.Wa.N&&e(a.Wa.N,a);a.Wa=null};a.de=function(a){return a.Wa?
a.Wa.type:null};a.get_parent=function(a){return a.Wa&&a.Wa.N?a.Wa.N:null};a.ce=function(a){return a.Wa&&11==a.Wa.type?a.Wa.Xs:null};a.Vx=q};b4w.module.__container=function(a,p){var b,d,c,e,f;function g(a,c){b=a;d=c}function k(){var a=m.getBoundingClientRect();g(a.left,a.top)}var q=p("__print"),h=p("__util"),m=null,u=null,n=!1;e=c=0;f=1;b=d=0;a.get_canvas=function(){return m};a.get_container=function(){return u};a.init=function(a){a&&a.parentNode?(m=a,u=a.parentNode):h.pa("canvas container is not available")};a.insert_to_container=function(a,b){b=b||"LAST";switch(b){case "FIRST":u.insertBefore(a,u.firstElementChild);break;case "JUST_BEFORE_CANVAS":u.insertBefore(a,
m);break;case "JUST_AFTER_CANVAS":m.nextElementSibling?u.insertBefore(a,m.nextElementSibling):u.appendChild(a,m);break;case "LAST":u.appendChild(a,m);break;default:q.error(b+" behavior unknown")}};a.ry=function(){return c};a.qy=function(){return e};a.set_canvas_offsets=g;a.update_canvas_offsets=k;a.zA=function(a,b,d){c=a;e=b;f=d;k()};a.force_offsets_updating=function(){n=!0};a.client_to_canvas_coords=function(a,c,e){e||(e=new Float32Array(2));var h=e;n&&(k(),n=!1);h[0]=a-b;a=e;n&&(k(),n=!1);a[1]=
c-d;return e};a.El=function(a,b,d,e){d||(d=new Float32Array(2));d[0]=a*f;d[1]=b*f;e&&(a=e.width/c,d[0]*=a,d[1]*=a);return d};a.eC=function(a,b,d,e){d||(d=new Float32Array(2));d[0]=a/f;d[1]=b/f;e&&(a=e.width/c,d[0]/=a,d[1]/=a)}};b4w.module.__controls=function(a,p){function b(a){return{type:a,value:0,aa:null,Xc:!1,key:0,Na:"",ld:!1,Ll:null,Kl:function(){},Jl:null,xp:function(){},ne:null,M:new Float32Array(3),la:new Float32Array(3),Tq:!1,Yj:!1,bs:0,as:function(){},axis:"",Dc:0,Hh:new Float32Array(3),Ak:new Float32Array(4),threshold:0,Yr:new Float32Array(4),uj:0,tj:0,js:0,vj:0,Qc:0,repeat:!1,Zo:!1,Xj:0,Wj:0,Vj:0,Gm:0,Fm:0,Em:0}}function d(a,b){a.value=Number(b)}function c(a){a=P.indexOf(a);-1<a?P.splice(a,1):A.error("Wrong object")}
function e(a,b){for(var c=0,d=0;d<b.length;d++)for(var e=b[d].ye,l=0;l<e.length;l++)for(var G=e[l].vd,h=0;h<G.length;h++)G[h]===a&&c++;return c}function f(a,b){switch(a.type){case 80:t.remove_collision_test(a.Ll,a.Na,a.Kl);a.Xc=!0;break;case 90:t.clear_collision_impulse_test(a.Jl);a.Xc=!0;break;case 100:t.remove_ray_test(a.bs);a.Xc=!0;break;case 130:a.Xc=!0}var c=b.indexOf(a);-1<c&&b.splice(c,1)}function g(a){for(var b=0;b<z.length;b++){var c=z[b];20==c.type&&a.keyCode==c.key&&d(c,1)}pa&&a.preventDefault();
sa&&sa(a)}function k(a){for(var b=0;b<z.length;b++){var c=z[b];20==c.type&&0==a.keyCode&&16==c.key&&d(c,0);20==c.type&&a.keyCode==c.key&&d(c,0)}pa&&a.preventDefault();sa&&sa(a)}function q(a){var b=!1,c=null;Y=!0;W=a.clientX;X=a.clientY;L=a.clientX;O=a.clientY;for(var e=0;e<z.length;e++){var l=z[e];50==l.type&&(d(l,1),l.aa=a.which);160==l.type&&(b||(b=r.client_to_canvas_coords(a.clientX,a.clientY,v),c=F.pick_object(b[0],b[1]),b=!0),l.value=c==l.ne?1:0)}U&&a.preventDefault();ra&&ra(a)}function h(a){for(var b=
0;b<z.length;b++){var c=z[b];50==c.type&&d(c,0);160==c.type&&c.Zo&&(c.value=0)}Y=!1;U&&!ia&&a.preventDefault();ra&&ra(a)}function m(a){var b=a.clientX,c=a.clientY;L=b;O=c;if(!I.Lm||Y)for(var e=b-W,l=c-X,G=Math.sqrt(e*e+l*l),h=0;h<z.length;h++){var f=z[h];if(40===f.type)switch(f.axis){case "X":d(f,e);f.aa=b;break;case "Y":d(f,l);f.aa=c;break;case "XY":d(f,G),f.aa[0]=b,f.aa[1]=c}}U&&!ia&&a.preventDefault();ra&&ra(a)}function u(a){var b=a.wheelDelta||-40*a.detail,b=b*K.iz;G+=b;for(b=0;b<z.length;b++){var c=
z[b];30===c.type&&d(c,G)}S&&a.preventDefault();Q&&Q(a)}function n(a){var b=a.targetTouches;if(1==b.length){for(var c=b[0],b=c.clientX,c=c.clientY,d=!1,e=null,l=0;l<z.length;l++){var h=z[l];160==h.type&&(d||(d=r.client_to_canvas_coords(b,c,v),e=F.pick_object(d[0],d[1]),d=!0),h.value=e==h.ne)}ja[0]=b;ja[1]=-1;qa[0]=c;qa[1]=-1}else 1<b.length&&(la=V=B(b),ja[0]=b[0].clientX,ja[1]=b[1].clientX,qa[0]=b[0].clientY,qa[1]=b[1].clientY);R.set(ja);ga.set(qa);ca&&ca(a)}function w(E){var b=E.targetTouches;if(0!==
b.length){if(1===b.length){R[0]=b[0].clientX;R[1]=-1;ga[0]=b[0].clientY;ga[1]=-1;var b=R[0]-ja[0],c=ga[0]-qa[0],e=Math.sqrt(b*b+c*c);if(-1!=ja[1]&&-1!=qa[1]){var l=R[0]-ja[1],h=ga[0]-qa[1],G=Math.sqrt(l*l+h*h);G<e&&(b=l,c=h,e=G)}for(G=0;G<z.length;G++){var f=z[G];if(60===f.type)switch(f.aa=a.PL_SINGLE_TOUCH_MOVE,f.axis){case "X":d(f,b);break;case "Y":d(f,c);break;case "XY":d(f,e)}}}else if(1<b.length){R[0]=b[0].clientX;R[1]=b[1].clientX;ga[0]=b[0].clientY;ga[1]=b[1].clientY;la=B(b);e=la-V;l=v;l[0]=
(R[0]+R[1])/2;l[1]=(ga[0]+ga[1])/2;h=Z;h[0]=(ja[0]+ja[1])/2;h[1]=(qa[0]+qa[1])/2;var g,b=l[0],c=l[1],G=h[0],f=h[1];g=Math.sqrt((b-G)*(b-G)+(c-f)*(c-f));for(G=0;G<z.length;G++)if(f=z[G],70===f.type&&Math.abs(g)<Math.abs(e)&&(f.aa=a.PL_MULTITOUCH_MOVE_ZOOM,d(f,e)),60===f.type&&Math.abs(g)>Math.abs(e))switch(f.aa=a.PL_MULTITOUCH_MOVE_PAN,f.axis){case "X":b=l[0]-h[0];d(f,b);break;case "Y":c=l[1]-h[1];d(f,c);break;case "XY":d(f,g)}}fa&&E.preventDefault();ca&&ca(E)}}function x(a){for(var b=0;b<z.length;b++){var c=
z[b];if(170==c.type||180==c.type)c.Wj=a.beta,c.Xj=a.gamma,c.Vj=a.alpha,c.value||(c.Gm=a.gamma,c.Fm=a.beta,c.Em=a.alpha,d(c,1))}}function B(a){var b=a[0],c=a[1];a=b.clientX;var b=b.clientY,d=c.clientX,c=c.clientY;return Math.sqrt((a-d)*(a-d)+(b-c)*(b-c))}var y=p("__config"),r=p("__container"),A=p("__print"),t=p("__physics"),F=p("__scenes"),C=p("__time"),l=p("__util"),H=p("vec3"),J=p("quat"),K=y.controls,I=y.o,P=[],z=[],N={},G=0,L=0,O=0,W=0,X=0,Y=!1,R=new Float32Array(2),ga=new Float32Array(2),ja=new Float32Array(2),
qa=new Float32Array(2),v=new Float32Array(2),Z=new Float32Array(2),la=0,V=0,ha=!1,ea=0,pa=!1,U=!1,S=!1,fa=!1,ia=!1,sa=null,ra=null,Q=null,ca=null;a.CT_CONTINUOUS=10;a.CT_TRIGGER=20;a.CT_SHOT=30;a.CT_LEVEL=40;a.PL_SINGLE_TOUCH_MOVE=0;a.PL_MULTITOUCH_MOVE_ZOOM=1;a.PL_MULTITOUCH_MOVE_PAN=2;a.update=function(E,b){for(var c=0;c<z.length;c++){var e=z[c],h=E,f=b;if(f)switch(e.type){case 110:var g=e.ne,Q=g.d.h,g=g.d.quat,k=H.dist(e.Hh,Q),m=e.Yr;J.invert(e.Ak,m);J.multiply(g,m,m);J.normalize(m,m);m=Math.abs(2*
Math.acos(m[3]));k/=f;e.uj=l.smooth(k,e.uj,f,.3);e.aa[0]=k;k=m/f;e.tj=l.smooth(k,e.tj,f,.3);e.aa[1]=k;e.uj>=e.threshold||e.tj>=e.js?d(e,1):d(e,0);H.copy(Q,e.Hh);J.copy(g,e.Ak);e.Dc=h;break;case 120:g=e.ne;Q=g.d.h;g=Math.abs(Q[1]-e.Hh[1])/f;e.vj=l.smooth(g,e.vj,f,.3);e.aa=g;e.vj>=e.threshold?d(e,1):d(e,0);H.copy(Q,e.Hh);e.Dc=h;break;case 130:!e.Xc&&0<=e.Qc&&h-e.Dc>=e.Qc&&(d(e,1),e.repeat?e.Dc=h:e.Qc=-e.Qc);break;case 140:e.Dc||(e.Dc=h);d(e,h-e.Dc);e.Dc=h;break;case 150:d(e,h);break;case 170:e.aa[0]=
Math.PI*(e.Xj-e.Gm)/180;e.aa[1]=Math.PI*(e.Wj-e.Fm)/180;e.aa[2]=Math.PI*(e.Vj-e.Em)/180;e.Gm=e.Xj;e.Fm=e.Wj;e.Em=e.Vj;break;case 180:e.aa[0]=Math.PI*e.Xj/180,e.aa[1]=Math.PI*e.Wj/180,e.aa[2]=Math.PI*e.Vj/180}}for(c=0;c<P.length;c++)for(f=P[c],e=f.ye,h=0;h<e.length;h++)if(Q=e[h],Q.Zs!=ea){Q.Zs=ea;for(var g=Q,k=g.vd,m=g.fA,t=0;t<k.length;t++)m[t]=k[t].value;var g=g.Yy(m),k=Q,m=k.dr,u=t=void 0;switch(k.type){case a.CT_CONTINUOUS:g?u=t=1:1==m?u=t=-1:t=0;break;case a.CT_TRIGGER:g&&-1==m?u=t=1:g||1!=m?
t=0:u=t=-1;break;case a.CT_SHOT:g&&-1==m?u=t=1:g||1!=m?t=0:(t=0,u=-1);break;case a.CT_LEVEL:t=k.cr!=g?1:0;break;default:l.pa("Wrong sensor manifold type: "+k.type)}u&&(k.dr=u);if(k=t)if(m=f==N?null:f,ha=!1,Q.callback(m,Q.id,k,Q.Hv),Q.cr=g,ha){c=-1;break}}for(c=0;c<P.length;c++)for(f=P[c],e=f.ye,h=0;h<e.length;h++)for(Q=e[h],f=Q.vd,Q=0;Q<f.length;Q++)switch(g=f[Q],g.type){case 30:d(g,0);break;case 40:d(g,0);break;case 60:d(g,0);break;case 70:d(g,0);break;case 130:d(g,0)}G=0;W=L;X=O;ja.set(R);qa.set(ga);
V=la;ea++};a.create_custom_sensor=function(a){var c=b(10);d(c,a);return c};a.create_keyboard_sensor=function(a){var c=b(20);c.key=a;return c};a.create_collision_sensor=function(a,c,e){if(!a||!t.has_physics(a))return A.error("Wrong collision object"),null;var l=b(80);l.Ll=a;l.Na=c;l.ld=e;l.aa={coll_obj:null,coll_pos:e?new Float32Array(3):null,coll_norm:e?new Float32Array(3):null,coll_dist:0};l.Kl=function(a,E,b,c,e){d(l,a);a=l.aa;a.coll_obj=E;l.ld&&(a.coll_pos.set(b),a.coll_norm.set(c),a.coll_dist=
e)};l.Xc=!0;return l};a.create_collision_impulse_sensor=function(a){if(!a||!a.m)return A.error("Wrong collision impulse object"),null;var c=b(90);c.Jl=a;c.xp=function(a){d(c,a)};c.Xc=!0;return c};a.create_ray_sensor=function(a,c,e,l,h,f,G){var g=b(100);g.ne=a;g.M=c;g.la=e;g.Na=l;g.Tq=h;g.ld=f;g.Yj=G;g.aa={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3)};g.as=function(a,E,b,c,e,T){g.Tq?d(g,-1==E?0:1):d(g,E);g.aa.hit_fract=E;g.aa.obj_hit=b;g.aa.hit_time=
c;g.ld&&(g.aa.hit_pos.set(e),g.aa.hit_norm.set(T))};g.Xc=!0;return g};a.create_mouse_click_sensor=function(){return b(50)};a.create_mouse_wheel_sensor=function(){return b(30)};a.create_mouse_move_sensor=function(a){var c=b(40);c.axis=a||"XY";c.aa="XY"==c.axis?new Float32Array(2):0;return c};a.create_touch_move_sensor=function(a){var c=b(60);c.axis=a||"XY";c.aa=0;return c};a.create_touch_zoom_sensor=function(){var a=b(70);a.aa=0;return a};a.create_motion_sensor=function(a,c,d){if(!a)return A.error("Wrong collision object"),
null;var e=b(110);e.ne=a;var l=a.d.h;a=a.d.quat;e.Yr=new Float32Array(4);e.Hh=new Float32Array(l);e.Ak=new Float32Array(a);e.uj=0;e.tj=0;e.threshold=c||.1;e.js=d||.1;e.Dc=0;e.aa=new Float32Array([0,0]);return e};a.create_vertical_velocity_sensor=function(a,c){if(!a)return A.error("Wrong collision object"),null;var d=b(120);d.ne=a;var e=a.d.quat;d.Hh=new Float32Array(a.d.h);d.Ak=new Float32Array(e);d.vj=0;d.threshold=c||1;d.Dc=0;d.aa=0;return d};a.create_timer_sensor=function(a,c){var d=b(130);d.Qc=
a;d.repeat=c;d.Xc=!0;return d};a.reset_timer_sensor=function(a,b,c,d){a=a||N;a=a.Tc;if(!a||!a[b])return A.error("reset_timer_sensor(): wrong object"),null;b=a[b].vd[c];if(!b)return A.error("reset_timer_sensor(): sensor not found"),null;b.Dc=C.get_timeline();b.Qc=d};a.create_elapsed_sensor=function(){var a=b(140);a.Dc=0;return a};a.create_gyro_delta_sensor=function(){var a=b(170);a.aa=new Float32Array(3);return a};a.create_gyro_angles_sensor=function(){var a=b(180);a.aa=new Float32Array(3);return a};
a.create_timeline_sensor=function(){return b(150)};a.create_selection_sensor=function(a,c){var d=b(160);d.ne=a;d.Zo=c;return d};a.eA=d;a.get_sensor_value=function(a,b,c){a=a||N;a=a.Tc;if(!a||!a[b])return A.error("get_sensor_value(): wrong object"),null;b=a[b].vd[c];return b?b.value:(A.error("get_sensor_value(): sensor not found"),null)};a.get_sensor_payload=function(a,b,c){a=a||N;a=a.Tc;if(!a||!a[b])return A.error("get_sensor_payload(): wrong object"),null;b=a[b].vd[c];return b?b.aa:(A.error("get_sensor_payload(): sensor not found"),
null)};a.cleanup=function(){P=[];z=[];N={}};a.check_sensor_manifold=function(a,b){a=a||N;if(!a.Tc)return!1;if(b&&a.Tc[b])return!0;if(!b)for(var c in a.Tc)return!0;return!1};a.remove_sensor_manifold=function(a,b){a=a||N;var d=a.Tc;if(d){var h=a.ye;if(b){var G=d[b];if(G){for(var g=G.vd,Q=0;Q<g.length;Q++)1===e(g[Q],P)&&f(g[Q],z);delete d[b];G=h.indexOf(G);-1<G?h.splice(G,1):l.pa("Incorrect manifolds array");Object.getOwnPropertyNames(d).length||c(a)}}else{for(b in d){G=d[b];g=G.vd;for(Q=0;Q<g.length;Q++)1===
e(g[Q],P)&&f(g[Q],z);delete d[b];G=h.indexOf(G);-1<G?h.splice(G,1):l.pa("Incorrect manifolds array")}c(a);ha=!0}}};a.create_sensor_manifold=function(a,b,c,d,h,G,g){a=a||N;a.Tc=a.Tc||{};a.ye=a.ye||[];var Q=a.Tc,L=a.ye,k=Q[b];if(k){d=k.vd;for(var m=0;m<d.length;m++)1===e(d[m],P)&&f(d[m],z);k=L.indexOf(k);-1<k?L.splice(k,1):l.pa("Incorrect manifolds array")}c={id:b,type:c,vd:d.slice(0),Yy:h,fA:Array(d.length),callback:G,Hv:g,dr:-1,cr:0,Zs:-1};Q[b]=c;L.push(c);-1==P.indexOf(a)&&P.push(a);a=c.vd;for(b=
0;b<a.length;b++){Q=a[b];if(Q.Xc){switch(Q.type){case 80:t.append_collision_test(Q.Ll,Q.Na,Q.Kl,Q.ld);break;case 90:t.apply_collision_impulse_test(Q.Jl,Q.xp);break;case 100:Q.bs=t.append_ray_test(Q.ne,Q.M,Q.la,Q.Na,Q.as,!1,!1,Q.ld,Q.Yj);break;case 130:Q.Dc=C.get_timeline(),0>Q.Qc&&(Q.Qc=-Q.Qc)}Q.Xc=!1}-1==z.indexOf(Q)&&z.push(Q)}ha=!0};a.Np=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.Vw=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-
1]};a.reset=function(){for(var a=0;a<P.length;a++){var b=P[a],c=b.Tc,b=b.ye,d;for(d in c)delete c[d];b.splice(0,b.length)}for(a=0;a<z.length;a++)f(z[a],z),a--;P.splice(0,P.length)};a.debug=function(){A.log(String(P.length)+" objects with manifolds",P);A.log(String(z.length)+" sensors",z);for(var a=[],b=[],c=0;c<z.length;c++){var d=z[c];80==d.type&&a.push(d);100==d.type&&b.push(d)}A.log(String(a.length)+" collision sensors",a);A.log(String(b.length)+" ray sensors",b)};a.register_keyboard_events=function(a,
b){a.addEventListener("keydown",g,!1);a.addEventListener("keyup",k,!1);pa=b};a.register_mouse_events=function(a,b,c){if(c)var d=window;else d=a,d.addEventListener("mouseout",h,!1);a.addEventListener("mousedown",q,!1);d.addEventListener("mousemove",m,!1);d.addEventListener("mouseup",h,!1);U=b;ia=c};a.register_wheel_events=function(a,b){a.addEventListener("mousewheel",u,!1);a.addEventListener("DOMMouseScroll",u,!1);S=b};a.register_touch_events=function(a,b){a.addEventListener("touchstart",n,!1);a.addEventListener("touchmove",
w,!1);document.addEventListener("touchstart",function(){});fa=b};a.register_device_orientation=function(){window.DeviceOrientationEvent&&I.gyro_use&&window.addEventListener("deviceorientation",x,!1)};a.unregister_keyboard_events=function(a){a.removeEventListener("keydown",g,!1);a.removeEventListener("keyup",k,!1)};a.unregister_mouse_events=function(a){a.removeEventListener("mousedown",q,!1);a.removeEventListener("mousemove",m,!1);a.removeEventListener("mouseout",h,!1);a.removeEventListener("mouseup",
h,!1)};a.unregister_wheel_events=function(a){a.removeEventListener("mousewheel",u,!1);a.removeEventListener("DOMMouseScroll",u,!1)};a.unregister_touch_events=function(a){a.removeEventListener("touchstart",n,!1);a.removeEventListener("touchmove",w,!1);document.removeEventListener("touchstart",function(){})};a.unregister_device_orientation=function(){window.DeviceOrientationEvent&&I.gyro_use&&window.removeEventListener("deviceorientation",x,!1)};a.OC=function(a){sa=a};a.PC=function(a){ra=a};a.SC=function(a){Q=
a};a.RC=function(a){ca=a}};b4w.module.__curve=function(a,p){function b(a,b,c,d,e){var m=d.length;e||(e=new Float32Array(m));for(var u=m+a,n=new Float32Array(u),w=1;w<=u-1;w++)n[w-1]=b>=c[w-1]&&b<c[w+1-1]?1:0;for(var x=2;x<=a;x++)for(w=1;w<=u-x;w++)n[w-1]=(0!=n[w-1]?(b-c[w-1])*n[w-1]/(c[w+x-1-1]-c[w-1]):0)+(0!=n[w+1-1]?(c[w+x-1]-b)*n[w+1-1]/(c[w+x-1]-c[w+1-1]):0);b==c[u-1]&&(n[m-1]=1);a=0;for(w=1;w<=m;w++)a+=n[w-1]*d[w-1];for(w=1;w<=m;w++)e[w-1]=0!=a?n[w-1]*d[w-1]/a:0;return e}function d(a){a=a.fk;return a[a.length-1]}function c(a){a=
a.Jp;return a[a.length-1]}var e=p("__util");a.Hw=function(a){var c={},d=a.data;a=d.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var e=a.order_u;c.Te=e;a=a.points;var h=a.length/5,m=[],u=h+e,h=h+2;m[0]=0;for(var n=2;n<=u;n++)m[n-1]=n>e&&n<h?m[n-2]+1:m[n-2];c.fk=m;if("2D"==d.dimensions)c.Qe=!1;else if("3D"==d.dimensions)c.Qe=!0;else throw"Wrong curve dimensions";e=[];m=[];for(d=0;d<a.length;d+=5)e.push(a[d]),e.push(a[d+1]),e.push(a[d+2]),c.Qe&&e.push(a[d+3]),m.push(a[d+4]);c.Pl=
e;c.uo=m;a=[];for(var d=c.Pl,e=c.Qe?4:3,m=c.uo,u=c.fk,h=c.Te,n=d.length/e,w=n+h,x=0,B=u[w-1]/999,y=0;1E3>y;y++){5E-6>u[w-1]-x&&(x=u[w-1]);for(var r=b(h,x,u,m),A=0;A<e;A++)for(var t=a[e*y+A]=0;t<n;t++)a[e*y+A]+=r[t]*d[e*t+A];x+=B}e=c.Qe?4:3;m=new Float32Array(1E3);m[0]=0;for(d=1;1E3>d;d+=1)u=a[(d-1)*e],h=a[(d-1)*e+1],n=a[(d-1)*e+2],w=a[d*e],x=a[d*e+1],B=a[d*e+2],m[d]=m[d-1]+Math.sqrt((w-u)*(w-u)+(x-h)*(x-h)+(B-n)*(B-n));c.Jp=m;return c};a.TA=function(a,c,e){e||(e=[]);var q=c,h=Math.max(q,0);c=h=Math.min(q,
d(a));var q=a.Pl,h=a.Qe?4:3,m=a.uo,u=a.fk,n=a.Te;a=q.length/h;var w=a+n;5E-6>u[w-1]-c&&(c=u[w-1]);w=new Float32Array(a);b(n,c,u,m,w);for(c=0;c<h;c++)for(m=e[c]=0;m<a;m++)e[c]+=w[m]*q[h*m+c]};a.QA=function(a,b,c){c||(c=[]);var d=a.Pl,e=a.Qe?4:3,m=a.uo,u=a.fk,n=a.Te;a=d.length/e;var w=a+n;5E-6>u[w-1]-b&&(b=u[w-1]);var w=new Float32Array(a),x=b;b=w;var B=m.length;b||(b=new Float32Array(B));var y=new Float32Array(B),r=new Float32Array(B),A=y,t=r;A||(A=new Float32Array(B));t||(t=new Float32Array(B));for(var F=
B+n,C=new Float32Array(F),l=new Float32Array(F),H=1;H<=F-1;H++)C[H-1]=x>=u[H-1]&&x<u[H+1-1]?1:0;x==u[F-1]&&(C[B-1]=1);for(var J=2;J<=n;J++)for(H=1;H<=F-J;H++){var K=0!=C[H-1]?C[H-1]/(u[H+J-1-1]-u[H-1]):0,I=0!=C[H+1-1]?-C[H+1-1]/(u[H+J-1]-u[H+1-1]):0,P=0!=l[H-1]?(x-u[H-1])*l[H-1]/(u[H+J-1-1]-u[H-1]):0,z=0!=l[H+1-1]?(u[H+J-1]-x)*l[H+1-1]/(u[H+J-1]-u[H+1-1]):0;C[H-1]=(0!=C[H-1]?(x-u[H-1])*C[H-1]/(u[H+J-1-1]-u[H-1]):0)+(0!=C[H+1-1]?(u[H+J-1]-x)*C[H+1-1]/(u[H+J-1]-u[H+1-1]):0);l[H-1]=K+I+P+z}for(H=1;H<=
B;H++)A[H-1]=C[H-1],t[H-1]=l[H-1];u=0;for(n=1;n<=B;n++)u+=y[n-1]*m[n-1];x=0;for(n=1;n<=B;n++)x+=r[n-1]*m[n-1];for(n=1;n<=B;n++)b[n-1]=0!=u?r[n-1]*m[n-1]/u+y[n-1]*m[n-1]*x/(u*u):0;for(m=0;m<e;m++)for(u=c[m]=0;u<a;u++)c[m]+=w[u]*d[e*u+m]};a.GE=d;a.SA=c;a.RA=function(a,b){if(0>=b)return 0;var k=d(a);if(b>=c(a))return k;var q=a.Jp,h=e.xj(q,b,0,q.length-1);return k*(h+(b-q[h])/(q[h+1]-q[h]))/1E3}};b4w.module.__dds=function(a,p){function b(a,b,c,d){var e=new Uint16Array(4),h=new Uint16Array(c*d),g=0,f=0,k=0,t=f=g=0,q=0,C=0,l=0,H=c/4;d/=4;for(var J=0;J<d;J++)for(var K=0;K<H;K++)k=b+4*(J*H+K),e[0]=a[k],e[1]=a[k+1],g=e[0]&31,f=e[0]&2016,t=e[0]&63488,q=e[1]&31,C=e[1]&2016,l=e[1]&63488,e[2]=5*g+3*q>>3|5*f+3*C>>3&2016|5*t+3*l>>3&63488,e[3]=5*q+3*g>>3|5*C+3*f>>3&2016|5*l+3*t>>3&63488,g=a[k+2],f=4*J*c+4*K,h[f]=e[g&3],h[f+1]=e[g>>2&3],h[f+2]=e[g>>4&3],h[f+3]=e[g>>6&3],f+=c,h[f]=e[g>>8&3],h[f+1]=e[g>>
10&3],h[f+2]=e[g>>12&3],h[f+3]=e[g>>14],g=a[k+3],f+=c,h[f]=e[g&3],h[f+1]=e[g>>2&3],h[f+2]=e[g>>4&3],h[f+3]=e[g>>6&3],f+=c,h[f]=e[g>>8&3],h[f+1]=e[g>>10&3],h[f+2]=e[g>>12&3],h[f+3]=e[g>>14];return h}function d(a,c,d,e){var x=new Int32Array(d,0,31),B,y,r,A,t,F;if(542327876!=x[0])return g.error("Invalid magic number in DDS header"),0;if(!x[20]&4)return g.error("Unsupported format, must contain a FourCC code"),0;B=x[21];switch(B){case k:y=8;r=c?c.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case q:y=16;r=
c?c.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case h:y=16;r=c?c.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return g.error("Unsupported FourCC code:",f(B)),null}F=1;x[2]&131072&&!1!==e&&(F=Math.max(1,x[7]));A=x[4];t=x[3];x=x[1]+4;if(c)for(B=0;B<F;++B)e=Math.max(4,A)/4*Math.max(4,t)/4*y,c=new Uint8Array(d,x,e),a.compressedTexImage2D(a.TEXTURE_2D,B,r,A,t,0,c),x+=e,A=Math.max(.5*A,1),t=Math.max(.5*t,1);else if(B==k)Math.max(4,A),Math.max(4,t),c=new Uint16Array(d),d=b(c,x/2,A,t),a.texImage2D(a.TEXTURE_2D,
0,a.RGB,A,t,0,a.RGB,a.UNSIGNED_SHORT_5_6_5,d),e&&a.generateMipmap(a.TEXTURE_2D);else return g.error("No manual decoder for",f(B),"and no native support"),0;return F}function c(a,b,c,e,h,g){var f=new XMLHttpRequest;f.open("GET",c,!0);f.responseType="arraybuffer";f.onload=function(){if(200==f.status){a.bindTexture(a.TEXTURE_2D,e);var c=d(a,b,f.response,h);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<c?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}g&&
g(e)};f.send(null);return e}function e(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function f(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var g=p("__print"),k=e("DXT1"),q=e("DXT3"),h=e("DXT5");a.oD=b;a.OB=d;a.Aq=function(a){a=new Int32Array(a,0,31);return{width:a[4],height:a[3]}};a.Yx=function(a){var b=1;a=(new Int32Array(a,0,31))[21];switch(a){case k:b=6;break;case q:case h:b=4;break;default:g.error("Unsupported FourCC code:",f(a))}return b};
a.lE=c;a.kE=function(a,b,d,e){var h=a.createTexture();c(a,b,d,h,!0,e);return h}};b4w.module.__debug=function(a,p){function b(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function d(a,b){typeof a!=typeof b&&g.pa("Structure assertion failed: incompatible types");for(var c in a)c in b||g.pa("Structure assertion failed: missing key in the first object: "+c);for(c in b)c in a||g.pa("Structure assertion failed: missing key in the second object: "+c),typeof a[c]!=typeof b[c]&&g.pa("Structure assertion failed: incompatible types for key "+c)}var c=
p("__extensions"),e=p("__print"),f=p("__textures"),g=p("__util"),k=null,q={},h=!1,m={},u=[],n=-1,w=null,x=!1;a.Go={WM_OPAQUE_WIREFRAME:0,WM_TRANSPARENT_WIREFRAME:1,WM_FRONT_BACK_VIEW:2,WM_DEBUG_SPHERES:3};a.bd=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c;for(c in b){var d=b[c];d in a&&(q[a[d]]=d)}k=a};a.Rv=function(a){if(h){var b=k.getError();b!=k.NO_ERROR&&(b in q?g.pa("GL Error: "+b+", gl."+q[b]+" ("+
a+")"):g.pa("Unknown GL error: "+b+" ("+a+")"))}};a.Mv=function(){if(h)switch(k.checkFramebufferStatus(k.FRAMEBUFFER)){case k.FRAMEBUFFER_COMPLETE:break;case k.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case k.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case k.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");
break;case k.FRAMEBUFFER_UNSUPPORTED:e.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;default:e.error("FRAMEBUFFER CHECK FAILED")}};a.Pv=function(){if(-1!=n)return n;k.bindFramebuffer(k.FRAMEBUFFER,k.createFramebuffer());var a=f.Jj("DEBUG",f.Qh);f.resize(a,1,1);k.framebufferTexture2D(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,a.Ob,a.Va,0);k.checkFramebufferStatus(k.FRAMEBUFFER)!=k.FRAMEBUFFER_COMPLETE?(n=!0,e.warn("depth-only issue was found")):n=!1;k.bindFramebuffer(k.FRAMEBUFFER,null);return n};
a.Sv=function(a,c,d){if(h&&!k.getShaderParameter(a,k.COMPILE_STATUS))throw d=b(d),e.error("shader compilation failed:\n"+d+"\n"+k.getShaderInfoLog(a)+" ("+c+")"),"Engine failed: see above for error messages";};a.Tv=function(a,d,g,f,m,u){if(h&&!k.getProgramParameter(a,k.LINK_STATUS)){var l=c.qq();l&&(m=l.getTranslatedShaderSource(g),u=l.getTranslatedShaderSource(f));m=b(m);u=b(u);e.error("shader linking failed:\n"+m+"\n\n\n"+u+"\n"+k.getProgramInfoLog(a)+" ("+d+")");throw"Engine failed: see above for error messages";
}};a.set_check_gl_errors=function(a){h=a};a.pD=function(a){m[a]=a in m?m[a]+1:1};a.update=function(){for(var a in m)e.log(a,m[a]),m[a]=0};a.fbmsg=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(g.is_vector(c))for(var d=0;d<c.length;d++)a.push(c[d]);else a.push(arguments[b])}u.push(a)};a.msg=function(){for(var a=1,b=0;b<u.length;b++){var c=u[b];c[1]==arguments[0]&&a++}c=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],g.is_vector(a))for(var d=0;d<a.length;d++)c.push(a[d]);
else c.push(arguments[b]);u.push(c)};var B=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.print_telemetry=function(a){a||(a=1);for(var b=0,c={},d=Math.max(0,performance.now()-1E3*a),h=0;h<u.length;h++){var g=u[h];a=g[0];if(!(a<d)){var l=String(g[1]);c[l]||(c[l]=B[b++%B.length]);a=["%c"+(a/1E3).toFixed(6),c[l],l];for(l=2;l<g.length;l++)a.push(g[l]);e.log.apply(this,a)}}u.splice(0)};a.plot_telemetry=function(a){a||(a=1);for(var b={},c=Math.max(0,performance.now()-
1E3*a),d=0;d<u.length;d++){var h=u[d];a=h[0];if(!(a<c))for(var g=2;g<h.length;g++){var l=String(h[1]);3<h.length&&(l+="_"+String(g-2));b[l]||(b[l]=l+"\n");b[l]+=String(a)+" "+h[g]+"\n"}}a="";for(l in b)a+=b[l]+"\n\n";e.log(a);u.splice(0)};a.ZC=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&b("firefox");case "msie":return b("mozilla")&&
b("trident")&&b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.check_finite=function(a){if(g.is_vector(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.NC=function(a,b){typeof a!=b&&g.pa("Type assertion failed: value type is not a {"+b+"}:",a)};a.LC=d;a.MC=function(a){x?d(a,w):x=!0;w=a}};b4w.module.__extensions=function(a,p){function b(a){if(a in e)return e[a];var b=c.getExtension(a)||null;e[a]=b;d.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}var d=p("__print"),c=null,e={};a.bd=function(a){c=a};a.xq=function(){return b("WEBGL_compressed_texture_s3tc")||b("WEBKIT_WEBGL_compressed_texture_s3tc")||b("MOZ_WEBGL_compressed_texture_s3tc")};a.$x=function(){return b("WEBGL_depth_texture")||b("WEBKIT_WEBGL_depth_texture")||b("MOZ_WEBGL_depth_texture")};a.Sx=function(){return b("EXT_texture_filter_anisotropic")||
b("WEBKIT_EXT_texture_filter_anisotropic")||b("MOZ_EXT_texture_filter_anisotropic")};a.qq=function(){return b("WEBGL_debug_shaders")};a.wq=function(){return b("WEBGL_debug_renderer_info")};a.rq=function(){return b("OES_element_index_uint")};a.ly=function(){return b("OES_standard_derivatives")};a.cleanup=function(){e={}}};b4w.module.__graph=function(a){function p(a,c,d){d||(d=null);if(b(a,c))throw"Graph already has node with given ID";a.X.push(c,d)}function b(a,b){for(var c=a.X,d=0;d<c.length;d+=2)if(c[d]==b)return!0;return!1}function d(a,c,d,e){e||(e=null);if(b(a,c)&&b(a,d))a.oa.push(c,d,e);else throw"Wrong node IDs";}function c(a,c){if(!b(a,c))throw"Node not found";for(var d=a.X,e=0;e<d.length;e+=2)d[e]==c&&(d.splice(e,2),e-=2)}function e(a,b,c,d){if(!l(a,b,c))throw"Edge not found";a=a.oa;for(var e=0,h=0;h<a.length;h+=
3)if(a[h]==b&&a[h+1]==c){if(-1==d)a.splice(h,3);else{if(d==e){a.splice(h,3);break}e++}h-=3}}function f(a){a=a.X;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function g(a,b){for(var c=a.X,d=0;d<c.length;d+=2)if(c[d+1]==b)return c[d];return-1}function k(a){var b=[],c={};q(a,c);for(var d=a.X,e=0;e<d.length;e+=2)0==t(a,d[e])&&h(a,d[e],c,b);return{X:b,oa:a.oa.slice(0)}}function q(a,b){for(var c=a.X,d=0;d<c.length;d+=2)b[c[d]]=!1}function h(a,b,c,d){if(!c[b]){c[b]=!0;for(var e=0;e<A(a,
b);e++)h(a,F(a,b,e),c,d);d.unshift(b,r(a,b))}}function m(a,b,c,d){if(!c[b]){c[b]=!0;if(10==d||30==d)for(var e=0;e<A(a,b);e++){var l=F(a,b,e);m(a,l,c,d)}if(20==d||30==d)for(e=0;e<t(a,b);e++)l=C(a,b,e),m(a,l,c,d)}}function u(a){for(var b=[],c=a.X,d=0;d<c.length;d+=2){var e=c[d];A(a,e)||b.push(e)}return b}function n(a){var b=a.X;a=a.oa;for(var c=[],d=[],e=[],l=0;l<b.length;l++)e[b[2*l]]=l,c.push(l,b[2*l+1]);for(l=0;l<a.length;l+=3)d.push(e[a[l]],e[a[l+1]],a[l+2]);return{X:c,oa:d}}function w(a,b,c){if(c.md==
c.Se){for(var d=0,e=0;d<c.Se;d++)-1!=c.Td[d]&&(a[e]=d,b[e]=c.Td[d],e++);return!0}if(c.Se>c.lh||c.gf>c.hf||c.Eh>c.Gh||c.Dh>c.Fh)return!1;for(var e=d=-1,l=!1;!l&&x(c,I,d,e);)if(d=I[0],e=I[1],B(c,d,e)){var h;h=c;l={};l.pi=h.pi;l.qi=h.qi;l.mn=h.mn;l.Oj=h.Oj;l.Se=h.Se;l.lh=h.lh;l.Te=h.Te;l.md=l.mk=h.md;l.Dh=h.Dh;l.Eh=h.Eh;l.gf=h.gf;l.Fh=h.Fh;l.Gh=h.Gh;l.hf=h.hf;l.Uh=-1;l.Td=h.Td;l.Ff=h.Ff;l.Qf=h.Qf;l.Rf=h.Rf;l.gg=h.gg;l.hg=h.hg;l.Ik=h.Ik;h.Ik[0]+=1;var l=h=l,g=d,f=e,k=l.pi,m=l.qi,u=l.Se,n=l.lh,q=l.Td,
r=l.Ff,K=l.Qf,J=l.Rf,H=l.gg,p=l.hg;y(g<u);y(f<n);y(l.md<u);y(l.md<n);u=++l.md;l.Uh=g;K[g]||(K[g]=u,l.Dh++,H[g]&&l.gf++);H[g]||(H[g]=u,l.Eh++,K[g]&&l.gf++);J[f]||(J[f]=u,l.Fh++,p[f]&&l.hf++);p[f]||(p[f]=u,l.Gh++,J[f]&&l.hf++);q[g]=f;r[f]=g;for(q=0;q<t(k,g);q++)r=C(k,g,q),K[r]||(K[r]=u,l.Dh++,H[r]&&l.gf++);for(q=0;q<A(k,g);q++)r=F(k,g,q),H[r]||(H[r]=u,l.Eh++,K[r]&&l.gf++);for(q=0;q<t(m,f);q++)r=C(m,f,q),J[r]||(J[r]=u,l.Fh++,p[r]&&l.hf++);for(q=0;q<A(m,f);q++)r=F(m,f,q),p[r]||(p[r]=u,l.Gh++,J[r]&&l.hf++);
l=w(a,b,h);y(1>=h.md-h.mk);y(-1!=h.Uh);r=h.pi;g=h.qi;f=h.md;k=h.Uh;m=h.Td;K=h.Ff;u=h.Qf;J=h.Rf;n=h.gg;H=h.hg;if(h.mk<f){u[k]==f&&(u[k]=0);for(p=0;p<t(r,k);p++)q=C(r,k,p),u[q]==f&&(u[q]=0);n[k]==f&&(n[k]=0);for(p=0;p<A(r,k);p++)q=F(r,k,p),n[q]==f&&(n[q]=0);r=m[k];J[r]==f&&(J[r]=0);for(p=0;p<t(g,r);p++)q=C(g,r,p),J[q]==f&&(J[q]=0);H[r]==f&&(H[r]=0);for(p=0;p<A(g,r);p++)q=F(g,r,p),H[q]==f&&(H[q]=0);m[k]=-1;K[r]=-1;h.md=h.mk;h.Uh=-1}}return l}function x(a,b,c,d){-1==c&&(c=0);-1==d?d=0:d++;var e=a.gf,
l=a.hf,h=a.Eh,g=a.Gh,f=a.Dh,k=a.Fh,m=a.md,t=a.Se,u=a.lh,q=a.Td,n=a.Ff,F=a.Qf,r=a.Rf,w=a.gg,C=a.hg;if(e>m&&l>m)for(;c<t&&(-1!=q[c]||0==w[c]||0==F[c]);)c++,d=0;else if(h>m&&g>m)for(;c<t&&(-1!=q[c]||0==w[c]);)c++,d=0;else if(f>m&&k>m)for(;c<t&&(-1!=q[c]||0==F[c]);)c++,d=0;else if(0==c&&0!=a.Te){for(F=0;F<t&&-1!=q[c=a.Te[F]];)F++;F==t&&(c=t)}else for(;c<t&&-1!=q[c];)c++,d=0;if(e>m&&l>m)for(;d<u&&(-1!=n[d]||0==C[d]||0==r[d]);)d++;else if(h>m&&g>m)for(;d<u&&(-1!=n[d]||0==C[d]);)d++;else if(f>m&&k>m)for(;d<
u&&(-1!=n[d]||0==r[d]);)d++;else for(;d<u&&-1!=n[d];)d++;return c<t&&d<u?(b[0]=c,b[1]=d,!0):!1}function B(a,b,c){var d=a.pi,e=a.qi,h=a.lh,g=a.Td,f=a.Ff,k=a.Qf,m=a.Rf,u=a.gg,q=a.hg;y(b<a.Se);y(c<h);y(-1==g[b]);y(-1==f[c]);if(!(0,a.mn)(r(d,b),r(e,c)))return!1;for(var n=h=0,w=0,K=0,I=0,x=0,B=0;B<A(d,b);B++){var J=F(d,b,B);if(-1!=g[J]){var p=g[J];if(!l(e,c,p)||!H(a.Oj,d,b,J,e,c,p))return!1}else k[J]&&w++,u[J]&&h++,k[J]||u[J]||I++}for(B=0;B<t(d,b);B++)if(J=C(d,b,B),-1!=g[J]){if(p=g[J],!l(e,p,c)||!H(a.Oj,
d,J,b,e,p,c))return!1}else k[J]&&w++,u[J]&&h++,k[J]||u[J]||I++;for(B=0;B<A(e,c);B++)if(p=F(e,c,B),-1!=f[p]){if(J=f[p],!l(d,b,J))return!1}else m[p]&&K++,q[p]&&n++,m[p]||q[p]||x++;for(B=0;B<t(e,c);B++)if(p=C(e,c,B),-1!=f[p]){if(J=f[p],!l(d,J,b))return!1}else m[p]&&K++,q[p]&&n++,m[p]||q[p]||x++;return w<=K&&h<=n&&I<=x}function y(a){if(!a)throw"Assertion failed";}function r(a,b){for(var c=a.X,d=0;d<c.length;d+=2)if(c[d]==b)return c[d+1];return null}function A(a,b){for(var c=a.oa,d=0,e=0;e<c.length;e+=
3)c[e]==b&&d++;return d}function t(a,b){for(var c=a.oa,d=0,e=0;e<c.length;e+=3)c[e+1]==b&&d++;return d}function F(a,b,c){a=a.oa;for(var d=0,e=0;e<a.length;e+=3)if(a[e]==b){if(d==c)return a[e+1];d++}return-1}function C(a,b,c){a=a.oa;for(var d=0,e=0;e<a.length;e+=3)if(a[e+1]==b){if(d==c)return a[e];d++}return-1}function l(a,b,c){a=a.oa;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c)return!0;return!1}function H(a,b,c,d,e,l,h){for(var g=J(b,c,d),f=J(e,l,h),k=0;k<g;k++){for(var m=!1,t=0;t<f;t++)if(a(K(b,
c,d,k),K(e,l,h,t))){m=!0;break}if(!m)return!1}return!0}function J(a,b,c){var d=0;a=a.oa;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&d++;return d}function K(a,b,c,d){a=a.oa;for(var e=0,l=0;l<a.length;l+=3)if(a[l]==b&&a[l+1]==c){if(e==d)return a[l+2];e++}return null}var I=[-1,-1];a.Co=-1;a.BC=10;a.yo=20;a.FC=30;a.create=function(){for(var a=arguments,b=[],c=[],d=0;d<a.length;d++){var e=a[d];switch(e.length){case 2:b.push(e[0],e[1]);break;case 3:c.push(e[0],e[1],e[2]);break;default:throw"Wrong graph constructor params";
}}return{X:b,oa:c}};a.gD=function(a,b){for(var c=[],d=[],e=0;e<a.length;e++)c.push(a[e][0],a[e][1]);for(e=0;e<b.length;e++)d.push(b[e][0],b[e][1],b[e][2]);return{X:c,oa:d}};a.sj=p;a.QD=b;a.Uc=d;a.ph=c;a.Xe=e;a.s=function(a,b){if(-1==g(a,b)){var c=f(a);p(a,c,b);return c}throw"Non-unique attribute";};a.Rz=function(a,b,c,d,e){a=a.oa;for(var l=0;l<a.length;l+=3)a[l]==b&&a[l+1]==c&&a[l+2]==d&&(a[l+2]=e)};a.jq=f;a.cg=g;a.l=function(a,b,c,e){b=g(a,b);c=g(a,c);if(-1!=b&&-1!=c)d(a,b,c,e);else throw"Attributes not found";
};a.O=function(a,b){for(var c=a.X,d=0;d<c.length&&!b(c[d],c[d+1]);d+=2);};a.re=function(a,b){for(var c=a.oa,d=0;d<c.length&&!b(c[d],c[d+1],c[d+2]);d+=3);};a.se=function(a,b,c){for(var d=a.oa,e=0;e<d.length;e+=3)if(d[e+1]==b){var l=d[e];if(c(l,r(a,l),d[e+2]))break}};a.kf=function(a,b,c){for(var d=a.oa,e=0;e<d.length;e+=3)if(d[e]==b){var l=d[e+1];if(c(l,r(a,l),d[e+2]))break}};a.bo=k;a.kB=function(a){a=k(a).X;for(var b=[],c=0;c<a.length;c+=2)b.push(a[c+1]);return b};a.aE=function(){};a.Os=function(a,
c,d){if(!b(a,c))throw"No such node";var e={};q(a,e);m(a,c,e,d);c=[];for(var l in e)e[l]&&(l=Number(l),c.push(l,r(a,l)));a={X:c,oa:a.oa.slice(0)};e=a.oa;for(l=0;l<e.length;l+=3)c=e[l+1],b(a,e[l])&&b(a,c)||(e.splice(l,3),l-=3);return a};a.ky=function(a){for(var b=[],c=a.X,d=0;d<c.length;d+=2){var e=c[d];t(a,e)||b.push(e)}return b};a.zq=u;a.match=function(a,b,c,d){var e={};e.pi=n(a);e.qi=n(b);e.mn=c||function(a,b){return a==b};e.Oj=d||function(a,b){return a==b};d=a.X.length/2;var l=b.X.length/2;e.Se=
d;e.lh=l;e.Te=0;e.md=e.mk=0;e.gf=e.Dh=e.Eh=0;e.hf=e.Fh=e.Gh=0;e.Uh=-1;e.Td=Array(d);e.Ff=Array(l);e.Qf=Array(d);e.Rf=Array(l);e.gg=Array(d);e.hg=Array(l);e.Ik=[1];for(c=0;c<d;c++)e.Td[c]=-1,e.Qf[c]=0,e.gg[c]=0;for(c=0;c<l;c++)e.Ff[c]=-1,e.Rf[c]=0,e.hg[c]=0;l=Array(d);d=Array(d);if(w(l,d,e)){for(c=0;c<l.length;c++)l[c]=a.X[2*l[c]],d[c]=b.X[2*d[c]];return[l,d]}return null};a.Ya=r;a.ig=A;a.Oq=t;a.Of=F;a.Tj=C;a.JD=J;a.Nf=K;a.replace=function(a,b,d){for(var e=a.oa,l=f(a),h=0;h<b.length;h++){var g=b[h];
c(a,g);for(var k=0;k<e.length;k+=3)e[k]==g&&(e[k]=l),e[k+1]==g&&(e[k+1]=l),e[k]==e[k+1]&&(e.splice(k,3),k-=3)}p(a,l,d)};a.Iz=function(a,b,c,d,e){if(!l(a,b,c))throw"Edge not found";a=a.oa;for(var h=0;h<a.length;h+=3)a[h]==b&&a[h+1]==c&&(a[h]=d,a[h+1]=e)};a.ix=function(a,b){function c(a,b){if(-1!=f.indexOf(a)){var d=f.slice(f.indexOf(a));if(-1!=l[d[d.length-1]].indexOf(d[0])){k.push([a,d[d.length-1]]);return}}f.push(a);for(d=0;d<b.length;d++)b[d]in l&&c(b[d],l[b[d]])}b||(b=u(a)[0]);for(var d=a.oa,l=
{},h=0,g=0;g<d.length;g+=3)d[g+1]in l?l[d[g+1]].push(d[g]):l[d[g+1]]=[d[g]],h++;var f=[],k=[];c(b,l[b]);for(g=0;g<k.length;g++)for(var m=h=0;m<d.length;m+=3)k[g][1]==d[m+1]&&k[g][0]==d[m]&&e(a,d[m],d[m+1],h),h++};a.iD=function(a,b){var c=a.X,d=a.oa,e;e="digraph debug {\n    node [shape=box];\n";for(var l=0;l<c.length;l+=2){var h=c[l],g=c[l+1],g=b?b(h,g):String(h);e+="    ";e+=String(h)+' [label="'+g.replace(/\"/g,'\\"')+'"];\n'}for(l=0;l<d.length;l+=3)c=d[l],h=d[l+1],e+="    ",e+=String(c)+" -> "+
String(h)+";\n";return e+="}"}};b4w.module.__ipc=function(a){a.Ft=0;var p=a.xt=1,b=a.zt=2;a.yt=3;a.Bt=4;a.Ct=5;a.Dt=6;a.Gt=7;var d=a.It=8,c=a.Bo=9,e=a.Jt=10;a.Kt=11;var f=a.Lt=12;a.Mt=13;a.Ht=14;a.Et=15;a.At=16;a.lu=100;a.Nt=101;a.Ot=102;a.Pt=103;a.Qt=104;a.St=105;a.Rt=106;a.Tt=107;a.Ut=108;a.Vt=109;a.Wt=110;a.Xt=111;a.Yt=112;a.$t=113;a.au=114;a.nu=115;a.bu=116;a.cu=117;a.du=118;a.fu=119;a.gu=120;a.hu=121;a.ju=122;a.ku=123;a.mu=124;a.Zt=125;a.pu=126;a.eu=127;a.Eo=128;a.ou=129;a.qu=130;a.ru=131;a.su=132;a.tu=133;a.uu=134;a.vu=135;
a.wu=136;a.xu=137;a.yu=138;a.zu=139;a.Fo=140;var g=a.kj=141;a.Au=142;a.Do=143;a.Bu=144;a.Cu=145;a.DC=146;a.iu=147;var k=null,q={msg_id:f,body_id:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),linvel:new Float32Array(3),angvel:new Float32Array(3),hb:new Float32Array(16)};q.hb[0]=f;var h={msg_id:d,chassis_hull_body_id:0,prop_ind:0,trans:new Float32Array(3),quat:new Float32Array(4),hb:new Float32Array(10)};h.hb[0]=d;var m={msg_id:c,id:0,body_id_hit:0,hit_fract:0,hit_time:0,hb:new Float32Array(5)};
m.hb[0]=c;var u={msg_id:e,id:0,body_id_hit:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),hb:new Float32Array(11)};u.hb[0]=e;var n={msg_id:p,body_id_a:0,body_id_b:0,result:0,hb:new Float32Array(4)};n.hb[0]=p;var w={msg_id:b,body_id_a:0,body_id_b:0,result:0,coll_point:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,hb:new Float32Array(11)};w.hb[0]=b;var x={msg_id:g,body_id:0,trans:new Float32Array(3),quat:new Float32Array(4),hb:new Float32Array(9)};
x.hb[0]=g;a.init=function(a,y){a.addEventListener("message",function(a){a=a.data;var k=a[0]|0;switch(k){case f:var t=q;t.body_id=a[1];t.time=a[2];t.trans[0]=a[3];t.trans[1]=a[4];t.trans[2]=a[5];t.quat[0]=a[6];t.quat[1]=a[7];t.quat[2]=a[8];t.quat[3]=a[9];t.linvel[0]=a[10];t.linvel[1]=a[11];t.linvel[2]=a[12];t.angvel[0]=a[13];t.angvel[1]=a[14];t.angvel[2]=a[15];break;case d:t=h;t.chassis_hull_body_id=a[1];t.prop_ind=a[2];t.trans[0]=a[3];t.trans[1]=a[4];t.trans[2]=a[5];t.quat[0]=a[6];t.quat[1]=a[7];
t.quat[2]=a[8];t.quat[3]=a[9];break;case c:t=m;t.id=a[1]|0;t.body_id_hit=a[2]|0;t.hit_fract=a[3];t.hit_time=a[4];break;case e:t=u;t.id=a[1]|0;t.body_id_hit=a[2]|0;t.hit_fract=a[3];t.hit_time=a[4];t.hit_pos[0]=a[5];t.hit_pos[1]=a[6];t.hit_pos[2]=a[7];t.hit_norm[0]=a[8];t.hit_norm[1]=a[9];t.hit_norm[2]=a[10];break;case p:t=n;t.body_id_a=a[1]|0;t.body_id_b=a[2]|0;t.result=a[3];break;case b:t=w;t.body_id_a=a[1]|0;t.body_id_b=a[2]|0;t.result=a[3];t.coll_point[0]=a[4];t.coll_point[1]=a[5];t.coll_point[2]=
a[6];t.coll_norm[0]=a[7];t.coll_norm[1]=a[8];t.coll_norm[2]=a[9];t.coll_dist=a[10];break;case g:t=x;t.body_id=a[1]|0;t.trans[0]=a[2];t.trans[1]=a[3];t.trans[2]=a[4];t.quat[0]=a[5];t.quat[1]=a[6];t.quat[2]=a[7];t.quat[3]=a[8];break;default:t=a}y(k,t)},!1);k=a};a.cleanup=function(){k=null};a.C=function(){if(k){switch(arguments[0]|0){case f:var a=q,y=a.hb;y[1]=a.body_id;y[2]=a.time;y[3]=a.trans[0];y[4]=a.trans[1];y[5]=a.trans[2];y[6]=a.quat[0];y[7]=a.quat[1];y[8]=a.quat[2];y[9]=a.quat[3];y[10]=a.linvel[0];
y[11]=a.linvel[1];y[12]=a.linvel[2];y[13]=a.angvel[0];y[14]=a.angvel[1];y[15]=a.angvel[2];break;case d:a=h;y=a.hb;y[1]=a.chassis_hull_body_id;y[2]=a.prop_ind;y[3]=a.trans[0];y[4]=a.trans[1];y[5]=a.trans[2];y[6]=a.quat[0];y[7]=a.quat[1];y[8]=a.quat[2];y[9]=a.quat[3];break;case c:a=m;y=a.hb;y[1]=a.id;y[2]=a.body_id_hit;y[3]=a.hit_fract;y[4]=a.hit_time;break;case e:a=u;y=a.hb;y[1]=a.id;y[2]=a.body_id_hit;y[3]=a.hit_fract;y[4]=a.hit_time;y[5]=a.hit_pos[0];y[6]=a.hit_pos[1];y[7]=a.hit_pos[2];y[8]=a.hit_norm[0];
y[9]=a.hit_norm[1];y[10]=a.hit_norm[2];break;case p:a=n;y=a.hb;y[1]=a.body_id_a;y[2]=a.body_id_b;y[3]=a.result;break;case b:a=w;y=a.hb;y[1]=a.body_id_a;y[2]=a.body_id_b;y[3]=a.result;y[4]=a.coll_point[0];y[5]=a.coll_point[1];y[6]=a.coll_point[2];y[7]=a.coll_norm[0];y[8]=a.coll_norm[1];y[9]=a.coll_norm[2];y[10]=a.coll_dist;break;case g:a=x;y=a.hb;y[1]=a.body_id;y[2]=a.trans[0];y[3]=a.trans[1];y[4]=a.trans[2];y[5]=a.quat[0];y[6]=a.quat[1];y[7]=a.quat[2];y[8]=a.quat[3];break;default:for(y=[],a=0;a<arguments.length;a++)y.push(arguments[a])}k.postMessage(y)}};
a.vq=function(a){switch(a){case f:return q;case d:return h;case c:return m;case e:return u;case p:return n;case b:return w;case g:return x;default:return null}}};b4w.module.__hud=function(a,p){function b(a){a.font="bold 15px Courier";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function d(a){c(' SCENE "'+a.name+'"');if(a.d){var b=0,d=0;k.O(a.d.fb,function(a,e){if("SINK"==e.type)c(" (F)",e.type);else{var h=e.type,g=Math.round(e.i.width)+"x"+Math.round(e.i.height),f=e.p.length,k=e.ei,m=e.enqueue&&e.Xa;m?c(" (A)",h,e.eg,g,k,"of",f):c(" (P)",h,e.eg,g,k,"of",f);e.ei=0;m&&(b+=f,d+=k)}});return[b,d]}c("No INFO")}function c(){for(var a=80+20*h[0],b=[5,
18,3,10,4,3,5],c=arguments[0],d=1;d<arguments.length;d++){for(var e="",g=0;g<b[d]-String(arguments[d]).length;g++)e+=" ";c+=e+arguments[d]}h[0]++;q.fillText(c,30,a)}function e(a,b,c){b*=a.Ea;c.x=a.x+b;c.y=a.y;c.Ea=a.Ea-2*b;c.xa=a.xa}function f(a){return a.x+a.Ea/2}function g(a){var b=q,c={x:0,y:0,Ea:0,xa:0},d=b.canvas.width,b=b.canvas.height;c.x=0;c.y=0;c.Ea=d;c.xa=b;e(c,.01,c);d=.02*c.xa;c.x=c.x;c.y+=d;c.Ea=c.Ea;c.xa-=2*d;d=c.Ea/8;c.x+=d*a;c.y=c.y;c.Ea=d;c.xa=c.xa;e(c,.02,c);return c}var k=p("__graph"),
q=null,h=[0,0];a.init=function(a){a=a.getContext("2d");b(a);return q=a};a.Ih=function(){q&&b(q)};a.reset=function(){var a=q;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),h[0]=0,h[1]=0)};a.DA=function(a,b){var e=q;if(e){e.textAlign="left";e.fillStyle="rgba(0,255,0,255)";c(" FPS",(1/b).toFixed(2));h[0]++;for(var g=e=0,f=0;f<a.length;f++){var k=d(a[f]),e=e+k[0],g=g+k[1];h[0]++}c(" ---------------------------------------------");
c("    ","TOTAL ACTIVE","","",g,"of",e)}};a.print=function(){var a=q;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",c.apply(Math,arguments))};a.plot_array=function(a,b,c,d,e,h,k){var r=q;if(r){b=g(b);var A=b.xa/5;b.x=b.x;b.y+=4*A;b.Ea=b.Ea;b.xa=A;r.textAlign="center";r.fillStyle="#00FF00";q.fillText(a,f(b),b.y-10);r.strokeStyle="#00FF00";r.lineWidth=.5;r.beginPath();r.moveTo(b.x,b.y);r.lineTo(b.x+b.Ea,b.y);r.lineTo(b.x+b.Ea,b.y+b.xa);r.lineTo(b.x,b.y+b.xa);r.closePath();r.stroke();if(!h&&
!k)for(h=1E6,k=-1E6,a=0;a<c.length;a++)h=Math.min(h,c[a]),k=Math.max(k,c[a]);r.textAlign="right";q.fillText(String(h),b.x-10,b.y+b.xa);q.fillText(String(k),b.x-10,b.y);r.textAlign="center";q.fillText(String(d),b.x,b.y+b.xa+15);q.fillText(String(e),b.x+b.Ea,b.y+b.xa+15);r.strokeStyle="#FF0000";r.lineWidth=1.5;r.beginPath();d=b.Ea/(c.length-1);k=b.xa/(k-h);for(a=0;a<c.length;a++)e=b.x+d*a,A=b.y+b.xa-(c[a]-h)*k,0==a?r.moveTo(e,A):r.lineTo(e,A);r.stroke()}};a.draw_mixer_strip=function(a,b,c,d,e,h,k){var r=
q;if(r)for(r.textAlign="center",r.fillStyle="#00FF00",r.font="bold 12px Courier",c=g(c),q.fillText(b?"["+a+"]":a,f(c),c.y),0<=h&&q.fillText(h?"[M]":"[ ]",f(c)-15,c.y+30),0<=k&&q.fillText(k?"[S]":"[ ]",f(c)+15,c.y+30),a={x:0,y:0,Ea:0,xa:0},b=0;b<d.length;b++){h=d[b];var A="VOLUME"==h[0];if(A){k=c.y+350;var t=c.Ea,F=a;F.x=c.x;F.y=k;F.Ea=t;F.xa=250}else{k=c.y+10+50*b;var t=c.Ea,F=c.xa,C=a;C.x=c.x;C.y=k;C.Ea=t;C.xa=F}k=r;var t=a,C=b==e,l=h[0],F=h[1],H=h[2],J=h[3],K=(J-H)/h[4],K=1>K?Math.floor(1/K-1E-5).toFixed(0).length:
0;h=h[5]?Math.log(F/H)/Math.log(J/H):(F-H)/(J-H);k.textAlign="center";C?k.fillText("["+l+"]",f(t),t.y):k.fillText(l,f(t),t.y);k.strokeStyle="#00FF00";k.lineWidth=A?3:1;A?(k.textAlign="right",k.fillText(J.toFixed(K),f(t)-10,t.y+15),k.textAlign="right",k.fillText(H.toFixed(K),f(t)-10,t.y+t.xa-15)):(k.textAlign="right",k.fillText(H.toFixed(K),t.x+28,t.y+15),k.textAlign="left",k.fillText(J.toFixed(K),t.x+t.Ea-28,t.y+15));k.beginPath();if(A){var I=t.y+15+(t.xa-30)*(1-h);k.moveTo(f(t),t.y+15);k.lineTo(f(t),
t.y+t.xa-15);k.moveTo(f(t)-5,t.y+15);k.lineTo(f(t)+5,t.y+15);k.moveTo(f(t)-5,t.y+t.xa-15);k.lineTo(f(t)+5,t.y+t.xa-15);k.moveTo(f(t)-5,I);k.lineTo(f(t)+5,I)}else{var P=t.x+30+(t.Ea-60)*h;k.moveTo(t.x+30,t.y+15);k.lineTo(t.x+t.Ea-30,t.y+15);k.moveTo(t.x+30,t.y+15-5);k.lineTo(t.x+30,t.y+15+5);k.moveTo(t.x+t.Ea-30,t.y+15-5);k.lineTo(t.x+t.Ea-30,t.y+15+5);k.moveTo(P,t.y+15-5);k.lineTo(P,t.y+15+5)}k.stroke();"EQ_Q"==l?(h=Math.log(1+1/(2*F*F)+Math.sqrt((2+1/(F*F))*(2+1/(F*F))/4-1))/Math.log(2),A?(k.textAlign=
"left",k.fillText(F.toFixed(K),f(t)+10,I),k.textAlign="left",k.fillText("("+h.toFixed(K+1)+")",f(t)+10,I+10)):(k.textAlign="right",k.fillText(F.toFixed(K),P,t.y+30),k.textAlign="left",k.fillText("("+h.toFixed(K+1)+")",P,t.y+30))):A?(k.textAlign="left",k.fillText(F.toFixed(K),f(t)+10,I)):(k.textAlign="center",k.fillText(F.toFixed(K),P,t.y+30))}}};b4w.module.__renderer=function(a,p){function b(a){for(var b=a.i,d=a.p,l=0;l<d.length;l++){var h=d[l];if(h.Xa){var g=a,f=b,k=h.td,m=h.B,z=m.Xb;r.useProgram(z.Mi);for(var h=m.R,q=m.Xo,G=z.Ws,L=G.length;L--;){var n=G[L];n.um(r,n.Zf,g,k,m,f)}f=m.Bp;r.colorMask(f,f,f,f);r.depthMask(m.W);m.Ja?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE);f=m.L;for(m=0;m<f.length;m++)G=f[m],r.activeTexture(r.TEXTURE0+m),r.bindTexture(G.Ob,G.Va);if("SKY"==g.type){f=g;z=z.Yi;m=f.i.eb.Va;G=f.di;for(L=0;6>L;L++)if(n=e(L),u.Il?
(r.bindTexture(r.TEXTURE_CUBE_MAP,m),r.texImage2D(n,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,y)):(r.uniformMatrix4fv(z.u_cube_view_matrix,!1,G[L]),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,n,m,0),c(h,q,k.ko)),f.kk&&3!=L){var n=f,w=L,x=A;u.Il?x.set(y):(r.readPixels(191,191,1,1,r.RGBA,r.UNSIGNED_BYTE,x),255!=x[0]&&255!=x[1]&&255!=x[2]||r.readPixels(191,220,1,1,r.RGBA,r.UNSIGNED_BYTE,x));var p=x[0],B=x[1],x=x[2],p=p/255,B=B/255,x=x/255;2===w?(n.mc[3]=p,n.mc[7]=B,n.mc[11]=x):2>w?(n.mc[4*w]=
p,n.mc[4*w+1]=B,n.mc[4*w+2]=x):(n.mc[4*(w-2)]=p,n.mc[4*(w-2)+1]=B,n.mc[4*(w-2)+2]=x)}g.ei+=6}else c(h,q,k.ko),g.ei++}}}function d(a){if(a){var b=(a.da?r.COLOR_BUFFER_BIT:0)|(a.ha?r.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case "MAIN_GLOW":a=B;break;case "SHADOW_CAST":a=n;break;case "DEPTH":a=w;break;case "COLOR_PICKING":case "COLOR_PICKING_XRAY":case "ANCHOR_VISIBILITY":a=x;break;case "OUTLINE_MASK":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_EDGE_DETECTION":a=B;break;default:a=u.background_color}}else b=
r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT,a=u.background_color;r.colorMask(!0,!0,!0,!0);r.depthMask(!0);r.clearColor(a[0],a[1],a[2],a[3]);r.clear(b)}function c(a,b,c){r.bindBuffer(r.ARRAY_BUFFER,a.mf);for(var d=0;d<b.length;d++){var e=b[d];r.enableVertexAttribArray(e.Zf);r.vertexAttribPointer(e.Zf,e.sd,r.FLOAT,!1,0,e.vv+e.wx*c)}a.ee?(r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,a.ee),r.drawElements(a.mode,a.count,a.Km,0)):r.drawArrays(a.mode,0,a.count);for(d=0;d<b.length;d++)e=b[d],r.disableVertexAttribArray(e.Zf)}
function e(a){switch(a){case 0:return r.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return r.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return r.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return r.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return r.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return r.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function f(a){var b=a.Yi,c=[],d=[],e={},h;for(h in b){var g=!1;switch(h){case "u_proj_matrix":var f=function(a,b,c,d,e,l){a.uniformMatrix4fv(b,!1,l.sa)},g=!0;break;case "u_view_matrix":case "u_view_matrix_frag":f=
function(a,b,c,d,e,l){a.uniformMatrix4fv(b,!1,l.ma)};g=!0;break;case "u_shadow_cast_billboard_view_matrix":f=function(a,b,c,d,e,l){a.uniformMatrix4fv(b,!1,l.ss)};g=!0;break;case "u_view_proj_prev":f=function(a,b,c,d,e,l){a.uniformMatrix4fv(b,!1,l.Fz)};g=!0;break;case "u_view_proj_inverse":f=function(a,b,c,d,e,l){a.uniformMatrix4fv(b,!1,l.Lh)};g=!0;break;case "u_sky_vp_inverse":f=function(a,b,c,d,e,l){a.uniformMatrix4fv(b,!1,l.xd)};g=!0;break;case "u_camera_eye":case "u_camera_eye_frag":f=function(a,
b,c,d,e,l){a.uniform3fv(b,l.Ke)};g=!0;break;case "u_camera_eye_last":f=function(a,b,c,d,e,l){a.uniform3fv(b,l.aq)};g=!0;break;case "u_camera_quat":f=function(a,b,c,d,e,l){a.uniform4fv(b,l.quat)};g=!0;break;case "u_view_max_depth":f=function(a,b,c,d,e,l){a.uniform1f(b,l.Pa)};g=!0;break;case "u_camera_range":f=function(a,b,c,d,e,l){a.uniform2f(b,l.Qa,l.Pa)};break;case "u_csm_center_dists":f=function(a,b,c,d,e,l){a.uniform4fv(b,l.Ip)};break;case "u_cam_water_depth":f=function(a,b,c){a.uniform1f(b,c.Dl)};
g=!0;break;case "u_waves_height":f=function(a,b,c){a.uniform1f(b,c.qf)};break;case "u_waves_length":f=function(a,b,c){a.uniform1f(b,c.Bg)};break;case "u_fog_color_density":f=function(a,b,c){a.uniform4fv(b,c.$b)};break;case "u_underwater_fog_color_density":f=function(a,b,c){a.uniform4fv(b,c.gd)};break;case "u_bloom_key":f=function(a,b,c){a.uniform1f(b,c.bloom_key)};break;case "u_bloom_edge_lum":f=function(a,b,c){a.uniform1f(b,c.bloom_edge_lum)};break;case "u_time":f=function(a,b,c){a.uniform1f(b,c.time)};
g=!0;break;case "u_wind":f=function(a,b,c){a.uniform3fv(b,c.dj)};break;case "u_sky_tex_dvar":f=function(a,b,c){a.uniform1f(b,c.ws)};break;case "u_sky_tex_fac":f=function(a,b,c){a.uniform4fv(b,c.xs)};break;case "u_sky_tex_color":f=function(a,b,c){a.uniform3fv(b,c.vs)};break;case "u_horizon_color":f=function(a,b,c){a.uniform3fv(b,c.Ne)};break;case "u_zenith_color":f=function(a,b,c){a.uniform3fv(b,c.rf)};break;case "u_environment_energy":f=function(a,b,c){a.uniform1f(b,c.Je)};break;case "u_sky_color":f=
function(a,b,c){a.uniform3fv(b,c.uh)};break;case "u_rayleigh_brightness":f=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};break;case "u_mie_brightness":f=function(a,b,c){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":f=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":f=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":f=function(a,b,c){a.uniform1f(b,c.rayleigh_strength)};break;case "u_mie_strength":f=function(a,
b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":f=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":f=function(a,b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":f=function(a,b,c){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":f=function(a,b,c){a.uniform3fv(b,c.Xf)};break;case "u_light_directions":f=function(a,b,c){a.uniform3fv(b,c.Vf)};break;case "u_light_color_intensities":f=
function(a,b,c){a.uniform3fv(b,c.Uf)};break;case "u_light_factors":f=function(a,b,c){a.uniform4fv(b,c.Wf)};break;case "u_sun_quaternion":f=function(a,b,c){a.uniform4fv(b,c.Rs)};break;case "u_sun_intensity":f=function(a,b,c){a.uniform3fv(b,c.Qs)};break;case "u_sun_direction":f=function(a,b,c){a.uniform3fv(b,c.Nk)};break;case "u_height":f=function(a,b,c,d,e,l){a.uniform1f(b,l.height)};g=!0;break;case "u_model_matrix":f=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.T)};g=!0;break;case "u_transb":f=function(a,
b,c,d){a.uniform4fv(b,d.Fc)};g=!0;break;case "u_transa":f=function(a,b,c,d){a.uniform4fv(b,d.Ec)};g=!0;break;case "u_arm_rel_trans":f=function(a,b,c,d){a.uniform4fv(b,d.ml)};g=!0;break;case "u_arm_rel_quat":f=function(a,b,c,d){a.uniform4fv(b,d.ll)};g=!0;break;case "u_quat":f=function(a,b,c,d){a.uniform4fv(b,d.quat)};g=!0;break;case "u_quatsb":f=function(a,b,c,d){a.uniform4fv(b,d.xc)};g=!0;break;case "u_quatsa":f=function(a,b,c,d){a.uniform4fv(b,d.wc)};g=!0;break;case "u_frame_factor":f=function(a,
b,c,d){a.uniform1f(b,d.Kf)};g=!0;break;case "au_center_pos":f=function(){};g=!0;break;case "au_wind_bending_amp":f=function(a,b,c,d){a.uniform1f(b,d.Fd)};g=!0;break;case "au_wind_bending_freq":f=function(a,b,c,d){a.uniform1f(b,d.te)};g=!0;break;case "au_detail_bending_freq":f=function(a,b,c,d){a.uniform1f(b,d.Vd)};g=!0;break;case "au_detail_bending_amp":f=function(a,b,c,d){a.uniform1f(b,d.Ud)};g=!0;break;case "au_branch_bending_amp":f=function(a,b,c,d){a.uniform1f(b,d.Qd)};g=!0;break;case "u_node_values":f=
function(a,b,c,d){a.uniform1fv(b,d.he)};g=!0;break;case "u_node_rgbs":f=function(a,b,c,d){a.uniform3fv(b,d.tc)};g=!0;break;case "u_diffuse_color":f=function(a,b,c,d,e){a.uniform4fv(b,e.Mc)};g=!0;break;case "u_diffuse_intensity":f=function(a,b,c,d,e){a.uniform1f(b,e.Ge)};g=!0;break;case "u_diffuse_params":f=function(a,b,c,d,e){a.uniform2fv(b,e.qc)};g=!0;break;case "u_emit":f=function(a,b,c,d,e){a.uniform1f(b,e.$d)};g=!0;break;case "u_ambient":f=function(a,b,c,d,e){a.uniform1f(b,e.Md)};g=!0;break;case "u_specular_color":f=
function(a,b,c,d,e){a.uniform3fv(b,e.yd)};g=!0;break;case "u_specular_alpha":f=function(a,b,c,d,e){a.uniform1f(b,e.vh)};g=!0;break;case "u_specular_params":f=function(a,b,c,d,e){a.uniform3fv(b,e.ic)};g=!0;break;case "u_reflect_factor":f=function(a,b,c,d,e){a.uniform1f(b,e.og)};g=!0;break;case "u_mirror_factor":f=function(a,b,c,d,e){a.uniform1f(b,e.jn)};g=!0;break;case "u_grass_map_dim":f=function(a,b,c,d,e){a.uniform3fv(b,e.bc)};g=!0;break;case "u_grass_size":f=function(a,b,c,d,e){a.uniform1f(b,e.Dm)};
g=!0;break;case "u_scale_threshold":f=function(a,b,c,d,e){a.uniform1f(b,e.Bq)};g=!0;break;case "u_cube_fog":f=function(a,b,c,d,e){a.uniformMatrix4fv(b,!1,e.mc)};break;case "u_jitter_amp":f=function(a,b,c,d,e){a.uniform1f(b,e.Zq)};g=!0;break;case "u_jitter_freq":f=function(a,b,c,d,e){a.uniform1f(b,e.$q)};g=!0;break;case "u_wireframe_mode":f=function(a,b,c,d,e){a.uniform1i(b,e.wireframe_mode)};break;case "u_wireframe_edge_color":f=function(a,b,c,d,e){a.uniform3fv(b,e.wireframe_edge_color)};break;case "u_subpixel_jitter":f=
function(a,b,c){a.uniform2fv(b,c.Ry)};g=!0;break;case "u_subsample_indices":f=function(a,b,c){a.uniform4fv(b,c.Sy)};g=!0;break;case "u_refr_bump":f=function(a,b,c,d,e){a.uniform1f(b,e.ds)};g=!0;break;case "u_lamp_light_positions":f=function(a,b,c,d,e){a.uniform3fv(b,e.Vm)};break;case "u_lamp_light_directions":f=function(a,b,c,d,e){a.uniform3fv(b,e.Tm)};break;case "u_lamp_light_color_intensities":f=function(a,b,c,d,e){a.uniform3fv(b,e.Sm)};break;case "u_lamp_light_factors":f=function(a,b,c,d,e){a.uniform4fv(b,
e.Um)};break;case "u_halo_size":f=function(a,b,c,d,e){a.uniform1f(b,e.Gq)};g=!0;break;case "u_halo_hardness":f=function(a,b,c,d,e){a.uniform1f(b,e.Dq)};g=!0;break;case "u_halo_rings_color":f=function(a,b,c,d,e){a.uniform3fv(b,e.Fq)};g=!0;break;case "u_halo_lines_color":f=function(a,b,c,d,e){a.uniform3fv(b,e.Eq)};g=!0;break;case "u_halo_stars_blend":f=function(a,b,c,d,e){a.uniform1f(b,e.Hq)};g=!0;break;case "u_halo_stars_height":f=function(a,b,c,d,e){a.uniform1f(b,e.Iq)};g=!0;break;case "u_fresnel_params":f=
function(a,b,c,d,e){a.uniform4fv(b,e.Yc)};g=!0;break;case "u_texture_scale":f=function(a,b,c,d,e){a.uniform3fv(b,e.jf)};g=!0;break;case "u_parallax_scale":f=function(a,b,c,d,e){a.uniform1f(b,e.kg)};g=!0;break;case "u_color_id":f=function(a,b,c,d){a.uniform3fv(b,d.Gj)};g=!0;break;case "u_line_points":f=function(a,b,c,d,e){a.uniform3fv(b,e.jE)};g=!0;break;case "u_diffuse_color_factor":f=function(a,b,c,d,e){a.uniform1f(b,e.Fe)};g=!0;break;case "u_alpha_factor":f=function(a,b,c,d,e){a.uniform1f(b,e.ze)};
g=!0;break;case "u_specular_color_factor":f=function(a,b,c,d,e){a.uniform1f(b,e.Ds)};g=!0;break;case "u_normal_factor":f=function(a,b,c,d,e){a.uniform1f(b,e.tr)};g=!0;break;case "u_normalmap0_scale":f=function(a,b,c,d,e){a.uniform2fv(b,e.dg[0])};g=!0;break;case "u_normalmap1_scale":f=function(a,b,c,d,e){a.uniform2fv(b,e.dg[1])};g=!0;break;case "u_normalmap2_scale":f=function(a,b,c,d,e){a.uniform2fv(b,e.dg[2])};g=!0;break;case "u_normalmap3_scale":f=function(a,b,c,d,e){a.uniform2fv(b,e.dg[3])};g=!0;
break;case "u_foam_factor":f=function(a,b,c,d,e){a.uniform1f(b,e.foam_factor)};g=!0;break;case "u_foam_uv_freq":f=function(a,b,c,d,e){a.uniform2fv(b,e.dq)};g=!0;break;case "u_foam_mag":f=function(a,b,c,d,e){a.uniform2fv(b,e.cq)};g=!0;break;case "u_foam_scale":f=function(a,b,c,d,e){a.uniform2fv(b,e.om)};g=!0;break;case "u_water_norm_uv_velocity":f=function(a,b,c,d,e){a.uniform1f(b,e.Oh)};g=!0;break;case "u_shallow_water_col":f=function(a,b,c,d,e){a.uniform3fv(b,e.shallow_water_col)};g=!0;break;case "u_shore_water_col":f=
function(a,b,c,d,e){a.uniform3fv(b,e.shore_water_col)};g=!0;break;case "u_water_shallow_col_fac":f=function(a,b,c,d,e){a.uniform1f(b,e.shallow_water_col_fac)};g=!0;break;case "u_water_shore_col_fac":f=function(a,b,c,d,e){a.uniform1f(b,e.shore_water_col_fac)};g=!0;break;case "u_p_length":f=function(a,b,c,d,e){a.uniform1f(b,e.Jr)};g=!0;break;case "u_p_cyclic":f=function(a,b,c,d,e){a.uniform1i(b,e.Fr)};g=!0;break;case "u_p_max_lifetime":f=function(a,b,c,d,e){a.uniform1f(b,e.Lr)};g=!0;break;case "u_p_fade_in":f=
function(a,b,c,d,e){a.uniform1f(b,e.Gr)};g=!0;break;case "u_p_fade_out":f=function(a,b,c,d,e){a.uniform1f(b,e.Hr)};g=!0;break;case "u_p_size":f=function(a,b,c,d,e){a.uniform1f(b,e.rn)};g=!0;break;case "u_p_alpha_start":f=function(a,b,c,d,e){a.uniform1f(b,e.Cr)};g=!0;break;case "u_p_alpha_end":f=function(a,b,c,d,e){a.uniform1f(b,e.Br)};g=!0;break;case "u_p_nfactor":f=function(a,b,c,d,e){a.uniform1f(b,e.qn)};g=!0;break;case "u_p_gravity":f=function(a,b,c,d,e){a.uniform1f(b,e.Ir)};g=!0;break;case "u_p_mass":f=
function(a,b,c,d,e){a.uniform1f(b,e.Kr)};g=!0;break;case "u_p_size_ramp":f=function(a,b,c,d,e){a.uniform2fv(b,e.Mr)};g=!0;break;case "u_p_color_ramp":f=function(a,b,c,d,e){a.uniform4fv(b,e.Dr)};g=!0;break;case "u_p_wind":f=function(a,b,c,d,e){a.uniform3fv(b,e.sk)};g=!0;break;case "u_texel_size":f=function(a,b,c){a.uniform2fv(b,c.Zn)};g=!0;break;case "u_p_time":f=function(a,b,c,d,e){a.uniform1f(b,e.uc.P.time)};g=!0;break;case "u_position":f=function(a,b,c,d,e){a.uniform3fv(b,e.Li)};g=!0;break;case "u_va_frame_factor":f=
function(a,b,c,d){a.uniform1f(b,d.it)};g=!0;break;case "u_perspective_cast_far_bound":f=function(a,b,c){a.uniform1f(b,c.uz)};break;case "u_normal_offset":f=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_pcf_blur_radii":f=function(a,b,c,d,e,l){a.uniform4fv(b,l.xk)};break;case "u_v_light_matrix":f=function(a,b,c){a.uniformMatrix4fv(b,!1,c.ht)};g=!0;break;case "u_b_light_matrix":f=function(a,b,c){a.uniformMatrix4fv(b,!1,c.bp)};break;case "u_p_light_matrix0":f=function(a,b,
c){a.uniformMatrix4fv(b,!1,c.jg[0])};g=!0;break;case "u_p_light_matrix1":f=function(a,b,c){a.uniformMatrix4fv(b,!1,c.jg[1])};g=!0;break;case "u_p_light_matrix2":f=function(a,b,c){a.uniformMatrix4fv(b,!1,c.jg[2])};g=!0;break;case "u_p_light_matrix3":f=function(a,b,c){a.uniformMatrix4fv(b,!1,c.jg[3])};g=!0;break;case "u_motion_blur_exp":f=function(a,b,c){a.uniform1f(b,c.or)};g=!0;break;case "u_motion_blur_decay_threshold":f=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};g=!0;break;case "u_refl_plane":f=
function(a,b,c,d){a.uniform4fv(b,d.ec)};break;case "u_radial_blur_step":f=function(a,b,c){a.uniform1f(b,c.Ck)};break;case "u_god_rays_intensity":f=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":f=function(a,b,c){a.uniform1f(b,c.yh)};break;case "u_ssao_blur_discard_value":f=function(a,b,c){a.uniform1f(b,c.ssao_blur_discard_value)};g=!0;break;case "u_ssao_influence":f=function(a,b,c){a.uniform1f(b,c.xh)};break;case "u_ssao_dist_factor":f=function(a,b,c){a.uniform1f(b,
c.wh)};break;case "u_dof_dist":f=function(a,b,c,d,e,l){a.uniform1f(b,l.dof_distance)};g=!0;break;case "u_dof_front":f=function(a,b,c,d,e,l){a.uniform1f(b,l.dof_front)};g=!0;break;case "u_dof_rear":f=function(a,b,c,d,e,l){a.uniform1f(b,l.dof_rear)};g=!0;break;case "u_outline_intensity":f=function(a,b,c,d){a.uniform1f(b,d.$c)};g=!0;break;case "u_outline_color":f=function(a,b,c){a.uniform3fv(b,c.Ue)};break;case "u_draw_outline":f=function(a,b,c){a.uniform1f(b,c.cm)};g=!0;break;case "u_glow_mask_small_coeff":f=
function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};g=!0;break;case "u_glow_mask_large_coeff":f=function(a,b,c){a.uniform1f(b,c.large_glow_mask_coeff)};g=!0;break;case "u_brightness":f=function(a,b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":f=function(a,b,c){a.uniform1f(b,c.contrast)};break;case "u_exposure":f=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":f=function(a,b,c){a.uniform1f(b,c.saturation)};break;default:f=null}f&&(f={name:h,um:f,Zf:b[h]},g?c.push(f):
(d.push(f),e[h]=f))}a.Ws=c;a.Ii=d;a.tn=e}var g=p("__config"),k=p("__debug"),q=p("__textures"),h=p("__util"),m=p("__camera");p("mat4");var u=g.o,n=[1,1,1,1],w=[1,1,1,1],x=[0,0,0,1],B=[0,0,0,0],y=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var r=null,A=new Uint8Array(4);a.bd=function(a){var b=u.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);
a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);r=a};a.ii=function(a){if(a.Xa){var c=a.i;r.bindFramebuffer(r.FRAMEBUFFER,c.be);if(a.ol){var h=c.eb;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,h.Ob,h.Va,0)}r.viewport(0,0,c.width,c.height);"MAIN_CUBE_REFLECT"!=a.type&&d(a);a.Fa?r.enable(r.BLEND):r.disable(r.BLEND);a.Db?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST);if(a.ia){for(var c=a.i,h=a.p,l=0;l<h.length;l++){var g=
h[l],q=g.B,u=q.Xb;r.useProgram(u.Mi);g=g.td;u.Ii.length||f(u);for(var u=u.Ii,n=u.length;n--;){var w=u[n];w.um(r,w.Zf,a,g,q,c)}}a.ia=!1}switch(a.type){case "SHADOW_CAST":r.enable(r.POLYGON_OFFSET_FILL);r.polygonOffset(a.self_shadow_polygon_offset,a.self_shadow_polygon_offset);r.cullFace(r.BACK);break;case "MAIN_PLANE_REFLECT":r.disable(r.POLYGON_OFFSET_FILL);r.cullFace(r.FRONT);break;default:r.disable(r.POLYGON_OFFSET_FILL),r.cullFace(r.BACK)}if("MAIN_CUBE_REFLECT"==a.type)for(c=a.i,h=c.eb.Va,l=0;6>
l;l++){q=e(l);c.ma=a.di[l];m.Cl(c);r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,q,h,0);d(a);q=a.p;for(g=0;g<q.length;g++)q[g].Xa=q[g].bm[l];b(a)}else b(a);k.Rv("draw subscene: "+a.type);r.bindFramebuffer(r.FRAMEBUFFER,null)}};a.clear=function(a){r.bindFramebuffer(r.FRAMEBUFFER,a.i.be);d(a)};a.Uo=function(a){var b=a.Xo;b.length=0;var c=a.R;a=a.Xb;c&&a||h.pa("Incomplete batch");c=c.Ub;a=a.attributes;for(var d in a){var e=c[d];b.push({Zf:a[d],vv:4*e.offset,wx:1<e.frames?4*e.length:0,sd:e.sd})}};
a.uv=f;a.Vo=function(a){var b=a.Xb,c=a.L;a=a.Gb;r.useProgram(b.Mi);for(var d=0;d<c.length;d++)r.uniform1i(b.Yi[a[d]],d)};a.cs=function(a,b,c,d,e,f){d||(d=1);e||(e=1);f||(f=new Uint8Array(4*d*e));f.length!=4*d*e&&h.pa("read_pixels(): Wrong storage");r.bindFramebuffer(r.FRAMEBUFFER,a);r.readPixels(b,c,d,e,r.RGBA,r.UNSIGNED_BYTE,f);r.bindFramebuffer(r.FRAMEBUFFER,null);return f};a.vB=function(a){var b=a.Xb;r.useProgram(b.Mi);b.Ii.length||f(b);b=b.tn.u_cube_fog;b.um(r,b.Zf,null,null,a,null)};a.Qz=function(a,
b){var c=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,c);if(a){var d=a,e=d.Va,d=d.Ob==r.TEXTURE_CUBE_MAP?r.TEXTURE_CUBE_MAP_NEGATIVE_Z:d.Ob;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,d,e,0)}q.Vq(b)?r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,b.nf):q.xi(b)&&(d=b,e=d.Va,d=d.Ob,r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,d,e,0));k.Mv();r.bindFramebuffer(r.FRAMEBUFFER,null);return c};a.Pz=function(a,b,c,d,e){null==a?(r.bindFramebuffer(r.FRAMEBUFFER,
a),r.viewport(0,0,d,e),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT)):(q.xi(b)&&r.deleteTexture(b.Va),q.Vq(c)?r.deleteRenderbuffer(c.nf):q.xi(c)&&r.deleteTexture(c.Va),r.deleteFramebuffer(a))};a.UD=function(){};a.cleanup=function(){}};b4w.module.__shaders=function(a,p){function b(a,b,c){var e=a.He;"string"==typeof c&&(a=d(a,c))&&(c=a[1]);for(a=0;a<e.length;a++)if(e[a][0]==b){e[a][1]=c;return}e.push([b,c])}function d(a,b){for(var c=a.He,d=0;d<c.length;d++)if(c[d][0]==b)return c[d];return!1}function c(a,b){var c=a+b;if(t[c])return t[c];if(y){var d=y[b];if(!d)return null}else{d=x.my(a+b);if(!d)return null;d=r.Rr.parse(d)}return t[c]=d}function e(a,b,d){function e(b){b=b.a;for(var d=0;d<b.length;d++){var n=b[d];switch(n.type){case "condition":a:for(var n=
n.a,w=0;w<n.length;w++){var x=n[w];switch(x.type){case "if":case "elif":var O=x.c;try{var U=h(O)}catch(S){throw"Failed to process #"+x.type+" expression: "+O.join(" ");}if(U){e(x.group);break a}break;case "else":e(x.group);break a;case "ifdef":x.name in t&&e(x.group);break;case "ifndef":x.name in t||e(x.group)}}break;case "include":n=c(B.shaders_dir,B.BA+n.file);e(n);break;case "var":case "export":case "import":break;case "define":w=n.name;t[w]=n.b;n.Ra&&(F[w]=n.Ra);break;case "error":throw"Shader error: #error "+
n.b.join(" ");case "line":break;case "pragma":G.push("#pragma "+n.name+" "+n.b.join(" "));break;case "undef":n=n.name;delete t[n];delete F[n];break;case "warning":u.warn("Shader warning: #warning "+n.b.join(" "));break;case "extension":G.push("#extension "+f(n.b,t,F,!1));break;case "#":break;case "node":r[n.name]=n;break;case "nodes_global":n=k;for(w=0;w<n.length;w++)if(x=n[w],O=r[x.id])for(var J=0,H=0;H<O.g.length;H++){var ga=O.g[H];"node_param"==ga.type&&(ga=ga.qualifier.join(" ")+" ","vert"==a?
ga+=x.Nh[J]:"frag"==a&&(ga+=x.Ra[J],null!==x.uk[J]&&(ga+=" = "+x.uk[J])),ga+=";",G.push(ga),J++)}break;case "nodes_main":n=k;for(w=0;w<n.length;w++)if(x=n[w],O=r[x.id]){J={};H={};for(ga=0;ga<x.Wd.length;ga++)H[x.Wd[ga][0]]=[x.Wd[ga][1]];v=p=y=0;for(var ga=x,ra=O.g,Q=J,ca=H,E=0;E<ra.length;E++){var T=ra[E];switch(T.type){case "node_in":var va=ga.J[y];if(null!==ga.Nm[y]){if(("MATERIAL"==ga.id&&3===y||"MATERIAL_EXT"==ga.id&&3===y||"TEXTURE_COLOR"==ga.id||"TEXTURE_NORMAL"==ga.id)&&T.e){Q[T.name]=ga.Nm[y];
y++;continue}var M=T.qualifier.join(" ")+" ",M=M+va,M=M+(" = "+ga.Nm[y]),M=M+";";G.push(M)}Q[T.name]=va;y++;break;case "node_out":va=ga.Ca[p];if(!T.e||-1<A.indexOf(va))M=T.qualifier.join(" ")+" ",M+=va,M+=";",G.push(M),Q[T.name]=va;-1<A.indexOf(va)&&(ca["USE_OUT_"+T.name]=[1]);p++;break;case "node_param":"vert"==a?va=ga.Nh[v]:"frag"==a&&(va=ga.Ra[v]),Q[T.name]=va,v++}}G.push("{");g(x,O.f,J,H);G.push("}")}break;case "lamp":C[n.name]=n;break;case "lamps_main":n=m;for(w=0;w<n.length;w++)if(x=n[w],x.Py){G.push("{");
O=C[x.type].f;for(J=0;J<O.length;J++){H=O[J];ga=[];for(ra=0;ra<H.b.length;ra++){Q=H.b[ra];switch(Q){case "LAMP_IND":Q=x.index;break;case "LAMP_LIGHT_FACT_IND":Q=x.Vy;break;case "LAMP_FAC_CHANNELS":Q=x.Uy;break;case "LAMP_SPOT_SIZE":Q=q(x.dd);break;case "LAMP_SPOT_BLEND":Q=q(x.sg||.01);break;case "LAMP_LIGHT_DIST":Q=q(x.distance);break;case "LAMP_SHADOW_MAP_IND":Q=x.Cx?1:0}ga.push(Q)}G.push(ga.join(" "))}G.push("}")}break;case "textline":G.push(f(n.b,t,F,!1));break;default:throw"Unknown element type: "+
n.type;}}}function h(a,b){var c=f(a,t,F,!0,b);return w.Rr.parse(c)}function g(a,b,c,d){for(var e=0;e<b.length;e++){var l=b[e];switch(l.type){case "node_condition":a:for(var k=a,l=l.a,m=c,q=d,n=0;n<l.length;n++){var u=l[n];switch(u.type){case "node_if":case "node_elif":var w=u.c;try{var Q=h(w,q)}catch(r){throw"Failed to process #"+u.type+" expression: "+w.join(" ");}if(Q){g(k,u.f,m,q);break a}break;case "node_else":g(k,u.f,m,q);break a;case "node_ifdef":(u.name in t||u.name in q)&&g(k,u.f,m,q);break;
case "node_ifndef":u.name in t||u.name in q||g(k,u.f,m,q)}}break;case "textline":k=[];for(m=0;m<l.b.length;m++)q=l.b[m],q in c?k.push(c[q]):k.push(q);G.push(f(k,t,F,!0,d))}}}var k=d.nn,m=d.Zm;d=d.He||[];for(var G=[],t={},n=0;n<d.length;n++)t[d[n][0]]=[d[n][1]];for(n=0;n<k.length;n++)t["USE_NODE_"+k[n].id]=[1];var F={},r={},C={},A=[];for(n in k)for(var x in k[n].J)A.push(k[n].J[x]);e(b);var y=0,p=0,v=0;return G.join("\n")}function f(a,b,c,d,e){var f=[];g(a,b,c,d,f,e);return f.join(" ")}function g(a,
b,c,d,e,f){for(var h=0;h<a.length;h++){var k=a[h];k in b||f&&k in f?(k=f&&f[k]||b[k],0==k.length&&d?e.push(0):g(k,b,c,d,e,f)):e.push(k)}}function k(a,b,c,d){d=a.createShader(d);a.shaderSource(d,c);a.compileShader(d);n.Sv(d,b,c);return d}function q(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return h(a);case 2:return"vec2("+h(a[0])+","+h(a[1])+")";case 3:return"vec3("+h(a[0])+","+h(a[1])+","+h(a[2])+")";case 4:return"vec4("+h(a[0])+","+h(a[1])+","+h(a[2])+","+h(a[3])+")";case 9:return"mat3("+
h(a[0])+","+h(a[1])+","+h(a[2])+","+h(a[3])+","+h(a[4])+","+h(a[5])+","+h(a[6])+","+h(a[7])+","+h(a[8])+")";case 16:return"mat4("+h(a[0])+","+h(a[1])+","+h(a[2])+","+h(a[3])+","+h(a[4])+","+h(a[5])+","+h(a[6])+","+h(a[7])+","+h(a[8])+","+h(a[9])+","+h(a[10])+","+h(a[11])+","+h(a[12])+","+h(a[13])+","+h(a[14])+","+h(a[15])+")";default:throw"Wrong glsl value dimension";}}function h(a){return a%1?String(a):String(a)+".0"}var m=p("__config"),u=p("__print"),n=p("__debug"),w=p("__gpp_eval"),x=p("__assets");
p("__util");var B=m.Tb;if(b4w.module_check("shader_texts"))var y=p("shader_texts"),r=null;else y=null,r=p("__gpp_parser");var A={},t={},F=[],C=null;a.bd=function(a){C=a};a.v=b;a.ay=d;a.bE=function(a,b){for(var c=a.He,d=0;d<c.length;d++)if(c[d][0]==b&&1==c[d][1])return!0;return!1};a.hA=function(a){a.He=[];for(var c="ALPHA ALPHA_CLIP BEND_CENTER_ONLY BILLBOARD_PRES_GLOB_ORIENTATION CAUSTICS CSM_BLEND_BETWEEEN_CASCADES CSM_FADE_LAST_CASCADE CSM_SECTION0 CSM_SECTION1 CSM_SECTION2 CSM_SECTION3 DEBUG_SPHERE DEBUG_SPHERE_DYNAMIC DEPTH_RGBA DISABLE_FOG DOUBLE_SIDED_LIGHTING DYNAMIC DYNAMIC_GRASS DYNAMIC_GRASS_COLOR DYNAMIC_GRASS_SIZE FOAM FRAMES_BLENDING BILLBOARD_JITTERED BILLBOARD_SPHERICAL HAIR_BILLBOARD SHADOW_TEX_RES MAIN_BEND_COL MAX_BONES NODES_GLOW NUM_NORMALMAPS PARALLAX PARALLAX_STEPS PERSPECTIVE_SHADOW_CAST PROCEDURAL_FOG PROCEDURAL_SKYDOME REFLECTION REFLECTION_PASS REFLECTION_TYPE REFRACTIVE USE_REFRACTION USE_REFRACTION_CORRECTION SHORE_SMOOTHING SKINNED SKY_COLOR SKY_TEXTURE SSAO_HEMISPHERE SSAO_BLUR_DEPTH SSAO_ONLY SSAO_WHITE STATIC_BATCH TEXTURE_COLOR TEXTURE_NORM TEXTURE_SPEC TEXTURE_STENCIL_ALPHA_MASK VERTEX_ANIM VERTEX_ANIM_MIX_NORMALS_FACTOR VERTEX_COLOR WATER_EFFECTS WIND_BEND DETAIL_BEND SHORE_PARAMS ALPHA_AS_SPEC DEPTH_RGBA MTEX_NEGATIVE MTEX_RGBTOINT NUM_LIGHTS NUM_LFACTORS NUM_LAMP_LIGHTS MAX_STEPS BILLBOARD_ALIGN SHADOW_USAGE POST_EFFECT SSAO_QUALITY TEXTURE_BLEND_TYPE TEXTURE_COORDS AA_METHOD AU_QUALIFIER BILLBOARD BILLBOARD_RANDOM PRECISION EPSILON USE_ENVIRONMENT_LIGHT WO_SKYBLEND WO_SKYPAPER WO_SKYREAL WO_SKYTEX WOMAP_BLEND WOMAP_HORIZ WOMAP_ZENUP WOMAP_ZENDOWN WIREFRAME_QUALITY SIZE_RAMP_LENGTH COLOR_RAMP_LENGTH PARTICLES_SHADELESS".split(" "),
d=0;d<c.length;d++){var e=c[d],f;switch(e){case "ALPHA":case "ALPHA_CLIP":case "BILLBOARD_PRES_GLOB_ORIENTATION":case "CAUSTICS":case "CSM_SECTION0":case "CSM_SECTION1":case "CSM_SECTION2":case "CSM_SECTION3":case "DEBUG_SPHERE":case "DEBUG_SPHERE_DYNAMIC":case "DEPTH_RGBA":case "DISABLE_FOG":case "DOUBLE_SIDED_LIGHTING":case "DYNAMIC":case "DYNAMIC_GRASS":case "DYNAMIC_GRASS_COLOR":case "DYNAMIC_GRASS_SIZE":case "FOAM":case "FRAMES_BLENDING":case "BILLBOARD_JITTERED":case "MAIN_BEND_COL":case "MAX_BONES":case "MTEX_NEGATIVE":case "MTEX_RGBTOINT":case "NODES_GLOW":case "NUM_LIGHTS":case "NUM_LFACTORS":case "NUM_NORMALMAPS":case "PARALLAX":case "PARALLAX_STEPS":case "PERSPECTIVE_SHADOW_CAST":case "PROCEDURAL_FOG":case "PROCEDURAL_SKYDOME":case "REFLECTION":case "REFLECTION_PASS":case "REFLECTION_TYPE":case "REFRACTIVE":case "USE_REFRACTION":case "USE_REFRACTION_CORRECTION":case "SHORE_SMOOTHING":case "SKINNED":case "SKY_COLOR":case "SKY_TEXTURE":case "SSAO_HEMISPHERE":case "SSAO_BLUR_DEPTH":case "SSAO_ONLY":case "SSAO_WHITE":case "STATIC_BATCH":case "TEXTURE_COLOR":case "TEXTURE_NORM":case "TEXTURE_SPEC":case "TEXTURE_STENCIL_ALPHA_MASK":case "VERTEX_ANIM":case "VERTEX_COLOR":case "WATER_EFFECTS":case "WIND_BEND":case "DETAIL_BEND":case "SHORE_PARAMS":case "BILLBOARD":case "BILLBOARD_RANDOM":case "HAIR_BILLBOARD":case "USE_ENVIRONMENT_LIGHT":case "WO_SKYBLEND":case "WO_SKYPAPER":case "WO_SKYREAL":case "WO_SKYTEX":case "WOMAP_BLEND":case "WOMAP_HORIZ":case "WOMAP_ZENUP":case "WOMAP_ZENDOWN":case "WIREFRAME_QUALITY":case "SIZE_RAMP_LENGTH":case "COLOR_RAMP_LENGTH":case "PARTICLES_SHADELESS":case "SMAA_JITTER":f=
0;break;case "ALPHA_AS_SPEC":case "BEND_CENTER_ONLY":case "CSM_BLEND_BETWEEEN_CASCADES":case "CSM_FADE_LAST_CASCADE":case "DEPTH_RGBA":case "BILLBOARD_SPHERICAL":case "NUM_LAMP_LIGHTS":case "MAX_STEPS":f=1;break;case "SHADOW_TEX_RES":f=q(2048);break;case "AA_METHOD":f="AA_METHOD_FXAA_QUALITY";break;case "AU_QUALIFIER":f="NOT_ASSIGNED";break;case "BILLBOARD_ALIGN":f="BILLBOARD_ALIGN_VIEW";break;case "POST_EFFECT":f="POST_EFFECT_NONE";break;case "SHADOW_USAGE":f="NO_SHADOWS";break;case "SSAO_QUALITY":f=
"SSAO_QUALITY_32";break;case "TEXTURE_BLEND_TYPE":f="TEXTURE_BLEND_TYPE_MIX";break;case "TEXTURE_COORDS":f="TEXTURE_COORDS_UV_ORCO";break;case "PRECISION":f=m.o.precision;break;case "EPSILON":f="highp"==m.o.precision?1E-6:1E-4;break;case "VERTEX_ANIM_MIX_NORMALS_FACTOR":f="u_va_frame_factor";break;default:u.error("Unknown directive ("+a.bj+", "+a.mi+"): "+e)}b(a,e,f)}};a.ND=function(a){return a.bj};a.sq=function(a){return a.mi};a.VD=function(a,c){for(var e=c.He,f=0;f<e.length;f++){var h=e[f][0],g=
e[f][1];d(a,h)&&b(a,h,g)}};a.Xx=function(a){var b=JSON.stringify(a),d=A[b];if(d)return d;var f=a.mi,d=c(B.shaders_dir,a.bj),f=c(B.shaders_dir,f);if(!d||!f)return null;var h=e("vert",d,a),g=e("frag",f,a),d=C,m=k(d,b,h,d.VERTEX_SHADER),q=k(d,b,g,d.FRAGMENT_SHADER),f=d.createProgram();d.attachShader(f,m);d.attachShader(f,q);d.linkProgram(f);d.validateProgram(f);d.getProgramParameter(f,d.VALIDATE_STATUS)==d.AC&&u.error("shader program is not valid",b);n.Tv(f,b,m,q,h,g);a={po:m,hq:q,Mi:f,attributes:{},
Yi:{},Ii:[],tn:{},Ws:[],pb:a};g=d.getProgramParameter(f,d.ACTIVE_ATTRIBUTES);for(h=0;h<g;h++)m=d.getActiveAttrib(f,h).name,a.attributes[m]=d.getAttribLocation(f,m);g=d.getProgramParameter(f,d.ACTIVE_UNIFORMS);for(h=0;h<g;h++)m=d.getActiveUniform(f,h).name.split("[0]").join(""),a.Yi[m]=d.getUniformLocation(f,m);return A[b]=d=a};a.Rw=function(){return F};a.pq=function(){return A};a.cleanup=function(){for(var a in A){var b=A[a];C.deleteProgram(b.Mi);C.deleteShader(b.po);C.deleteShader(b.hq);delete A[a]}for(var c in t)delete t[c];
for(var d in F)delete F[d]};a.jD=function(a){var b=a.He;u.log("Shader: "+a.bj+" "+a.mi+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)u.log("  "+b[a][0],b[a][1])};a.t=q;a.up=function(a,b){return b in a.Yi?!0:!1};a.py=function(a){return(C.getShaderSource(a).match(/(?:^|\s)varying(?=\s)/g)||[]).length}};b4w.module.__geometry=function(a,p){function b(a){return 65536<a.K?H.rq()?!1:!0:!1}function d(a){return 0<a.ea.length?!0:!1}function c(a,b,c){if(!d(a))return a;c||F.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.K*(b||1)+", will use drawArrays","color: #aa0");b=a.ea;c=a.K;var f=a.H,h=a.A,l;for(l in f){var g=f[l],k=w(g,c);f[l]=e(b,g,k)}for(f=0;f<h.length;f++){var m=h[f];for(l in m)g=m[l],k=w(g,c),m[l]=e(b,g,k)}for(f=0;f<a.V.length;f++){l=a.V[f].Qb;for(var q in l)g=l[q],k=
w(g,c),l[q]=e(b,g,k)}a.K=b.length;a.ea=new Uint16Array(0);return a}function e(a,b,c){if(0==b.length)return new Float32Array(0);for(var d=new Float32Array(a.length*c),e=0;e<a.length;e++)for(var f=a[e],l=0;l<c;l++)d[c*e+l]=b[c*f+l];return d}function f(a,b){var c=a.ed,d=a.Ub[b];if(d)return c.subarray(d.offset,d.offset+d.length);throw"extract_array() failed; invalid name: "+b;}function g(b,c){var d,e;switch(c){case a.Ph:case a.jj:d=z.TRIANGLES;e=z.STATIC_DRAW;break;case a.Ao:d=z.POINTS;e=z.STATIC_DRAW;
break;case a.ij:d=z.TRIANGLES;e=z.DYNAMIC_DRAW;break;case a.zo:d=z.POINTS;e=z.DYNAMIC_DRAW;break;case a.ut:d=z.LINES;e=z.STATIC_DRAW;break;default:throw"Wrong draw_mode";}b.mode=d;b.aj=e}function k(a){a.Oe?(a.ee||(a.ee=z.createBuffer()),z.bindBuffer(z.ELEMENT_ARRAY_BUFFER,a.ee),z.bufferData(z.ELEMENT_ARRAY_BUFFER,a.Oe,a.aj),a.Lj=a.Oe.byteLength):a.Lj=0;a.mf||(a.mf=z.createBuffer());z.bindBuffer(z.ARRAY_BUFFER,a.mf);z.bufferData(z.ARRAY_BUFFER,a.ed,a.aj);a.Mp=a.ed.byteLength}function q(a){for(var b=
l.lb("JOIN_"+a.length+"_SUBMESHES"),c=0,d=0;d<a.length;d++)c+=a[d].ea.length;b.ea=new Uint32Array(c);var e=c=0,f=0;if(0<a[0].V.length)for(var h=0;h<a[0].V.length;h++){for(d=0;d<a.length;d++)c+=a[d].V[h].Qb.a_position.length,e+=a[d].V[h].Qb.a_normal.length,f+=a[d].V[h].Qb.a_tangent.length;d={a_position:new Float32Array(c),a_normal:new Float32Array(e),a_tangent:new Float32Array(f)};b.V.push({ak:a[0].V[h].ak,Qb:d})}for(d=c=0;d<a.length;d++)c+=a[d].K;b.K=c;var e=a[0],g;for(g in e.H){for(d=c=0;d<a.length;d++)c+=
a[d].H[g].length;b.H[g]=new Float32Array(c)}for(g in e.A[0]){for(d=c=0;d<a.length;d++)c+=a[d].A[0][g].length;for(d=0;d<e.A.length;d++)b.A[d]=b.A[d]||{},b.A[d][g]=new Float32Array(c)}for(g=e=c=0;g<a.length;g++){for(var f=a[g],k=f.ea,h=f.K,m=f.H,d=0;d<k.length;d++)b.ea[c+d]=k[d]+e;var c=c+k.length,q;for(q in m){var k=m[q],n=e*w(k,h);b.H[q].set(k,n)}for(d=0;d<f.A.length;d++){var m=f.A[d],u=b.A[d];for(q in m)k=m[q],n=e*w(k,h),u[q].set(k,n)}e+=h}if(0<b.V.length)for(g=0;g<b.V.length;g++)for(q=b.V[g].Qb,
d=f=e=c=0;d<a.length;d++)h=a[d].V[g].Qb,q.a_position.set(h.a_position,c),q.a_normal.set(h.a_normal,e),q.a_tangent.set(h.a_tangent,f),c+=h.a_position.length,e+=h.a_normal.length,f+=h.a_tangent.length;return b}function h(a,b,d,e,f,h){var g=l.lb("SUBMESH_"+a.name+"_"+b),k=a.submeshes[b],q=k.base_length,t=a.materials[b];g.K=q;var w=!1;if(u(d,"a_texcoord")){var C=null,A=a.materials[b];b=a.submeshes[b];if(A.texture_slots.length)switch(A=A.texture_slots[0],A.texture_coords){case "UV":A=a.uv_textures.indexOf(A.uv_layer);
0==A||-1==A?C=new Float32Array(b.texcoord):1==A&&(C=new Float32Array(b.texcoord2));break;case "ORCO":for(var x=a.b4w_bounding_box_source,C=new Float32Array(2*b.base_length),A=(x.max_x+x.min_x)/2,z=(x.max_z+x.min_z)/2,y=x.max_x-x.min_x,x=x.max_z-x.min_z,K=0,I=0;I<b.position.length;I+=3)C[K++]=(b.position[I]-A)/y+.5,C[K++]=(z-b.position[I+2])/x+.5}null===C&&(C=new Float32Array(b.texcoord));b=C}else b=new Float32Array(0);if(u(d,"a_orco_tex_coord")){C=a.b4w_bounding_box_source;A=new Float32Array(3*k.base_length);
z=C.max_x-C.min_x;y=C.max_z-C.min_z;x=C.max_y-C.min_y;for(I=K=0;I<k.position.length;I+=3)0==z?A[K++]=-1:A[K++]=parseFloat(((k.position[I]-C.min_x)/z).toFixed(3)),0==y?A[K++]=-1:A[K++]=parseFloat(((-C.min_z-k.position[I+2])/y).toFixed(3)),0==x?A[K++]=-1:A[K++]=parseFloat(((k.position[I+1]-C.min_y)/x).toFixed(3));C=A}else C=new Float32Array(0);var U,A=k.group;if(u(d,"a_influence")&&e){z=new Float32Array(4*q);y=A.length/q;x=new Float32Array(y);for(K=0;K<y;K++)for(U in x[K]=-1,e)if(I=e[U],I.mt===K){x[K]=
I.fi;break}var S=3<y?y:4;e=new Float32Array(S);U=new Uint32Array(S);for(var K=new Float32Array(4),I=new Float32Array(S),S=new Uint32Array(S),fa=new Float32Array(4),p=0;p<q;p++)e.set(I),U.set(S),K.set(fa),z.set(n(A,y,p,q,x,e,U,K),4*p)}else z=new Float32Array(0);U=z;e=f?l.qa(f):{};e.a_color={Mf:!0};e.a_color.src=u(d,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,Nc:7}]:[];f={a_texcoord:b,a_influence:U,a_orco_tex_coord:C};U=k.vertex_colors;b=k.color;C=a.name;A=[];for(z=0;z<U.length;z++)A.push(U[z].name);
for(var J in e)if(z=e[J].src,z.length){for(x=y=0;x<z.length;x++)y+=l.pg(z[x].Nc);f[J]=new Float32Array(y*q);for(x=K=0;x<z.length;x++){var B=z[x].name,I=z[x].Nc,S=l.hs(I),Q=A.indexOf(B);-1==Q&&l.pa('vertex color "'+B+'" for mesh "'+C+'" not found.');fa=U[Q].mask;p=l.pg(fa);(I&fa)!==I&&F.error("Wrong color extraction from "+B+" to "+J+".");for(var ca=B=0;ca<Q;ca++)B+=l.pg(U[ca].mask);Q=B*q;for(B=0;B<q;B++)for(ca=0;3>ca;ca++)S[ca]&&(f[J][B*y+(K+l.Si(I,ca))]=b[Q+B*p+l.Si(fa,ca)]);K+=p}}else f[J]=new Float32Array(0);
J=a.uv_textures;e=k.texcoord;U=k.texcoord2;b=a.name;if(h)for(var E in h){C=J.indexOf(E);-1==C&&l.pa('uv map "'+E+'" for mesh "'+b+'" not found');if(0==C)var T=new Float32Array(e);else 1==C&&(T=new Float32Array(U));f[h[E]]=T}g.H=f;g.ea=new Uint32Array(k.indices);h=k.position.length/q/3;T=(E=u(d,"a_normal")&&k.normal.length?!0:!1)&&u(d,"a_tangent")&&k.tangent.length?!0:!1;J=E&&t.texture_slots.length&&u(d,"a_tangent")&&"ORCO"==t.texture_slots[0].texture_coords?!0:!1;0<a.b4w_shape_keys.length&&(w=!0);
for(f=0;f<h;f++){t=m(k,d,q,E,T,J,f);if(w)if(e={},e.name=a.b4w_shape_keys[f].name,g.V.push(e),0!=f){e.Qb=t;e.ak=a.b4w_shape_keys[f].value;continue}else e.Qb=m(k,d,q,E,T,J,f),e.ak=1;g.A.push(t)}if(1<h&&!w){a=g.A[0];var t={},va;for(va in a)t[va]=new Float32Array(a[va]);g.A.push(t)}u(d,"a_polyindex")&&(c(g,1,!0),g.H.a_polyindex=r(g));return g}function m(a,b,c,d,e,f,h){var g={},k=new Float32Array(3*c),m=new Float32Array(d?3*c:0),q=new Float32Array(e||f?4*c:0),n=h*c*3;k.set(a.position.subarray(n,n+3*c),
0);d&&(n=h*c*3,m.set(a.normal.subarray(n,n+3*c),0));if(e)n=h*c*4,q.set(a.tangent.subarray(n,n+4*c),0);else if(f)for(a=q,F.warn('Not precise tangents calculation for normalmap using GENERATED texture coordinates in mesh: "'+mesh.name+'". Please add a UV-map.'),b=0;b<c;b++)d=K,e=I,d[0]=m[3*b],d[1]=m[3*b+1],d[2]=m[3*b+2],J.cross(d,l.AXIS_Z,e),0==J.length(e)&&J.cross(d,l.AXIS_X,e),J.normalize(e,e),a[4*b]=e[0],a[4*b+1]=e[1],a[4*b+2]=e[2],a[4*b+3]=1;else if(d&&u(b,"a_tangent"))for(q=new Float32Array(4*
c),c=0;c<q.length;c++)q[c]=1;g.a_position=k;g.a_normal=m;g.a_tangent=q;return g}function u(a,b){return-1<a.indexOf(b)?!0:!1}function n(b,c,d,e,f,g,h,l){for(var k=!0,m=0;m<c;m++){var q=b[m*e+d];if(-1!==q){var n=f[m];-1!==n&&(g[m]=q,h[m]=n,k=!1)}}if(k)return l;x(g,h,a.bl,!1);for(m=b=0;4>m;m++)b+=g[m];if(.01>b)return l;for(m=0;4>m;m++)g[m]/=b;if(.01>Math.abs(g[0]-1))l[0]=h[0]+1;else for(m=0;4>m;m++)l[m]=h[m]+g[m];return l}function w(a,b){if(0==b)return 0;var c=a.length,d=c/b;if(d!=Math.floor(d))throw"Array size mismatch during geometry calculation: array length="+
c+", base length="+b;return d}function x(b,c,d,e){for(var f=b.length,g=f,h=!1,l=e?-1:1;1<g||h;){1<g&&(g=Math.floor(g/1.247330950103979));for(var h=!1,k=0;g+k<f;k++)if(d==a.bl?0>l*(b[k]-b[k+g]):b[k]<b[k+g]&&e)h=b[k],b[k]=b[k+g],b[k+g]=h,h=c[k],c[k]=c[k+g],c[k+g]=h,h=!0}}function B(a,b,c){var d=[],e=[];J.subtract(b,a,d);J.subtract(c,a,e);J.normalize(d,d);J.normalize(e,e);return Math.acos(J.dot(d,e))}function y(a,b,c){b||(b=[]);c=c?a.A[0].a_normal:a.A[0].a_position;if(d(a)){a=a.ea;for(var e=a.length/
3,f=0;f<e;f++){var g=new Float32Array(9),h=a[3*f];g[0]=c[3*h];g[1]=c[3*h+1];g[2]=c[3*h+2];h=a[3*f+1];g[3]=c[3*h];g[4]=c[3*h+1];g[5]=c[3*h+2];h=a[3*f+2];g[6]=c[3*h];g[7]=c[3*h+1];g[8]=c[3*h+2];b[f]=g}}else for(f=0;f<c.length;f++)g=new Float32Array(9),g[0]=c[9*f],g[1]=c[9*f+1],g[2]=c[9*f+2],g[3]=c[9*f+3],g[4]=c[9*f+4],g[5]=c[9*f+5],g[6]=c[9*f+6],g[7]=c[9*f+7],g[8]=c[9*f+8],b[f]=g;return b}function r(a){for(var b=new Float32Array(a.K),c=0;c<a.K;c++)b[c]=c%3;return b}function A(a,b,c){var d=J.dist(a,
b);a=J.dist(a,c);b=J.dist(b,c);c=(d+a+b)/2;return c*(c-d)*(c-a)*(c-b)}function t(a,b,c,d,e){c-=b;for(var f=0;f<c;f+=d)f%d==e&&vec3.normalize(a.subarray(f+b-e,f+b+1),a.subarray(f+b-e,f+b+1))}var F=p("__print"),C=p("__tsr"),l=p("__util"),H=p("__extensions"),J=p("vec3"),K=new Float32Array(3),I=new Float32Array(3),P=new Float32Array(3);a.Kd=10;a.Ho=20;a.GC=30;a.jj=10;a.Ao=20;a.ij=30;a.zo=40;a.ut=50;a.bl=0;a.Eu=1;a.Ph=a.jj;var z=null;a.bd=function(a){z=a};a.kD=function(a){var b=_buffers[a];z.deleteBuffer(b.ee);
z.deleteBuffer(b.mf);delete _buffers[a]};a.bB=function(e,f,h,l){b(e)&&c(e);var m=e.ea,q=e.K,n=e.A,t={},u;for(u in e.H)u in l&&!l[u].Mf||(t[u]=e.H[u]);l={Oe:null,ed:null,Km:0,count:0,Ub:{},mode:0,aj:0,Lj:0,Mp:0,mf:null,ee:null,Zj:null,V:null};if(0<e.V.length){u=n[0];for(var F=1;F<e.V.length;F++){for(var C=e.V[F].Qb,r=C.a_position,A=C.a_normal,x=u.a_position,y=u.a_normal,K=r.length,I=e.V[F].ak,J=0;J<K;J++)x[J]+=I*r[J],y[J]+=I*A[J];C=C.a_tangent;r=u.a_tangent;A=C.length;for(J=0;J<A;J++)r[J]+=I*C[J]}}if(m.length)if(u=
m.length,65536>=q)var F=new Uint16Array(m),U=z.UNSIGNED_SHORT;else F=new Uint32Array(m),U=z.UNSIGNED_INT;else u=q,F=null;var I=0,J=n.length,S;for(S in n[0])C=n[0][S],I+=C.length*J;for(S in t)C=t[S],I+=C.length;S=new Float32Array(I);var I=0,J={},p;for(p in t)if(r=t[p],C=r.length)S.set(r,I),J[p]={TC:p,sd:w(r,q),offset:I,frames:1,length:C},I+=C;t=n.length;for(p in n[0])if(r=n[0][p],C=r.length,r=w(r,q),C)for(J[p]={sd:r,offset:I,frames:t,length:C},1<t&&(J[p+"_next"]={sd:r,offset:I+C,frames:t,length:C}),
A=0;A<t;A++)r=n[A][p],S.set(r,I),I+=C;l.count=u;l.Oe=F;l.ed=S;l.Km=U;l.Ub=J;g(l,h);k(l);f!=a.Kd&&d(e)&&(l.Zj={gz:new Float32Array(m.length),hz:new Float32Array(m.length),cx:new Float32Array(m.length/3),type:f});l.V=e.V;return l};a.Ny=b;a.My=d;a.Un=c;a.xB=function(a,b,c){g(a,b);a.count=c.length;a.Oe=c;a.Km=c instanceof Uint16Array?z.UNSIGNED_SHORT:z.UNSIGNED_INT};a.Rk=function(a,b,c,d){var e=a.ed,f=a.Ub,g=f[b];g?(c&&g.sd!=c&&l.pa('invalid num_comp for "'+b+'"'),e.set(d,g.offset)):(e=e.length,g=new Float32Array(e+
d.length),g.set(a.ed),g.set(d,e),a.ed=g,f[b]={sd:c,offset:e});k(a)};a.nx=f;a.oE=function(a){a.aj=z.STATIC_DRAW};a.az=function(a){a.aj=z.DYNAMIC_DRAW};a.bt=k;a.wp=function(a){a.ee&&z.deleteBuffer(a.ee);a.mf&&z.deleteBuffer(a.mf)};a.Jq=function(a,b){return a.submeshes[b].base_length?!1:!0};a.Ps=function(a,b){for(var c=0;c<a.A.length;c++){var d=a.A[c].a_position;C.transform_vectors(d,b,d,0);d=a.A[c].a_normal;0<d.length&&C.transform_dir_vectors(d,b,d,0);d=a.A[c].a_tangent;0<d.length&&C.transform_tangents(d,
b,d,0)}(c=a.H.au_center_pos)&&c.length&&C.transform_vectors(c,b,c,0);return a};a.$A=function(a,b){var c=a.H.au_center_pos;if(c&&c.length){var d=new Float32Array(c);C.transform_vectors(d,b,d,0);for(var e=0;e<a.A.length;e++)for(var f=0;f<d.length;f++)a.A[e].a_position[f]+=d[f]-c[f];c.set(d)}else throw'Attribute "au_center_pos" is missing in particle submesh';};a.ZA=function(a,b){var c=a.K,d;for(d in b){var e=b[d].length;a.H[d]=new Float32Array(e*c);for(var f=0;f<c;f++)for(var g=0;g<e;g++)a.H[d][f*e+
g]=b[d][g]}};a.aB=q;a.$y=function(a,b,d){if(!a.K)return l.lb("EMPTY");var e=d.length;65536<a.K*e&&!H.rq()&&c(a,e);var f=a.ea,g=a.K,h=a.H;a=a.A;for(var k in b){var m=b[k].length,q=m*g;h[k]=new Float32Array(q);for(var n=0;n<g;n++)for(q=0;q<m;q++)h[k][n*m+q]=b[k][q]}b=l.lb("CLONE_"+e+"_SUBMESHES");b.K=g*e;b.ea=new Uint32Array(f.length*e);for(n=0;n<e;n++)for(m=f.length*n,k=g*n,q=0;q<f.length;q++)b.ea[m+q]=f[q]+k;for(var t in h)for(f=h[t],q=f.length*e,m=w(f,g),b.H[t]=new Float32Array(q),n=0;n<e;n++)k=
g*m*n,b.H[t].set(f,k);for(t in a[0])for(n=0;n<a.length;n++)for(f=a[n][t],q=f.length*e,m=w(f,g),b.A[n]=b.A[n]||{},b.A[n][t]=new Float32Array(q),q=0;q<e;q++)switch(h=d[q],k=g*m*q,t){case "a_position":C.transform_vectors(f,h,b.A[n][t],k);break;case "a_normal":C.transform_dir_vectors(f,h,b.A[n][t],k);break;case "a_tangent":C.transform_tangents(f,h,b.A[n][t],k);break;default:throw"Wrong attribute name: "+t;}return b};a.Zp=h;a.qx=function(a){var b=a.K,c=a.A[0].a_position,d=new Float32Array(12*b),e=new Float32Array(8*
b);a=new Uint16Array(4*a.ea.length);for(var f=0;f<b;f++)d[12*f]=c[3*f],d[12*f+1]=c[3*f+1],d[12*f+2]=c[3*f+2],d[12*f+3]=c[3*f],d[12*f+4]=c[3*f+1],d[12*f+5]=c[3*f+2],d[12*f+6]=c[3*f],d[12*f+7]=c[3*f+1],d[12*f+8]=c[3*f+2],d[12*f+9]=c[3*f],d[12*f+10]=c[3*f+1],d[12*f+11]=c[3*f+2],e[8*f]=-.5,e[8*f+1]=-.5,e[8*f+2]=-.5,e[8*f+3]=.5,e[8*f+4]=.5,e[8*f+5]=.5,e[8*f+6]=.5,e[8*f+7]=-.5,a[6*f]=4*f+2,a[6*f+1]=4*f+1,a[6*f+2]=4*f,a[6*f+3]=4*f+2,a[6*f+4]=4*f,a[6*f+5]=4*f+3;c=l.lb("HALO");c.A=[];c.A[0]={};c.K=4*b;c.A[0].a_position=
d;c.H.a_halo_bb_vertex=e;c.ea=a;return c};a.xy=u;a.$p=function(a,b,c){for(var d=[],e=0;e<a.submeshes.length;e++){var f=h(a,e,b,null,c,null);f.K&&d.push(f)}return 0==d.length?l.lb("EMPTY"):1==d.length?d[0]:q(d)};a.wB=function(a,b,c){for(var d=a.Oe,e=f(a,"a_position"),g=a.Zj,h=g.gz,k=g.hz,g=g.cx,m=d,q=m.length/3,n=0;n<q;n++){var t=m[3*n],u=m[3*n+1],w=m[3*n+2],C=e[3*t+1],F=e[3*t+2],r=e[3*u+1],A=e[3*u+2],x=e[3*w+1],y=e[3*w+2];h[3*n]=(e[3*t]+e[3*u]+e[3*w])/3;h[3*n+1]=(C+r+x)/3;h[3*n+2]=(F+A+y)/3}l.We(h,
b,k);b=k.length/3;for(e=0;e<b;e++)h=k[3*e]-c[0],m=k[3*e+1]-c[1],q=k[3*e+2]-c[2],g[e]=h*h+m*m+q*q;c=d;d=g.length;if(!(2>d))for(k=d,e=!1;1<k||e;)for(1<k&&(k=Math.floor(k/1.247330950103979)),e=!1,b=0;k+b<d;b++)0>g[b]-g[b+k]&&(e=g[b],g[b]=g[b+k],g[b+k]=e,e=c,h=b,m=b+k,q=e[3*h],n=e[3*h+1],t=e[3*h+2],e[3*h]=e[3*m],e[3*h+1]=e[3*m+1],e[3*h+2]=e[3*m+2],e[3*m]=q,e[3*m+1]=n,e[3*m+2]=t,e=!0);d=c;z.bindBuffer(z.ELEMENT_ARRAY_BUFFER,a.ee);z.bufferData(z.ELEMENT_ARRAY_BUFFER,d,z.DYNAMIC_DRAW)};a.Bs=x;a.kp=function(a,
b,c){for(var d=b.length/3,e=a.length/3,f=[],g=Array(3),h=Array(3),l=Array(3),k=0;k<e;k++){for(var m=a[3*k],q=a[3*k+1],n=a[3*k+2],t=0;3>t;t++)g[t]=b[3*m+t],h[t]=b[3*q+t],l[t]=b[3*n+t];if(c)var t=B(g,h,l),u=B(h,l,g),w=Math.PI-t-u;else w=u=t=1;var C=f,F;F=g;var r=l,A=[],x=[],z=[];J.subtract(h,F,A);J.subtract(r,F,x);J.cross(A,x,z);J.normalize(z,z);F=z;for(r=0;3>r;r++)A=3*q+r,x=3*n+r,C[3*m+r]=t*F[r],C[A]=u*F[r],C[x]=w*F[r]}if(c)for(var y in c)for(k=c[y],a=0;3>a;a++){b=3*k[0]+a;for(e=1;e<k.length;e++)g=
3*k[e]+a,f[b]+=f[g];for(e=1;e<k.length;e++)g=3*k[e]+a,f[g]=f[b]}for(k=0;k<d;k++){c=k;y=f;a=new Float32Array(3);for(b=0;3>b;b++)e=3*c+b,a[b]=y[e];J.normalize(a,a);for(b=0;3>b;b++)e=3*c+b,y[e]=a[b]}return f};a.mp=function(a,b,c){for(var d={},e=b.length/3,f=0;f<e;f++){var g=String(b[3*f])+String(b[3*f+1])+String(b[3*f+2]);d[g]=[]}e=a.length;for(f=0;f<e;f++)b=a[f],g=String(c[3*b])+String(c[3*b+1])+String(c[3*b+2]),g in d&&d[g].push(b);return d};a.wm=function(a,b,c,d){var e=y(a,null,!1);if(c)var f=y(a,
null,!0);var g=e.length,h=new Float32Array(g),k=K,m=I;for(a=0;a<g;a++){var q=e[a];k.set(q.subarray(0,3));m.set(q.subarray(3,6));P.set(q.subarray(6));h[a]=Math.sqrt(A(k,m,P))}k=new Float32Array(g);k[0]=h[0];for(a=1;a<g;a++)k[a]=k[a-1]+h[a];g=k[h.length-1];h=[];for(a=0;a<b;a++){var m=g*l.Rc(d),m=l.xj(k,m,0,k.length-1),q=c?f[m]:e[m],m=a,n=q,t=d,q=void 0,q=new Float32Array(3),u=n[0],w=n[1],C=n[2],F=n[3],r=n[4],x=n[5],z=n[6],J=n[7],p=n[8],n=l.Rc(t),t=l.Rc(t);1<n+t&&(n=1-n,t=1-t);var B=1-n-t,w=B*w+n*r+
t*J,C=B*C+n*x+t*p;q[0]=B*u+n*F+t*z;q[1]=w;q[2]=C;h[m]=q}return h};a.qD=y;a.Yp=r;a.LE=A;a.gy=function(a,b,c,d){var e=b[0]-a[0],f=c[0]-a[0],g=b[1]-a[1],h=c[1]-a[1];b=b[2]-a[2];a=c[2]-a[2];d[0]=g*a-b*h;d[1]=f*b-e*a;d[2]=e*h-g*f;return d};a.$z=function(a,b,c){a=a.A[0].a_position;for(var d=0;d<a.length;d+=3)a[d]=(a[d]-c[0])*b[0]+c[0],a[d+1]=(a[d+1]-c[1])*b[1]+c[1],a[d+2]=(a[d+2]-c[2])*b[2]+c[2]};a.mv=function(a,b,c){var d=a.n;a=a.d.af;for(var e=1;e<a.length;e++)a[e].name==b&&(a[e].value=c);for(e=0;e<d.length;e++)if(!d[e].Jf&&
d[e].Dd&&!d[e].Ng){var f=d[e].R.Ub;b=d[e].R.ed;z.bindBuffer(z.ARRAY_BUFFER,d[e].R.mf);if(f.a_position){var g=f.a_position.offset,h=f.a_position.length+g,l=d[e].R.V[0].Qb.a_position;for(c=g;c<h;c++)b[c]=l[c-g];for(l=1;l<d[e].R.V.length;l++){var k=d[e].R.V[l].Qb.a_position,m=a[l].value;if(m)for(c=g;c<h;c++)b[c]+=m*k[c-g]}z.bufferSubData(z.ARRAY_BUFFER,4*g,b.subarray(g))}if(f.a_normal){g=f.a_normal.offset;h=f.a_normal.length+g;l=d[e].R.V[0].Qb.a_normal;for(c=g;c<h;c++)b[c]=l[c-g];for(l=1;l<d[e].R.V.length;l++)if(k=
d[e].R.V[l].Qb.a_normal,m=a[l].value)for(c=g;c<h;c++)b[c]+=m*k[c-g];t(b,g,h,3,2);z.bufferSubData(z.ARRAY_BUFFER,4*g,b.subarray(g))}if(f.a_tangent){g=f.a_tangent.offset;f=f.a_tangent.length+g;l=d[e].R.V[0].Qb.a_tangent;for(c=g;c<f;c++)b[c]=l[c-g];for(l=1;l<d[e].R.V.length;l++)if(h=d[e].R.V[l].Qb.a_tangent,m=a[l].value)for(c=g;c<f;c++)b[c]+=m*h[c-g];t(b,g,f,4,3);z.bufferSubData(z.ARRAY_BUFFER,4*g,b.subarray(g))}}};a.check_shape_keys=function(a){return a.d.Dd};a.get_shape_keys_names=function(a){var b=
[];if(a.d)for(var c=1;c<a.d.af.length;c++)b.push(a.d.af[c].name);return b};a.get_shape_key_value=function(a,b){if(a.d)for(var c=1;c<a.d.af.length;c++)if(b==a.d.af[c].name)return a.d.af[c].value;return 0};a.Lq=function(a,b){var c=a.d.af;if(c)for(var d=1;d<c.length;d++)if(c[d].name==b)return!0;return!1};a.si=function(a){return a&&a.d&&a.d.nd?!0:!1}};b4w.module.__objects=function(a,p){function b(a){a={type:a,pc:0,vy:[0,0],h:new Float32Array(3),quat:new Float32Array(4),Ab:new Float32Array(8),T:new Float32Array(16),Rq:new Float32Array(16),Lb:new Float32Array(3),Sb:new Float32Array(3),$g:0,ah:0,Pm:!1,Gj:null,$c:0,Xn:!1,ft:!1,ua:n.MS_STATIC,mo:1,lo:1,no:1,dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,Yd:null,Ys:!1,Xd:0,Gf:0,Ua:!1,Rb:null,fd:null,xb:null,dm:!0,G:null,Ei:null,nc:null,vc:null,ec:null,oi:0,ji:0,qm:0,Ai:0,$f:0,Sr:"",Tk:!1,Ac:!1,Yb:!1,
hc:!1,Vb:!1,Mb:!1,yc:!1,ke:!1,Af:!1,Gc:!1,Mj:!1,nd:!1,mb:!1,Pg:!1,Zg:!1,gk:!1,qg:!1,ok:!1,Fb:!1,nk:!1,yr:!1,ek:!1,is_visible:!1,sm:!1,ej:0,Fd:0,te:0,Vd:0,Ud:0,Qd:0,ge:"",Jb:null,wj:!1,kd:!1,Xh:"",Wh:!1,Kf:0,time:0,ko:0,it:0,ie:0,ni:!1,Xk:!1,Dd:!1,af:[],bh:!1,Be:!1,Ae:1,kl:0,jl:1,Pk:new Int8Array([-1,-1]),Kk:[],nr:[],ts:[],xc:null,wc:null,Fc:null,Ec:null,Kc:null,Tr:null,ml:null,ll:null,he:null,bg:null,hk:null,tc:null,ag:null,ik:null,Pb:null,sl:null,ql:null,rl:null,bb:null,Vc:null,vb:null,yf:null,zf:null,
scale:1,Re:1E4};K.identity(a.quat);H.identity(a.Ab);P.identity(a.T);P.identity(a.Rq);return a}function d(a){var b=a.parent;if(b&&b.Eg)return!0;switch(a.type){case "MESH":var c=h.bk(a),d=a.b4w_do_not_batch,e=a.b4w_collision,f=a.b4w_vehicle,g=a.b4w_floating,b=a.b4w_character,l=t.zy(a),k=A.Kq(a),m=0<a.data.b4w_shape_keys.length,q=a.b4w_dynamic_geometry;if(!(c=c||d||e||f||m||g))a:{a=a.data;for(c=0;c<a.materials.length;c++)if("LENS_FLARES"===a.materials[c].name){c=!0;break a}c=!1}return c||l||b||k||q;
case "EMPTY":return b=h.bk(a),l=A.Kq(a),a=a.b4w_do_not_batch,b||l||a;default:return!0}}function c(a,b,d,f,g,h,l,k,m){for(var q=0;q<a.nodes.length;q++){var n=a.nodes[q];if("VALUE"==n.type){var t=b+n.name;f.push(n.outputs[0].default_value);g.push(t,g.length/2)}else"RGB"==n.type?(t=b+n.name,n=n.outputs[0].default_value.slice(0,3),l.push(n[0],n[1],n[2]),k.push(t,k.length/2)):"GROUP"==n.type&&(t=n.node_group.node_tree,c(t,b+n.name+"%join%",t.animation_data,f,g,h,l,k,m))}if(d)for((a=d.action)&&e(a,b,h,
g,m,k),d=d.nla_tracks,f=0;f<d.length;f++)for(l=d[f].strips,q=0;q<d[f].strips.length;q++)a=l[q].action,e(a,b,h,g,m,k)}function e(a,b,c,d,e,g){var h=a.d.Ra,l;for(l in h){var k=b+l.match(/"(.*?)"/)[1],h=f(d,k);null!=h?(k=a.name+"%join%"+l,c.push(k,h)):(h=f(g,k),null!=h&&(k=a.name+"%join%"+l,e.push(k,h)))}}function f(a,b){for(var c=0;c<a.length;c+=2)if(a[c]==b)return a[c+1];return null}function g(a,b,c){return{name:a,type:b,modifiers:[],particle_systems:[],constraints:[],data:null,parent:null,b4w_vehicle_settings:null,
b4w_floating_settings:null,b4w_character_settings:null,b4w_vehicle:!1,b4w_character:!1,b4w_floating:!1,n:[],Io:c,Ic:[],ye:[],Ld:[],Tc:null,Wa:null,Jc:null,k:null,D:[],m:null,j:null,na:null}}function k(a){return a instanceof Array?a.slice():a}function q(a){if("object"!=typeof a||null===a)return a;var b=a instanceof Array?[]:{},c=null,d=null,e=null;a.L&&(c=a.L,a.L=null);a.Gb&&(d=a.Gb,a.Gb=null);a.V&&(e=a.V,a.V=null);for(var f in a)b[f]=a[f]&&"object"==typeof a[f]?a[f]instanceof Float32Array?new Float32Array(a[f]):
a[f]instanceof Uint32Array?new Uint32Array(a[f]):a[f]instanceof Uint16Array?new Uint16Array(a[f]):a[f]instanceof WebGLUniformLocation?a[f]:a[f]instanceof WebGLProgram?a[f]:a[f]instanceof WebGLShader?a[f]:a[f]instanceof WebGLBuffer?null:q(a[f]):a[f];c&&(b.L=c,a.L=c);d&&(b.Gb=d,a.Gb=d);e&&(b.V=e,a.V=e);return b}var h=p("__animation"),m=p("__batch"),u=p("__boundings"),n=p("__camera"),w=p("__config"),x=p("__constraints"),B=p("__curve"),y=p("__geometry"),r=p("__lights"),A=p("__nla"),t=p("__particles"),
F=p("__print"),C=p("__scenes"),l=p("__transform"),H=p("__tsr"),J=p("__util"),K=p("quat"),I=p("vec3"),P=p("mat4"),z=w.Fb,N=0,G=0,L=[],O=new Float32Array(4);a.Ij=b;a.Sk=function(a,e){var f=d(a);a.Eg=f;a.d=b("MESH"===a.type?f?"DYNAMIC":"STATIC":a.type);a.Io=!1;a.Wa=null;a.Ic=[];a.D=[];a.m=null;a.j=null;a.na=null;a.za||(a.za=null);var f=a.d,g=a.location,k=a.scale[0];J.xn(a.rotation_quaternion,O);l.set_translation(a,g);l.set_rotation(a,O);l.set_scale(a,k);switch(a.type){case "ARMATURE":g=a.pose.bones;
for(k=0;k<g.length;k++){var q=g[k],t=q.bone,w=new Float32Array(t.matrix_local),A=new Float32Array(16);P.invert(w,A);var y=new Float32Array(q.matrix_basis),p=new Float32Array(3);I.subtract(t.tail_local,t.head_local,p);J.bC(p,A,p);q.Ru=p;q.Lu=[q].concat(q.parent_recursive);q.Ko=H.from_mat4(w,H.create());q.Jo=H.from_mat4(y,H.create());q.fl=H.create();q.oj=!1}g=h.Gv(a);f.Kc=g;g=h.lp(a,g);a.b4w_animation_mixing?(f.xc=new Float32Array(g.ya),f.wc=new Float32Array(g.ya),f.Fc=new Float32Array(g.h),f.Ec=new Float32Array(g.h)):
(f.xc=g.ya,f.wc=g.ya,f.Fc=g.h,f.Ec=g.h);f.Tr=g;f.Kf=0;f.Be=a.b4w_animation_mixing;break;case "MESH":f.qg=z.outlining_overview_mode||a.b4w_selectable;f.ok=a.b4w_selectable;f.Fb=z.outlining_overview_mode||a.b4w_outlining;f.nk=a.b4w_outlining;f.yr=z.outlining_overview_mode||a.b4w_outline_on_select;f.kd=a.b4w_billboard;f.cp=a.b4w_pres_glob_orientation;f.Xh="BASIC";f.Wh="SPHERICAL"==a.b4w_billboard_geometry;f.Ei={pk:a.b4w_outline_settings.outline_duration,qk:a.b4w_outline_settings.outline_period,rk:a.b4w_outline_settings.outline_relapses};
f.qg&&(a.d.Gj=J.iq(N),N++);if("MESH"!=a.type)throw"Wrong object type: "+a.name;a.d.Xk=a.data.b4w_vertex_anim.length?!0:!1;if("MESH"!=a.type)throw"Wrong object type: "+a.name;k=a.d;if(a.data.b4w_shape_keys.length)for(k.Dd=!0,g=0;g<a.data.b4w_shape_keys.length;g++)q={},q.value=a.data.b4w_shape_keys[g].value,q.name=a.data.b4w_shape_keys[g].name,k.af.push(q);else k.Dd=!1;if(k=h.get_first_armature_object(a)){g=a.d;t=a.data.vertex_groups;if(t.length){w=k.data.bones;A=k.pose.bones;y=0;q={};for(p=0;p<w.length;p++){var ha=
w[p].name,ea=J.keysearch("name",ha,t);if(ea){var pa=J.Am(A,"name",ha);q[ha]={ip:p,fi:y++,un:pa,mt:ea.index}}}t=y;g.Kc=q;q=h.uq();g.ie=t;t>2*q?(g.bh=!1,F.error('too many bones for "'+a.name+'" / '+g.ie+" bones (max "+q+" with blending, "+2*q+" without blending). Skinning will be disabled.")):g.bh=!0}g=a.d.Kc;g=h.lp(k,g);k.b4w_animation_mixing?(f.xc=new Float32Array(g.ya),f.wc=new Float32Array(g.ya),f.Fc=new Float32Array(g.h),f.Ec=new Float32Array(g.h)):(f.xc=g.ya,f.wc=g.ya,f.Fc=g.h,f.Ec=g.h);f.ml=
new Float32Array(4);f.ll=K.create();f.Tr=g;f.Kf=0}k=a.d;g=a.data.materials;q=[];t=[];w=[];A=[];y=[];p=[];for(ha=0;ha<g.length;ha++)ea=g[ha],(pa=ea.node_tree)&&c(pa,ea.name+"%join%",pa.animation_data,q,t,w,A,y,p);k.he=q;k.bg=t;k.hk=w;k.tc=A;k.ag=y;k.ik=p;a.n=[];f.Ac=a.b4w_shadow_cast;f.Yb=a.b4w_shadow_receive;f.hc=a.b4w_shadow_cast_only&&f.Ac;f.Vb=a.b4w_reflexible;f.Mb=a.b4w_reflexible_only&&f.Vb;f.yc=a.b4w_reflective;f.ke=a.b4w_reflection_type;a.el=null;if(a.b4w_reflective)if(k=a.d,"CUBE"==a.b4w_reflection_type)k.nc=
G++;else{a:{g=a.constraints;for(q=0;q<g.length;q++)if(t=g[q],"LOCKED_TRACK"==t.type&&"REFLECTION PLANE"==t.name){g=t.target;break a}g=null}if(g){q=null;for(t=0;t<L.length;t++)if(L[t]==g){q=t;break}null==q?(L.push(g),k.vc=L.length-1):k.vc=q;a.el=g}}f.Af=a.b4w_caustics;f.Gc=a.b4w_wind_bending;f.ej=a.b4w_wind_bending_angle;k=m.iC(a.b4w_wind_bending_angle,m.wv(a.data.b4w_bounding_box),a.scale[0]);f.Fd=k;f.te=a.b4w_wind_bending_freq;f.Vd=a.b4w_detail_bending_freq;f.Ud=a.b4w_detail_bending_amp;f.Qd=a.b4w_branch_bending_amp;
f.Zg=!1;f.ge=a.b4w_main_bend_stiffness_col;k=a.b4w_detail_bend_colors;f.Jb={};f.Jb.fr=k.leaves_stiffness_col;f.Jb.er=k.leaves_phase_col;f.Jb.Ar=k.overall_stiffness_col;f.Pg=a.b4w_do_not_cull;f.Mj=a.b4w_disable_fogging;f.nd=a.b4w_dynamic_geometry;if("MESH"!==a.type)throw"Wrong object";k=a.data.materials[0];f.oi=k.physics.friction;f.ji=k.physics.elasticity;f.Ai=0;f.Re=1E4;f.$f=a.b4w_lod_transition;f.gk=!0;break;case "CAMERA":n.Iv(a);n.rv(a);break;case "LAMP":r.Ty(a);break;case "CURVE":if(k=B.Hw(a))a.Qu=
k;break;case "EMPTY":f.Pb=u.Gd(),k=u.fj(),f.Vc=k}if(!e&&(a.parent&&"OBJECT"==a.parent_type?(g=f.h,q=f.quat,k=f.scale,x.To(a,a.parent,g,q,k)):a.parent&&"BONE"==a.parent_type&&"ARMATURE"==a.parent.type?(g=f.h,q=f.quat,k=f.scale,x.So(a,a.parent,a.parent_bone,g,q,k)):a.za&&a.za.b4w_group_relative?(k=H.create_sep(f.h,f.scale,f.quat),x.Vu(a,a.za,k)):a.za&&!a.za.b4w_group_relative&&(l.u(a),H.multiply(a.za.d.Ab,a.d.Ab,a.d.Ab),l.set_translation(a,H.get_trans_view(a.d.Ab)),l.set_scale(a,H.get_scale(a.d.Ab)),
l.set_rotation(a,H.get_quat_view(a.d.Ab))),k=a.dupli_group))for(g=k.objects,k=0;k<g.length;k++)g[k].za=a;a.field&&(f.qm=a.field.strength,C.at(a));f.Tk=a.game.use_collision_compound;f.Sr=a.game.physics_type;l.u(a)};a.FB=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.d||"DYNAMIC"!=c.d.type&&"CAMERA"!=c.d.type||l.u(c);c.b4w_use_default_animation&&h.bk(c)&&(h.apply_def(c),c.D.length&&h.play(c,null,h.SLOT_ALL))}};a.cc=function(a){return a.Eg?!0:!1};a.ti=function(a){return"MESH"==a.type&&a.Eg?!0:
!1};a.get_meta_tags=function(a){a=a.b4w_object_tags;return{title:a?a.title:"",description:a?a.description:"",category:a?a.category:""}};a.cleanup=function(){G=N=0;L=[]};a.Pq=g;a.copy=function(a,b,c){b=g(b,a.type,!1);var d=[];if(c){for(var e=0;e<a.n.length;e++)a.n[e].Jf||(b.n.push(q(a.n[e])),d.push(a.n[e].R));for(e=0;e<a.n.length;e++)if(a.n[e].Jf){var f=q(a.n[e]);b.n.push(f);for(var h=0;h<d.length;h++)d[h]==a.n[e].R&&(f.R=b.n[h].R)}}else b.n=k(a.n);b.d=q(a.d);a.Eg&&(b.Eg=a.Eg);a.za&&(b.za=a.za);a.Ld&&
(b.Ld=k(a.Ld));!a.m||a.b4w_vehicle||a.b4w_character||a.b4w_floating||(b.m=q(a.m));b.game=q(a.game);b.b4w_collision_id=a.b4w_collision_id;b.b4w_correct_bounding_offset=a.b4w_correct_bounding_offset;b.b4w_collision=a.b4w_collision;b.data=a.data;b.particle_systems=c?q(a.particle_systems):k(a.particle_systems);if(c)for(e=0;e<b.n.length;e++){b.n[e].R&&y.bt(b.n[e].R);if("PARTICLES"==b.n[e].type&&b.n[e].wn)for(h=0;h<b.vE.length;h++)if(b.particle_systems[h].name==b.n[e].wn){b.n[e].uc=b.particle_systems[h];
break}b.n[e].mh=b.uuid;m.tB(b.n[e],J.Jg(b.d,0))}b.uuid=J.vm();b.d.Pm=!0;b.d.Gj=J.iq(N);N++;return b};a.iw=q;a.oy=function(a,b){for(var c=a.d.bg,d=0;d<c.length;d+=2)if(c[d]==b)return c[d+1];return null};a.iy=function(a,b){for(var c=a.d.ag,d=0;d<c.length;d+=2)if(c[d]==b)return c[d+1];return null}};b4w.module.__particles=function(a,p){function b(){throw"_rand() undefined";}function d(a,b,c,d,e,f,g){var h=a.P.$l,k=a.P.od,l=a.P.time;a=a.P.Ur;for(var m=b?4:1,p=0;p<h.length;p+=m){var K=h[p];if(K>a&&K<=l)for(K=0;8>K;K++)k[8*p+K]=e[K];for(K=0;8>K;K++)u[K]=k[8*p+K];K=n;K[0]=c[3*p];K[1]=c[3*p+1];K[2]=c[3*p+2];q.transform_vec3(K,u,K);f[3*p]=K[0];f[3*p+1]=K[1];f[3*p+2]=K[2];var I=n;I[0]=d[3*p];I[1]=d[3*p+1];I[2]=d[3*p+2];q.transform_dir_vec3(I,u,I);g[3*p]=I[0];g[3*p+1]=I[1];g[3*p+2]=I[2];if(b)for(K=1;4>
K;K++)f[3*(p+K)]=f[3*p],f[3*(p+K)+1]=f[3*p+1],f[3*(p+K)+2]=f[3*p+2],g[3*(p+K)]=I[0],g[3*(p+K)+1]=I[1],g[3*(p+K)+2]=I[2]}}function c(a){a?(k.UA(a),b=function(){return k.Gz()}):b=function(){return Math.random()}}var e=p("__config"),f=p("__geometry"),g=p("__scenes"),k=p("__util"),q=p("__tsr"),h=p("vec3"),m=e.Nd,u=new Float32Array(8),n=new Float32Array(3);a.Yg=function(a){return 0<a.particle_systems.length?!0:!1};a.Hm=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==a.particle_systems[b].settings.type)return!0;
return!1};a.OD=function(a){for(var b=0;b<a.particle_systems.length;b++)if("HAIR"==a.particle_systems[b].settings.type)return!0;return!1};a.zy=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.Hx=function(a,e,g,q){g.P=g.P||{};var n=f.$p(e,["a_position","a_normal"],null),u=g.settings.count,t=g.settings.frame_start/m.Ha,F=g.settings.frame_end/m.Ha,C=g.settings.lifetime/m.Ha,l=g.settings.lifetime_random,
p=g.settings.emit_from,J=g.settings.factor_random,K=g.settings.angular_velocity_mode,I=g.settings.angular_velocity_factor,P=g.settings.b4w_randomize_emission,z=g.settings.b4w_cyclic;c(g.seed);var N=g.P.ZB="WORLD"==g.settings.b4w_coordinate_system?!0:!1;g.P.frame=0;if(e=!a.Pf){var G;G=[];for(var L=0;L<u;L++)G.push(-.5,-.5,-.5,.5,.5,.5,.5,-.5);G=new Float32Array(G);for(var L=[],O=0;O<u;O++)L.push(4*O,4*O+2,4*O+1,4*O,4*O+3,4*O+2);L=new Uint16Array(L)}switch(p){case "VERT":for(var O=n.A[0].a_position,
n=n.A[0].a_normal,W=O.length/3,p=[],X=0;X<u;X++){var Y=Math.round((W-1)*b());p.push(Y);e&&(p.push(Y),p.push(Y),p.push(Y))}W=[];for(X=0;X<p.length;X++)W.push(O[3*p[X]]),W.push(O[3*p[X]+1]),W.push(O[3*p[X]+2]);O=new Float32Array(W);W=[];for(X=0;X<p.length;X++)W.push(n[3*p[X]]),W.push(n[3*p[X]+1]),W.push(n[3*p[X]+2]);p=new Float32Array(W);break;case "FACE":O=[];p=[];X=[];k.$j(0,X);W=f.wm(n,u,!1,X);k.$j(0,X);n=f.wm(n,u,!0,X);for(X=0;X<W.length;X++)O.push(W[X][0],W[X][1],W[X][2]),e&&(O.push(W[X][0],W[X][1],
W[X][2]),O.push(W[X][0],W[X][1],W[X][2]),O.push(W[X][0],W[X][1],W[X][2])),p.push(n[X][0],n[X][1],n[X][2]),e&&(p.push(n[X][0],n[X][1],n[X][2]),p.push(n[X][0],n[X][1],n[X][2]),p.push(n[X][0],n[X][1],n[X][2]));O=new Float32Array(O);p=new Float32Array(p);break;case "VOLUME":throw"Particle emission from volume is not supported";default:throw"Wrong emit from option";}p=[O,p];n=p[0];p=p[1];g.P.Li=new Float32Array(n);g.P.nz=new Float32Array(p);g.P.zz=new Float32Array(n.length);g.P.oz=new Float32Array(p.length);
g.P.time=0;g.P.Ur=-1;O=[];F=(F-t)/u;for(W=0;W<u;W++)X=P?F*W+10*F*(.5-b()):F*W,z||(X+=t),O.push(X),e&&(O.push(X),O.push(X),O.push(X));t=new Float32Array(O);g.P.$l=new Float32Array(t);g.P.Op=new Float32Array(t);g.P.od=new Float32Array(8*t.length);for(P=0;P<8*t.length;P++)for(z=0;8>z;z++)g.P.od[8*P+z]=q[z];N&&d(g,e,n,p,q,n,p);g=[];q=C*l;for(l=0;l<u;l++)N=q*b(),g.push(C-N),e&&(g.push(C-N),g.push(C-N),g.push(C-N));C=new Float32Array(g);g=[];for(q=0;q<u;q++){l=[b()-.5,b()-.5,b()-.5];h.normalize(l,l);g.push(J*
l[0]);g.push(J*l[1]);g.push(J*l[2]);switch(K){case "NONE":g.push(0);break;case "SPIN":case "VELOCITY":g.push(I);break;case "RAND":g.push(2*I*(b()-.5));break;default:throw"Undefined velocity factor";}if(e)for(l=g.slice(-4),N=0;12>N;N++)g.push(l[N%4])}u=new Float32Array(g);J=k.lb("EMITTER_PARTICLES");K=k.Wc();K.a_position=n;K.a_normal=p;J.A[0]=K;e?(a.Zd=f.ij,J.ea=L):(a.Zd=f.zo,J.ea=new Uint16Array(0));J.K=n.length/3;J.H.a_p_delay=t;J.H.a_p_lifetime=C;J.H.a_p_vels=u;e&&(J.H.a_p_bb_vertex=G);return J};
a.CB=function(a){for(var b=a.n,c=0;c<b.length;c++){var e=b[c],g=b[c].uc;if(g){var h=e.R;if(!g.P.ZB)break;var k=g.P.zz,m=g.P.oz;d(g,!e.Pf,g.P.Li,g.P.nz,a.d.Ab,k,m);f.az(h);f.Rk(h,"a_position",3,k);f.Rk(h,"a_normal",3,m)}}};a.iA=function(a,b,c){var d=b.settings.lifetime/m.Ha,e=b.settings.normal_factor,f=9.81*b.settings.effector_weights.gravity,h=b.settings.effector_weights.wind,k=b.settings.mass,q=b.settings.b4w_fade_in/m.Ha,l=b.settings.b4w_fade_out/m.Ha,n=b.settings.b4w_cyclic;a.Jr=b.settings.frame_end/
m.Ha-b.settings.frame_start/m.Ha;a.Fr=n?1:0;a.qn=e;a.Ir=f;e=g.ty();a.sk[0]=e[0]*h;a.sk[1]=e[1]*h;a.sk[2]=e[2]*h;a.Lr=d;a.Kr=k;a.Gr=q;a.Hr=l;a.Pf?(d=c.halo.size,h=c.halo.hardness,30>h?(h=.5,k=.9):40>h?(h=.1,k=1):50>h?(h=0,k=.8):(h=0,k=.5)):(d=b.settings.particle_size,k=h=1);a.rn=d;a.Cr=h;a.Br=k;d=b.settings.texture_slots;b=[-1,0,-1,0,-1,0,-1,0];if(d[0]&&d[0].use_map_size&&d[0].texture&&"BLEND"==d[0].texture.type&&d[0].texture.use_color_ramp){d=d[0].texture.color_ramp.elements;h=Math.min(2*d.length,
b.length);for(k=0;k<h;k+=2)q=d[k/2],b[k]=q.position,b[k+1]=(q.color[0]+q.color[1]+q.color[2])/3;a.Nr=d.length}a.Mr.set(b);b=c.texture_slots;c=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(b[0]&&"STRAND"==b[0].texture_coords&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp){d=b[0].texture.color_ramp.elements;h=Math.min(4*d.length,c.length);for(k=0;k<h;k+=4)q=d[k/4],c[k]=q.position,c[k+1]=q.color[0],c[k+2]=q.color[1],c[k+3]=q.color[2];a.Er=d.length}a.Dr.set(c)};a.sA=function(a,b){a.P.Ur=
a.P.time;a.P.time=b};a.Bz=function(a){for(var b=a.K,c=a.A[0].a_position,d=a.H.a_texcoord,e=[],f=[],g=0;g<b;g++)f.push(c[3*g]),f.push(c[3*g+1]),e.push(c[3*g+2]);e=new Float32Array(e);f=new Float32Array(f);a.H.a_lf_dist=e;a.H.a_lf_bb_vertex=f;a.H.a_texcoord=d;return a};a.set_size=function(a,b,c){a=a.n;for(var d=0;d<a.length;d++){var e=a[d],f=e.uc;f&&f.name==b&&(e.rn=c)}};a.set_normal_factor=function(a,b,c){a=a.n;for(var d=0;d<a.length;d++){var e=a[d],f=e.uc;f&&f.name==b&&(e.qn=c)}};a.set_factor=function(a,
b,c){a=a.n;for(var d=0;d<a.length;d++){var e=a[d],g=e.uc;if(g&&g.name==b){var h=g.P.$l;if(1==c)g=h;else if(0==c)for(var k=!e.Pf,m=k?4:1,g=g.P.Op,l=0;l<g.length;l+=m)g[l]=1E4,k&&(g[l+1]=g[l],g[l+2]=g[l],g[l+3]=g[l]);else for(var q=1/c,g=g.P.Op,m=(k=!e.Pf)?4:1,n=0,l=0;l<g.length;l+=m)l>=n?(g[l]=h[l],n+=q):g[l]=1E4,k&&(g[l+1]=g[l],g[l+2]=g[l],g[l+3]=g[l]);f.Rk(e.R,"a_p_delay",1,g)}}};a.LB=function(a,b,c){a=a.particle_systems;for(var d=0;d<a.length;d++){var e=a[d];if("EMITTER"==e.settings.type)for(var f=
e.P.$l,d=0;d<8*f.length;d++)e.P.od[8*d]=b[0],e.P.od[8*d+1]=b[1],e.P.od[8*d+2]=b[2],e.P.od[8*d+3]=b[3],e.P.od[8*d+4]=c[0],e.P.od[8*d+5]=c[1],e.P.od[8*d+6]=c[2],e.P.od[8*d+7]=c[3]}}};b4w.module.__primitives=function(a,p){function b(a,b,c,d){for(var e=[],f=[],k=[],p=[],y=2*c/(a-1),r=2*d/(b-1),A=0;A<a;A++)for(var t=-c+A*y,F=0;F<b;F++)if(f.push(t,0,-d+F*r),k.push(0,1,0),p.push(A/(a-1),F/(b-1)),A&&F){var C=A*b+F,l=C-1,H=(A-1)*b+F,J=H-1;e.push(C,l,H);e.push(l,J,H)}a=g.Wc();a.a_position=new Float32Array(f);a.a_normal=new Float32Array(k);k=g.lb("GRID_PLANE");k.A[0]=a;k.H.a_texcoord=new Float32Array(p);k.ea=new Uint32Array(e);k.K=f.length/3;return k}function d(a){var b=a.length;if(b%
4)throw"Wrong array";for(var c=[],d=[],f=0;f<b;f+=4){var k=a[f+1],p=a[f+2],B=a[f+3];e(a[f],d);e(k,d);e(p,d);e(B,d);c.push(f,f+1,f+2);c.push(f,f+2,f+3)}a=g.Wc();a.a_position=new Float32Array(d);b=g.lb("FROM_QUADS");b.A[0]=a;b.ea=new Uint32Array(c);b.K=d.length/3;return b}function c(a,b){var c=3*b;return[a[c],a[c+1],a[c+2]]}function e(a,b){b.push(a[0],a[1],a[2])}var f=p("__geometry"),g=p("__util"),k=p("__config").o;a.GD=function(a){for(var b=g.lb("LINE"),c=[],d=0;d<2*a;d++)c.push(d);d=g.Wc();d.a_point=
new Float32Array(c);b.A[0]=d;b.ea=new Uint32Array(c);b.K=2*a;return b};a.HD=function(a,c){var d=b(2,2,a,c);d.name="PLANE";return d};a.FD=b;a.Mx=function(a,b,c){function d(a,b){return 1==a%2&&(0==b||b==B-1)||1==b%2&&(0==a||a==p-1)?!0:!1}var e=c/=Math.pow(2,a-1),w=c,p=b+1,B=b+1;b=[];c=[];for(var y=0,r=0,A=-1,t=[],F=0;F<a;F++){for(var C=2*e/(p-1),l=2*w/(B-1),H=[],J=[],K=0,I=0;I<p;I++){for(var P=-e+I*C,z=[],N=0;N<B;N++){var G=-w+N*l;if(P>-y&&P<y&&G>-r&&G<r)z.push(-1),K++;else{for(var L=null,O=0;O<t.length;O+=
3)if(P==t[O]&&G==t[O+1]){L=t[O+2];break}O=null!==L?L:A+1;d(I,N)?(z.push(-2),K++):(null==L&&(0==N||N==B-1||0==I||I==p-1?(L=F==a-1?C:2*C,H.push(P,G,O)):L=C,c.push(P,L,G),A++),z.push(O));if(I&&N)if(1==I)if(d(I-1,N)){if(1<N){var G=O-1,L=J[I-1][N+1],W=L-1;b.push(O,G,W)}else L=J[I-1][N+1],W=L-1;b.push(O,W,L)}else d(I,N)||(G=O-1,L=J[I-1][N],b.push(O,G,L));else if(I==p-1){if(!d(I,N))if(N==B-1)G=O-1,L=J[I-1][N-1],W=J[I-2][N],b.push(O,G,L),b.push(O,L,W);else{var G=O-1,L=J[I-1][N],W=L-1,X=L+1;b.push(O,G,W);
b.push(O,W,L);b.push(O,L,X);2==N&&(X=J[I-2][N-2],b.push(G,X,W))}}else 1==N?d(I,N-1)?(G=J[I-1][N],L=J[I-1][N-1],b.push(O,L,G)):(G=z[N-1],L=J[I-1][N],W=J[I-2][N-1],b.push(O,G,L),b.push(G,W,L)):N==B-1?d(I,N)||(G=z[N-1],L=J[I-1][N-1],W=J[I-2][N],b.push(O,G,L),b.push(O,L,W)):-1!=J[I-1][N]&&-1!=J[I-1][N-1]&&-1!=z[N-1]?(G=z[N-1],L=J[I-1][N],W=J[I-1][N-1],b.push(O,G,L),b.push(G,W,L),N==B-2&&d(I,N+1)&&(X=J[I-1][N+1],b.push(O,L,X))):N==B-2&&d(I,N+1)&&(L=J[I-1][N],X=J[I-1][N+1],b.push(O,L,X))}}J.push(z)}t=H;
y=e;r=w;e*=2;w*=2}2E4>y&&(a=-(2*y)/(p-1),c.push(-2E4,a,-2E4),c.push(-2E4,a,2E4),c.push(-y,a,-r),c.push(-y,a,r),c.push(2E4,a,-2E4),c.push(2E4,a,2E4),c.push(y,a,-r),c.push(y,a,r),O=A+1,b.push(O+3,O+2,O+1,O+2,O+0,O+1,O+6,O+4,O+2,O+4,O+0,O+2,O+5,O+7,O+1,O+7,O+3,O+1,O+5,O+4,O+7,O+7,O+4,O+6));a=g.Wc();a.a_position=new Float32Array(c);e=g.lb("multigrid_plane");e.A[0]=a;e.ea=new Uint32Array(b);e.K=c.length/3;k.rt&&(f.Un(e,1,!0),a.a_polyindex=f.Yp(e));return e};a.ED=function(a){var b=a.length;if(b%3)throw"Wrong array";
for(var c=[],d=[],f=0;f<b;f+=3){var k=a[f+1],p=a[f+2];e(a[f],d);e(k,d);e(p,d);c.push(f,f+1,f+2)}a=g.Wc();a.a_position=new Float32Array(d);b=g.lb("FROM_TRIANGLES");b.A[0]=a;b.ea=new Uint32Array(c);b.K=d.length/3;return b};a.DD=d;a.Ix=function(a){a=g.cC(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],a[7],a[6],a[2]);b.push(a[0],a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=d(b);a.name="FRUSTUM";return a};a.nb=function(){var a=g.lb("FULLSCREEN_TRI"),
b=g.Wc();b.a_position=new Float32Array([0,0,1,0,0,1]);a.A[0]=b;a.ea=new Uint32Array([0,1,2]);a.K=3;return a};a.Jx=function(){var a=g.lb("FULLSCREEN_QUAD"),b=g.Wc();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.A[0]=b;a.ea=new Uint32Array([0,2,1,1,2,3]);a.K=4;return a};a.Ex=function(){var a=g.lb("BILLBOARD"),b=g.Wc();b.a_bb_vertex=new Float32Array([-.5,-.5,-.5,.5,.5,.5,.5,-.5]);a.A[0]=b;a.ea=new Uint32Array([0,2,1,0,3,2]);a.K=4;return a};a.Fx=function(){var a=g.lb("CUBEMAP_BOARD"),b=g.Wc();
b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.A[0]=b;a.ea=new Uint32Array([0,2,1,0,3,2]);a.K=4;return a};a.lq=function(a,b){var d=g.lb("UV_SPHERE"),k,n,w=[],p=[],B=[];for(n=0;8>=n;n++)for(k=0;16>=k;k++){var y=k/16,r=n/8;p.push(-a*Math.cos(2*y*Math.PI)*Math.sin(r*Math.PI)+b[0],a*Math.cos(r*Math.PI)+b[1],a*Math.sin(2*y*Math.PI)*Math.sin(r*Math.PI)+b[2])}for(n=y=0;8>n;n++)for(k=0;16>k;k++){var r=c(p,17*n+k+1),A=c(p,17*n+k),t=c(p,17*(n+1)+k),F=c(p,17*(n+1)+k+1);Math.abs(r[1])==a+b[1]?(e(r,w),
e(t,w),e(F,w),B.push(y,y+1,y+2),y+=3):Math.abs(t[1])==a+b[1]?(e(r,w),e(A,w),e(t,w),B.push(y,y+1,y+2),y+=3):(e(r,w),e(A,w),e(t,w),e(F,w),B.push(y,y+1,y+2),B.push(y,y+2,y+3),y+=4)}k={};k.a_position=w;p=f.mp(B,p,w);k.a_normal=f.kp(B,w,p);k.a_tangent=[];d.H.a_influence=[];d.H.a_color=[];d.H.a_texcoord=[];d.A[0]=k;d.ea=B;d.K=w.length/3;return d};a.kq=function(a){var b=g.lb("INDEX"),c=g.Wc();c.a_index=new Float32Array(a);for(var d=0;d<a;d++)c.a_index[d]=d;b.A[0]=c;b.ea=new Uint16Array(0);b.K=a;return b}};b4w.module.__prerender=function(a,p){function b(a,b){var d=a.td,e=b.i;d.is_visible=!1;var g;if(!(g=!d||d.Zg)){var h=e.Ke,k=d.vb.F;g=d.Re;h=Math.sqrt((k[0]-h[0])*(k[0]-h[0])+(k[1]-h[1])*(k[1]-h[1])+(k[2]-h[2])*(k[2]-h[2]));k=d.$f*d.vb.Da;g=!(h>=d.Ai&&h<g+k)}if(g)return!1;d.is_visible=!0;(g="OUTLINE_MASK"==b.type&&!Boolean(d.$c))||(e=e.Qj,d.Pg?g=!1:("STATIC"===d.type?(g=d.vb,d=g.F,d=f.PA(d,e,g.Da)):(g=d.zf,d=g.F,d=f.hx(d,e,g.vf,g.wf,g.xf)),g=d));return g?!1:"WIREFRAME"==b.type?a.B.wireframe_mode==c.Go.WM_DEBUG_SPHERES?
a.B.Ng:!a.B.Ng:!0}var d=p("__config"),c=p("__debug"),e=p("__geometry"),f=p("__util"),g=p("__renderer"),k=p("vec3"),q=d.o,h="MAIN_OPAQUE MAIN_BLEND MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_GLOW SHADOW_CAST DEPTH OUTLINE_MASK WIREFRAME COLOR_PICKING MAIN_XRAY COLOR_PICKING_XRAY".split(" ");a.vn=function(a){if(-1<h.indexOf(a.type)){for(var c=!1,d=a.p,f=0;f<d.length;f++){var p=d[f];if("MAIN_CUBE_REFLECT"==a.type)for(var B=0;6>B;B++)a.i.Qj=a.Ul[B],p.bm[B]=b(p,a),p.bm[B]&&(c=!0);else p.Xa=b(p,a),p.Xa&&
(c=!0)}switch(a.type){case "WIREFRAME":break;default:"MAIN_OPAQUE"===a.type||"DEPTH"===a.type||c?a.Xa=!0:(a.Xa&&g.clear(a),a.Xa=!1)}}if("MAIN_BLEND"==a.type&&q.alpha_sort&&a.p){c=a.i.Ke;d=k.dist(c,a.tt)>q.alpha_sort_threshold;for(f=0;f<a.p.length;f++)if(B=a.p[f],p=B.td,p.sm||d){var y=B.B;if(y&&y.Fa&&y.ve!=e.Kd){y=y.R;if(!y||!B.Xa)continue;(B=y.Zj)&&B.type==e.Ho&&e.wB(y,p.T,c)}p.sm=!1}d&&a.tt.set(c)}}};b4w.module.__print=function(a){function p(a,b){var c=[];-1<a[0].indexOf("%c")?c.push(a[0].replace("%c","%c"+b+": ")):c.push(b+": "+a[0]);for(var d=1;d<a.length;d++)c.push(a[d]);return c}var b=!1,d=0,c=0;a.uA=function(a){b=a};a.Xy=function(){console.log.apply(console,arguments)};a.log=function(){if(b){var a=p(arguments,"B4W LOG");console.log.apply(console,a)}};a.error=function(){d++;var a=p(arguments,"B4W ERROR");console.error.apply(console,a)};a.warn=function(){c++;var a=p(arguments,"B4W WARN");console.warn.apply(console,
a)};a.info=function(){var a=p(arguments,"B4W INFO");console.info.apply(console,a)};a.lx=function(){d++;var a=p(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.mx=function(){c++;var a=p(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){b&&console.time.apply(console,arguments)};a.timeEnd=function(){b&&console.timeEnd.apply(console,arguments)};a.group=function(){b&&console.group.apply(console,arguments)};a.groupCollapsed=function(){b&&console.groupCollapsed.apply(console,
arguments)};a.groupEnd=function(){b&&console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==typeof console.clear&&console.clear.apply(console,arguments)};a.sy=function(){return c};a.by=function(){return d};a.clear_errors_warnings=function(){d=c=0}};b4w.module.print=b4w.module.__print;b4w.module.__reformer=function(a,p){function b(a){switch(a.type){case "MAPPING":a.vector_type||(a.vector_type="POINT",c("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"specular_shader"in a||(a.specular_shader="COOKTORR",c("node material",a,"specular_shader"));"specular_hardness"in a||(a.specular_hardness=50,c("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,c("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=
.5,c("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,c("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,c("node material",a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",c("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,c("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,c("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in
a||(a.diffuse_fresnel_factor=.5,c("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,c("node "+a.type,a,"use_clamp"));break;case "GROUP":switch(a.node_tree_name=a.node_tree_name.replace(/\.[0-9]{3,}$/g,""),a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name=
"B4W_"+a.node_tree_name}}}function d(a){if(a=a.nla_tracks)for(var b=0;b<a.length;b++)for(var d=a[b],e=0;e<d.strips.length;e++){var f=d.strips[e];"action"in f||(f.action=null,c("strip",f,"action"));"action_frame_start"in f||(f.action_frame_start=0,c("strip",f,"action_frame_start"));"action_frame_end"in f||(f.action_frame_end=f.frame_end-f.frame_start,c("strip",f,"action_frame_end"));"repeat"in f||(f.repeat=1,c("strip",f,"repeat"));"use_reverse"in f||(f.use_reverse=!1,c("strip",f,"use_reverse"));"scale"in
f||(f.scale=1,c("strip",f,"scale"))}}function c(a,b,c){c=c+">>"+a;c in B||(B[c]={Tn:[],fs:"undefined",type:a});B[c].Tn.push(b.name)}function e(a,b){param_id in B||(B[param_id]={Tn:[],fs:"deprecated",type:a});B[param_id].Tn.push(b.name)}function f(a,b){b||(b=a.name+"_COPY");var c=a.materials,d=a.submeshes;a.materials=null;a.submeshes=null;var e=h.Df(a);a.materials=c;a.submeshes=d;e.name=b;e.materials=a.materials.slice(0);e.submeshes=[];for(c=0;c<d.length;c++){var f=h.Fj(d[c]);e.submeshes.push(f)}return e}
var g=p("__boundings"),k=p("__curve"),q=p("__print"),h=p("__util"),m=p("vec3"),u=p("vec4"),n=p("quat"),w=p("mat4"),x=[5,4],B={};a.tp=function(a){return-1!=h.kt(a,x)};a.Nv=function(a){B={};var f=a.worlds;if(0==f.length){q.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var g={name:"DEFAULT",horizon_color:new Float32Array([0,0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},use_sky_paper:!1,
use_sky_blend:!1,use_sky_real:!1,b4w_fog_color:[.5,.5,.5],b4w_fog_density:0,texture_slots:[]};f.push(g)}for(var f=a.worlds,k=0;k<f.length;k++){g=f[k];"use_sky_blend"in g||(c("world",g,"use_sky_blend"),g.use_sky_blend=!1);"use_sky_paper"in g||(c("world",g,"use_sky_paper"),g.use_sky_paper=!1);"use_sky_real"in g||(c("world",g,"use_sky_real"),g.use_sky_real=!1);"b4w_sky_settings"in g&&"rayleigh_brightness"in g.b4w_sky_settings||(c("world",g,"rayleigh_brightness"),g.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,
use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"render_sky"in g.b4w_sky_settings||(c("world",g,"render_sky"),g.b4w_sky_settings.render_sky=!1);"b4w_fog_density"in g||(c("world",g,"b4w_fog_density"),g.b4w_fog_density=0);for(var m=g.texture_slots,g=0;g<m.length;g++){var n=m[g];"blend_type"in n||(n.blend_type=
"MIX",c("world_texture_slot",n,"blend_type"));"use_map_blend"in n||(n.use_map_blend=!1,c("world_texture_slot",n,"use_map_blend"));"use_map_horizon"in n||(n.use_map_horizon=!0,c("world_texture_slot",n,"use_map_horizon"));"use_map_zenith_up"in n||(n.use_map_zenith_up=!1,c("world_texture_slot",n,"use_map_zenith_up"));"use_rgb_to_intensity"in n||(n.use_rgb_to_intensity=!1,c("world_texture_slot",n,"use_rgb_to_intensity"));"invert"in n||(n.invert=!1,c("world_texture_slot",n,"invert"));"color"in n||(n.color=
[1,0,1],c("world_texture_slot",n,"color"));"blend_factor"in n||(n.blend_factor=0,c("world_texture_slot",n,"blend_factor"));"horizon_factor"in n||(n.horizon_factor=1,c("world_texture_slot",n,"horizon_factor"));"zenith_up_factor"in n||(n.zenith_up_factor=0,c("world_texture_slot",n,"zenith_up_factor"));"zenith_down_factor"in n||(n.zenith_down_factor=0,c("world_texture_slot",n,"zenith_down_factor"));"default_value"in n||(n.default_value=1,c("world_texture_slot",n,"default_value"))}}g=a.scenes;for(k=0;k<
g.length;k++)m=g[k],n=m.world,"timeline_markers"in m||(m.timeline_markers=null,c("scene",m,"timeline_markers")),"b4w_use_nla"in m||(m.b4w_use_nla=!1,c("scene",m,"b4w_use_nla")),"fps"in m||(m.fps=24,c("scene",m,"fps")),"b4w_nla_cyclic"in m||(m.b4w_nla_cyclic=!1,c("scene",m,"b4w_nla_cyclic")),"b4w_nla_script"in m||(m.b4w_nla_script=[],c("scene",m,"b4w_nla_script")),"b4w_detect_collisions"in m&&(e("scene",m),delete m.b4w_detect_collisions),"audio_doppler_speed"in m||(m.audio_doppler_speed=343.3),"audio_doppler_factor"in
m||(m.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in m||(m.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},c("scene",m,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in m||(m.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in m||(m.b4w_enable_bloom=!1,c("scene",m,"b4w_enable_bloom")),"b4w_enable_motion_blur"in m||(m.b4w_enable_motion_blur=!1,c("scene",m,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in m||(m.b4w_enable_color_correction=
!1,c("scene",m,"b4w_enable_color_correction")),"b4w_enable_antialiasing"in m||(m.b4w_enable_antialiasing=!0,c("scene",m,"b4w_enable_antialiasing")),"b4w_tags"in m||(m.b4w_tags={title:"",description:""},c("scene",m,"b4w_tags")),"b4w_enable_object_selection"in m||(m.b4w_enable_object_selection="AUTO",c("scene",m,"b4w_enable_object_selection")),"b4w_enable_outlining"in m||(m.b4w_enable_outlining="AUTO",c("scene",m,"b4w_enable_outlining")),"b4w_enable_glow_materials"in m||(m.b4w_enable_glow_materials=
"AUTO",c("scene",m,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in m||(m.b4w_enable_anchors_visibility="AUTO",c("scene",m,"b4w_enable_anchors_visibility")),"b4w_outline_color"in m||(m.b4w_outline_color=[1,1,1],c("scene",m,"b4w_outline_color")),"b4w_outline_factor"in m||(m.b4w_outline_factor="b4w_glow_factor"in m?m.b4w_glow_factor:1,c("scene",m,"b4w_outline_factor")),"b4w_shadow_settings"in m||(c("scene",m,"b4w_shadow_settings"),f=n.b4w_shadow_settings,m.b4w_shadow_settings=f?f:{csm_resolution:2048,
self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),f=m.b4w_shadow_settings,"csm_resolution"in f||(c("scene",m,"b4w_shadow_settings.csm_resolution"),f.csm_resolution=2048),"self_shadow_polygon_offset"in f||(c("scene",m,"b4w_shadow_settings.self_shadow_polygon_offset"),f.self_shadow_polygon_offset=1),"self_shadow_normal_offset"in f||
(c("scene",m,"b4w_shadow_settings.self_shadow_normal_offset"),f.self_shadow_normal_offset=.01),"b4w_enable_csm"in f||(c("scene",m,"b4w_shadow_settings.b4w_enable_csm"),f.b4w_enable_csm=!1),"csm_num"in f||(c("scene",m,"b4w_shadow_settings.csm_num"),f.csm_num=1),"csm_first_cascade_border"in f||(c("scene",m,"b4w_shadow_settings.csm_first_cascade_border"),f.csm_first_cascade_border=10),"first_cascade_blur_radius"in f||(c("scene",m,"b4w_shadow_settings.first_cascade_blur_radius"),f.first_cascade_blur_radius=
3),"csm_last_cascade_border"in f||(c("scene",m,"b4w_shadow_settings.csm_last_cascade_border"),f.csm_last_cascade_border=100),"last_cascade_blur_radius"in f||(c("scene",m,"b4w_shadow_settings.last_cascade_blur_radius"),f.last_cascade_blur_radius=1.5),"fade_last_cascade"in f||(c("scene",m,"b4w_shadow_settings.fade_last_cascade"),f.fade_last_cascade=!0),"blend_between_cascades"in f||(c("scene",m,"b4w_shadow_settings.blend_between_cascades"),f.blend_between_cascades=!0),"b4w_ssao_settings"in m||(c("scene",
m,"b4w_ssao_settings"),f=n.b4w_ssao_settings,m.b4w_ssao_settings=f?f:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),f=m.b4w_ssao_settings,"dist_factor"in f||(c("scene",m,"b4w_ssao_settings.dist_factor"),f.dist_factor=0),"samples"in f||(c("scene",m,"b4w_ssao_settings.samples"),f.samples=16),"hemisphere"in f||(c("scene",m,"b4w_ssao_settings.hemisphere"),f.hemisphere=!1),"blur_depth"in f||(c("scene",m,"b4w_ssao_settings.blur_depth"),f.blur_depth=!1),"blur_discard_value"in
f||(c("scene",m,"b4w_ssao_settings.blur_discard_value"),f.blur_discard_value=1),"b4w_bloom_settings"in m||(c("scene",m,"b4w_bloom_settings"),f=n.b4w_bloom_settings,m.b4w_bloom_settings=f?f:{key:.2,blur:4,edge_lum:1}),"key"in m.b4w_bloom_settings||(c("scene",m,"b4w_bloom_settings.key"),m.b4w_bloom_settings.key=.2),"blur"in m.b4w_bloom_settings||(c("scene",m,"b4w_bloom_settings.blur"),m.b4w_bloom_settings.blur=4),"edge_lum"in m.b4w_bloom_settings||(c("scene",m,"b4w_bloom_settings.edge_lum"),m.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in m||(c("scene",m,"b4w_motion_blur_settings"),f=n.b4w_motion_blur_settings,m.b4w_motion_blur_settings=f?f:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in m.b4w_motion_blur_settings||(c("scene",m,"b4w_motion_blur_settings.motion_blur_factor"),m.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in m.b4w_motion_blur_settings||(c("scene",m,"b4w_motion_blur_settings.motion_blur_decay_threshold"),m.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in m||(c("scene",m,"b4w_color_correction_settings"),f=n.b4w_color_correction_settings,m.b4w_color_correction_settings=f?f:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in m||(c("scene",m,"b4w_god_rays_settings"),f=n.b4w_god_rays_settings,m.b4w_god_rays_settings=f?f:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in m.b4w_god_rays_settings||(c("scene",m,"b4w_god_rays_settings.steps_per_pass"),m.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in m||(c("scene",m,"b4w_glow_settings"),m.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},f=m.b4w_glow_settings,"b4w_render_glow_over_blend"in n&&(f.render_glow_over_blend=n.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in n&&(f.small_glow_mask_coeff=n.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in n&&(f.large_glow_mask_coeff=n.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
n&&(f.small_glow_mask_width=n.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in n&&(f.large_glow_mask_width=n.b4w_large_glow_mask_width)),n=m.b4w_render_shadows,"AUTO"!=n&&"OFF"!=n&&"ON"!=n&&(m.b4w_render_shadows=n?"ON":"OFF"),n=m.b4w_render_reflections,"OFF"!=n&&"ON"!=n&&(m.b4w_render_reflections=n?"ON":"OFF"),n=m.b4w_render_refractions,"AUTO"!=n&&"OFF"!=n&&"ON"!=n&&(m.b4w_render_refractions=n?"ON":"OFF");m=a.meshes;for(k=0;k<m.length;k++){n=m[k];n.b4w_bounding_box||(c("mesh",n,"b4w_bounding_box"),
n.b4w_bounding_box={max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0});n.b4w_bounding_box_source||(c("mesh",n,"b4w_bounding_box_source"),n.b4w_bounding_box_source=n.b4w_bounding_box);n.uv_textures||(c("mesh",n,"uv_textures"),n.uv_textures=[]);n.b4w_bounding_sphere_center||(n.b4w_bounding_sphere_center=[0,0,0]);n.b4w_bounding_cylinder_center||(n.b4w_bounding_cylinder_center=[0,0,0]);n.b4w_bounding_ellipsoid_center||(n.b4w_bounding_ellipsoid_center=[0,0,0]);n.b4w_bounding_ellipsoid_axes||(g=n.b4w_bounding_box,
n.b4w_bounding_ellipsoid_axes=[(g.max_x-g.min_x)/2,(g.max_y-g.min_y)/2,(g.max_z-g.min_z)/2]);"b4w_shape_keys"in n||(n.b4w_shape_keys=[],c("mesh",n,"b4w_shape_keys"));for(var g=n,f=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"],l=null,u=0;u<f.length;u++)g[f[u]]&&(l?(g[f[u]]=!1,q.warn('WARNING property "'+f[u]+'" of object "'+g.name+'" has been set to "false". Foreground property "'+l+'" already exists.')):l=f[u]);for(g=0;g<n.b4w_vertex_anim.length;g++)f=
n.b4w_vertex_anim[g],"allow_nla"in f||(c('mesh["b4w_vertex_anim"]',n,"allow_nla"),f.allow_nla=!0)}g=a.cameras;for(k=0;k<g.length;k++)m=g[k],m.type||(m.type="PERSP",c("camera",m,"type")),"b4w_eye_target_dist"in m&&(delete m.b4w_eye_target_dist,e("camera",m)),"b4w_trans_velocity"in m||(m.b4w_trans_velocity=1,c("camera",m,"b4w_trans_velocity")),"b4w_rot_velocity"in m||(m.b4w_rot_velocity=1,c("camera",m,"b4w_rot_velocity")),"b4w_zoom_velocity"in m||(m.b4w_zoom_velocity=.1,c("camera",m,"b4w_zoom_velocity")),
"b4w_use_distance_limits"in m||(m.b4w_use_distance_limits=!1,c("camera",m,"b4w_use_distance_limits")),"b4w_distance_min"in m||(m.b4w_distance_min=1,c("camera",m,"b4w_distance_min")),"b4w_distance_max"in m||(m.b4w_distance_max=100,c("camera",m,"b4w_distance_max")),"b4w_horizontal_translation_min"in m||(m.b4w_horizontal_translation_min=-100,c("camera",m,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in m||(m.b4w_horizontal_translation_max=100,c("camera",m,"b4w_horizontal_translation_max")),
"b4w_vertical_translation_min"in m||(m.b4w_vertical_translation_min=-100,c("camera",m,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in m||(m.b4w_vertical_translation_max=100,c("camera",m,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in m||(m.b4w_use_horizontal_clamping=!1,c("camera",m,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in m||(m.b4w_rotation_left_limit=-Math.PI,c("camera",m,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in m||(m.b4w_rotation_right_limit=
Math.PI,c("camera",m,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in m||(m.b4w_horizontal_clamping_type="LOCAL",c("camera",m,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in m||(m.b4w_use_vertical_clamping=!1,c("camera",m,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in m||(m.b4w_rotation_down_limit=-Math.PI/2,c("camera",m,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in m||(m.b4w_rotation_up_limit=Math.PI/2,c("camera",m,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in
m||(m.b4w_vertical_clamping_type="LOCAL",c("camera",m,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in m||(m.b4w_hover_angle_min=Math.PI/6,c("camera",m,"b4w_hover_angle_min")),"b4w_hover_angle_max"in m||(m.b4w_hover_angle_max=Math.PI/6,c("camera",m,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in m||(m.b4w_enable_hover_hor_rotation=!0,c("camera",m,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in m||(m.b4w_use_panning=!0,c("camera",m,"b4w_use_panning"));g=a.lamps;for(k=0;k<g.length;k++)m=
g[k],"b4w_generate_shadows"in m||(m.b4w_generate_shadows=!1,c("lamp",m,"b4w_generate_shadows")),"b4w_dynamic_intensity"in m||(m.b4w_dynamic_intensity=!1,c("lamp",m,"b4w_dynamic_intensity")),"use_diffuse"in m||(m.use_diffuse=!0,c("lamp",m,"use_diffuse")),"use_specular"in m||(m.use_specular=!0,c("lamp",m,"use_specular"));g=a.speakers;for(k=0;k<g.length;k++)m=g[k],"b4w_behavior"in m||(m.b4w_behavior=m.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_disable_doppler"in m||(m.b4w_disable_doppler=
!1),"b4w_delay"in m||(m.b4w_delay=0),"b4w_delay_random"in m||(m.b4w_delay_random=0),"b4w_volume_random"in m||(m.b4w_volume_random=0),"b4w_pitch_random"in m||(m.b4w_pitch_random=0),"b4w_fade_in"in m||(m.b4w_fade_in=0),"b4w_fade_out"in m||(m.b4w_fade_out=0),"b4w_loop"in m||(m.b4w_loop=!1),"b4w_loop_count"in m||(m.b4w_loop_count=0),"b4w_loop_count_random"in m||(m.b4w_loop_count_random=0),"b4w_playlist_id"in m||(m.b4w_playlist_id=""),m.animation_data&&d(m.animation_data);g=a.textures;for(k=0;k<g.length;k++)m=
g[k],"b4w_anisotropic_filtering"in m||(m.b4w_anisotropic_filtering="OFF",c("texture",m,"b4w_anisotropic_filtering")),"b4w_water_foam"in m||(m.b4w_water_foam=!1,c("texture",m,"b4w_water_foam")),"b4w_foam_uv_freq"in m||(m.b4w_foam_uv_freq=[1,1],c("texture",m,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in m||(m.b4w_foam_uv_magnitude=[1,1],c("texture",m,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in m||(m.b4w_parallax_steps=5,c("material",m,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in m||(m.b4w_parallax_lod_dist=
10,c("material",m,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in m||(m.b4w_shore_dist_map=!1,c("texture",m,"b4w_shore_dist_map")),"b4w_shore_boundings"in m||(m.b4w_shore_boundings=new Float32Array(4),m.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],c("texture",m,"b4w_shore_boundings")),"b4w_max_shore_dist"in m||(m.b4w_max_shore_dist=100,c("texture",m,"b4w_max_shore_dist")),"b4w_disable_compression"in m||(m.b4w_disable_compression=!1,c("texture",m,"b4w_disable_compression")),"b4w_source_type"in m||(m.b4w_source_type=
"",c("texture",m,"b4w_source_type")),"b4w_source_id"in m||(m.b4w_source_id="",c("texture",m,"b4w_source_id")),"b4w_source_size"in m||(m.b4w_source_size=1024,c("texture",m,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in m||(m.b4w_enable_canvas_mipmapping=!0,c("texture",m,"b4w_enable_canvas_mipmapping"));f=a.materials;for(k=0;k<f.length;k++){l=f[k];"b4w_node_mat_type"in l&&e("material",l);"b4w_skydome"in l&&e("material",l);"b4w_procedural_skydome"in l&&e("material",l);l.b4w_water&&("b4w_water_shore_smoothing"in
l||(l.b4w_water_shore_smoothing=!1,c("material",l,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in l||(l.b4w_water_dynamic=!1,c("material",l,"b4w_water_dynamic")),"b4w_waves_height"in l||(l.b4w_waves_height=1,c("material",l,"b4w_waves_height")),"b4w_waves_length"in l||(l.b4w_waves_length=1,c("material",l,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in l||(l.b4w_water_dst_noise_scale0=.05,c("material",l,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in l||(l.b4w_water_dst_noise_scale1=
.03,c("material",l,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in l||(l.b4w_water_dst_noise_freq0=1.3,c("material",l,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in l||(l.b4w_water_dst_noise_freq1=1,c("material",l,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in l||(l.b4w_water_dir_min_shore_fac=.4,c("material",l,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in l||(l.b4w_water_dir_freq=.5,c("material",l,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in
l||(l.b4w_water_dir_noise_scale=.05,c("material",l,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in l||(l.b4w_water_dir_noise_freq=.07,c("material",l,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in l||(l.b4w_water_dir_min_noise_fac=.5,c("material",l,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in l||(l.b4w_water_dst_min_fac=.2,c("material",l,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in l||(l.b4w_water_waves_hor_fac=5,c("material",l,"b4w_water_waves_hor_fac")),
"b4w_water_absorb_factor"in l||(l.b4w_water_absorb_factor=6,c("material",l,"b4w_water_absorb_factor")),"b4w_water_fog_color"in l||(l.b4w_water_fog_color=new Float32Array(3),l.b4w_water_fog_color=[.5,.7,.7],c("material",l,"b4w_water_fog_color")),"b4w_foam_factor"in l||(l.b4w_foam_factor=5,c("material",l,"b4w_foam_factor")),"b4w_generated_mesh"in l||(l.b4w_generated_mesh=!1,c("material",l,"b4w_generated_mesh")),"b4w_water_num_cascads"in l||(l.b4w_water_num_cascads=5,c("material",l,"b4w_water_num_cascads")),
"b4w_water_subdivs"in l||(l.b4w_water_subdivs=64,c("material",l,"b4w_water_subdivs")),"b4w_water_detailed_dist"in l||(l.b4w_water_detailed_dist=1E3,c("material",l,"b4w_water_detailed_dist")));"b4w_dynamic_grass_size"in l||(l.b4w_dynamic_grass_size="");"b4w_dynamic_grass_color"in l||(l.b4w_dynamic_grass_color="");"diffuse_intensity"in l||(l.diffuse_intensity=1,c("material",l,"diffuse_intensity"));"b4w_use_ghost"in l||(l.b4w_use_ghost=!1);"b4w_collision_margin"in l||(l.b4w_collision_margin=.04,c("material",
l,"b4w_collision_margin"));"b4w_collision_group"in l||(l.b4w_collision_group=128,c("material",l,"b4w_collision_group"));"b4w_collision_mask"in l||(l.b4w_collision_mask=127,c("material",l,"b4w_collision_mask"));"b4w_do_not_render"in l||(l.b4w_do_not_render=!1,c("material",l,"b4w_do_not_render"));"HALO"!=l.type||"b4w_halo_sky_stars"in l||(l.b4w_halo_sky_stars=!1,c("material",l,"b4w_halo_sky_stars"));"HALO"!=l.type||"b4w_halo_stars_blend_height"in l||(l.b4w_halo_stars_blend_height=10,c("material",l,
"b4w_halo_stars_blend_height"));"HALO"!=l.type||"b4w_halo_stars_min_height"in l||(l.b4w_halo_stars_min_height=0,c("material",l,"b4w_halo_stars_min_height"));"specular_shader"in l||(l.specular_shader="COOKTORR",c("material",l,"specular_shader"));"diffuse_shader"in l||(l.diffuse_shader="LAMBERT",c("material",l,"diffuse_shader"));"roughness"in l||(l.roughness=.5,c("material",l,"roughness"));"diffuse_fresnel"in l||(l.diffuse_fresnel=.1,c("material",l,"diffuse_fresnel"));"diffuse_fresnel_factor"in l||
(l.diffuse_fresnel_factor=.5,c("material",l,"diffuse_fresnel_factor"));"specular_slope"in l||(l.specular_slope=.2,c("material",l,"specular_slope"));"specular_toon_size"in l||(l.specular_toon_size=.5,c("material",l,"specular_toon_size"));"specular_toon_smooth"in l||(l.specular_toon_smooth=.1,c("material",l,"specular_toon_smooth"));"specular_alpha"in l||(l.specular_alpha=1,c("material",l,"specular_alpha"));"b4w_wettable"in l||(l.b4w_wettable=!1,c("material",l,"b4w_wettable"));"b4w_refractive"in l||
(l.b4w_refractive=!1,c("material",l,"b4w_refractive"));"b4w_refr_bump"in l||(l.b4w_refr_bump=0,c("material",l,"b4w_refr_bump"));"b4w_shallow_water_col"in l||(l.b4w_shallow_water_col=[0,.8,.3],c("material",l,"b4w_shallow_water_col"));"b4w_shore_water_col"in l||(l.b4w_shore_water_col=[0,.9,.2],c("material",l,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in l||(l.b4w_shallow_water_col_fac=1,c("material",l,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in l||(l.b4w_shore_water_col_fac=.5,
c("material",l,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in l||(l.b4w_water_sss_strength=5.9,c("material",l,"b4w_water_sss_strength"));"b4w_water_sss_width"in l||(l.b4w_water_sss_width=.45,c("material",l,"b4w_water_sss_width"));"b4w_render_above_all"in l||(l.b4w_render_above_all=!1,c("material",l,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in l||(l.b4w_water_norm_uv_velocity=.05,c("material",l,"b4w_water_norm_uv_velocity"));"specular_ior"in l||(l.specular_ior=1,c("material",l,"specular_ior"));
"darkness"in l||(l.darkness=0,c("material",l,"darkness"));"diffuse_toon_size"in l||(l.diffuse_toon_size=0,c("material",l,"diffuse_toon_size"));"diffuse_toon_smooth"in l||(l.diffuse_toon_smooth=0,c("material",l,"diffuse_toon_smooth"));m=l.texture_slots;for(g=0;g<m.length;g++)n=m[g],"blend_type"in n||(n.blend_type="MIX",c("texture_slot",n,"blend_type"));if(l.node_tree){m=l.node_tree.nodes;for(g=0;g<m.length;g++)b(m[g]);l.node_tree.animation_data&&d(l.node_tree.animation_data)}}n=a.node_groups;for(k=
0;k<n.length;k++)for(m=n[k].node_tree.nodes,g=0;g<m.length;g++)b(m[g]);m=a.objects;for(k=0;k<m.length;k++){n=m[k];switch(n.type){case "MESH":"b4w_dynamic_geometry"in n||(n.b4w_dynamic_geometry=!1);"b4w_reflexible"in n||(n.b4w_reflexible=!1);"b4w_reflexible_only"in n||(n.b4w_reflexible_only=!1);"b4w_reflective"in n||(n.b4w_reflective=!1);"b4w_reflection_type"in n||(n.b4w_reflection_type="PLANE",c("object",n,"b4w_reflection_type"));"b4w_wind_bending"in n||(n.b4w_wind_bending=!1,c("object",n,"b4w_wind_bending"));
"b4w_wind_bending_angle"in n||(n.b4w_wind_bending_angle=10,n.b4w_wind_bending_freq=.25,c("object",n,"wind bending params"));"b4w_detail_bending_amp"in n||(n.b4w_detail_bending_amp=.1,n.b4w_branch_bending_amp=.3,c("object",n,"detail bending params"));"b4w_detail_bending_freq"in n||(n.b4w_detail_bending_freq=1,c("object",n,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in n||(n.b4w_main_bend_stiffness_col="",c("object",n,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in n||(n.b4w_detail_bend_colors=
{leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},c("object",n,"b4w_detail_bend_colors"));"b4w_caustics"in n||(n.b4w_caustics=!1);"vertex_groups"in n&&n.vertex_groups.length&&n.data&&0==n.data.vertex_groups.length&&(n.data.vertex_groups=n.vertex_groups,delete n.vertex_groups,c("object",n,"vertex_groups"));"b4w_vertex_anim"in n&&n.b4w_vertex_anim.length&&n.data&&0==n.data.b4w_vertex_anim.length&&(n.data.b4w_vertex_anim=n.b4w_vertex_anim,delete n.b4w_vertex_anim,c("object",n,"b4w_vertex_anim"));
"b4w_do_not_render"in n||(n.b4w_do_not_render=!1);"use_ghost"in n.game||(n.game.use_ghost=!1);"use_sleep"in n.game||(n.game.use_sleep=!1);"velocity_min"in n.game||(n.game.velocity_min=0);"velocity_max"in n.game||(n.game.velocity_max=0);"collision_group"in n.game||(n.game.collision_group=1);"collision_mask"in n.game||(n.game.collision_mask=255);"b4w_vehicle_settings"in n?n.b4w_vehicle_settings&&("steering_ratio"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.steering_ratio=10),"steering_max"in n.b4w_vehicle_settings||
(n.b4w_vehicle_settings.steering_max=1),"inverse_control"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.inverse_control=!1),"force_max"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.force_max=1500),"brake_max"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.brake_max=100),"speed_ratio"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in n.b4w_vehicle_settings||
(n.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.suspension_damping=2.3),"wheel_friction"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.roll_influence=
.1),"max_suspension_travel_cm"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.floating_factor=3),"floating_factor"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.water_rot_damp=.9)):(n.b4w_vehicle_settings=null,c("object",n,"b4w_vehicle_settings"));
"b4w_floating_settings"in n?n.b4w_floating_settings&&("floating_factor"in n.b4w_floating_settings||(n.b4w_floating_settings.floating_factor=3),"water_lin_damp"in n.b4w_floating_settings||(n.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in n.b4w_floating_settings||(n.b4w_floating_settings.water_rot_damp=.8)):(n.b4w_floating_settings=null,c("object",n,"b4w_floating_settings"));"b4w_character_settings"in n?n.b4w_character_settings&&("walk_speed"in n.b4w_character_settings||(n.b4w_character_settings.walk_speed=
4),"run_speed"in n.b4w_character_settings||(n.b4w_character_settings.run_speed=8),"step_height"in n.b4w_character_settings||(n.b4w_character_settings.step_height=.25),"jump_strength"in n.b4w_character_settings||(n.b4w_character_settings.jump_strength=5),"waterline"in n.b4w_character_settings||(n.b4w_character_settings.waterline=0)):(n.b4w_character_settings=null,c("object",n,"b4w_character_settings"));"b4w_selectable"in n||(n.b4w_selectable=!1,c("object",n,"b4w_selectable"));"b4w_outlining"in n||
(n.b4w_outlining=!1,c("object",n,"b4w_outlining"));"b4w_outline_on_select"in n||(n.b4w_outline_on_select=!1,c("object",n,"b4w_outline_on_select"));"b4w_billboard"in n||(n.b4w_billboard=!1,c("object",n,"b4w_billboard"));"b4w_billboard_geometry"in n||(n.b4w_billboard_geometry="SPHERICAL",c("object",n,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in n||(n.b4w_pres_glob_orientation=!1,c("object",n,"b4w_pres_glob_orientation"));"b4w_outline_settings"in n||("b4w_glow_settings"in n?n.b4w_outline_settings=
n.b4w_glow_settings:(n.b4w_outline_settings={},n.b4w_outline_settings.outline_duration=1,n.b4w_outline_settings.outline_period=1,n.b4w_outline_settings.outline_relapses=0),c("object",n,"b4w_outline_settings"));"b4w_lod_transition"in n||(n.b4w_lod_transition=.01,c("object",n,"b4w_lod_transition"));"lod_levels"in n||(n.lod_levels=[],c("object",n,"lod_levels"));"b4w_animation_mixing"in n||(n.b4w_animation_mixing=!1,c("object",n,"b4w_animation_mixing"));break;case "EMPTY":"b4w_group_relative"in n||(n.b4w_group_relative=
!1,c("object",n,"b4w_group_relative")),"b4w_anchor"in n||(n.b4w_anchor=null,c("object",n,"b4w_anchor")),!n.b4w_anchor||"max_width"in n.b4w_anchor||(n.b4w_anchor.max_width=250)}"collision_margin"in n.game||(n.game.collision_margin=.04,c("object",n,"collision_margin"));"b4w_anim_behavior"in n||(n.b4w_anim_behavior=n.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",c("object",n,"b4w_anim_behavior"));if(!("rotation_quaternion"in n)){g=[0,0,0,1];h.euler_to_quat(n.rotation_euler,g);var f=g,l=g[0],u=g[1],w=g[2];
f[0]=g[3];f[1]=l;f[2]=u;f[3]=w;n.rotation_quaternion=g;c("object",n,"rotation_quaternion")}"webgl_do_not_batch"in n&&(n.b4w_do_not_batch=n.webgl_do_not_batch)&&e("object",n);"b4w_shadow_cast_only"in n||(n.b4w_shadow_cast_only=!1,c("object",n,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in n||(n.b4w_correct_bounding_offset="AUTO",c("object",n,"b4w_correct_bounding_offset"));f=n.particle_systems;for(g=0;g<f.length;g++)l=f[g],u=l.settings,"use_rotation_dupli"in u||(u.use_rotation_dupli=!1,c("object",
u,"use_rotation_dupli")),"use_whole_group"in u||(u.use_whole_group=!1,c("object",u,"use_whole_group")),l.transforms||(l.transforms=new Float32Array,c("particle_system",l,"transforms")),"b4w_billboard_align"in u||(u.b4w_billboard_align="VIEW",c("particle_settings",u,"b4w_billboard_align")),"b4w_dynamic_grass"in u||(u.b4w_dynamic_grass=!1,c("object",u,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in u||(u.b4w_dynamic_grass_scale_threshold=.01,c("object",u,"b4w_dynamic_grass_scale_threshold")),
"b4w_initial_rand_rotation"in u||(u.b4w_initial_rand_rotation=!1,c("particle_settings",u,"b4w_initial_rand_rotation")),"b4w_rotation_type"in u||(u.b4w_rotation_type="Z",c("particle_settings",u,"b4w_rotation_type")),"b4w_rand_rotation_strength"in u||(u.b4w_rand_rotation_strength=1,c("particle_settings",u,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in u||(u.b4w_hair_billboard=!1,c("particle_settings",u,"b4w_hair_billboard")),"b4w_hair_billboard_type"in u||(u.b4w_hair_billboard_type="BASIC",c("particle_settings",
u,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in u||(u.b4w_hair_billboard_jitter_amp=0,c("particle_settings",u,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in u||(u.b4w_hair_billboard_jitter_freq=0,c("particle_settings",u,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in u||(u.b4w_hair_billboard_geometry="SPHERICAL",c("particle_settings",u,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in u||(u.b4w_wind_bend_inheritance="PARENT",c("particle_settings",
u,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in u||(u.b4w_shadow_inheritance="PARENT",c("particle_settings",u,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in u||(u.b4w_reflection_inheritance="PARENT",c("particle_settings",u,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in u||(u.b4w_vcol_from_name="",c("particle_settings",u,"b4w_vcol_from_name")),"b4w_vcol_to_name"in u||(u.b4w_vcol_to_name="",c("particle_settings",u,"b4w_vcol_to_name")),"b4w_coordinate_system"in u||(u.b4w_coordinate_system=
"LOCAL",c("particle_settings",u,"b4w_coordinate_system")),"b4w_allow_nla"in u||(u.b4w_allow_nla=!0,c("particle_settings",u,"b4w_allow_nla"));"constraints"in n||(n.constraints=[],c("object",n,"constraints"));f=n.modifiers;for(g=0;g<f.length;g++){a:{l=f[g];switch(l.type){case "ARRAY":if(!("fit_type"in l)){q.error("WARNING Incomplete modifier "+String(l.type)+' for "'+n.name+'", reexport "'+a.b4w_filepath_blend+'" scene');l=!1;break a}}l=!0}l||(f.splice(g,1),g--)}"animation_data"in n||(n.animation_data=
{action:null,nla_tracks:[]},c("object",n,"animation_data"));n.animation_data&&("action"in n.animation_data||(n.animation_data.action=null,q.warn("no action in animation data "+n.name)),"nla_tracks"in n.animation_data||(n.animation_data.nla_tracks=[],q.warn("no NLA in animation data "+n.name)),d(n.animation_data));"b4w_collision_id"in n||(n.b4w_collision_id="",c("material",n,"b4w_collision_id"));g=n.scale;0==g[0]&&0==g[1]&&0==g[2]?g=!0:(f=Math.abs((g[1]-g[2])/g[1]),g=.005>Math.abs((g[0]-g[1])/g[0])&&
.005>f);g||q.warn("non-uniform scale for object "+n.name)}for(var p in B)k=B[p],g=p.match(/.*?(?=>>|$)/i)[0],q.warn("WARNING "+String(g)+" is "+k.fs+" for "+k.type+", reexport "+a.b4w_filepath_blend)};a.Kv=function(a,b){"num_channels"in a||(a.num_channels=1,q.warn('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.kv=function(a){var b;a:{b=a.modifiers;for(var c=0;c<b.length;c++){var d=b[c].type;if("ARRAY"==d||"CURVE"==d){b=!0;break a}}b=!1}if(!b)return null;
b=f(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var e=a[c];switch(e.type){case "ARRAY":for(var d=b,q=e,l=0,p=0,x=0,K=new Float32Array(16),e=[],I=1;I<q.count;I++){q.use_constant_offset&&(l+=q.constant_offset_displace[0],p+=q.constant_offset_displace[1],x+=q.constant_offset_displace[2]);if(q.use_relative_offset)var B=d.b4w_bounding_box,l=l+(B.max_x-B.min_x)*q.relative_offset_displace[0],p=p+(B.max_y-B.min_y)*q.relative_offset_displace[1],x=x+(B.max_z-B.min_z)*q.relative_offset_displace[2];
h.lB(l,p,x,K);for(var z=B=f(d),N=K,G=0;G<z.submeshes.length;G++){var L=z.submeshes[G];h.We(L.position,N,L.position,0);h.dC(L.normal,N,L.normal);h.iB(L.tangent,N,L.tangent)}e.push(B)}for(I=0;I<e.length;I++)for(q=d,l=e[I],p=0;p<q.submeshes.length;p++){x=q.submeshes[p];K=l.submeshes[p];B=x.base_length;z=x.indices.length;x.base_length+=K.base_length;for(var O in x)if("base_length"!=O)if("indices"==O)for(x[O]=h.pB(x[O],K[O]),N=z;N<x.indices.length;N++)x.indices[N]+=B;else"vertex_colors"!=O&&(x[O]=h.ux(x[O],
K[O]))}break;case "CURVE":for(var d=b,I=e.object.Qu,q=new Float32Array(16),p=I.Qe?4:3,l=new Float32Array(p),p=new Float32Array(p),x=new Float32Array(3),K=new Float32Array(4),B=new Float32Array(4),z=new Float32Array(3),N=new Float32Array(3),G=new Float32Array(3),L=new Float32Array(4),W=new Float32Array(4),X=0;X<d.submeshes.length;X++){var Y=d.submeshes[X],R=Y.position,ga=Y.normal,Y=Y.tangent,ja;a:switch(ja=e.deform_axis,ja){case "POS_X":case "NEG_X":ja=0;break a;case "POS_Y":case "NEG_Y":ja=1;break a;
case "POS_Z":case "NEG_Z":ja=2;break a;default:throw"Wrong deform axis value "+ja;}z[0]=0;z[1]=0;z[2]=0;z[ja]=1;for(var qa=k.SA(I),v=0;v<R.length/3;v++){G[0]=R[3*v];G[1]=R[3*v+1];G[2]=R[3*v+2];var Z=G[ja],la=k.RA(I,Z);k.TA(I,la,l);x[0]=l[0];x[1]=l[1];x[2]=l[2];k.QA(I,la,p);N[0]=p[0];N[1]=0;N[2]=p[2];m.normalize(N,N);n.rotationTo(z,N,K);0>Z?(l[0]=N[0],l[1]=N[1],l[2]=N[2],m.scale(l,Z,l),m.add(x,l,x)):Z>qa&&(l[0]=N[0],l[1]=N[1],l[2]=N[2],m.scale(l,Z-qa,l),m.add(x,l,x));w.fromRotationTranslation(K,x,
q);I.Qe&&(n.setAxisAngle(z,l[3],B),m.transformQuat(G,B,G));G[ja]=0;m.transformMat4(G,q,G);R[3*v]=G[0];R[3*v+1]=G[1];R[3*v+2]=G[2];ga.length&&(L[0]=ga[3*v],L[1]=ga[3*v+1],L[2]=ga[3*v+2],L[3]=0,u.transformMat4(L,q,L),ga[3*v]=L[0],ga[3*v+1]=L[1],ga[3*v+2]=L[2]);Y.length&&(W[0]=Y[3*v],W[1]=Y[3*v+1],W[2]=Y[3*v+2],W[3]=0,u.transformMat4(W,q,W),Y[3*v]=W[0],Y[3*v+1]=W[1],Y[3*v+2]=W[2])}}}g.Hz(b)}return b};a.fD=function(){return{name:"DEFAULT",use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],
diffuse_intensity:1,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,
b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[]}};a.sv=function(a,b){for(var c=0;c<
b.length;c++){var d=b[c];if(d.b4w_use_nla)for(var d=d.b4w_nla_script,e=0;e<d.length;e++){var f=d[e];switch(f.type){case "SELECT":case "SELECT_PLAY":for(var g=0;g<a.length;g++){var h=a[g];h.name==f.object&&(h.b4w_selectable=!0)}break;case "SHOW":case "HIDE":for(g=0;g<a.length;g++)h=a[g],h.name==f.object&&(h.b4w_do_not_batch=!0)}}}}};b4w.module.__scenegraph=function(a,p){function b(a){a=ua.qa(a);a.be=null;a.eb=null;a.Lc=null;return a}function d(a,b){var d=[];M.re(a,function(b,c,f){-1<d.indexOf(f)?M.Rz(a,b,c,f,e(f)):d.push(f)});M.O(a,function(c,f){for(var g=0;g<f.ka.length;g++){var E=f.ka[g];b||"MAIN_PLANE_REFLECT"!=f.type&&"MAIN_CUBE_REFLECT"!=f.type&&"MAIN_XRAY"!=f.type||(E.xg=!0);-1<d.indexOf(E)?f.ka[g]=e(E):d.push(E)}"ANTIALIASING"==f.type&&M.se(a,c,function(a,b){if("MOTION_BLUR"==b.type)for(var c=0;c<b.ka.length;c++){var d=
b.ka[c];d.Z=ma.r;d.Y=ma.r}});b||M.se(a,c,function(a,b,c){"DEPTH"==c.M&&(c.xg=!0)})});M.O(a,function(b){var d={};c(a,b,d);for(var e in d){b=d[e];for(var f=b[0],g=0;g<b.length;g++)if(b[g].Z==ma.r){f=b[g];break}for(var E=b[0],g=0;g<b.length;g++)if(b[g].Y==ma.r){E=b[g];break}for(var h=b[0],g=0;g<b.length;g++)if(!b[g].xg){h=b[g];break}for(g=0;g<b.length;g++)b[g].Z=f.Z,b[g].Y=E.Y,b[g].xg=h.xg}})}function c(a,b,d){M.se(a,b,function(b,e,f){f.Ma&&f.M==f.la&&(d[f.M]=d[f.M]||[],-1==d[f.M].indexOf(f)&&d[f.M].push(f),
c(a,b,d))});M.kf(a,b,function(a,b,c){c.Ma&&(d[c.M]=d[c.M]||[],-1==d[c.M].indexOf(c)&&d[c.M].push(c))});b=M.Ya(a,b);if("MOTION_BLUR"==b.type)for(var e=0;e<b.ka.length;e++){var f=b.ka[e];d[f.M].push(f)}}function e(a){if(a.ta)throw"Failed to clone slink with attached texture";return ua.Df(a)}function f(a){var b=M.bo(a),c=[];M.O(b,function(a,d){switch(d.type){case "MOTION_BLUR":case "SMAA_RESOLVE":case "SMAA_NEIGHBORHOOD_BLENDING":case "MAIN_PLANE_REFLECT":var e=[];break;default:e=c}for(var f=0;f<d.ka.length;f++){var g=
d.ka[f],E=m(e,g,k(g));g.ta=E;d.Bd[f]=E}for(f=0;f<d.Bd.length;f++)E=d.Bd[f],h(e,E);switch(d.type){case "MOTION_BLUR":case "SMAA_RESOLVE":case "SMAA_NEIGHBORHOOD_BLENDING":case "MAIN_PLANE_REFLECT":e=[]}M.kf(b,a,function(c,d,f){if(!f.ta){if((c=q(b,a,f.M))&&f.Ma&&!f.ta){d=e;for(var g=c,E=0;E<d.length;E++){var h=d[E];h.Yn===g&&h.Oi++}}else c=m(e,f,k(f));f.ta=c}});M.se(b,a,function(a,b,c){h(e,c.ta)});M.kf(b,a,function(a,b,c){c.ta&&"NONE"==c.la&&h(e,c.ta)})})}function g(a){n(a,function(b,c,d){b.Ih&&(fa(a,
d,"SMAA_NEIGHBORHOOD_BLENDING")&&"SMAA_NEIGHBORHOOD_BLENDING"!=d.type||fa(a,d,"ANTIALIASING")||"ANCHOR_VISIBILITY"==d.type)&&(b.ef*=ba.render_resolution_factor)})}function k(a){a=ua.Df(a);delete a.la;delete a.Ma;delete a.ta;return JSON.stringify(a)}function q(a,b,c){var d=null;M.se(a,b,function(a,b,e){if(e.Ma&&e.M==e.la&&e.M==c&&e.ta)return d=e.ta,!0});M.kf(a,b,function(a,b,e){if(e.Ma&&e.M==c&&e.ta)return d=e.ta,!0});return d}function h(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.Yn===b&&d.Oi&&
d.Oi--}}function m(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=a[e];if(f.id==c&&0===f.Oi){d=f;break}}if(d)return d.Oi++,d.Yn;b=u(b);a.push({id:c,Oi:1,Yn:b});return b}function u(a){var b=a.ef*a.size;switch(a.M){case "COLOR":var c=ma.Jj("COLOR",ma.Dg);ma.resize(c,b,b);ma.Gn(c,a.Z,a.Y);return c;case "DEPTH":return a.xg?(c=ma.Jj("DEPTH_RBUF",ma.Cg),ma.resize(c,b,b)):(c=ma.Jj("DEPTH_TEX",ma.Qh),ma.resize(c,b,b),ma.Gn(c,a.Z,a.Y)),c;case "CUBEMAP":return c=ma.qw(b);case "SCREEN":return null;default:throw"Wrong slink param: "+
a.M;}}function n(a,b){var c=!1;M.re(a,function(d,e,f){if(f&&(d=M.Ya(a,d),e=M.Ya(a,e),b(f,!1,d,e)))return c=!0});c||M.O(a,function(a,c){for(var d=0;d<c.ka.length;d++)if(b(c.ka[d],!0,c,null))return!0})}function w(a){M.O(a,function(b,c){if("SINK"!=c.type){var d=c.i;M.kf(a,b,function(a,b,c){c.Ma&&c.ta&&(E.Gk(d,c.M,c.ta),c.M==c.la&&b.i&&E.Gk(b.i,c.M,c.ta))});for(var e=0;e<c.ka.length;e++){var f=c.ka[e];f.Ma&&f.M==f.la&&E.Gk(d,f.M,c.Bd[e])}!d.eb&&!d.Lc||d.be||(d.be=Xb.Qz(d.eb,d.Lc))}})}function x(a){var b=
null,c=0;M.O(a,function(a,d){if(d.type==sb.eB){if(c==sb.dB)return b=d,!0;c++}});return b}function B(a,b){var c=M.cg(a,b),d=C("NONE"),e=M.s(a,d),f=M.zq(a)[0];M.re(a,function(b,c){c==f&&M.Iz(a,b,f,b,e)});M.re(a,function(e,f,g){if(e==c)return M.l(a,b,d,A(sb.EA,"u_color",g.size,g.ef,g.Ih)),!0});M.Uc(a,e,f,A("SCREEN","NONE",.5,.5,!0))}function y(a,b){var c=r("SHADOW_CAST");c.Sl=a;c.self_shadow_polygon_offset=b.self_shadow_polygon_offset;switch(b.Wm){case "SPOT":case "POINT":c.i=E.kb(E.Hb);E.Hk(c.i,180*
b.dd/Math.PI,.1,2*b.distance);break;default:c.i=E.kb(E.tf)}return c}function r(a){return{type:a,Ka:"",Fa:!1,Or:!1,ol:!1,kk:!1,ei:0,time:0,i:null,di:null,Ul:[],p:[],ka:[],Bd:[],dj:new Float32Array(3),tt:new Float32Array(3),bc:new Float32Array(3),$b:new Float32Array(4),mc:new Float32Array(16),ws:0,Je:0,eg:0,Vf:null,Xf:null,Uf:null,Wf:null,Ne:new Float32Array(3),rf:new Float32Array(3),xs:new Float32Array(4),Qs:new Float32Array([0,0,0]),Nk:new Float32Array(3),Rs:new Float32Array(4),vs:new Float32Array(3),
Fi:0,cm:0,vi:!1,Ue:new Float32Array(3),of:0,$a:null,Vk:!1,bf:new Float32Array(2),cf:new Float32Array(2),th:0,hh:0,Dl:0,gd:null,qf:0,Bg:0,pf:0,Af:!1,pp:0,qp:new Float32Array(2),op:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,uh:new Float32Array(3),ssao_hemisphere:0,ssao_blur_depth:0,ssao_blur_discard_value:0,yh:0,
xh:0,wh:0,Is:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,gh:0,Ck:0,Bh:0,Sl:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,ht:null,bp:null,jg:null,bloom_key:0,bloom_blur:0,bloom_edge_lum:0,vl:0,im:0,mb_decay_threshold:0,mb_factor:0,or:0,yk:"",Ry:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,Zn:new Float32Array(2),w:new Float32Array(2),Xa:!0,enqueue:!0,da:!0,ha:!0,Db:!0,
ia:!0,qe:1}}function A(a,b,c,d,e){return{M:a,la:b,size:c,ef:d,Ih:e,Ma:!0,ta:null,xg:!1,Z:ma.Id,Y:ma.Id}}function t(a,b){for(var c=0,d=sa(a,b),e=0;e<d.length;e++){var f=d[e];"SHADOW_CAST"==f.type&&(f=f.i,b.uz=f.Pa/(f.Pa-f.Qa),b.ht=f.ma,b.bp=new Float32Array([.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1]),b.jg=b.jg||[],b.jg[c]=f.sa,c++)}}function F(){var a=r("GRASS_MAP");a.i=E.kb(E.xe);return a}function C(a){var b=r("POSTPROCESSING");b.da=!1;b.ha=!1;b.Db=!1;b.i=E.kb(E.tb);b.yk=a;switch(a){case "NONE":b.w[0]=
1;b.w[1]=1;break;case "GRAYSCALE":b.w[0]=1;b.w[1]=1;break;case "X_BLUR":b.w[0]=1;b.w[1]=0;break;case "Y_BLUR":b.w[0]=0;b.w[1]=1;break;case "X_GLOW_BLUR":b.w[0]=1;b.w[1]=0;break;case "Y_GLOW_BLUR":b.w[0]=0;b.w[1]=1;break;case "X_EXTEND":b.w[0]=1;b.w[1]=0;break;case "Y_EXTEND":b.w[0]=0;b.w[1]=1;break;default:throw"Wrong postprocessing effect: "+a;}return b}function l(a){var b=r("BLOOM_BLUR");b.da=!1;b.ha=!1;b.Db=!1;b.i=E.kb(E.tb);b.yk=a;switch(a){case "X_BLUR":b.w[0]=1;b.w[1]=0;break;case "Y_BLUR":b.w[0]=
0;b.w[1]=1;break;default:throw"Wrong postprocessing effect for bloom blur: "+a;}return b}function H(a,b){var c=r("GLOW_COMBINE");c.da=!1;c.ha=!1;c.Db=!1;c.small_glow_mask_coeff=b.Me.small_glow_mask_coeff;c.large_glow_mask_coeff=b.Me.large_glow_mask_coeff;c.small_glow_mask_width=b.Me.small_glow_mask_width;c.large_glow_mask_width=b.Me.large_glow_mask_width;c.w[0]=1;c.w[1]=1;c.i=a;return c}function J(a,b,c,d,e,f,g,E,h){var k=r("MAIN_"+a);if("OPAQUE"===a)k.da=!0,k.ha=c,k.Fa=!1;else if("BLEND"===a)k.da=
!1,k.ha=!1,k.Fa=!0;else if("XRAY"===a)k.da=!1,k.ha=!0,k.Fa=!0;else if("PLANE_REFLECT"===a||"CUBE_REFLECT"===a)k.da=!0,k.ha=!0,k.Fa=!1;else if("GLOW"===a)k.da=!0,k.ha=!1,k.Fa=!1;else throw"wrong main subscene type";k.Fa&&E&&(k.self_shadow_normal_offset=E.self_shadow_normal_offset);k.i=b;if(a=g.Kn)k.xs.set([a.Av,a.By,a.mC,a.lC]),k.vs.set(a.color),k.ws=a.Aa;k.Ne.set(g.Ne);k.rf.set(g.rf);k.Je=g.Je;k.$b=f;d&&(k.$a=d,d.$b&&(k.gd=new Float32Array(d.$b)),k.qf=d.waves_height,k.Bg=d.waves_length,k.pf=d.pf,
d.Dj&&h&&(k.Af=!0,k.pp=d.Dj,k.qp.set(d.Gl),k.op=d.Fl),d.Jk&&(k.Vk=!0,f=d.CA,k.bf[0]=(f[0]+f[1])/2,k.bf[1]=(f[2]+f[3])/2,k.cf[0]=f[0]-f[1],k.cf[1]=f[2]-f[3],k.th=d.th,k.hh=d.hh));k.Vf=new Float32Array(3*e);k.Xf=new Float32Array(3*e);k.Uf=new Float32Array(3*e);k.Wf=new Float32Array(0==e%2?2*e:2*e+2);return k}function K(a,b){var c=r("COLOR_PICKING");b&&(c.type+="_XRAY",c.da=!1,c.ha=!0);c.enqueue=!1;c.i=a;return c}function I(a){var b=r("WIREFRAME");b.Xa=!1;b.da=!1;b.ha=!1;b.i=a;return b}function P(a){var b=
r("ANCHOR_VISIBILITY");b.da=!0;b.ha=!1;b.w[0]=1;b.w[1]=1;b.i=a;return b}function z(a,b){var c=r("DEPTH");c.i=a;c.self_shadow_normal_offset=b.self_shadow_normal_offset;return c}function N(a,b,c){var d=r("SSAO");d.da=!1;d.ha=!1;d.Db=!1;d.i=a;d.w[0]=1;d.w[1]=1;d.$b=b;d.gd=new Float32Array(b);d.yh=c.radius_increase;d.ssao_hemisphere=c.Ay;d.xh=c.influence;d.wh=c.dist_factor;d.Is=c.Yz;return d}function G(a,b){var c=r("SSAO_BLUR");c.da=!1;c.ha=!1;c.Db=!1;c.w[0]=1;c.w[1]=1;c.i=a;c.ssao_blur_depth=b.Cv;c.ssao_blur_discard_value=
b.hp;return c}function L(){var a=r("ANTIALIASING");a.da=!1;a.ha=!1;a.Db=!1;a.qe=1/ba.render_resolution_factor;a.w[0]=1;a.w[1]=1;a.i=E.kb(E.tb);return a}function O(a){var b=r(a);b.da="SMAA_BLENDING_WEIGHT_CALCULATION"==a||"SMAA_EDGE_DETECTION"==a?!0:!1;b.ha=!1;b.Db=!1;b.qe=1/ba.render_resolution_factor;b.w[0]=1;b.w[1]=1;b.i=E.kb(E.tb);"SMAA_BLENDING_WEIGHT_CALCULATION"==a&&(b.Sy=new Float32Array(4));return b}function W(a,b,c,d){var e=r("COMPOSITING");e.da=!1;e.ha=!1;e.Db=!1;e.w[0]=1;e.w[1]=1;e.i=E.kb(E.tb);
e.brightness=a;e.contrast=b;e.exposure=c;e.saturation=d;return e}function X(a,b){var c=r("MOTION_BLUR");c.da=!1;c.ha=!1;c.Db=!1;c.i=E.kb(E.tb);c.ol=!0;c.mb_decay_threshold=a;c.mb_factor=b;return c}function Y(a){var b=r("DOF");b.da=!1;b.ha=!1;b.Db=!1;b.w[0]=1;b.w[1]=1;b.i=a;b.qe=b.i.dof_power;return b}function R(a){var b=r("OUTLINE_MASK");b.Db=!1;b.w[0]=1;b.w[1]=1;b.i=a;return b}function ga(a){var b=r("OUTLINE");b.Ue.set(a.Ue);b.Fi=a.Fi;b.im=5;b.vl=3;b.Db=!1;b.i=E.kb(E.tb);return b}function ja(){var a=
r("REFRACT");a.da=!1;a.ha=!1;a.Db=!1;a.i=E.kb(E.tb);return a}function qa(a,b,c,d,e,f,g){var E=r("GOD_RAYS");E.da=!1;E.ha=!1;E.Db=!1;E.Ne=new Float32Array([1,1,1]);E.rf=new Float32Array([1,1,1]);E.Je=1;E.Or=d;E.of=b;E.Ck=e;E.gh=c;E.Bh=g;E.i=a;E.eg=f;E.Vf=new Float32Array(3*f);E.Xf=new Float32Array(3*f);E.Uf=new Float32Array(3*f);E.w[0]=1;E.w[1]=1;E.Wf=new Float32Array(0==f%2?2*f:2*f+2);return E}function v(a,b){var c=r("GOD_RAYS_COMBINE");c.da=!1;c.ha=!1;c.Db=!1;c.i=E.kb(E.tb);c.god_rays_intensity=
a;c.eg=b;c.Vf=new Float32Array(3*b);c.Xf=new Float32Array(3*b);c.Uf=new Float32Array(3*b);c.w[0]=1;c.w[1]=1;c.Wf=new Float32Array(0==b%2?2*b:2*b+2);return c}function Z(a,b){var c=r("SKY");c.enqueue=!1;c.da=!1;c.ha=!1;c.Db=!1;var d=E.kb(E.tb);d.width=Sa.Ee;d.height=Sa.Ee;c.i=d;c.di=ua.Gx();c.eg=a;c.Vf=new Float32Array(3*a);c.Xf=new Float32Array(3*a);c.Uf=new Float32Array(3*a);c.Wf=new Float32Array(0==a%2?2*a:2*a+2);c.Ne=new Float32Array([1,1,1]);c.rf=new Float32Array([1,1,1]);c.Je=1;c.uh.set(b.uh);
c.procedural_skydome=b.procedural_skydome;c.use_as_environment_lighting=b.use_as_environment_lighting;c.rayleigh_brightness=b.rayleigh_brightness;c.mie_brightness=b.mie_brightness;c.spot_brightness=b.spot_brightness;c.scatter_strength=b.scatter_strength;c.rayleigh_strength=b.rayleigh_strength;c.mie_strength=b.mie_strength;c.rayleigh_collection_power=b.rayleigh_collection_power;c.mie_collection_power=b.mie_collection_power;c.mie_distribution=b.mie_distribution;c.w[0]=1;c.w[1]=1;return c}function la(){var a=
r("COPY");a.da=!1;a.ha=!1;a.i=E.kb(E.tb);return a}function V(){var a=r("ANAGLYPH");a.da=!1;a.ha=!1;a.i=E.kb(E.tb);return a}function ha(){var a=r("LUMINANCE");a.da=!1;a.ha=!1;a.w[0]=1;a.w[1]=1;a.i=E.kb(E.tb);return a}function ea(){var a=r("AVERAGE_LUMINANCE");a.da=!1;a.ha=!1;a.w[0]=1;a.w[1]=1;a.i=E.kb(E.tb);return a}function pa(a,b,c,d){var e=r("LUMINANCE_TRUNCED");e.da=!1;e.ha=!1;e.bloom_key=a;e.bloom_edge_lum=b;e.w[0]=1;e.w[1]=1;e.i=d;e.Vf=new Float32Array(3*c);e.Xf=new Float32Array(3*c);e.Uf=new Float32Array(3*
c);e.Wf=new Float32Array(0==c%2?2*c:2*c+2);return e}function U(a){var b=r("BLOOM");b.da=!1;b.ha=!1;b.w[0]=1;b.w[1]=1;b.i=E.kb(E.tb);b.bloom_blur=a;return b}function S(){var a=r("SINK");a.enqueue=!1;return a}function fa(a,b,c){if(b.type===c)return!0;b=ra(a,b);for(var d=0;d<b.length;d++)if(fa(a,b[d],c))return!0;return!1}function ia(a,b,c){if(b.type===c)return!0;b=sa(a,b);for(var d=0;d<b.length;d++)if(ia(a,b[d],c))return!0;return!1}function sa(a,b){var c=M.cg(a,b);if(c==M.Co)throw"Subscene not in graph";
for(var d=[],e=M.Oq(a,c),f=0;f<e;f++){var g=M.Tj(a,c,f);g!=c&&d.push(M.Ya(a,g))}return d}function ra(a,b){var c=M.cg(a,b);if(c==M.Co)throw"Subscene not in graph";for(var d=[],e=M.ig(a,c),f=0;f<e;f++){var g=M.Of(a,c,f);g!=c&&d.push(M.Ya(a,g))}return d}function Q(a){var b=[],c=[];n(a,function(a){a.ta&&-1==b.indexOf(a.ta)&&(b.push(a.ta),c.push(a.ta,b.length-1))});return c}function ca(a,b){var c;c=""+(a.M+"\\n");c+="NONE"!=a.la?a.la+"\\n":"";c+="(";if(a.Ih){var d=a.ef;Math.round(d)!=d&&(d=d.toFixed(2));
d=(1==d?"":d)+"S";c+=d+"x"+d}else c+=a.size+"x"+a.size;if("SCREEN"!=a.M){c+=" ";if(a.xg)c+="RR";else{var d=a.Z,e=a.Y,f="";d==ma.r?f+="L":d==ma.Id&&(f+="N");e==ma.r?f+="L":e==ma.Id&&(f+="N");c+=f}for(d=0;d<b.length;d+=2)b[d]==a.ta&&(c+=" "+b[d+1])}return c+")\\n"}var E=p("__camera"),T=p("__config"),va=p("__debug"),M=p("__graph"),Xb=p("__renderer"),ma=p("__textures"),ua=p("__util");p("vec4");var sb=T.Zl,ba=T.o,Sa=T.Ti;a.Uv=function(a){switch(a.la){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "NONE":return!1;
default:return!0}};a.oB=n;a.Bw=function(a,c,e){function k(d,e){var f=b(wa[e]);c.G.push(f);f=J(d,f,!1,$a,na,Ib,Jb,Ta,a.tg);T.push(f);M.s(h,f);M.l(h,m[e],f,Q[e]);"XRAY"==d?f.ka.push(A("DEPTH","DEPTH",1,1,!0)):M.l(h,m[e],f,q[e]);Xa&&(M.l(h,Xa,f,Rb),M.l(h,Xa,f,hb));if(Qa){for(var g=0;g<ra.length;g++)M.l(h,ra[g],f,Xb[g]);if(ob.fc&&tb||Ba){var g=Yb[e],E=b(g.i);c.G.push(E);var l=r("DEPTH_PACK");l.da=!1;l.ha=!1;l.i=E;M.s(h,l);var E=A("DEPTH","u_depth",1,1,!0),n=A("COLOR","u_scene_depth",1,1,!0);n.Z=ma.Id;
n.Y=ma.Id;M.l(h,g,l,E);M.l(h,l,f,n)}}if(u.length)for(l=u.length/wa.length,g=0;g<l;g++)E=l*e+g,M.l(h,u[E],f,p[E]);if(ia.length)for(g=0;g<ia.length;g++)M.l(h,ia[g],f,sa[g]);ca.length&&M.l(h,ca[e],f,fa[e]);return f}var h=M.create(),m=[],T=[],n=[],Q=[],q=[],u=[],p=[],ca=[],fa=[],ra=[],Xb=[],ia=[],sa=[],na=a.br,$a=a.$a,Ba=a.shore_smoothing,Ga=a.Dn,pb=a.ff,Da=a.Xg,ob=a.cz,Cb=a.zb,tc=a.Ig,uc=a.jh,vc=a.Mg,Kb=a.antialiasing,Jb=a.vo,Ib=a.$b,Ta=a.wd,ab=a.fz,ub=a.Bv,Ra=a.Jv,Ea=a.uy,gb=a.sz,vb=a.Qg,Qa=a.$w,tb=
a.fc,ya=Boolean(e.length),wa=[];if(a.anaglyph_use&&!ya){var wb=c.G[0],qb=b(wb);E.lr(wb,E.ub);E.lr(qb,E.Bb);wa.push(wb,qb);c.G.push(qb)}else{var xa=c.G[0];wa.push(xa)}if(Ga){E.ho(wa[0],Ta);for(var ic=Ta.csm_num,aa=0;aa<ic;aa++){var xb=y(aa,Ta);M.s(h,xb);ra.push(xb);var Na=Ta.csm_resolution,xa=xb.i;xa.width=Na;xa.height=Na;xb.da=!1;Xb.push(A("DEPTH","u_shadow_map"+aa,Na,1,!1));(va.Pv()||ba.bq)&&xb.ka.push(A("COLOR","COLOR",Na,1,!1))}}if(Cb&&Cb.ur&&!ya)for(aa=0;aa<Cb.ur;aa++){xa=E.kb(E.Hb);xa.width=
Sa.Ee;xa.height=Sa.Ee;E.Hk(xa,90,.1,100);E.$e(xa,xa.wa);var za=J("CUBE_REFLECT",xa,!1,$a,na,Ib,Jb,null,a.tg);za.di=ua.Kx();for(var Aa=0;6>Aa;Aa++)za.Ul.push(E.tw());M.s(h,za);var jb=A("CUBEMAP","u_cube_reflection",Sa.Ee,1,!1);jb.Z=ma.r;jb.Y=ma.r;var Kc=A("DEPTH","DEPTH",Sa.Ee,1,!1);sa.push(jb);za.ka.push(Kc);ia.push(za);Cb.Kj.push(za)}if(Cb&&0<Cb.Dk.length&&!ya)for(aa=0;aa<wa.length;aa++)for(Aa=0;Aa<Cb.Dk.length;Aa++)xa=b(wa[aa]),xa.ec=new Float32Array(4),c.G.push(xa),za=J("PLANE_REFLECT",xa,!1,$a,
na,Ib,Jb,null,a.tg),M.s(h,za),jb=A("COLOR","u_plane_reflection",1,ba.Pi,!0),jb.Z=ma.r,jb.Y=ma.r,Kc=A("DEPTH","DEPTH",1,ba.Pi,!0),p.push(jb),za.ka.push(Kc),u.push(za),Cb.Ki.push(za);m=[];T=[];if(a.mb){var Xa=F();M.s(h,Xa);Na=Sa.Uj;Xa.i.width=Na;Xa.i.height=Na;var Rb=A("DEPTH","u_grass_map_depth",Na,1,!1);Rb.Z=ma.r;Rb.Y=ma.r;var hb=A("COLOR","u_grass_map_color",Na,1,!1);hb.Z=ma.r;hb.Y=ma.r}else hb=Rb=Xa=null;for(var Lb=[],jc=[],Yb=[],wc=[],aa=0;aa<wa.length;aa++){var xa=wa[aa],bb={};q.push(A("DEPTH",
"DEPTH",1,1,!0));if(Qa){var Zb=b(xa);c.G.push(Zb);bb=z(Zb,Ta);Yb.push(bb);M.s(h,bb);if(Ga){for(Aa=0;Aa<ra.length;Aa++)xb=ra[Aa],M.l(h,xb,bb,Xb[Aa]);var Pc=A("COLOR","u_color",1,1,!0),xc=A("DEPTH","u_depth",1,1,!0);if(pb){var D=b(xa);c.G.push(D);var Mb=a.VA,Ia=N(D,Ib,Mb);M.s(h,Ia);var Ua=A("COLOR","u_ssao_mask",1,1,!0);M.l(h,bb,Ia,Pc);M.l(h,bb,Ia,xc);var yb=b(xa);c.G.push(yb);var da=G(yb,Mb);M.s(h,da);var kc=A("COLOR","u_shadow_mask",1,1,!0);M.l(h,Ia,da,Ua);M.l(h,bb,da,xc)}}Xa&&(M.l(h,Xa,bb,Rb),M.l(h,
Xa,bb,hb))}za=J("OPAQUE",xa,!Qa,$a,na,Ib,Jb,null,a.tg);M.s(h,za);T.push(za);jc.push(za);Qa&&(M.l(h,bb,za,q[aa]),Ua?M.l(h,da,za,kc):Ga&&M.l(h,bb,za,A("COLOR","u_shadow_mask",1,1,!0)));var kb=A("COLOR","u_color",1,1,!0);Q.push(A("COLOR","COLOR",1,1,!0));Xa&&(M.l(h,Xa,za,Rb),M.l(h,Xa,za,hb));if(u.length)for(var cb=u.length/wa.length,Aa=0;Aa<cb;Aa++){var lc=cb*aa+Aa;M.l(h,u[lc],za,p[lc])}if(ia.length)for(Aa=0;Aa<ia.length;Aa++)M.l(h,ia[Aa],za,sa[Aa])}m=T;T=[];if(!ya&&a.aw){xa=b(m[0].i);c.G.push(xa);var ta=
K(xa,!1);M.s(h,ta);if(a.ue){xa=b(m[0].i);c.G.push(xa);var rb=K(xa,!0);M.s(h,rb);M.l(h,ta,rb,A("COLOR","COLOR",1,1,!0));M.l(h,ta,rb,A("DEPTH","DEPTH",1,1,!0))}}else ta=null;if(ob.fc&&!ya)for(aa=0;aa<wa.length;aa++){var zb=ja();M.s(h,zb);M.l(h,m[aa],zb,kb);ca.push(zb);fa.push(A("COLOR","u_refractmap",1,1,!0))}if(a.Cm){for(aa=0;aa<wa.length;aa++)za=k("BLEND",aa),Lb.push(za);m=T;T=[]}if(a.Le){for(aa=0;aa<wa.length;aa++){var ed=b(wa[aa]);c.G.push(ed);var Oa=J("GLOW",ed,!1,$a,na,Ib,Jb);M.s(h,Oa);M.l(h,
jc[aa],Oa,q[aa]);var Nb=C("X_GLOW_BLUR");Nb.Ka="GLOW_MASK_SMALL";Nb.qe=a.Me.small_glow_mask_width;var Qc=A("COLOR","u_color",1,1,!0);Qc.Z=ma.r;Qc.Y=ma.r;M.s(h,Nb);M.l(h,Oa,Nb,Qc);var db=C("Y_GLOW_BLUR");db.Ka="GLOW_MASK_SMALL";db.qe=a.Me.small_glow_mask_width;var $b=A("COLOR","u_color",1,.5,!0);$b.Z=ma.r;$b.Y=ma.r;M.s(h,db);M.l(h,Nb,db,$b);var ac=C("X_GLOW_BLUR");ac.Ka="GLOW_MASK_LARGE";ac.qe=a.Me.large_glow_mask_width;var mc=A("COLOR","u_color",1,.5,!0);mc.Z=ma.r;mc.Y=ma.r;M.s(h,ac);M.l(h,db,ac,
mc);var nc=C("Y_GLOW_BLUR");nc.Ka="GLOW_MASK_LARGE";nc.qe=a.Me.large_glow_mask_width;var Rc=A("COLOR","u_color",1,.25,!0);Rc.Z=ma.r;Rc.Y=ma.r;M.s(h,nc);M.l(h,ac,nc,Rc);var Zc=b(wa[aa]);c.G.push(Zc);var bc=H(Zc,a);M.s(h,bc);a.Cm?M.l(h,Lb[aa],bc,A("COLOR","u_src_color",1,1,!0)):M.l(h,jc[aa],bc,A("COLOR","u_src_color",1,1,!0));var $c=A("COLOR","u_glow_mask_small",1,.5,!0);$c.Z=ma.r;$c.Y=ma.r;M.l(h,db,bc,$c);var lb=A("COLOR","u_glow_mask_large",1,.25,!0);lb.Z=ma.r;lb.Y=ma.r;M.l(h,nc,bc,lb);n.push(bc)}m=
n;T=[]}if(!a.Cm){for(aa=0;aa<wa.length;aa++)za=k("BLEND",aa),Lb.push(za);m=T;T=[]}if(a.ue){for(aa=0;aa<wa.length;aa++){var Lc=k("XRAY",aa);wc.push(Lc)}m=T;T=[]}if(ba.wireframe_debug){for(aa=0;aa<wa.length;aa++){xa=ua.qa(wa[aa]);c.G.push(xa);var eb=I(xa);T.push(eb);M.s(h,eb);M.l(h,m[aa],eb,Q[aa]);M.l(h,m[aa],eb,q[aa]);Xa&&(M.l(h,Xa,eb,Rb),M.l(h,Xa,eb,hb))}m=T;T=[]}if(!ya&&a.Su){xa=ua.qa(wa[0]);c.G.push(xa);var yc=P(xa);M.s(h,yc);M.l(h,m[0],yc,q[0])}if(Da&&Qa&&!ya){for(aa=0;aa<wa.length;aa++){var ib=
Ea.gh,oc=Ea.Gy,Ab=Ea.Bh,Ma=m[aa],Db=$a?1:0,zc=A("DEPTH","u_input",1,1,!0);zc.Z=ma.r;zc.Y=ma.r;var Eb=A("COLOR","u_input",1,.25,!0);Eb.Z=ma.r;Eb.Y=ma.r;var Sb=ib/Ab,Ac=b(wa[aa]);c.G.push(Ac);var Hb=qa(Ac,Db,ib,!0,Sb,na,Ab);M.s(h,Hb);M.l(h,Ma,Hb,zc);var Sb=ib/Ab*.5,Va=b(wa[aa]);c.G.push(Va);var Pa=qa(Va,Db,ib,!1,Sb,na,Ab);M.s(h,Pa);M.l(h,Hb,Pa,Eb);var Sb=ib/Ab*.25,Ob=b(wa[aa]);c.G.push(Ob);var Sc=qa(Ob,Db,ib,!1,Sb,na,Ab);M.s(h,Sc);M.l(h,Pa,Sc,Eb);var Pb=v(oc,na);T.push(Pb);M.s(h,Pb);M.l(h,Ma,Pb,A("COLOR",
"u_main",1,1,!0));M.l(h,Sc,Pb,A("COLOR","u_god_rays",1,1,!0))}m=T;T=[]}if(tc&&!ya){for(aa=0;aa<wa.length;aa++){var Ma=m[aa],ld=ha();M.s(h,ld);M.l(h,Ma,ld,A("COLOR","u_input",1,1,!0));var Bc=ea();M.s(h,Bc);Bc.i.width=1;Bc.i.height=1;var ad=A("COLOR","u_input",1,.25,!0);ad.Z=ma.r;ad.Y=ma.r;var fd=A("COLOR","u_luminance",1,.25,!0);fd.Z=ma.r;fd.Y=ma.r;M.l(h,ld,Bc,ad);var Tb=ub.key,ud=ub.ex,pd=b(wa[aa]);c.G.push(pd);var Tc=pa(Tb,ud,na,pd);M.s(h,Tc);M.l(h,Ma,Tc,A("COLOR","u_main",1,1,!0));M.l(h,ld,Tc,fd);
M.l(h,Bc,Tc,A("COLOR","u_average_lum",1,1,!1));var cc=A("COLOR","u_color",1,.25,!0);cc.Z=ma.r;cc.Y=ma.r;Nb=l("X_BLUR");M.s(h,Nb);M.l(h,Tc,Nb,cc);db=l("Y_BLUR");M.s(h,db);M.l(h,Nb,db,cc);var fb=U(ub.blur);M.s(h,fb);var Uc=A("COLOR","u_bloom",1,.25,!0);Uc.Z=ma.r;Uc.Y=ma.r;M.l(h,db,fb,Uc);M.l(h,Ma,fb,A("COLOR","u_main",1,1,!0));T.push(fb)}m=T;T=[]}if(uc&&!ya){for(aa=0;aa<m.length;aa++){var qd=m[aa],Vc=X(ab.mb_decay_threshold,ab.mb_factor);T.push(Vc);M.s(h,Vc);M.l(h,qd,Vc,A("COLOR","u_mb_tex_curr",1,
1,!0));Vc.ka.push(A("COLOR","u_mb_tex_accum",1,1,!0))}m=T;T=[]}if(vb&&Qa&&!ya){for(aa=0;aa<m.length;aa++){var Ma=m[aa],Cc=b(wa[aa]);c.G.push(Cc);cc=A("COLOR","u_color",1,1,!0);cc.Z=ma.r;cc.Y=ma.r;var pc=C("X_BLUR");M.s(h,pc);M.l(h,Ma,pc,cc);var Dc=C("Y_BLUR");M.s(h,Dc);M.l(h,pc,Dc,cc);var bb=Lb[aa],bd=Y(Cc);Cc.dof_distance=c.dof_distance;Cc.Yd=c.Yd;Cc.dof_front=c.dof_front;Cc.dof_rear=c.dof_rear;Cc.dof_power=c.dof_power;Cc.dof_on=1;T.push(bd);M.s(h,bd);M.l(h,Ma,bd,A("COLOR","u_sharp",1,1,!0));M.l(h,
Dc,bd,A("COLOR","u_blurred",1,1,!0));M.l(h,bb,bd,A("DEPTH","u_depth",1,1,!0))}m=T;T=[]}if(!ya&&a.outline){for(aa=0;aa<wa.length;aa++){var Ma=m[aa],rd=b(wa[aa]);c.G.push(rd);var md=R(rd);M.s(h,md);var Mc=C("X_EXTEND"),sd=A("COLOR","u_color",1,1,!0),gd=A("COLOR","u_outline_mask",1,1,!0);Mc.vi=!0;M.s(h,Mc);M.l(h,md,Mc,sd);var qc=A("COLOR","u_color",1,.5,!0);qc.Z=ma.r;qc.Y=ma.r;var Ec=C("Y_EXTEND");Ec.vi=!0;M.s(h,Ec);M.l(h,Mc,Ec,qc);pc=C("X_BLUR");pc.vi=!0;M.s(h,pc);M.l(h,Ec,pc,qc);var Fb=A("COLOR","u_color",
1,.25,!0);Fb.Z=ma.r;Fb.Y=ma.r;var Wc=A("COLOR","u_outline_mask_blurred",1,.25,!0);Wc.Z=ma.r;Wc.Y=ma.r;Dc=C("Y_BLUR");Dc.vi=!0;M.s(h,Dc);M.l(h,pc,Dc,Fb);var Xc=ga(gb);M.s(h,Xc);M.l(h,Ma,Xc,A("COLOR","u_outline_src",1,1,!0));M.l(h,md,Xc,gd);M.l(h,Dc,Xc,Wc);T.push(Xc)}m=T;T=[]}if(vc&&!ya){for(aa=0;aa<m.length;aa++){var Ma=m[aa],Ub=W(Ra.brightness,Ra.contrast,Ra.exposure,Ra.saturation);M.s(h,Ub);M.l(h,Ma,Ub,A("COLOR","u_color",1,1,!0));T.push(Ub)}m=T;T=[]}if(Kb){for(aa=0;aa<m.length;aa++)if(Ma=m[aa],
ba.smaa){var cd=A("COLOR","u_color",1,1,!0);cd.Z=ma.r;cd.Y=ma.r;var Yc=O("SMAA_EDGE_DETECTION");M.s(h,Yc);M.l(h,Ma,Yc,cd);var Vb=O("SMAA_BLENDING_WEIGHT_CALCULATION");M.s(h,Vb);M.l(h,Yc,Vb,cd);var Fc=A("COLOR","u_search_tex",1,1,!1),hd=A("COLOR","u_area_tex",1,1,!1);Fc.Z=ma.r;Fc.Y=ma.r;hd.Z=ma.r;hd.Y=ma.r;Vb.ka.push(Fc);Vb.ka.push(hd);var oa=O("SMAA_NEIGHBORHOOD_BLENDING");M.s(h,oa);M.l(h,Ma,oa,cd);var Wa=A("COLOR","u_blend",1,1,!0);Wa.Z=ma.r;Wa.Y=ma.r;M.l(h,Vb,oa,Wa);T.push(oa)}else{var jd=L();M.s(h,
jd);var rc=A("COLOR","u_color",1,1,!0);rc.Z=ma.r;rc.Y=ma.r;M.l(h,Ma,jd,rc);if(1<ba.render_resolution_factor){var Ka=C("NONE");M.s(h,Ka);M.l(h,jd,Ka,rc);T.push(Ka)}else T.push(jd)}m=T;T=[]}if(a.anaglyph_use&&!ya){var Ya=V();M.s(h,Ya);M.l(h,m[0],Ya,A("COLOR","u_sampler_left",1,1,!0));M.l(h,m[1],Ya,A("COLOR","u_sampler_right",1,1,!0));T.push(Ya)}else T.push(m[0]);var vd=M.cg(h,m[0]),mb=!1;M.se(h,vd,function(a,b,c){if(c.M==c.la)return mb=!0});if(mb){var dc=la();M.s(h,dc);M.l(h,m[0],dc,A("COLOR","u_color",
1,1,!0));m=T;T=[];T.push(dc)}ta&&(rb?T.push(rb):T.push(ta));yc&&T.push(yc);if(!ya&&a.Lk.procedural_skydome){var Nc=Z(na,a.Lk);M.s(h,Nc);T.push(Nc)}var Wb=S();M.s(h,Wb);for(aa=0;aa<T.length;aa++){var ec=T[aa];switch(ec.type){case "COLOR_PICKING":case "COLOR_PICKING_XRAY":M.l(h,ec,Wb,A("COLOR","NONE",1,1,!0));M.l(h,ec,Wb,A("DEPTH","NONE",1,1,!0));break;case "SKY":M.l(h,ec,Wb,A("CUBEMAP","u_sky",Sa.Ee,1,!1));break;case "ANCHOR_VISIBILITY":M.l(h,ec,Wb,A("COLOR","NONE",1,1,!0));break;default:if(ya){var dd=
e[0].d,fc=A("COLOR","OFFSCREEN",1,1,!0);fc.ta=dd;M.l(h,T[aa],Wb,fc);for(Aa=1;Aa<e.length;Aa++){var td=e[Aa].d,dc=la();M.s(h,dc);M.l(h,T[aa],dc,A("COLOR","u_color",1,1,!0));fc=A("COLOR","OFFSCREEN",1,td.rg/dd.rg,!0);fc.ta=td;M.l(h,dc,Wb,fc)}}else M.l(h,T[aa],Wb,A("SCREEN","NONE",1,1,!0))}}if(sb.enabled){var nd=x(h);nd&&B(h,nd)}d(h,Qa);1<ba.render_resolution_factor&&g(h);f(h);w(h);if(Ga){for(aa=0;aa<Yb.length;aa++)t(h,Yb[aa]);for(aa=0;aa<Lb.length;aa++)t(h,Lb[aa]);for(aa=0;aa<wc.length;aa++)t(h,wc[aa])}return h};
a.YD=r;a.zc=function(a,b,c){var d=a.qe;a.Zn[0]=b*a.w[0]*d;a.Zn[1]=c*a.w[1]*d};a.Nb=function(a,b){a.qe=b};a.tD=function(a){var b=null;M.O(a,function(a,c){return c.i&&null===c.i.be?(b=c,!0):!1});return b};a.Ga=function(a,b,c){a=sa(a,b);for(b=0;b<a.length;b++)if(a[b].type===c)return a[b];return null};a.PD=fa;a.RD=ia;a.tq=sa;a.LD=ra;a.Ba=function(a,b){var c=null;M.O(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.Qw=function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',
b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=Q(a);M.O(a,function(a,d){var e=b+="    ",f="",f=d.type.replace(/_/g," ");"POSTPROCESSING"==d.type&&(f+=" ("+d.yk.replace(/_/g," ")+")");if(d.i){for(var f=f+"\\n",g=0;g<c.length;g+=2)c[g]==d.i.eb&&(f+="C"+c[g+1]+" ");for(g=0;g<c.length;g+=2)c[g]==d.i.Lc&&(f+="D"+c[g+1])}d.ka.length&&(f+="\\n-----\\n");for(g=0;g<d.ka.length;g++)f+=ca(d.ka[g],c);g="SINK"==d.type?"dotted":d.enqueue?"solid":"dashed";b=e+(String(a)+
' [label="'+f+'" color="black" style="'+(g+",bold")+'"];\n')});M.re(a,function(a,d,e){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+ca(e,c)+'" style="'+(e.Ma?"solid":"dotted")+'"];\n'});return b+="}"};a.Cw=function(a){a=M.kB(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.enqueue&&b.push(d)}return b}};b4w.module.__textures=function(a,p){function b(){return{name:"",type:0,source:"",Nn:"",width:0,height:0,Ol:1,qj:!0,rg:1024,Up:!1,Rd:null,La:null,qh:null,ls:1,me:0,rh:!1,Yk:!1,Tf:!1,I:0,ra:0,Ug:0,PB:!1,vg:!1,kn:0,ac:0,Ob:0,Va:null,nf:null}}function d(d,e,f,g){var h=d.type,k=new Uint8Array([204,204,204,255]),m=b();switch(h){case "DATA_TEX2D":case "IMAGE":var n=l.createTexture(),q=l.TEXTURE_2D;l.bindTexture(q,n);l.texImage2D(q,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,k);d.image&&"MOVIE"==d.image.source&&
(m.Tf=!0,m.I=d.frame_start,m.ra=d.frame_offset,m.Ug=d.frame_duration,m.PB=d.use_auto_refresh,m.vg=d.use_cyclic,m.kn=d.movie_length,0!=m.ra&&w.warn('Frame offset for texture "'+d.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.'));break;case "NONE":n=l.createTexture();q=l.TEXTURE_2D;l.bindTexture(q,n);if("NONE"==d.b4w_source_type)return null;if("SCENE"==d.b4w_source_type)if(d.b4w_source_id&&(f=y.keysearch("name",d.b4w_source_id,f)))m.rg=d.b4w_source_size,f.jd=f.jd||
[],f.jd.push(d),l.texImage2D(q,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,k);else return null;break;case "ENVIRONMENT_MAP":n=l.createTexture();q=l.TEXTURE_CUBE_MAP;l.bindTexture(q,n);f="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var u=0;6>u;u++)r.Om?l.texImage2D(l["TEXTURE_CUBE_MAP_"+f[u]],0,l.RGB,1,1,0,l.RGB,l.UNSIGNED_BYTE,k):l.texImage2D(l["TEXTURE_CUBE_MAP_"+f[u]],0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,k);break;case "VORONOI":case "BLEND":return null;default:return w.error('texture "'+
d.name+'" has unsupported type "'+h+'"'),null}("NONE"!=h||d.b4w_enable_canvas_mipmapping&&"CANVAS"==d.b4w_source_type)&&"DATA_TEX2D"!=h?r.Om&&"ENVIRONMENT_MAP"==h?l.texParameteri(q,l.TEXTURE_MIN_FILTER,l.LINEAR):l.texParameteri(q,l.TEXTURE_MIN_FILTER,H[r.Ok]):l.texParameteri(q,l.TEXTURE_MIN_FILTER,l.LINEAR);l.texParameteri(q,l.TEXTURE_MAG_FILTER,l.LINEAR);k=q;f=d.b4w_anisotropic_filtering;"DEFAULT"===f&&(f=e);"OFF"!==f&&r.rj&&(e=B.Sx())&&(f=parseFloat(f.split("x")[0]),l.texParameterf(k,e.TEXTURE_MAX_ANISOTROPY_EXT,
f));"REPEAT"!=d.extension||d.b4w_shore_dist_map?(l.texParameteri(q,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(q,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE)):(l.texParameteri(q,l.TEXTURE_WRAP_S,l.REPEAT),l.texParameteri(q,l.TEXTURE_WRAP_T,l.REPEAT));m.type=a.Dg;m.width=1;m.height=1;m.Va=n;m.Ob=q;"CANVAS"==d.b4w_source_type&&"NONE"==h?(h=d.b4w_source_id,n=d.b4w_source_size,m.Up=d.b4w_enable_canvas_mipmapping,m.Nn=h,m.source="CANVAS",q=document.createElement("canvas"),q.width=n,q.height=n,m.Rd=q.getContext("2d"),
g in F||(F[g]={}),F[g][h]=m,c(m)):"SCENE"==d.b4w_source_type&&"NONE"==h?(m.Nn=d.b4w_source_id,m.source="SCENE"):(m.source=h,l.generateMipmap(q),l.bindTexture(q,null));m.name=d.name;return d.d=m}function c(a){if("CANVAS"!=a.source)throw"Wrong texture";var b=a.Ob;l.bindTexture(b,a.Va);var c=k(a),d=q(a),e=a.Rd.canvas;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!0);l.texImage2D(b,0,c,c,d,e);l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!1);a.Up&&l.generateMipmap(b);l.bindTexture(b,null);a.width=e.width;a.height=e.height}
function e(a){var b=a.Ob;l.bindTexture(b,a.Va);l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!0);l.texImage2D(b,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,a.qh[a.me]);l.bindTexture(b,null)}function f(a){l.texParameteri(a,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE);l.texParameteri(a,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE);l.texParameteri(a,l.TEXTURE_MAG_FILTER,l.LINEAR);l.texParameteri(a,l.TEXTURE_MIN_FILTER,l.LINEAR)}function g(a,b){var c=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384];return-1==c.indexOf(a)||-1==c.indexOf(b)}
function k(b){switch(b.type){case a.Dg:b=l.RGBA;break;case a.cl:b=l.RGB;break;case a.lj:b=l.RGBA;break;case a.mj:b=l.RGB;break;case a.Qh:b=l.DEPTH_COMPONENT;break;default:throw"Wrong texture type";}return b}function q(b){switch(b.type){case a.Dg:b=l.UNSIGNED_BYTE;break;case a.cl:b=l.UNSIGNED_BYTE;break;case a.lj:b=l.FLOAT;break;case a.mj:b=l.FLOAT;break;case a.Qh:b=l.UNSIGNED_INT;break;default:throw"Wrong texture type";}return b}function h(a,b){return b in C&&a in C[b]?(r.Sc?C[b][a].rh=!0:C[b][a].La.play(),
!0):null}function m(a,b){if(b in C&&a in C[b]){var c=C[b][a];r.Sc?(c.me=c.ra,e(c),c.me++):c.La.currentTime=c.ra/c.ac;return!0}return null}function u(a,b){return b in C&&a in C[b]?(r.Sc?C[b][a].rh=!1:C[b][a].La.pause(),!0):null}var n=p("__config"),w=p("__print"),x=p("__dds"),B=p("__extensions"),y=p("__util"),r=n.o,A=n.Nd,t=n.cd;a.Id=0;a.r=0;a.Iu=0;a.Gu=0;a.Hu=0;a.Fu=0;a.Dg=10;a.cl=20;a.lj=30;a.mj=40;a.Qh=50;a.Cg=60;var F={},C={},l=null,H;a.bd=function(b){H=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,
b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.Id=b.NEAREST;a.r=b.LINEAR;a.Iu=b.NEAREST_MIPMAP_NEAREST;a.Gu=b.LINEAR_MIPMAP_NEAREST;a.Hu=b.NEAREST_MIPMAP_LINEAR;a.Fu=b.LINEAR_MIPMAP_LINEAR;l=b};a.Wx=function(a,b){return b in F&&a in F[b]?F[b][a].Rd:null};a.AB=function(a,b){return b in F&&a in F[b]?(c(F[b][a]),!0):!1};a.Jj=function(c,d){var e=b();e.name=c;e.type=d;e.source="NONE";if(d==a.Cg)e.nf=l.createRenderbuffer();else{var f=l.TEXTURE_2D,g=l.createTexture();l.bindTexture(f,g);l.texParameteri(f,
l.TEXTURE_MAG_FILTER,l.LINEAR);l.texParameteri(f,l.TEXTURE_MIN_FILTER,l.LINEAR);l.texParameteri(f,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE);l.texParameteri(f,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE);l.bindTexture(f,null);e.Ob=f;e.Va=g}return e};a.qw=function(c){var d=l.createTexture(),e=l.TEXTURE_CUBE_MAP;l.bindTexture(e,d);l.texParameteri(e,l.TEXTURE_MAG_FILTER,l.LINEAR);l.texParameteri(e,l.TEXTURE_MIN_FILTER,l.LINEAR);l.texParameteri(e,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE);l.texParameteri(e,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE);
for(var f="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),g=0;6>g;g++)l.texImage2D(l[f[g]],0,l.RGBA,c,c,0,l.RGBA,l.UNSIGNED_BYTE,null);l.bindTexture(e,null);e=b();e.name="CUBEMAP";e.type=a.Dg;e.source="NONE";e.width=3*c;e.height=2*c;e.Ol=1;e.Va=d;e.Ob=l.TEXTURE_CUBE_MAP;return e};a.Gn=function(b,c,d){if(b.type!=a.Cg){var e=b.Ob;l.bindTexture(e,b.Va);c&&l.texParameteri(e,
l.TEXTURE_MIN_FILTER,c);d&&l.texParameteri(e,l.TEXTURE_MAG_FILTER,d);l.bindTexture(e,null)}};a.KD=function(b){if(b.type==a.Cg)return{min:a.Id,Zy:a.Id};var c=b.Ob;l.bindTexture(c,b.Va);b=l.getTexParameter(c,l.TEXTURE_MIN_FILTER);var d=l.getTexParameter(c,l.TEXTURE_MAG_FILTER);l.bindTexture(c,null);return{min:b,Zy:d}};a.resize=function(b,c,d){c=Math.max(c,1);d=Math.max(d,1);if(b.width!=c||b.height!=d){if(b.type==a.Cg)l.bindRenderbuffer(l.RENDERBUFFER,b.nf),l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,
c,d),l.bindRenderbuffer(l.RENDERBUFFER,null);else{var e=b.Ob;l.bindTexture(e,b.Va);var f=k(b),g=q(b);l.texImage2D(e,0,f,c,d,0,f,g,null);l.bindTexture(e,null)}c>r.Kb||d>r.Kb?w.error('Slink texture "'+b.name+'" has unsupported size: '+c+"x"+d+". Max available: "+r.Kb+"x"+r.Kb+"."):(b.width=c,b.height=d)}};a.Kw=d;a.MB=function(a){var b=a.Ob;l.bindTexture(b,a.Va);l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!0);4!=a.La.length?l.texImage2D(b,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,a.La):l.texImage2D(b,0,l.RGBA,1,1,0,l.RGBA,
l.UNSIGNED_BYTE,a.La);l.bindTexture(b,null)};a.JB=e;a.Zi=function(a,b,c,d,e){var h=a.source,k=a.Ob;l.bindTexture(k,a.Va);if(4==b.length){var m=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==h)if(m)l.texImage2D(k,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(c){c=x.Aq(b);if(c.width>r.Kb||c.height>r.Kb){w.error('Texture "'+d+'" has unsupported size: '+c.width+"x"+c.height+". Max available: "+r.Kb+"x"+r.Kb+".");return}x.OB(l,B.xq(),b,!0);g(c.width,c.height)&&
(a.ap||w.warn("using NPOT texture",d),f(k));a.width=c.width;a.height=c.height;a.Ol=x.Yx(b)}else{l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!0);if(b.width>r.Kb||b.height>r.Kb){w.error('Texture "'+d+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+r.Kb+"x"+r.Kb+".");return}a.Tf?r.Sc?b&&(e in C||(C[e]={}),C[e][a.name]=a,a.qh=b,a.ac=a.kn/b.length,a.Ug=Math.round(a.Ug/a.ac),a.ra=Math.round(a.ra/a.ac),a.I=Math.round(a.I/a.ac),a.me=a.ra,l.texImage2D(k,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,a.qh[0])):
(a.La=b,a.La.loop=a.vg,b&&(e in C||(C[e]={}),C[e][a.name]=a),a.ac=A.Ha,b.duration&&(a.ac=a.kn/b.duration),t.Rp||(b.playbackRate=A.Ha/a.ac,t.vp&&2<b.playbackRate&&(b.playbackRate=2)),l.texImage2D(k,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,a.La)):l.texImage2D(k,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,b);r.Sc&&a.Tf?(a.width=b[0].width,a.height=b[0].height):(a.width=b.width,a.height=b.height);g(b.width,b.height)?(a.ap||(a.Tf?w.warn("using NPOT video texture",d):w.warn("using NPOT texture",d)),f(k)):a.Tf||l.generateMipmap(k)}else if("ENVIRONMENT_MAP"==
h)if(c=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],m){for(m=0;6>m;m++)e=c[m],l.texImage2D(l["TEXTURE_CUBE_MAP_"+e[0]],0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,b);a.width=3;a.height=2}else{l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!1);h=b.width/3;if(h>r.Bi||h>r.Bi){w.error('Cubemap texture "'+d+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*r.Bi+"x"+2*r.Bi+".");return}for(m=0;6>m;m++){e=c[m];var n=document.createElement("canvas");
n.width=h;n.height=h;var q=n.getContext("2d");"POSITIVE_Y"==e[0]||"NEGATIVE_Y"==e[0]?(q.translate(0,h),q.scale(1,-1)):(q.translate(h,0),q.scale(-1,1));q.drawImage(b,e[1]*h,e[2]*h,h,h,0,0,h,h);l.texImage2D(l["TEXTURE_CUBE_MAP_"+e[0]],0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,n)}a.width=3*h;a.height=2*h;g(b.width/3,b.height/2)?(w.warn("using NPOT cube map texture",d),f(k)):l.generateMipmap(k)}else"DATA_TEX2D"==h&&(l.texImage2D(k,0,l.RGBA,b.width,b.height,0,l.RGBA,l.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=
b.height);l.bindTexture(k,null)};a.Zw=function(a){l.deleteTexture(a)};a.xi=function(a){return a&&a.name&&(a.Va||a.nf)?!0:!1};a.Vq=function(a){return a&&a.name&&a.nf?!0:!1};a.cE=function(b){return b.type==a.lj||b.type==a.mj?!0:!1};a.ny=function(b){var c=0;switch(b.type){case a.Dg:case a.cl:c=4;break;case a.lj:case a.mj:c=16;break;case a.Qh:c=3;break;case a.Cg:c=2}return c};a.Ox=function(a){var b=null,b={name:"special_ssao_texture",type:"DATA_TEX2D",extension:"REPEAT",b4w_anisotropic_filtering:"OFF"};
d(b,null,a,0);b.image={filepath:null};return b};a.cleanup=function(){if(!r.Sc)for(var a in C)for(var b in C[a])C[a][b].La.pause(),C[a][b].La.src="",C[a][b].La.load();F={};C={}};a.play_video=h;a.reset_video=m;a.pause_video=u;a.pause=function(){for(var a in C)for(var b in C[a])r.Sc&&!C[a][b].rh||!r.Sc&&C[a][b].La.paused||(u(b,a),C[a][b].Yk=!0)};a.reset=function(){for(var a in C)for(var b in C[a])m(b,a),C[a][b].Yk=!1};a.play=function(a){for(var b in C)for(var c in C[b])if(!a||C[b][c].Yk)h(c,b),C[b][c].Yk=
!1}};b4w.module.__assets=function(a,p){function b(){return x.Iy()?p(x.Tb.Aj).data:null}function d(){var a={nj:null,Pu:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),e=0;e<c;e++)d[e]=b.charCodeAt(e);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.nj=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var c=b();c&&a.nj in c&&(a.status=200,c[a.nj]&&(a.response=a.Pu(c[a.nj])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function c(b){for(var c=0,d=0;d<b.length;d++){var l=b[d];20===l.state&&c++;if(c>=F.dz)break;if(10===l.state)switch(l.state=20,c++,l.type){case a.AT_ARRAYBUFFER:e(l,"arraybuffer");break;case a.AT_JSON:e(l,"json");break;case a.AT_TEXT:e(l,"text");break;case a.AT_AUDIOBUFFER:f(l);break;case a.AT_IMAGE_ELEMENT:g(l);
break;case a.AT_AUDIO_ELEMENT:k(l);break;case a.hj:q(l);break;case a.gj:h(l);break;default:r.pa("Wrong asset type: "+l.type)}}}function e(a,c){var e=b(),f=e&&a.q in e?new d:new XMLHttpRequest;f.open("GET",a.q,!0);"text"==c?(f.overrideMimeType("text/plain"),f.responseType="text"):"json"==c?(f.overrideMimeType("application/json"),f.responseType="text"):f.responseType=c;f.onreadystatechange=function(){if(40!=a.state&&4==f.readyState){if(200==f.status||0==f.status){var b=f.response;if(b){if("json"==c&&
"string"==typeof b)try{b=JSON.parse(b)}catch(d){a.jb(null,a.uri,a.type,a.q,a.ob);B.error(d+" (parsing JSON "+a.q+")");return}a.jb(b,a.uri,a.type,a.q,a.ob)}else a.jb(null,a.uri,a.type,a.q,a.ob),B.error("empty responce when trying to get "+a.q)}else a.jb(null,a.uri,a.type,a.q,a.ob),B.error(f.status+" when trying to get "+a.q);a.state=30}};f.addEventListener("progress",function(b){b.lengthComputable&&a.Xr(b.loaded/b.total)},!1);f.send(null)}function f(a){var c=b(),e=c&&a.q in c?new d:new XMLHttpRequest;
e.open("GET",a.q,!0);e.responseType="arraybuffer";e.onreadystatechange=function(){if(40!=a.state&&4==e.readyState)if(200==e.status||0==e.status){var b=e.response;b?y.Uw(b,function(b){a.jb(b,a.uri,a.type,a.q,a.ob);a.state=30},function(){a.jb(null,a.uri,a.type,a.q,a.ob);B.error("failed to decode "+a.q);a.state=30}):(a.jb(null,a.uri,a.type,a.q,a.ob),B.error("empty responce when trying to get "+a.q),a.state=30)}else a.jb(null,a.uri,a.type,a.q,a.ob),B.error(e.status+" when trying to get "+a.q),a.state=
30};e.send(null)}function g(a){var c=document.createElement("img");C.allow_cors&&(c.crossOrigin="Anonymous");c.onload=function(){40!=a.state&&(a.jb(c,a.uri,a.type,a.q,a.ob),a.state=30)};c.addEventListener("error",function(){40!=a.state&&(a.jb(null,a.uri,a.type,a.q,a.ob),B.error("could not load image: "+a.q),a.state=30)},!1);var d=b();if(d&&a.q in d)if(d[a.q]){var e=u(a.q);c.src="data:"+e+";base64,"+d[a.q]}else t.Qm()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=
new CustomEvent("error"),c.dispatchEvent(d);else c.src=a.q}function k(a){var c=document.createElement("audio");C.allow_cors&&(c.crossOrigin="Anonymous");c.addEventListener("loadeddata",function(){40!=a.state&&(a.jb(c,a.uri,a.type,a.q,a.ob),a.state=30)},!1);c.addEventListener("error",function(){40!=a.state&&(a.jb(null,a.uri,a.type,a.q,a.ob),B.error("could not load sound: "+a.q),a.state=30)},!1);var d=b();if(d&&a.q in d)if(d[a.q]){var e=n(a.q);c.src="data:"+e+";base64,"+d[a.q];40!=a.state&&(a.jb(c,
a.uri,a.type,a.q,a.ob),a.state=30)}else t.Qm()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),c.dispatchEvent(d);else c.src=a.q,C.Sf&&c.load();setTimeout(function(){c.HA=1},5E3)}function q(a){function c(){40!=a.state&&(a.jb(null,a.uri,a.type,a.q),B.error("could not load video: "+a.q,a.ob),a.state=30)}var d=document.createElement("video");d.muted=!0;if(C.allow_cors||C.Sf)d.crossOrigin="Anonymous";d.addEventListener("loadeddata",function(){d.removeEventListener("error",
c,!1);40!=a.state&&(a.jb(d,a.uri,a.type,a.q,a.ob),a.state=30)},!1);d.addEventListener("error",c,!1);var e=b();if(e&&a.q in e)if(e[a.q]){var f=w(a.q);d.src="data:"+f+";base64,"+e[a.q];40!=a.state&&d.addEventListener("loadeddata",function(){a.jb(d,a.uri,a.type,a.q,a.ob);a.state=30},!1)}else t.Qm()?(e=document.createEvent("CustomEvent"),e.initCustomEvent("error",!1,!1,null)):e=new CustomEvent("error"),d.dispatchEvent(e);else d.src=a.q,C.Sf&&d.load();setTimeout(function(){d.HA=1},1E4)}function h(a){function c(b){a.jb(b,
a.uri,a.type,a.q,a.ob)}var e=b(),f=e&&a.q in e?new d:new XMLHttpRequest;f.open("GET",a.q,!0);f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=a.state&&4==f.readyState){if(200==f.status||0==f.status){var b=f.response;b?m(b,c):(a.jb(null,a.uri,a.type,a.q,a.ob),B.error("empty responce when trying to get "+a.q))}else a.jb(null,a.uri,a.type,a.q,a.ob),B.error(f.status+" when trying to get "+a.q);a.state=30}};f.addEventListener("progress",function(b){b.lengthComputable&&a.Xr(b.loaded/
b.total)},!1);f.send(null)}function m(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),e=c[3],f={images:[],gp:[],ac:c[4]},g=20,h=0;h<e;h++){var k=c[g/4],l=new Blob([d.subarray(g+4,g+4+k)],{type:"image/jpg"}),m=document.createElement("img");m.src=window.URL.createObjectURL(l);f.images.push(m);f.gp.push(l);g+=k+8-k%4}m.onload=function(){for(var a=0;a<f.images.length;a++)window.URL.revokeObjectURL(f.images[a].src);delete f.gp;b(f)}}function u(a){var b="image";switch(r.ym(a).toLowerCase()){case "jpeg":case "jpg":b+=
"/jpeg";break;case "png":b+="/png"}return b}function n(a){var b="audio";switch(r.ym(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+="/mp4";break;case "webm":b+="/webm"}return b}function w(a){var b="video";switch(r.ym(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var x=p("__config"),B=p("__print"),y=p("__sfx"),r=p("__util"),A=p("__version"),t=p("__compat"),F=x.Od,C=x.o;a.AT_ARRAYBUFFER=
10;a.AT_JSON=20;a.AT_TEXT=30;a.AT_AUDIOBUFFER=40;a.AT_IMAGE_ELEMENT=50;a.AT_AUDIO_ELEMENT=60;a.hj=70;a.gj=80;var l=[],H=0,J={};a.Wi=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));return b};a.my=function(a){if(J[a])return J[a];var b=F.Vr?a+A.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==c.status){b=c.responseText;if(b.length)return J[a]=b;r.pa("Error XHR: responce is empty, GET "+
a)}else r.pa("Error XHR: "+c.status+", GET "+a)};a.cleanup=function(){for(var a=0;a<l.length;a++)l[a].state=40;l=[];H=0;J={}};a.enqueue=function(a,d,e,f){for(var g=0;g<a.length;g++){var h=a[g],h={uri:h[0],type:h[1],q:h[2],ob:h[3],state:10,jb:d||function(){},Pr:e||function(){},Xr:f||function(){},Qr:H};if(F.Vr){var k=b();k&&h.q in k||(h.q+=A.timestamp())}l.push(h)}c(l);H++};a.update=function(){c(l);for(var a=l,b=0,d=!0,e=0;e<a.length;e++){var f=a[e];f.Qr===a[b].Qr?30!==f.state&&(d=!1):(d&&(a[e-1].Pr(),
d=e-b,a.splice(b,d),e-=d),b=e,d=30===a[e].state?!0:!1);e===a.length-1&&d&&(a[e].Pr(),a.splice(b))}}};b4w.module.__loader=function(a,p){function b(b,c,e,f){var g=r,h=x.create(),k;for(k in c){var m=d(c[k]);(f&&m.gb||!b&&m.yb)&&u(m);x.s(h,m)}for(k in c)for(m=c[k],m.name=k,b=0;b<m.J.length;b++)x.l(h,c[m.J[b]],m,null);c=d({name:"out",Ta:a.vt,cb:function(a,b,c,d,e){0===b.id&&(g.Rn=!0);w(b)||(b.status=2);b.jr(b.id,!0);e(b,c);B.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},ib:5});var n=[];if(e)for(e=x.zq(h),b=0;b<e.length;b++)n.push(x.Ya(h,e[b]));else x.O(h,function(a,b){b.ab||n.push(b)});x.s(h,
c);for(b=0;b<n.length;b++)c.J.push(n[b].name),x.l(h,n[b],c,null);return h}function d(a){a.ab=a.ab||!1;a.Ta||0===a.Ta||(a.Ta=a.hd);a.J=a.J||[];a.ui=a.ui||!1;a.Jn=a.Jn||!1;a.ib=a.ib||0;a.gb=a.gb||!1;a.yb=a.yb||!1;a.status=0;a.mE=0;a.bn=0;a.Cf=a.Cf||null;return a}function c(a,b){for(var c=[],d=[],e=0;e<b.length;e++){var f=b[e];x.Ya(a.zd,f).ui&&(x.kf(a.zd,f,function(d){var e=!0;x.se(a.zd,d,function(a,b){if(!b.ui)return e=!1,1});e&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),d.push(e))}for(e=d.length-
1;0<=e;e--)b.splice(d[e],1);return c}function e(a){function b(c,d){var e=x.Ya(a.zd,c),f=x.Ya(a.zd,d),g=f.Ta-e.Ta;0==g&&(g=e.ab-f.ab);return g}var d=[],e=a.pe,f=!1;do{var g=c(a,e);d.push.apply(d,e);0<g.length&&(f=!0);e=g}while(0<g.length);f&&d.sort(b);a.pe=d;return a.pe.length}function f(a,b,c){if(b.Jn)return b.ui=!0,k(a,b),!1;if(!b.cb&&!b.Bf&&!b.Zh)return k(a,b),!1;if(0==b.status&&(b.status++,b.cb))return b.cb(c,a,b,b.Cf,k,q),!0;if(1==b.status){if(b.Bf)return b.Bf(c,a,b,b.Cf,k,q),!0;b.status++}return 2==
b.status&&(b.status++,b.Zh)?(b.Zh(c,a,b,b.Cf,k,q),!0):!1}function g(a){if(0==a.Mk)return 100;var b=0;x.O(a.zd,function(c,d){a.do_not_load_resources&&d.gb||(b+=d.bn*d.ib)});return y.trunc(100*b/a.Mk)}function k(a,b){b.ui=!0;b.status=3;h(a,b,1)}function q(a,b,c){1>c?h(a,b,c):b.status++}function h(a,b,c){var d=r;if(b.cb||b.Bf||b.Zh)if(b.bn=c,b=g(a),a.Kp!=b||1==c)a.Qn(b,performance.now()-a.Us),a.Kp=b,d.dn=!0}function m(a,b){var c=null;x.O(a.zd,function(a,d){if(d.name==b)return c=d,1});return c}function u(a){a.Jn=
!0;a.bn=1}function n(a){a.Qn=null;a.Nl=null;a.zd=null;a.pe=null}function w(a){return a&&(3==a.status||4==a.status)}var x=p("__graph"),B=p("__print"),y=p("__util");a.hd=0;a.we=1;a.vt=2;var r=null;a.yq=function(){return r};a.Dw=function(){var a={Cd:[],Xl:0,pj:0,Rn:!1,dn:!1};return r=a};a.Lw=function(a,c,d,e,f,g,h,k){var m=r,n={id:m.Cd.length,status:0,q:c,dp:"",jr:d||function(){},an:k||!1,PE:g,Us:0,Kp:0,Mk:0,En:!1,Qn:e||function(){},Nl:f||function(){},zd:null,pe:null,Jm:!1,Im:!1,Mm:!1};a=b(0===n.id,
a,g,h);n.zd=a;c=[];d=x.ky(a);for(e=0;e<d.length;e++)c.push(d[e]);n.pe=c;x.O(a,function(a,b){!(b.cb||b.Bf||b.Zh)||n.do_not_load_resources&&b.gb||(n.Mk+=b.ib)});m.Cd.push(n);m.pj++;return n.id};a.IB=function(b){var c=r;if(c&&0!=r.pj)if(c.dn)c.dn=!1;else{var d=performance.now();do{var g=c.Cd[c.Xl],h=b[g.id];if(!w(g))if(0==g.status&&(g.status=1,g.Us=performance.now(),g.Qn(0,0)),e(g)){var k=g,m=k.pe.length;do{var q=x.Ya(k.zd,k.pe[0]),u=f(k,q,h);q.Ta==a.we&&(k.En=!0);q=k.pe.shift();k.pe.push(q);m--}while(!u&&
0!=m)}else k=c,m=g,m.Nl(h,m),m.status=3,k.pj--,n(m);c.Rn&&(c.Xl=(c.Xl+1)%c.Cd.length);if(g.En){g.En=!1;break}}while(16>performance.now()-d)}};a.Lo=function(a){var b=r;a.Nl(null,a);a.status=3;b.pj--;n(a);a.status=4;0===a.id&&(b.Rn=!0);a.jr(a.id,!1)};a.HE=q;a.us=function(a,b){var c=m(a,b);null!==c&&u(c)};a.jB=w;a.is_primary_loaded=function(a){var b=r;if(!b)return!1;a|=0;return b.Cd[a]&&(3==b.Cd[a].status||2==b.Cd[a].status)};a.cleanup=function(){r=null}};b4w.module.__nla=function(a,p){function b(){return{type:"CLIP",I:0,U:0,le:!1,paused:!1,uf:"",Vh:"",Ib:0,Th:0,Sh:0,Xp:0,Wp:0,Ch:!1,gt:!1,scale:1,repeat:1}}function d(a,b){if(a.animation_data){var c=a.animation_data.nla_tracks;if(c)for(var e=0;e<c.length;e++)b.push(c[e])}c=a.nodes;for(e=0;e<c.length;e++){var f=c[e];f.node_group&&(f=f.node_group.node_tree)&&d(f,b)}}function c(a,b){for(var c=a.b4w_nla_script,d=b.Ye,e=0;e<c.length;e++){var f=c[e];switch(f.type){case "PLAY":d.push({type:"PLAY",I:f.frame_range[0],
U:f.frame_range[1],Pe:!1});break;case "SELECT":case "SELECT_PLAY":var g=A.rd(A.sf,f.object,0),h=A.jy(a),k=h.indexOf(g);if(-1==k){r.error("NLA script error: non-selectable object");return}for(var f={type:f.type,zs:"SELECT"==f.type?f.target_slot:e+1,FA:e+1,Ze:-1,dA:h.length,cA:k,I:f.frame_range[0],U:f.frame_range[1],Pe:!1},k=[],l=0;l<h.length;l++)k.push(B.create_selection_sensor(h[l],!0));B.create_sensor_manifold(g,"NLA_SELECT_"+e,B.CT_SHOT,k,B.Vw,function(a,c,d,e){if(!(b.Cb>=b.Ye.length)&&(d=b.Ye[b.Cb],
"SELECT"==d.type||"SELECT_PLAY"==d.type&&!d.Pe)){for(d=0;d<e.dA;d++)if(B.get_sensor_value(a,c,d)&&d==e.cA){e.Ze=1;return}e.Ze=0}},f);d.push(f);break;case "JUMP":d.push({type:"JUMP",Ln:f.target_slot});break;case "CONDJUMP":d.push({type:"CONDJUMP",Ln:f.target_slot,dw:f.condition,Qi:f.register1,Ri:f.register2,on:f.number1,pn:f.number2});break;case "REGSTORE":d.push({type:"REGSTORE",Jz:f.registerd,pz:f.number1});break;case "MATH":d.push({type:"MATH",rz:f.operation,Qi:f.register1,Ri:f.register2,on:f.number1,
pn:f.number2,oh:f.registerd});break;case "SHOW":case "HIDE":g=A.rd(A.sf,f.object,0);d.push({type:f.type,obj:g});break;case "REDIRECT":d.push({type:"REDIRECT",url:f.url});break;case "PAGEPARAM":d.push({type:"PAGEPARAM",tz:f.param_name,oh:f.registerd});break;case "NOOP":d.push({type:"NOOP"})}}}function e(a,b,c,d){if(a.Ye.length){if(a.Cb>=a.Ye.length)if(a.cyclic)a.Cb=0;else{a.ra-=l.Ha*c;return}var h=g(a,b,!1,d),k=a.Ye[a.Cb];switch(k.type){case "PLAY":k.Pe?h>=k.U&&(k.Pe=!1,a.Cb++,e(a,b,c,d)):(a.ra+=k.I-
h,k.Pe=!0,f(a,k));break;case "SELECT":case "SELECT_PLAY":-1<k.Ze?"SELECT"==k.type||"SELECT_PLAY"==k.type&&0==k.Ze?(a.Cb=k.Ze?k.zs:k.FA,k.Ze=-1,e(a,b,c,d)):k.Pe?h>=k.U&&(k.Pe=!1,a.Cb=k.zs,k.Ze=-1,e(a,b,c,d)):(a.ra+=k.I-h,k.Pe=!0,f(a,k)):a.ra-=l.Ha*c;break;case "JUMP":a.Cb=k.Ln;e(a,b,c,d);break;case "CONDJUMP":var h=-1==k.Qi?k.on:a.ud[k.Qi],m=-1==k.Ri?k.pn:a.ud[k.Ri],n=!1;switch(k.dw){case "EQUAL":h==m&&(n=!0);break;case "NOTEQUAL":h!=m&&(n=!0);break;case "LESS":h<m&&(n=!0);break;case "GREATER":h>m&&
(n=!0);break;case "LEQUAL":h<=m&&(n=!0);break;case "GEQUAL":h>=m&&(n=!0)}n?a.Cb=k.Ln:a.Cb++;e(a,b,c,d);break;case "REGSTORE":a.ud[k.Jz]=k.pz;a.Cb++;e(a,b,c,d);break;case "MATH":h=-1==k.Qi?k.on:a.ud[k.Qi];m=-1==k.Ri?k.pn:a.ud[k.Ri];switch(k.rz){case "ADD":a.ud[k.oh]=h+m;break;case "MUL":a.ud[k.oh]=h*m;break;case "SUB":a.ud[k.oh]=h-m;break;case "DIV":0==m&&F.pa("Division by zero in NLA script"),a.ud[k.oh]=h/m}a.Cb++;e(a,b,c,d);break;case "SHOW":A.show_object(k.obj);a.Cb++;e(a,b,c,d);break;case "HIDE":A.hide_object(k.obj);
a.Cb++;e(a,b,c,d);break;case "REDIRECT":window.location.href=k.url;a.Ye.length=0;break;case "PAGEPARAM":a:{h=location.href.toString();if(-1!=h.indexOf("?"))for(h=h.split("?")[1].split("&"),m=0;m<h.length;m++)if(n=h[m].split("="),1<n.length&&n[0]==k.tz){h=Number(n[1]);break a}h=0}a.ud[k.oh]=h;a.Cb++;e(a,b,c,d);break;case "NOOP":a.Cb++,e(a,b,c,d)}}}function f(a,b){for(var c=a.Ye,d=0;d<c.length;d++){var e=c[d];e!=b&&(e.Ze=-1)}}function g(a,b,c,d){b=(b-d)*l.Ha+a.ra-a.I;a.cyclic&&c&&(b%=a.U-a.I+1);return b+=
a.I}function k(a,b){a=F.clamp(a,b.I,b.U);var c=a-b.I,d=(b.U-b.I)/b.repeat,c=c/d&&0==c%d?b.Sh:b.Th+c%d/b.scale;b.gt&&(c=b.Sh-c+b.Th);return c}function q(a,b,c){b?C.pause_video(a.name,c):(C.reset_video(a.name,c),C.play_video(a.name,c))}function h(a,c){for(var d=[],e=0;e<a.length;e++){var f=a[e].strips;if(f)for(var g=0;g<f.length;g++){var h=f[g],k=b();k.type=h.type;k.I=h.frame_start;k.U=h.frame_end;k.Ib=c;k.Th=h.action_frame_start;k.Sh=h.action_frame_end;k.gt=h.use_reverse;k.scale=h.scale;k.repeat=h.repeat;
h.action&&(k.uf=h.action.name,k.Vh=h.action.uuid);d.push(k)}}return d}function m(a){return t.fe(a)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function u(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c=c.use_nodes&&d)a:{if(d.animation_data&&(c=d.animation_data.nla_tracks)&&c.length){c=!0;break a}d=d.nodes;for(c=0;c<d.length;c++);c=!1}if(c)return!0}return!1}function n(a,b){var c=A.get_active();
c.fa&&(c.fa.ra-=g(c.fa,b,!0,K)-a,c.fa.rm=!0)}var w=p("__animation"),x=p("__camera"),B=p("__controls"),y=p("__config");p("__loader");var r=p("__print"),A=p("__scenes"),t=p("__sfx"),F=p("__util"),C=p("__textures"),l=y.Nd,H=y.o,J=[],K=-1;a.HB=function(a,e,f){e={I:a.frame_start,U:a.frame_end,ra:0,yi:-1,zn:a.frame_end,An:a.frame_start,Jh:null,pc:f,cyclic:e,je:[],L:[],Ye:[],wi:!1,rm:!1,AE:a.name,Cb:0,ud:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}};a.fa=e;c(a,e);for(var g=A.Ia(a,"ALL",A.DATA_ID_ALL),k=0;k<
g.length;k++){var l=g[k],n=0,q=[];if((f=l.animation_data)&&f.nla_tracks.length){var u=f.nla_tracks;if(F.is_armature(l)||x.is_camera(l)||F.is_mesh(l)||F.ck(l)||t.fe(l))u=h(u,n),u.length&&(q=q.concat(u),n++)}m(l)&&(u=l.data.animation_data.nla_tracks,u=h(u,n),u.length&&(q=q.concat(u),n++));if(w.wy(l)){var p=l.data.materials;for(f=0;f<p.length;f++){var B=p[f].node_tree;if(B&&(u=[],d(B,u),u=h(u,n),u.length)){for(var B=n,y=u,C=w.mq(),K=[],v=0,Z=0;Z<y.length;Z++){var la=y[Z];""!=la.Vh?la=F.keysearch("uuid",
la.Vh,C):(la=la.uf,la=F.keysearch("name",la,C)||F.keysearch("name",la+"_B4W_BAKED",C));var la=la.fcurves,V=[],ha;for(ha in la)V.push(ha);K.push(V)}for(Z=0;Z<K.length;Z++){C=!1;for(la=0;la<Z;la++)if(F.pv(K[Z],K[la])){y[Z].Ib=y[la].Ib;C=!0;break}C||(y[Z].Ib=n+v++)}n=B+v;q=q.concat(u)}}}for(f=0;f<l.particle_systems.length;f++)u=l.particle_systems[f],p=u.settings,"EMITTER"==p.type&&p.b4w_allow_nla&&(p=b(),p.type="CLIP",p.I=e.I,p.U=e.U+1,p.uf=u.name,p.Ib=n,p.Th=p.I,p.Sh=p.U,q.push(p),n++);u=n+1;if(F.is_mesh(l)&&
l.data)for(f=0;f<l.data.b4w_vertex_anim.length;f++)B=l.data.b4w_vertex_anim[f],B.allow_nla&&(n=u,p=b(),p.type="CLIP",p.I=e.I,p.U=e.U+1,p.uf=B.name,p.Ib=n,p.Th=p.I,p.Sh=p.U,q.push(p));q.length&&(l.dl=q,e.je.push(l))}a=a.d.Kh;for(f=0;f<a.length;f++)if(ha=a[f].d,ha.La||ha.qh)p=b(),p.type="VIDEO",g=1,H.Sc&&(g=ha.ac),p.I=Math.min(ha.I*g,e.U),p.U=ha.vg?e.U:Math.min((ha.Ug+ha.I+ha.ra)*g,e.U),p.uf=a[f].name,ha.Nu=p,e.L.push(ha);a=e.I;f=e.U;for(ha=0;ha<e.je.length;ha++)for(g=e.je[ha],k=g.dl,l=0;l<k.length;l++)q=
k[l],p=g.name+" ["+q.I+":"+q.U+"]",q.I=Math.max(a,q.I),q.U=Math.min(f+1,q.U),q.I>q.U?(r.warn("NLA: out of scene range: "+p),k.splice(l,1),l--):q.uf||"CLIP"!=q.type||(r.warn('NLA: no action in strip for object "'+g.name+'".'),k.splice(l,1),l--);for(a=0;a<e.je.length;a++)for(f=e.je[a].dl,ha=0;ha<f.length;ha++){g=f[ha];k=e.I;l=e.U+1;for(q=0;q<f.length;q++)p=f[q],g.Ib==p.Ib&&(p.U<=g.I&&(k=g.I),p.I>=g.U&&(l=Math.min(l,p.I)));g.Xp=k;g.Wp=l}J.push(e)};a.start=function(){K=0};a.update=function(a,b){if(!(0>
K)){0==K&&(K=a);for(var c=0;c<J.length;c++){var d=J[c];if(d.wi&&(d.ra-=l.Ha*b,!d.rm))continue;d.rm=!1;e(d,a,b,K);var f=g(d,a,!0,K);if(f>=d.zn+1)if(d.cyclic)d.Jh&&d.Jh(),n(d.An,a),f=g(d,a,!0,K);else{d.wi=!0;d.Jh&&d.Jh();continue}for(var h=0;h<d.je.length;h++){for(var m=d.je[h],u=m.dl,p=0;p<u.length;p++){var r=u[p];"SOUND"==r.type&&f<d.yi-1E-6&&(r.le=!1)}for(p=0;p<u.length;p++)switch(r=u[p],r.type){case "CLIP":if(r.Xp<=f&&f<r.Wp&&!r.le){var x=m,B=r;""!=B.Vh?w.iv(x,B.Vh,B.Ib):w.apply(x,B.uf,B.Ib);w.set_behavior(x,
w.AB_FINISH_STOP,B.Ib);var y=k(B.I,B);w.set_current_frame_float(x,y,B.Ib);for(x=0;x<u.length;x++)u[x]!=r&&u[x].Ib==r.Ib&&(u[x].le=!1);r.le=!0}r.le&&(x=m,B=k(f,r),y=w.get_current_frame_float(x,r.Ib),1E-6<Math.abs(B-y)&&w.set_current_frame_float(x,B,r.Ib));break;case "SOUND":(f<d.yi-1E-6||d.yi<r.I)&&r.I<=f&&f<r.U&&!r.le&&(t.play(m,(r.I-f)/l.Ha,(r.U-r.I)/l.Ha),r.le=!0),d.yi<r.U&&r.U<=f&&r.le&&(r.le=!1)}}for(h=0;h<d.L.length;h++)r=d.L[h].Nu,r.I<=Math.round(f)&&Math.round(f)<r.U&&!r.Ch&&(q(d.L[h],r.Ch,
d.pc),r.Ch=!0),r.U<=Math.round(f)&&r.Ch&&(q(d.L[h],r.Ch,d.pc),r.Ch=!1);d.yi=f}}};a.cleanup=function(){J.length=0;K=-1};a.Kq=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||m(a)||u(a)?!0:!1};a.set_frame=n;a.get_frame=function(a){var b=A.get_active();return b.fa?g(b.fa,a,!0,K):-1};a.WA=function(){var a=A.get_active();a.fa&&(a.fa.wi=!0)};a.yz=function(a){var b=A.get_active();b.fa&&(b.fa.wi=!1,b.fa.Jh=a?a:null)};a.get_frame_start=function(){var a=A.get_active();return a.fa?a.fa.I:-1};
a.get_frame_end=function(){var a=A.get_active();return a.fa?a.fa.U:-1};a.is_play=function(){var a=A.get_active();return a.fa?!a.fa.wi:!1};a.check_nla=function(){var a=A.get_active();return a.fa?a.b4w_use_nla:!1};a.check_nla_scripts=function(){var a=A.get_active();return a.fa?0<a.b4w_nla_script.length:!1};a.set_range=function(a,b){var c=A.get_active();if(c.fa)c.fa.An=a,c.fa.zn=b;else return!1};a.reset_range=function(){var a=A.get_active();if(a.fa)a=a.fa,a.An=a.I,a.zn=a.U;else return!1};a.set_cyclic=
function(a){var b=A.get_active();if(b.fa)b.fa.cyclic=a;else return!1};a.clear_callback=function(){var a=A.get_active();a.fa&&(a.fa.Jh=null)}};b4w.module.__camera=function(a,p){function b(b){b=b.d;switch(b.ua){case a.MS_TARGET_CONTROLS:b.$g=R.dist(b.h,b.Lb);b.ah=b.G[0].top;break;case a.MS_HOVER_CONTROLS:b.Ua&&(b.$g=R.dist(b.h,b.Sb),b.ah=b.G[0].top)}}function d(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),Qa:new Float32Array([0,0,0,0]),Pa:new Float32Array([0,0,0,0])}}function c(b){switch(b){case "STATIC":return a.MS_STATIC;case "TARGET":return a.MS_TARGET_CONTROLS;
case "EYE":return a.MS_EYE_CONTROLS;case "HOVER":return a.MS_HOVER_CONTROLS;default:throw"Unknown move style";}}function e(b){var c={type:b,name:"",ef:1,width:0,height:0,be:null,eb:null,Lc:null,wa:0,sc:0,Qa:0,Pa:0,left:0,right:0,top:0,bottom:0,Ke:new Float32Array(3),aq:new Float32Array(3),quat:new Float32Array(4),ma:new Float32Array(16),VC:new Float32Array(16),sa:new Float32Array(16),Lh:new Float32Array(16),Fz:new Float32Array(16),xd:new Float32Array(16),ss:new Float32Array(16),Ed:new Float32Array(16),
dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,Yd:null,dof_on:0,Qj:d(),Xi:0,Ad:0,ec:null,ci:null,Tl:null,Ip:new Float32Array(4),xk:new Float32Array(4)};if(b==a.tb)return c;switch(b){case a.Hb:q(c,40,.1,1E3);break;case a.Hc:q(c,2.5,.1,1E3);break;case a.Jd:break;case a.xe:break;case a.tf:break;case a.ub:case a.Bb:throw"Stereo camera may only be created from perspective one";default:throw"Unknown camera type";}return c}function f(b,c,d){if(b.type!=a.ub&&b.type!=a.Bb)throw"set_stereo_params(): wrong camera type";
b.Xi=c;b.Ad=d;C(b,b.wa);if(X.ga())for(c=X.get_active(),b=c.d.wd,c=X.Rj(c).d.G,d=0;d<c.length;d++)P(c[d],b)}function g(a,b){return k(a.d.quat,b)}function k(a,b){var c=Y.quat_to_dir(a,Y.AXIS_Y,V),d=Y.quat_to_dir(a,Y.AXIS_Z,ha),e=-Math.asin(c[1]/R.length(c)),c=Math.abs(e)>Math.PI/4?R.scale(d,-Y.sign(e),ea):R.scale(c,-Y.sign(d[1]),ea),f=Math.atan(Math.abs(c[0]/c[2]));0<d[1]&&(e=Y.sign(e)*Math.PI-e);d=f;0>c[2]&&(d=Math.PI-d);0>c[0]&&(d=2*Math.PI-d);b[0]=d;b[1]=e;return b}function q(b,c,d,e,f){switch(b.type){case a.Hb:case a.ub:case a.Bb:b.sc=
c;b.wa=1;break;case a.Hc:b.top=c;b.wa=1;break;case a.Jd:delete b.sc;b.sc=c;b.wa=f/c;break;case a.xe:b.top=c;b.wa=f/c;break;default:W.error("set_frustum(): Unsupported camera type: "+b.type)}b.Qa=d;b.Pa=e}function h(b,c){var d=c.d.h,e=c.d.quat,f=sa;v.rotateX(c.d.T,-Math.PI/2,f);v.invert(f,b.ma);if(b.ec){var f=b.ec[0],g=b.ec[1],h=b.ec[2],k=b.ec[3],m=sa;m[0]=1-2*f*f;m[1]=-2*f*g;m[2]=-2*f*h;m[3]=0;m[4]=-2*f*g;m[5]=1-2*g*g;m[6]=-2*g*h;m[7]=0;m[8]=-2*f*h;m[9]=-2*g*h;m[10]=1-2*h*h;m[11]=0;m[12]=-2*f*k;m[13]=
-2*g*k;m[14]=-2*h*k;m[15]=1;v.multiply(b.ma,m,b.ma);C(b,b.wa,!0);f=S;g=sa;v.invert(b.ma,g);v.transpose(g,g);ga.transformMat4(b.ec,g,f);g=fa;g[0]=(Y.sign(f[0])+b.sa[8])/b.sa[0];g[1]=(Y.sign(f[1])+b.sa[9])/b.sa[5];g[2]=-1;g[3]=(1+b.sa[10])/b.sa[14];ga.scale(f,2/(f[0]*g[0]+f[1]*g[1]+f[2]*g[2]+f[3]*g[3]),f);b.sa[2]=f[0];b.sa[6]=f[1];b.sa[10]=f[2]+1;b.sa[14]=f[3]}b.type==a.ub?b.ma[12]+=b.Ad/2:b.type==a.Bb&&(b.ma[12]-=b.Ad/2);v.multiply(b.sa,b.ma,b.Ed);H(b);l(b);R.copy(b.Ke,b.aq);R.copy(d,b.Ke);ja.copy(e,
b.quat)}function m(b,c,d,e){v.lookAt(c,d,e,b.ma);b.type==a.ub?b.ma[12]+=b.Ad/2:b.type==a.Bb&&(b.ma[12]-=b.Ad/2);v.multiply(b.sa,b.ma,b.Ed);H(b);l(b);R.copy(c,b.Ke)}function u(a){var b=a.d.G;if(!b)throw"Wrong object";for(var c=a.d,d=0;d<b.length;d++){var e=b[d];h(e,a);Y.jm(e.Ed,e.Qj);if(e.Yd)if(e.dof_on){var f=R.dist(c.h,e.Yd.location);e.dof_distance=f}else e.dof_distance=0}}function n(b){b=b.d;if(b.ua==a.MS_TARGET_CONTROLS){var c=Y.quat_to_dir(b.quat,Y.AXIS_Z,V);b.Xn=0<c[1]}}function w(b,c){var d=
b.d,e=d.Rb;!e||d.ua!=a.MS_EYE_CONTROLS&&d.ua!=a.MS_TARGET_CONTROLS||(c&&(d=g(b,Z),e.left+=d[0],e.right+=d[0]),e.left=Y.angle_wrap_0_2pi(e.left),e.right=Y.angle_wrap_0_2pi(e.right))}function x(b,c){var d=b.d,e=d.fd;!e||d.ua!=a.MS_EYE_CONTROLS&&d.ua!=a.MS_TARGET_CONTROLS||(c&&(d=g(b,Z),e.Za+=d[1],e.Oa+=d[1]),e.Za=Y.angle_wrap_periodic(e.Za,-Math.PI,Math.PI),e.Oa=Y.angle_wrap_periodic(e.Oa,-Math.PI,Math.PI))}function B(b){var c=b.d;if(K(b)&&c.G[0].type===a.Hc){if(c.ua===a.MS_TARGET_CONTROLS)var d=R.dist(c.h,
c.Lb),c=d/c.$g*c.ah;else c.Ua&&c.ua===a.MS_HOVER_CONTROLS?(d=R.distance(c.h,c.Sb),c=d/c.$g*c.ah):c=b.d.G[0].top;for(var e in b.d.G)d=b.d.G[e],d.top=c,C(d,d.wa);u(b)}}function y(a,b,c,d,e){var f=a.d,h=b,k=c;if(d||e)a=g(a,la),d&&(h=b-a[0]),e&&(k=c-a[1]);if(h||k)b=ja.identity(pa),h&&(h=ja.setAxisAngle(Y.AXIS_Y,h,U),ja.multiply(b,h,b)),k&&(h=Y.quat_to_dir(f.quat,Y.AXIS_X,V),k=ja.setAxisAngle(h,k,U),ja.normalize(k,k),ja.multiply(b,k,b)),ja.multiply(b,f.quat,f.quat)}function r(a,b,c,d,e){var f=a.d,h=b,
k=c;if(d||e){var l=g(a,la);d&&(h=b-l[0]);e&&(k=c-l[1])}t(a,a.d.Lb,h,k);a=g(a,la);a=Y.angle_wrap_periodic(a[1],-Math.PI,Math.PI);f.Xn=Math.abs(a)>Math.PI/2}function A(a,b,c,d,e){var f=a.d,h=b,k=c;if(d||e){var l=g(a,la);d&&(h=b-l[0]);e&&(k=c-l[1])}f.dm||(h=0);t(a,f.Sb,h,k);k&&F(a)}function t(a,b,c,d){var e=a.d;if(c||d){var f=ja.identity(pa);c&&(c=ja.setAxisAngle(Y.AXIS_Y,c,U),ja.multiply(f,c,f));a=I(a);d&&(!a||a&&e.Ua)&&(a=Y.quat_to_dir(e.quat,Y.AXIS_X,V),d=ja.setAxisAngle(a,d,U),ja.normalize(d,d),
ja.multiply(f,d,f));Y.Vz(e.h,b,f,e.h);ja.multiply(f,e.quat,e.quat)}}function F(a){var b=a.d;if(b.Ua){var c=g(a,Z)[1];a=a.d;a.xb.Oa-a.xb.Za?(c=(a.xb.Oa-c)/(a.xb.Oa-a.xb.Za),c=Math.max(c,0)):c=0;c=c*(a.Gf-a.Xd)+a.Xd;a=Y.quat_to_dir(b.quat,Y.AXIS_MY,V);R.normalize(a,a);R.scale(a,c,a);R.subtract(b.Sb,a,b.h)}}function C(b,c,d){switch(b.type){case a.Hb:if(!c)throw"No aspect ratio";b.wa=c;case a.Jd:v.perspective(Y.Bk(b.sc),b.wa,b.Qa,b.Pa,b.sa);break;case a.Hc:if(!c)throw"No aspect ratio";b.wa=c;case a.xe:c=
b.top*b.wa;v.ortho(-c,c,-b.top,b.top,b.Qa,b.Pa,b.sa);break;case a.tf:v.ortho(b.left,b.right,b.bottom,b.top,b.Qa,b.Pa,b.sa);break;case a.ub:case a.Bb:if(!c)throw"No aspect ratio";b.wa=c;var e=Math.tan(b.sc*Math.PI/360);c=b.Qa*e;var f=b.wa*b.Xi*e;b.type==a.ub?(e=f-b.Ad/2,f+=b.Ad/2):(e=f+b.Ad/2,f-=b.Ad/2);e=-(b.Qa/b.Xi*e);f*=b.Qa/b.Xi;v.frustum(e,f,-c,c,b.Qa,b.Pa,b.sa);b.left=e;b.right=f;break;case a.tb:return;default:throw"Wrong camera type: "+b.type;}d||(v.multiply(b.sa,b.ma,b.Ed),H(b),l(b))}function l(a){v.copy(a.ma,
a.xd);a.xd[12]=0;a.xd[13]=0;a.xd[14]=0;a.xd[15]=1;v.multiply(a.sa,a.xd,a.xd);v.invert(a.xd,a.xd)}function H(a){v.copy(a.ma,a.Lh);v.multiply(a.sa,a.Lh,a.Lh);v.invert(a.Lh,a.Lh)}function J(b,c,d,e,f){e||(e=new Float32Array(24));c||(c=b.Qa);d||(d=b.Pa);var g,h,k,l,m,n,q,u;switch(b.type){case a.tb:throw"Extraction from NONE camera is not possible";case a.Hb:case a.Jd:g=c*Math.tan(b.sc*Math.PI/360);l=-g;h=g*b.wa;k=-h;m=d/c*g;u=-m;n=m*b.wa;q=-n;break;case a.Hc:case a.xe:k=b.top*b.wa;g=m=b.top;h=n=k;l=u=
-b.top;k=q=-k;break;case a.tf:g=m=b.top;h=n=b.right;l=u=b.bottom;k=q=b.left;break;case a.ub:case a.Bb:m=c/b.Qa;g=c*Math.tan(b.sc*Math.PI/360);l=-g;h=b.right*m;k=b.left*m;q=d/c;m=g*q;u=-m;n=h*q;q*=k;break;default:throw"Wrong camera type: "+b.type;}e[0]=k;e[1]=l;e[2]=-c;e[3]=h;e[4]=l;e[5]=-c;e[6]=h;e[7]=g;e[8]=-c;e[9]=k;e[10]=g;e[11]=-c;e[12]=q;e[13]=u;e[14]=-d;e[15]=q;e[16]=m;e[17]=-d;e[18]=n;e[19]=m;e[20]=-d;e[21]=n;e[22]=u;e[23]=-d;f&&(c=sa,v.invert(b.ma,c),Y.We(e,c,e,0));return e}function K(a){return"CAMERA"===
a.type?!0:!1}function I(b){return K(b)&&b.d&&b.d.ua==a.MS_HOVER_CONTROLS?!0:!1}function P(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.ci){var d=b.csm_num;a.ci=Array(d);for(var e=0;e<d;e++)a.ci[e]=new Float32Array(3);a.Tl=new Float32Array(d)}for(d=0;d<c;d++){var e=0==d?a.Qa:z(b,a,d-1),f=z(b,a,d),e=J(a,e,f,ra),e=G.ey(e);a.ci[d].set(e.F);a.Tl[d]=e.Da;a.Ip[d]=R.length(e.F);a.xk[d]=N(b.first_cascade_blur_radius,b.last_cascade_blur_radius,c,d)}}else a.xk[0]=b.first_cascade_blur_radius}function z(a,b,c){var d=
a.csm_num,e=Y.clamp(a.csm_first_cascade_border,b.Qa,b.Pa);a=Y.clamp(a.csm_last_cascade_border,b.Qa,b.Pa);return Y.clamp(N(e,a,d,c),b.Qa,b.Pa)}function N(a,b,c,d){switch(d){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,d/(c-1))}return a}var G=p("__boundings");p("__config");var L=p("__constraints"),O=p("__container"),W=p("__print"),X=p("__scenes"),Y=p("__util"),R=p("vec3"),ga=p("vec4"),ja=p("quat"),qa=p("mat3"),v=p("mat4");a.tb=10;a.Hb=20;a.Hc=30;a.Jd=40;a.xe=50;a.tf=60;a.ub=70;a.Bb=
80;a.MS_STATIC=0;a.MS_TARGET_CONTROLS=2;a.MS_EYE_CONTROLS=3;a.MS_HOVER_CONTROLS=4;var Z=new Float32Array(2),la=new Float32Array(2),V=new Float32Array(3),ha=new Float32Array(3),ea=new Float32Array(3),pa=new Float32Array(4),U=new Float32Array(4),S=new Float32Array(4),fa=new Float32Array(4),ia=new Float32Array(16),sa=new Float32Array(16),ra=new Float32Array(24);a.Iv=function(d){var f=d.d,h=d.data;switch(h.type){case "PERSP":var k=e(a.Hb);if(h.angle_y)var l=h.angle_y/Math.PI*180;q(k,l,h.clip_start,h.clip_end);
break;case "ORTHO":k=e(a.Hc),q(k,h.ortho_scale/2,h.clip_start,h.clip_end)}k.name=d.name;f.Ys=!1;f.ua=c(h.b4w_move_style);f.dof_distance=d.data.dof_distance;f.Yd=d.data.dof_object;f.dof_front=d.data.b4w_dof_front;f.dof_rear=d.data.b4w_dof_rear;f.dof_power=d.data.b4w_dof_power;f.dm=d.data.b4w_enable_hover_hor_rotation;f.G=[k];f.mo=d.data.b4w_trans_velocity;f.lo=d.data.b4w_rot_velocity;f.no=d.data.b4w_zoom_velocity;f.ua==a.MS_TARGET_CONTROLS&&(f.Lb.set(h.b4w_target),n(d));h=d.d;l=h.ua;if(l===a.MS_TARGET_CONTROLS||
l===a.MS_EYE_CONTROLS||l===a.MS_HOVER_CONTROLS){var m=d.data,u=null,t=null,p=null;l===a.MS_TARGET_CONTROLS||l===a.MS_EYE_CONTROLS?(m.b4w_use_panning&&(h.ft=m.b4w_use_panning),m.b4w_use_horizontal_clamping&&(u={left:m.b4w_rotation_left_limit,right:m.b4w_rotation_right_limit}),m.b4w_use_vertical_clamping&&(t={Oa:m.b4w_rotation_down_limit,Za:m.b4w_rotation_up_limit}),l===a.MS_TARGET_CONTROLS&&(h.Ua=m.b4w_use_distance_limits&&m.b4w_distance_min<=m.b4w_distance_max,h.Ua&&(h.Xd=m.b4w_distance_min,h.Gf=
m.b4w_distance_max))):l===a.MS_HOVER_CONTROLS&&(m.b4w_use_horizontal_clamping&&m.b4w_horizontal_translation_min<=m.b4w_horizontal_translation_max&&(u={left:m.b4w_horizontal_translation_min,right:m.b4w_horizontal_translation_max}),m.b4w_use_vertical_clamping&&m.b4w_vertical_translation_min<=m.b4w_vertical_translation_max&&(t={Oa:m.b4w_vertical_translation_min,Za:m.b4w_vertical_translation_max}),h.Ua=m.b4w_use_distance_limits&&m.b4w_hover_angle_min<=m.b4w_hover_angle_max&&m.b4w_distance_min<=m.b4w_distance_max,
h.Ua&&(p={Oa:m.b4w_hover_angle_min,Za:m.b4w_hover_angle_max},h.Xd=m.b4w_distance_min,h.Gf=m.b4w_distance_max));var r=u;r&&l==a.MS_EYE_CONTROLS&&(r.left*=-1,r.right*=-1);if(r=t)switch(l){case a.MS_TARGET_CONTROLS:r.Oa*=-1;r.Za*=-1;break;case a.MS_HOVER_CONTROLS:var U=-r.Oa;r.Oa=-r.Za;r.Za=U}(r=p)&&l==a.MS_HOVER_CONTROLS&&(r.Oa*=-1,r.Za*=-1);h.Rb=u;h.fd=t;h.xb=p;w(d,"LOCAL"==m.b4w_horizontal_clamping_type);x(d,"LOCAL"==m.b4w_vertical_clamping_type)}if(f.ua===a.MS_HOVER_CONTROLS)if(f=d.d,f.Ua){h=d.d;
l=Y.quat_to_dir(h.quat,Y.AXIS_MY,V);m=S;m.set(Y.AXIS_Y);m[3]=0;l=Y.line_plane_intersect(m,0,h.h,l,h.Sb);if(!l||100<R.len(l))h.Sb[0]=h.h[0],h.Sb[1]=0,h.Sb[2]=h.h[2];h=g(d,Z);f=Y.Ce(h[1],f.xb.Za,f.xb.Oa);0<h[1]&&W.warn("Active hover camera has wrong orientation");f?A(d,0,f):F(d)}else f.dm=!1;k.type==a.Hc&&b(d)};a.Dy=b;a.tw=d;a.kb=e;a.WC=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.eb);case "DEPTH":return Boolean(a.Lc);case "SCREEN":return!Boolean(a.eb)&&!Boolean(a.Lc);default:throw"Wrong attachment type: "+
b;}};a.Gk=function(a,b,c){switch(b){case "COLOR":case "CUBEMAP":a.eb=c;break;case "DEPTH":a.Lc=c;break;case "SCREEN":a.eb=null;a.Lc=null;break;default:throw"Wrong attachment type: "+b;}};a.ID=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.eb;case "DEPTH":return a.Lc;case "SCREEN":return null;default:throw"Wrong attachment type: "+b;}};a.lr=function(b,c){if(b.type!=a.Hb||c!=a.ub&&c!=a.Bb)throw"make_stereo(): wrong camera type";b.type=c;f(b,6,.065)};a.rA=f;a.get_camera_angles=g;a.oq=k;
a.get_camera_angles_char=function(a,b){g(a,b);b[0]=Y.angle_wrap_0_2pi(b[0]+Math.PI);b[1]*=-1;return b};a.get_angles=function(a,b){var c=a.d,d=Y.quat_to_dir(c.quat,Y.AXIS_MY,V),e=Math.asin(d[1]/R.length(d));0==d[0]&&0==d[2]?c=0:(Math.abs(e)>Math.PI/4&&(d=0>=e?Y.quat_to_dir(c.quat,Y.AXIS_MZ,ha):Y.quat_to_dir(c.quat,Y.AXIS_Z,ha)),c=Math.atan(Math.abs(d[0]/d[2])),0<d[2]&&(c=Math.PI-c),0<d[0]&&(c=2*Math.PI-c));b[0]=c;b[1]=e;return b};a.Hk=q;a.jA=function(b,c,d,e,f,g,h){switch(b.type){case a.tf:b.left=
c;b.right=d;b.bottom=e;b.top=f;b.Qa=g;b.Pa=h;break;default:W.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.get_move_style=function(a){return a.d.ua};a.vA=h;a.BE=m;a.ps=function(a,b,c){var d=V;d[0]=0;d[1]=-1;d[2]=0;R.transformQuat(d,c,d);d[0]+=b[0];d[1]+=b[1];d[2]+=b[2];var e=ha;e[0]=0;e[1]=0;e[2]=-1;R.transformQuat(e,c,e);m(a,b,d,e)};a.rx=function(a,b,c,d,e){d[0]=a[0];d[1]=a[1];d[2]=a[2];v.lookAt(a,b,c,sa);v.invert(sa,sa);v.rotateX(sa,Math.PI/2,sa);qa.fromMat4(sa,ia);ja.fromMat3(ia,
e)};a.zB=u;a.yB=function(b){var c=b.d,d=b.d;if(d.ua===a.MS_TARGET_CONTROLS||d.ua===a.MS_EYE_CONTROLS){if(d.Rb){var e=d.Rb.left,f=d.Rb.right,h=g(b,Z);(h=d.ua==a.MS_TARGET_CONTROLS?Y.Ce(h[0],e,f):Y.Ce(h[0],f,e))&&(d.ua==a.MS_TARGET_CONTROLS?r(b,h,0):y(b,h,0))}d.fd&&(e=d.fd.Oa,f=d.fd.Za,h=g(b,Z),(h=d.ua==a.MS_TARGET_CONTROLS?Y.Ce(h[1],f,e):Y.Ce(h[1],e,f))&&(d.ua==a.MS_TARGET_CONTROLS?r(b,0,h):y(b,0,h)));d.ua===a.MS_TARGET_CONTROLS&&d.Ua&&(h=b.d,e=R.subtract(h.h,h.Lb,V),f=R.length(e),f>h.Gf?(R.scale(e,
h.Gf/f,e),R.add(h.Lb,e,h.h)):f<h.Xd&&(f=Y.quat_to_dir(h.quat,Y.AXIS_MY,ha),R.scale(f,100*h.Xd,f),R.add(e,f,e),R.scale(e,-h.Xd/R.length(e),e),R.add(h.Lb,e,h.h)))}d.ua===a.MS_HOVER_CONTROLS&&(d=b.d,h=d.Ua?d.Sb:d.h,d.Rb&&(e=Y.clamp(h[0],d.Rb.left,d.Rb.right)-h[0],h[0]+=e,d.Ua&&(d.h[0]+=e)),d.fd&&(e=Y.clamp(h[2],d.fd.Oa,d.fd.Za)-h[2],h[2]+=e,d.Ua&&(d.h[2]+=e)),d=b.d,d.Ua&&d.xb&&(h=g(b,Z)[1],h=Y.Ce(h,d.xb.Za,d.xb.Oa),Y.quat_to_dir(d.quat,Y.AXIS_MY,V),h&&A(b,0,h)));B(b);switch(c.ua){case a.MS_TARGET_CONTROLS:L.Wz(c.h,
c.quat,c.Lb);L.correct_up(b,Y.AXIS_Y);break;case a.MS_EYE_CONTROLS:b.Wa||L.correct_up(b,Y.AXIS_Y)}n(b)};a.io=n;a.Az=w;a.Ez=x;a.GB=B;a.rotate_eye_camera=y;a.rotate_target_camera=r;a.rotate_hover_camera=A;a.Cy=F;a.dE=function(b){switch(b.type){case a.Hb:case a.Hc:case a.ub:case a.Bb:return!0;default:return!1}};a.Qx=function(b){b=b.d.G[0];switch(b.type){case a.Hb:case a.Jd:case a.ub:case a.Bb:return Math.PI*b.sc/180;default:return W.error("get_min_fov(): Unsupported camera type: "+b.type),0}};a.$e=C;
a.Cl=l;a.np=H;a.px=J;a.rv=function(a){a=a.d;var b=G.Gd();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.Pb=b;var c=G.Rl(1,[0,0,0]);a.Vc=c;a.ql=G.Ep(1,b);a.sl=G.Gp(1,b);a.rl=G.Fp(1,b)};a.is_camera=K;a.is_target_camera=function(b){return K(b)&&b.d&&b.d.ua==a.MS_TARGET_CONTROLS?!0:!1};a.is_eye_camera=function(b){return K(b)&&b.d&&b.d.ua==a.MS_EYE_CONTROLS?!0:!1};a.is_hover_camera=I;a.ho=P;a.Ow=z;a.project_point=function(b,c,d){b=b.d.G[0];switch(b.type){case a.Hb:case a.Jd:case a.Hc:case a.xe:case a.ub:case a.Bb:var e=
S;e.set(c);e[3]=1;ga.transformMat4(e,b.Ed,e);c=-e[1]/e[3];d[0]=(e[0]/e[3]+1)/2*b.width;d[1]=(c+1)/2*b.height;O.eC(d[0],d[1],d,b);2<d.length&&(d[2]=(e[2]/Math.abs(e[3])+1)/2);return d;default:return W.error("Non-compatible camera"),d}};a.cy=function(a){return a.d.G[0]};a.Sj=function(b,c){switch(b.type){case a.Hb:case a.Jd:case a.ub:case a.Bb:var d=Math.tan(Y.Bk(b.sc)/2);switch(c){case "LEFT":return-d*b.wa;case "RIGHT":return d*b.wa;case "TOP":return d;case "BOTTOM":return-d}break;case a.Hc:case a.xe:switch(c){case "LEFT":return-b.top*
b.wa;case "RIGHT":return b.top*b.wa;case "TOP":return b.top;case "BOTTOM":return-b.top}break;case a.tf:switch(c){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;default:Y.pa("Unknown camera type")}};a.Qy=function(b){switch(b.type){case a.Hc:case a.xe:case a.tf:return!0;default:return!1}};a.get_fov=function(b,c){switch(b.type){case a.Hb:case a.Jd:case a.ub:case a.Bb:var d=Y.Bk(b.sc);return c?d*b.wa:d;default:return 0}}};b4w.module.__lights=function(a,p){function b(a){return{name:"",index:0,type:a,direction:new Float32Array(3),color:new Float32Array(3),Kg:new Float32Array(3),dd:0,sg:0,Nx:!1,Tp:!1,wg:!0,lf:!0,Ie:1,distance:25,sD:"INVERSE_SQUARE"}}function d(a){a.Kg[0]=a.color[0]*a.Ie;a.Kg[1]=a.color[1]*a.Ie;a.Kg[2]=a.color[2]*a.Ie}var c=p("__util"),e=p("vec3");a.XD=b;a.Ty=function(a){var g=a.data,k=b(g.type);k.name=a.name;k.wg=g.use_diffuse;k.lf=g.use_specular;var q=c.quat_to_dir(a.d.quat,c.AXIS_Y,[]);e.normalize(q,
q);k.direction[0]=q[0];k.direction[1]=q[1];k.direction[2]=q[2];k.color[0]=g.color[0];k.color[1]=g.color[1];k.color[2]=g.color[2];k.Ie=g.energy;d(k);k.distance=g.distance;if("POINT"===k.type||"SPOT"===k.type)k.distance=g.distance;"SPOT"===k.type?(k.sg=g.spot_blend,k.dd=g.spot_size):"POINT"===k.type&&(k.dd=Math.PI/2);k.Nx=g.b4w_generate_shadows;k.Tp=g.b4w_dynamic_intensity;a.na=k};a.lA=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];d(a)};a.nA=function(a,b){a.sg=b};a.mA=function(a,b){a.distance=
b};a.oA=function(a,b){a.dd=b};a.ms=function(a,b){a.Ie=b;d(a)};a.Rm=function(a){return"LAMP"===a.type?!0:!1};a.DB=function(a){if("LAMP"!=a.type)throw"Wrong light object";var b=a.na;b&&(c.quat_to_dir(a.d.quat,c.AXIS_Y,b.direction),e.normalize(b.direction,b.direction))}};b4w.module.__scenes=function(a,p){function b(){ub||(ub=d(Ea));return ub}function d(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.jd||!c.jd.length)return c}return null}function c(){if(!Ra)throw"No active scene available";return Ra}function e(a,b,c,d){for(var e=null,f=0;f<b.length;f++){var g=b[f];if((c?g.origin_name:g.name)==a&&g.d.pc==d){e=g;break}}return e}function f(a,b){b||(b="ALL");var c=[];g(a.objects,b,c);return c}function g(a,b,c){for(var d=0;d<a.length;d++){var e=a[d];"ALL"!=b&&b!=e.type||
c.push(e);(e=e.dupli_group)&&g(e.objects,b,c)}}function k(b){if(Da.Vi)switch(b.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var c=!1,d=!1;if(0==ea(b,"LAMP",a.DATA_ID_ALL).length)return!1;b=ea(b,"MESH",a.DATA_ID_ALL);for(var e=0;e<b.length;e++){var f=b[e];f.b4w_shadow_cast&&(c=!0);f.b4w_shadow_receive&&(d=!0);if(c&&d)return!0}return!1}function q(a){if(!a.va)return!1;a=a.va.LAMP;for(var b=0;b<a.length;b++)if("SUN"==a[b].na.type)return!0;return!1}function h(a){if(!Da.shore_smoothing)return!1;
a=pa(a);for(var b=0;b<a.length;b++){var c=a[b];if(c.b4w_water&&c.b4w_water_shore_smoothing)return!0}return!1}function m(b){var c=pa(b),d=[];b=ea(b,"MESH",a.DATA_ID_ALL);for(var e=0;e<c.length;e++){var f=c[e];if(f.b4w_water){for(var g={},h=0;h<b.length;h++)for(var k=b[h],E=k.data.materials,l=0;l<E.length;l++)E[l]==f&&(g.pf=k.location[1]);if(Da.gi)for(g.$b=f.b4w_water_fog_color.slice(0),g.$b.push(f.b4w_water_fog_density),f.b4w_water_dynamic?(g.Rg=!0,g.waves_height=f.b4w_waves_height,g.waves_length=
f.b4w_waves_length,g.dst_noise_scale0=f.b4w_water_dst_noise_scale0,g.dst_noise_scale1=f.b4w_water_dst_noise_scale1,g.dst_noise_freq0=f.b4w_water_dst_noise_freq0,g.dst_noise_freq1=f.b4w_water_dst_noise_freq1,g.dir_min_shore_fac=f.b4w_water_dir_min_shore_fac,g.dir_freq=f.b4w_water_dir_freq,g.dir_noise_scale=f.b4w_water_dir_noise_scale,g.dir_noise_freq=f.b4w_water_dir_noise_freq,g.dir_min_noise_fac=f.b4w_water_dir_min_noise_fac,g.dst_min_fac=f.b4w_water_dst_min_fac,g.waves_hor_fac=f.b4w_water_waves_hor_fac):
(g.Rg=!1,g.waves_height=0,g.waves_length=0),g.Dj=null,g.Fl=null,g.Gl=new Float32Array(2),g.Jk=null,f=f.texture_slots,h=0;h<f.length;h++)k=f[h].texture,"VORONOI"==k.type&&(g.Dj=k.noise_scale,g.Gl.set([.3,.7]),g.Fl=k.noise_intensity),!0===k.b4w_shore_dist_map&&(g.Jk=k.image,g.th=k.image.size[0],g.CA=k.b4w_shore_boundings,g.hh=k.b4w_max_shore_dist);else g.waves_height=0,g.waves_length=0,g.Dj=null,g.Fl=null,g.Gl=null,g.$b=null,g.Rg=!1;d.push(g)}}if(0<d.length){g=d[0];if(!g.Rg)for(e=0;e<d.length;e++)d[e].Rg&&
(g=d[e]);return g}return null}function u(a){function b(a){if(a){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d];"GROUP"==e.type&&e.node_group&&b(e.node_group.node_tree);"GROUP"==e.type&&"B4W_REFRACTION"==e.node_tree_name&&(c.fc=!0)}}}var c={fc:!1};a=pa(a);for(var d=0;d<a.length;d++){var e=a[d];e.b4w_refractive&&(c.fc=!0);e.node_tree&&b(e.node_tree)}return c}function n(b){if(Da.Ek)switch(b.b4w_render_reflections){case "OFF":return!1}else return!1;var c=[],d=0;b=ea(b,"MESH",a.DATA_ID_ALL);for(var e=
0;e<b.length;e++){var f=b[e];if(f.d.yc)if("CUBE"==f.d.ke)d++;else{var g=f.el;f.el=null;if(g){g.d||Bb.Sk(g,!1);for(var f=null,h=0;h<c.length;h++)if(c[h]==g){f=h;break}null==f&&c.push(g)}}}return{Dk:c,ur:d,Kj:[],Ki:[]}}function w(a,b){var c={},d=a.world.b4w_sky_settings;c.Oz=d.render_sky;c.procedural_skydome=d.procedural_skydome&&b;c.use_as_environment_lighting=d.use_as_environment_lighting;c.uh=d.color;c.rayleigh_brightness=d.rayleigh_brightness;c.mie_brightness=d.mie_brightness;c.spot_brightness=
d.spot_brightness;c.scatter_strength=d.scatter_strength;c.rayleigh_strength=d.rayleigh_strength;c.mie_strength=d.mie_strength;c.rayleigh_collection_power=d.rayleigh_collection_power;c.mie_collection_power=d.mie_collection_power;c.mie_distribution=d.mie_distribution;c.Vb=d.reflexible;c.Mb=d.reflexible_only;!b&&d.procedural_skydome&&Ca.warn("There is no sun on the scene. Procedural sky won't be rendered");return c}function x(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.Ay=
a.hemisphere;b.Cv=a.blur_depth;b.hp=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.Yz=a.samples;return b}function B(a){var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.ex=a.edge_lum;b.key=a.key;return b}function y(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function r(a){var b={};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;
b.saturation=a.saturation;return b}function A(a){var b={};a=a.b4w_god_rays_settings;b.Gy=a.intensity;b.gh=a.max_ray_length;b.Bh=a.steps_per_pass;return b}function t(a){var b={};b.Ue=a.b4w_outline_color;b.Fi=a.b4w_outline_factor;return b}function F(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function C(a,b){var c=
a.world,d=c.light_settings,e={};e.Je=d.environment_energy;e.jo=d.use_environment_light;e.em=d.environment_color;e.Ne=c.horizon_color.slice(0);e.rf=c.zenith_color.slice(0);e.XB=c.use_sky_paper;e.WB=c.use_sky_blend;e.YB=c.use_sky_real;e.ys=null;e.Kn=null;e.fm=null;if(e.jo&&"SKY_TEXTURE"==e.em&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var d=null,f=0;f<c.texture_slots.length;f++)if(c.texture_slots[f].texture.b4w_use_as_environment_lighting){d=c.texture_slots[f];break}d?e.fm=d:(Ca.warn("environment lighting is set to 'Sky Texture', but there is no world texture with 'Sky Texture Usage' property set to 'ENVIRONMENT_LIGHTING'"),
e.jo=!1)}for(f=0;f<c.texture_slots.length;f++)if(c.texture_slots[f].texture.b4w_use_as_skydome){c=c.texture_slots[f];e.ys=c;e.Kn={Av:c.blend_factor,By:c.horizon_factor,mC:c.zenith_up_factor,lC:c.zenith_down_factor,color:c.color,Aa:c.default_value,invert:c.invert,VB:c.use_rgb_to_intensity,fp:c.blend_type,RB:c.use_map_blend,SB:c.use_map_horizon,UB:c.use_map_zenith_up,TB:c.use_map_zenith_down};break}return e}function l(b){if(!Da.mb)return!1;var c=!1,d=!1;b=ea(b,"MESH",a.DATA_ID_ALL);for(var e=0;e<b.length;e++){for(var f=
b[e],g=f.data.materials,h=0;h<g.length;h++)g[h].b4w_terrain&&(c=!0);f=f.particle_systems;for(h=0;h<f.length;h++)g=f[h].settings,"HAIR"==g.type&&g.b4w_dynamic_grass&&(d=!0);if(c&&d)return!0}return!1}function H(b){if(ob.outlining_overview_mode)return!0;if(Da.enable_selectable)switch(b.b4w_enable_object_selection){case "OFF":return!1;case "ON":return!0;case "AUTO":b=ea(b,"MESH",a.DATA_ID_ALL);for(var c=0;c<b.length;c++)if(b[c].d.qg)return!0;return!1}else return!1}function J(b){if(ob.outlining_overview_mode)return!0;
if(Da.enable_outlining)switch(b.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":b=ea(b,"MESH",a.DATA_ID_ALL);for(var c=0;c<b.length;c++)if(b[c].d.Fb)return!0;return!1}else return!1}function K(b){if(Da.Le)switch(b.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":b=ea(b,"MESH",a.DATA_ID_ALL);for(var c=0;c<b.length;c++)for(var d=b[c].data.materials,e=0;e<d.length;e++)if(Hc.sp(d[e]))return!0;return!1}else return!1}function I(a,b){if(Da.fc)switch(a.b4w_render_refractions){case "OFF":return!1;
case "ON":return!0;case "AUTO":return b.fc}else return!1}function P(b){b=ea(b,"MESH",a.DATA_ID_ALL);for(var c=0;c<b.length;c++)for(var d=b[c].data.materials,e=0;e<d.length;e++){var f=d[e],g=f.game_settings.alpha_blend;if(f.b4w_render_above_all&&"OPAQUE"!=g&&"CLIP"!=g)return!0}return!1}function z(b){switch(b.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0}b=ea(b,"EMPTY",a.DATA_ID_ALL);for(var c=0;c<b.length;c++){var d=b[c];if(d.b4w_anchor&&d.b4w_anchor.detect_visibility)return!0}return!1}
function N(a,b,c){var d=Ja.cg(a,b);Ja.se(a,d,function(a,b,d){if(d.Ma){switch(d.M){case "COLOR":case "CUBEMAP":a=b.i.eb;break;case "DEPTH":a=b.i.Lc;break;case "SCREEN":a=null;break;case "MAIN_CUBE_REFLECT":return;default:throw"Wrong slink";}switch(d.la){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "u_cube_reflection":case "u_plane_reflection":break;default:if(!a)throw"Connection of SCREEN is forbidden";if(a.nf)throw"Batch texture can't use renderbuffer";
na.up(c.Xb,d.la)&&ba.Hg(c,a,d.la)}}});for(a=0;a<b.ka.length;a++){var d=b.ka[a],e=b.Bd[a];switch(d.la){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":break;default:if(e.nf)throw"Batch texture can't use renderbuffer";na.up(c.Xb,d.la)&&ba.Hg(c,e,d.la)}}}function G(a,b){return{Xa:!0,bm:[!0,!0,!0,!0,!0,!0],td:a,B:b}}function L(a,b,c,d,e){switch(a.type){case "MAIN_OPAQUE":O(a,b,c,"OPAQUE",d,e);break;case "MAIN_BLEND":O(a,b,c,"BLEND",d,e);break;case "MAIN_XRAY":O(a,b,
c,"XRAY",d,e);break;case "MAIN_GLOW":O(a,b,c,"GLOW",d,e);break;case "MAIN_PLANE_REFLECT":case "MAIN_CUBE_REFLECT":for(var f=b.d,g=b.n,h=0;h<g.length;h++){var k=g[h];if(("MAIN"==k.type||"NODES"==k.type||"PARTICLES"==k.type)&&"REFLECT"==k.Ka){if("MAIN_PLANE_REFLECT"==a.type){var E;a:{if(d.d.zb){E=d.d.zb.Ki;for(var l=0;l<E.length;l++)if(E[l]==a){E=l;break a}}E=null}if(E==f.vc)continue}else{a:{if(d.d.zb)for(E=d.d.zb.Kj,l=0;l<E.length;l++)if(E[l]==a){E=l;break a}E=null}if(E==f.nc)continue}e||(W(k,a,b,
c,"REFLECT",d),E=k.pb,na.v(E,"DISABLE_FOG",0),na.v(E,"WATER_EFFECTS",0),"special_skydome.glslf"==na.sq(E)&&na.v(E,"REFLECTION_PASS",1),na.v(E,"TEXTURE_NORM",0),Y(d,k),ba.rb(k),R(k));a.p.push(G(f,k))}}break;case "DEPTH":f=b.d;b=b.n;for(g=0;g<b.length;g++)if(h=b[g],"DEPTH"==h.type&&!h.hc&&"DEPTH"==h.Ka){if(!e){k=h;l=a;E=f;var m=c,n=d,T=k.pb,q=ka.Ba(m,"SHADOW_CAST");q?k.Yb?(na.v(T,"SHADOW_USAGE","SHADOW_MASK_GENERATION"),ba.nl(k,n.d.wd,q),ka.tq(m,l)):na.v(T,"SHADOW_USAGE","NO_SHADOWS"):na.v(T,"SHADOW_USAGE",
"NO_SHADOWS");k.mb&&(l=ka.Ba(m,"GRASS_MAP"))&&ja(k,l,E);ba.rb(k);R(k)}a.p.push(G(f,h));N(c,a,h);ga(h)}break;case "SHADOW_CAST":f=!1;g=b.d;b=b.n;h=ka.Ba(c,"GRASS_MAP");for(k=0;k<b.length;k++)E=b[k],"DEPTH"==E.type&&"SHADOW_CAST"==E.Ka&&(f=!0,e||(na.v(E.pb,"SHADOW_USAGE","SHADOW_CASTING"),E.mb&&h&&ja(E,h,g),ba.ja(E,"SHADOW_TEX_RES",na.t(d.d.wd.csm_resolution)),ba.rb(E),R(E)),a.p.push(G(g,E)));f&&v(a,ka.Ba(c,"MAIN_OPAQUE"),a.p,d,!0);break;case "COLOR_PICKING":la(a,b,e);break;case "COLOR_PICKING_XRAY":la(a,
b,e);break;case "OUTLINE_MASK":c=b.d;d=b.n;for(b=0;b<d.length;b++)f=d[b],"COLOR_ID"==f.type&&"OUTLINE"==f.Ka&&(e||(ba.ja(f,"USE_OUTLINE",1),ba.rb(f),R(f)),a.p.push(G(c,f)));break;case "GRASS_MAP":c=b.d;d=b.n;for(b=0;b<d.length;b++)f=d[b],"GRASS_MAP"==f.type&&(e||(ba.rb(f),R(f)),a.p.push(G(c,f)),f=a.i,E=c.bb,g=a.bc[0],h=a.bc[1],k=a.bc[2],0==g&&0==h?(g=E.min_y,h=E.max_y):(g=Math.min(g,E.min_y),h=Math.max(h,E.max_y)),E=1E-4*(h-g),a.bc[0]=g-E,a.bc[1]=h+E,La.Hk(f,k/2,-h,-g,k/2),La.$e(f));break;case "WIREFRAME":for(d=
b.d,b=b.n,f=0;f<b.length;f++)g=b[f],"WIREFRAME"==g.type&&(e||(g.mb&&(h=ka.Ba(c,"GRASS_MAP"))&&ja(g,h,d),ba.rb(g),R(g)),a.p.push(G(d,g)),N(c,a,g),ga(g))}}function O(a,b,c,d,e,f){for(var g=b.d,h=b.n,k=0;k<h.length;k++){var E=h[k];E.hc||E.Mb||"MAIN"!=E.type&&"NODES"!=E.type&&"NODES_GLOW"!=E.type&&"PARTICLES"!=E.type||!("OPAQUE"==E.Ka&&"OPAQUE"==d||"BLEND"==E.Ka&&"BLEND"==d||"XRAY"==E.Ka&&"XRAY"==d||"NODES_GLOW"==E.type&&"GLOW"==d)||(f||(W(E,a,b,c,d,e),Y(e,E),ba.rb(E),R(E)),a.p.push(G(g,E)),N(c,a,E),
ga(E))}a.p.sort(function(a,b){var c;if(a.B&&b.B){c=a.B.Fa;var d=b.B.Fa;(c=c==d?0:c>d?1:-1)||(c=a.B.fg,d=b.B.fg,c=c==d?0:c>d?1:-1)}else c=0;return c})}function W(a,b,c,d,e,f){var g=c.d,h="NO_SHADOWS",k=ka.Ba(d,"SHADOW_CAST");if(k&&a.Yb)switch(e){case "OPAQUE":h="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":h="SHADOW_MAPPING_BLEND";break;case "REFLECT":case "GLOW":h="NO_SHADOWS";break;default:throw"Wrong main subscene type";}e=a.pb;var E=f.d.wd;na.v(e,"SHADOW_USAGE",h);ba.nl(a,E,k);h=b.eg;
na.v(e,"NUM_LIGHTS",h);na.v(e,"NUM_LFACTORS",0==h%2?h/2:Math.floor(h/2)+1);"special_skydome.glslf"==na.sq(e)&&na.v(e,"REFLECTION_PASS",0);na.v(e,"SSAO_ONLY",0);b.$a&&b.gd?na.v(e,"WATER_EFFECTS",1):na.v(e,"WATER_EFFECTS",0);b.$a&&b.Af&&g.Af?(na.v(e,"CAUSTICS",1),na.v(e,"CAUST_SCALE",b.pp),na.v(e,"CAUST_SPEED",na.t(b.qp,2)),na.v(e,"CAUST_BRIGHT",b.op)):na.v(e,"CAUSTICS",0);b.$a&&(na.v(e,"WAVES_HEIGHT",na.t(b.qf)),na.v(e,"WAVES_LENGTH",na.t(b.Bg)),na.v(e,"WATER_LEVEL",na.t(b.pf)));-1!==a.Gb.indexOf("u_mirrormap")?
na.v(e,"REFLECTION_TYPE","REFL_MIRRORMAP"):a.yc?null!=g.nc&&ka.Ba(d,"MAIN_CUBE_REFLECT")?(c=f.d.zb?f.d.zb.Kj[c.d.nc]:null)?(c=c.i.eb,ba.Hg(a,c,"u_cube_reflection"),na.v(e,"REFLECTION_TYPE","REFL_CUBE")):na.v(e,"REFLECTION_TYPE","REFL_NONE"):null!=g.vc&&ka.Ba(d,"MAIN_PLANE_REFLECT")?(c=f.d.zb?f.d.zb.Ki[c.d.vc]:null)?(c=c.i.eb,ba.Hg(a,c,"u_plane_reflection"),na.v(e,"REFLECTION_TYPE","REFL_PLANE")):na.v(e,"REFLECTION_TYPE","REFL_NONE"):na.v(e,"REFLECTION_TYPE","REFL_NONE"):na.v(e,"REFLECTION_TYPE","REFL_NONE");
(h=ka.Ba(d,"SKY"))?a.Wr?(c=h.i.eb,ba.Hg(a,c,"u_sky")):Da.zk?(a.mc=h.mc,na.v(e,"PROCEDURAL_FOG",1)):na.v(e,"PROCEDURAL_FOG",0):na.v(e,"PROCEDURAL_FOG",0);c=f.d.vo;c.jo&&(na.v(e,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==c.em?(c=c.fm?ba.Ux(c.fm,!1):h.i.eb,na.v(e,"SKY_TEXTURE",1),ba.Hg(a,c,"u_sky_texture")):"SKY_COLOR"==c.em&&na.v(e,"SKY_COLOR",1));a.mb&&(c=ka.Ba(d,"GRASS_MAP"))&&ja(a,c,g);a.Cn?(Da.gi&&na.v(e,"USE_REFRACTION_CORRECTION",1),"NODES"==a.type||"NODES_GLOW"==a.type?(na.v(e,"REFRACTIVE",1),
f.d.fc?na.v(e,"USE_REFRACTION",1):na.v(e,"USE_REFRACTION",0)):f.d.fc?na.v(e,"REFRACTIVE",1):na.v(e,"REFRACTIVE",0)):(na.v(e,"REFRACTIVE",0),na.v(e,"USE_REFRACTION",0),na.v(e,"USE_REFRACTION_CORRECTION",0));a.of&&(Da.shore_smoothing&&a.so&&ka.Ba(d,"DEPTH")?na.v(e,"SHORE_SMOOTHING",1):na.v(e,"SHORE_SMOOTHING",0),a.water_dynamic&&b.$a&&b.qf?na.v(e,"DYNAMIC",1):na.v(e,"DYNAMIC",0));"PARTICLES"==a.type&&(na.v(e,"SIZE_RAMP_LENGTH",a.Nr),na.v(e,"COLOR_RAMP_LENGTH",a.Er));if(!a.Jf)for(b=a.L,d=0;d<b.length;d++)if(c=
b[d],"SCENE"==c.source)for(g=0;g<Ea.length;g++)for(h=Ea[g],k=Ea[g].jd,E=0;E<k.length;E++)k[E].d==c&&Ja.l(gb,h,f,null);if(a.dh){b=0;for(var l in a.dh)b++;a.Vm=new Float32Array(3*b);a.Tm=new Float32Array(3*b);a.Sm=new Float32Array(3*b);a.Um=new Float32Array(4*b);na.v(e,"NUM_LAMP_LIGHTS",b);for(d=0;d<f.va.LAMP.length;d++)X(a,f.va.LAMP[d])}}function X(a,b){var c=b.uuid;if(c in a.dh){c=a.dh[c];a.Vm.set(b.d.h,3*c);a.Tm.set(b.na.direction,3*c);a.Sm.set(b.na.Kg,3*c);var d=wa,e=b.na;d[0]=-1;d[1]=-1;d[2]=-1;
d[3]=e.lf?1:0;switch(e.type){case "POINT":d[2]=e.distance;break;case "SPOT":d[2]=e.distance;var f=d[0]=Math.cos(e.dd/2);d[1]=e.sg*(1-f)}a.Um.set(d,4*c)}}function Y(b,c){var d=ea(b,"LAMP",a.DATA_ID_ALL);c.pb.Zm=[];for(var e=Z(d)||d[0],f=0;f<d.length;f++){var g=d[f].na;if("SPOT"==g.type||"POINT"==g.type)var h=Math.cos(g.dd/2);if("SPOT"==g.type)var k=g.sg*(1-h);var E=g.index;c.pb.Zm.push({type:g.type,index:E,Vy:Math.floor(E/2),Uy:0==E%2?"rg":"ba",dd:h,sg:k,distance:g.distance,Py:g.wg||g.lf,Cx:E==e.na.index})}}
function R(a){var b=a.Xb.attributes,c=a.R.Ub,d;for(d in b)c[d]||Ba.pa('missing data for "'+d+'" attribute');if("MAIN"==a.type||"NODES"==a.type||"NODES_GLOW"==a.type)if(b=na.py(a.Xb.po),10<b&&("MAIN"==a.type&&Ca.warn("Varying limit exceeded for main shader - "+b+', materials: "'+a.Pc.join(", ")+'"'),"NODES"==a.type||"NODES_GLOW"==a.type))d=c=0,a.zg&&(c=Ba.qd(a.zg)),a.sb&&(d=Ba.qd(a.sb)),Ca.warn("Varying limit exceeded for node shader - "+b+", uv: "+c+", vc: "+d+', materials: "'+a.Pc.join(", ")+'"')}
function ga(a){8<a.L.length&&Ca.warn("too many textures used - "+a.L.length+' (max 8), materials "'+a.Pc.join(", ")+'"')}function ja(a,b,c){a.bc=b.bc;var d=b.bc[0],e=b.bc[1],f=b.bc[2];c=c.Pb;c=Math.max(c.max_x-c.min_x,c.max_z-c.min_z);f=0==f?c:Math.max(f,c);b.bc[2]=f;b=b.i;La.Hk(b,f/2,-e,-d,f/2);La.$e(b);d=a.Dm||0;d=0==d?c:Math.max(d,c);a.Dm=d}function qa(a){var b=fa(a,"MAIN_OPAQUE"),c=!0;Ja.O(a.d.fb,function(d,e){"SHADOW_CAST"===e.type&&(v(e,b,e.p,a,c),c=!1)})}function v(b,c,d,e,f){if(0!=d.length){var g=
b.i;c=c.i;var h=ea(e,"LAMP",a.DATA_ID_ALL),h=Z(h)||h[0],k=h.d;La.ps(g,k.h,k.quat);Ga.copy(c.Ke,g.Ke);pb.copy(c.ma,g.ss);if("SPOT"==h.na.type||"POINT"==h.na.type)La.$e(g,g.wa);else{h=aa;Sa.Gd(h);for(k=0;k<d.length;k++){var E=d[k].td;0==k?Sa.Dp(E.bb,h):Sa.Vp(h,E.bb)}d=Sa.ox(h,xa);Ba.We(d,g.ma,d);if(e.d.wd.enable_csm){e=Ga.copy(c.ci[b.Sl],ya);h=pb.invert(c.ma,qb);Ba.We(e,h,e);Ba.We(e,g.ma,e);b=c.Tl[b.Sl];if(f)for(za=0,Aa=-Infinity,f=2;f<d.length;f+=3)za=Math.min(za,d[f]),Aa=Math.max(Aa,d[f]);f=aa;f.max_x=
e[0]+b;f.max_y=e[1]+b;f.max_z=Aa;f.min_x=e[0]-b;f.min_y=e[1]-b;f.min_z=za}else{b=f=aa;c=ic;c.set(d);e=Qa/9;d=pb.identity(qb);pb.rotate(d,e,Ba.AXIS_MZ,d);k=h=-1;for(E=0;10>E;E++){var l=Sa.xv(c,xb),m=(l.max_x-l.min_x)*(l.max_y-l.min_y);if(-1==h||m<h)h=m,k=E,Sa.Dp(l,b);Ba.We(c,d,c)}b=k*e;0<b&&(c=pb.identity(qb),pb.rotate(c,b,Ba.AXIS_MZ,c),pb.multiply(c,g.ma,g.ma));b=f.max_x-f.min_x;c=f.max_y-f.min_y;b&&c&&(e=Math.abs(b-c)/2,2<b/c?(f.max_y+=e,f.min_y-=e):2<c/b&&(f.max_x+=e,f.min_x-=e));f.max_x+=.005;
f.max_y+=.005;f.max_z+=.005;f.min_x-=.005;f.min_y-=.005;f.min_z-=.005}La.jA(g,f.min_x,f.max_x,f.min_y,f.max_y,-f.max_z,-f.min_z);La.$e(g)}Ba.jm(g.Ed,g.Qj)}}function Z(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.data.b4w_generate_shadows)return c}return!1}function la(a,b,c){var d=b.d;b=b.n;for(var e=0;e<b.length;e++){var f=b[e];"COLOR_ID"==f.type&&("COLOR_PICKING"==a.type&&"COLOR_ID"==f.Ka||"COLOR_PICKING_XRAY"==a.type&&"COLOR_ID_XRAY"==f.Ka)&&(c||(ba.ja(f,"USE_OUTLINE",0),ba.rb(f),R(f)),a.p.push(G(d,
f)))}}function V(a,b){for(var c=S(b,Kb),d=a.na,e=a.d,f=d.index,g=0;g<c.length;g++){var h=c[g];h.Xf.set(e.h,3*f);h.Vf.set(d.direction,3*f);h.Uf.set(d.Kg,3*f);switch(d.type){case "SUN":if(h.Rs.set(e.quat),h.Qs=d.Kg,"SKY"===h.type){var k=ya;k[0]=k[1]=k[2]=1;var E=Math.acos(Ga.dot(h.Nk,k)),k=Math.acos(Ga.dot(d.direction,k));h.kk=Math.floor(E/.025)!=Math.floor(k/.025)?!0:!1;Ga.copy(d.direction,h.Nk);ha(b,h)}else Ga.copy(d.direction,h.Nk);case "HEMI":case "POINT":case "SPOT":break;default:Ca.error("Unknown light type: "+
d.type+'".')}E=tb;E[0]=d.wg?1:0;E[1]=d.lf?1:0;h.Wf.set(E,2*f);h.ia=!0;for(E=0;E<h.p.length;E++)k=h.p[E].B,k.dh&&X(k,a)}}function ha(a,b){Fa.ii(b);if(b.kk)for(var c=S(a,["MAIN_OPAQUE","MAIN_BLEND","MAIN_XRAY","MAIN_GLOW"]),d=0;d<c.length;d++)for(var e=c[d].p,f=0;f<e.length;f++){var g=e[f];g.Xa&&(g=g.B,ba.Lv(g)&&Fa.vB(g))}}function ea(b,c,d){if(!b.va)throw"Access to uninitialized scene";b=b.va[c];if(d==a.DATA_ID_ALL)return b;c=[];for(var e=0;e<b.length;e++){var f=b[e];f.d.pc==d&&c.push(f)}return c}
function pa(b){var c=[];b=ea(b,"MESH",a.DATA_ID_ALL);for(var d=0;d<b.length;d++)for(var e=b[d].data,f=0;f<e.materials.length;f++){var g=e.materials[f];-1==c.indexOf(g)&&c.push(g)}return c}function U(a,b,c){for(var d=a.d,e=a.camera.d.G,f=0;f<e.length;f++){var g=e[f];La.$e(g,b/c);d.Dn&&La.ho(g,d.wd)}d.Dn&&(d.lk=!0,fa(a,"DEPTH").ia=!0,fa(a,"MAIN_BLEND").ia=!0);var h=d.fb;ka.oB(h,function(d,e,f){if(d.Ih){var g=d.ef*b,k=d.ef*c;if(e)for(e=0;e<f.ka.length;e++)f.ka[e]==d&&$a.resize(d.ta,g,k);else switch($a.xi(d.ta)&&
$a.resize(d.ta,g,k),d=f.i,d.width=g,d.height=k,f.type){case "DOF":ia(a,{dof_power:f.i.dof_power,dof_on:f.i.dof_on});break;case "GLOW_COMBINE":ra(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case "BLOOM":sa(a,{bloom_blur:f.bloom_blur});break;case "OUTLINE":f=ka.Ga(h,f,"POSTPROCESSING");g=ka.Ga(h,f,"POSTPROCESSING");k=ka.Ga(h,g,"POSTPROCESSING");d=ka.Ga(h,k,"POSTPROCESSING");ka.zc(f,1/b,1/c);ka.zc(g,1/b,1/c);ka.zc(k,1/b,1/c);ka.zc(d,1/b,1/c);
break;case "ANTIALIASING":case "SMAA_RESOLVE":case "SMAA_EDGE_DETECTION":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_NEIGHBORHOOD_BLENDING":case "SSAO":case "SSAO_BLUR":ka.zc(f,1/b,1/c)}}})}function S(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];Ja.O(a.d.fb,function(a,b){b.type==e&&c.push(b)})}return c}function fa(a,b){return ka.Ba(a.d.fb,b)}function ia(a,b){var c=fa(a,"DOF");if(!c)return Ca.error("DOF is not enabled on the scene. Check camera settings"),0;var d=a.d.fb;"boolean"==typeof b.dof_on&&
(c.i.dof_on=parseFloat(b.dof_on));"number"==typeof b.dof_distance&&(c.i.dof_distance=b.dof_distance);"number"==typeof b.dof_front&&(c.i.dof_front=b.dof_front);"number"==typeof b.dof_rear&&(c.i.dof_rear=b.dof_rear);if("number"==typeof b.dof_power){c.i.dof_power=b.dof_power;var e=ka.Ga(d,c,"POSTPROCESSING"),d=ka.Ga(d,e,"POSTPROCESSING");ka.Nb(e,c.i.dof_power);ka.zc(e,1/c.i.width,1/c.i.height);ka.Nb(d,c.i.dof_power);ka.zc(d,1/c.i.width,1/c.i.height)}c.ia=!0}function sa(a,b){var c=fa(a,"LUMINANCE_TRUNCED"),
d=fa(a,"BLOOM");if(!c||!d)return Ca.error("Bloom is not enabled on the scene"),0;"number"==typeof b.bloom_key&&(c.bloom_key=b.bloom_key,c.ia=!0);"number"==typeof b.bloom_edge_lum&&(c.bloom_edge_lum=b.bloom_edge_lum,c.ia=!0);if("number"==typeof b.bloom_blur){var e=a.d.fb,c=ka.Ga(e,d,"BLOOM_BLUR"),e=ka.Ga(e,c,"BLOOM_BLUR");d.bloom_blur=b.bloom_blur;ka.Nb(c,b.bloom_blur);ka.zc(c,1/d.i.width,1/d.i.height);ka.Nb(e,b.bloom_blur);ka.zc(e,1/d.i.width,1/d.i.height)}}function ra(a,b){var c=fa(a,"GLOW_COMBINE");
if(!c)return Ca.error("Glow is not enabled on the scene"),null;for(var d=a.d.fb,e=ka.tq(d,c),f=0;f<e.length;++f){var g=e[f];if("POSTPROCESSING"===g.type&&"GLOW_MASK_LARGE"===g.Ka)var h=g;if("POSTPROCESSING"===g.type&&"GLOW_MASK_SMALL"===g.Ka)var k=g}e=ka.Ga(d,h,"POSTPROCESSING");d=ka.Ga(d,k,"POSTPROCESSING");"number"==typeof b.small_glow_mask_coeff&&(c.small_glow_mask_coeff=b.small_glow_mask_coeff,c.ia=!0);"number"==typeof b.large_glow_mask_coeff&&(c.large_glow_mask_coeff=b.large_glow_mask_coeff,
c.ia=!0);"number"==typeof b.small_glow_mask_width&&(c.small_glow_mask_width=b.small_glow_mask_width,ka.Nb(k,b.small_glow_mask_width),ka.zc(k,1/c.i.width,1/c.i.height),k.ia=!0,ka.Nb(d,b.small_glow_mask_width),ka.zc(d,1/c.i.width,1/c.i.height),d.ia=!0);"number"==typeof b.large_glow_mask_width&&(c.large_glow_mask_width=b.large_glow_mask_width,ka.Nb(h,b.large_glow_mask_width),ka.zc(h,1/c.i.width,1/c.i.height),h.ia=!0,ka.Nb(e,b.large_glow_mask_width),ka.zc(e,1/c.i.width,1/c.i.height),e.ia=!0)}function Q(a,
b){var c=fa(Ra,"MAIN_OPAQUE");if(!c||!c.$a)return Ca.error("get_water_surface_level() - no water parameters on the scene"),0;var d=c.qf,e=c.Bg,f=c.pf,g=c.$a;if(!d||!g.Rg)return g.pf;var h=Ga.length(c.dj),k=c.time;h&&(k*=h);var E=tb;E[0]=20/e*(a-.25*k);E[1]=20/e*(b-.25*k);h=Ba.rp(E);E[0]=17/e*(b+.1*k);E[1]=17/e*(a+.1*k);var E=Ba.rp(E),h=h+E-1,l=g.dst_noise_scale0,E=g.dst_noise_scale1,m=g.dst_noise_freq0,n=g.dst_noise_freq1,T=tb;T[0]=l*(a+m*k);T[1]=l*(b+m*k);l=Ba.Mn(T);T[0]=E*(b-n*k);T[1]=E*(a-n*k);
E=Ba.Mn(T);E*=d*l;if(c.Vk)if(n=(a-c.bf[0])/c.cf[0],T=(c.bf[1]+b)/c.cf[1],n+=.5,T+=.5,1<n||0>n||1<T||0>T)d=E;else var n=Ba.nq(Ra.d.Hn,c.th,n,T),l=g.dir_freq,q=g.dir_noise_scale,u=g.dir_noise_freq,m=g.dir_min_noise_fac,T=g.dst_min_fac,c=e/c.hh/Math.PI,q=[q/e*(a+u*k),q/e*(b+u*k)],e=Math.sqrt(n),d=d*Math.max(n,g.dir_min_shore_fac)*Math.sin(e/c+l*k)*Math.max(Ba.Mn(q),m),g=Math.max(e,T),d=d*(1-g)+E*g,h=h*n;else d=E;return f+(d+.05*h)}function ca(a,b){a.vi&&"POSTPROCESSING"==a.type&&b.Xa!=a.Xa&&(a.Xa=b.Xa);
b.Xa||"OUTLINE"!=a.type||(a.cm=0)}function E(a,b,c,d){var e=Ja.Ya(a,b);La.Gk(e.i,c,d);e.ol=!0;Ja.kf(a,b,function(b,e,f){f.Ma&&f.M==c&&ka.Uv(f)&&T(a,b,f.la,d)});Ja.se(a,b,function(b,e,f){f.Ma&&f.M==c&&f.M==f.la&&E(a,b,c,d)})}function T(a,b,c,d){a=Ja.Ya(a,b).p;for(b=0;b<a.length;b++)ba.Sz(a[b].B,d,c)}function va(a){var b=fa(a,"GRASS_MAP");if(b){var c=b.i,d=a.camera.d,e=d.h;a=ya;a[0]=0;a[1]=-b.bc[2]/2;a[2]=0;Ga.transformQuat(a,d.quat,a);a[0]+=e[0];a[1]=0;a[2]+=e[2];b=wb;b[0]=0;b[1]=0;b[2]=0;b[3]=1;La.ps(c,
a,b)}}function M(a,b){Ja.O(a,function(c,d){if("MOTION_BLUR"==d.type){if(!d.ka[0]||!d.Bd[0])throw"Wrong MOTION_BLUR subscene";var e=d.ka[0],f=d.Bd[0];d.Bd[0]=d.i.eb;Ja.kf(a,c,function(b,c,d){d.Ma&&T(a,b,d.la,f)});E(a,c,e.M,f);T(a,c,e.la,d.Bd[0]);d.or=Math.exp(-b/d.mb_factor)}})}function Xb(b,c){var d=0,e=b.Ou;0==e.$n&&(e.$n=c);var f=c-e.$n;if(e.es&&f/e.Qc>=e.es)a.clear_outline_anim(b);else{f%=e.Qc;if(f<e.zr)switch(e=f/(e.zr/5),f=Math.floor(e),f){case 0:d=(e-f)/2;break;case 1:d=(e-f)/2+.5;break;case 2:d=
1;break;case 3:d=1-(e-f)/2;break;case 4:d=.5-(e-f)/2}b.d.$c=d}}function ma(a){Ja.O(a.d.fb,function(a,b){b.ia=!0})}function ua(a){if("WIND"==a.field.type){a=a.d;Ba.quat_to_dir(a.quat,Ba.AXIS_Y,Na);Ga.normalize(Na,Na);Ga.scale(Na,a.qm,Na);a=Ea;for(var b=0;b<a.length;b++)for(var c=S(a[b],Ib),d=0;d<c.length;d++)c[d].dj.set(Na)}}function sb(a){var b=c();if(b=fa(b,"OUTLINE"))b.Ue.set(a),b.ia=!0}var ba=p("__batch"),Sa=p("__boundings"),La=p("__camera"),gc=p("__config"),Ha=p("__container"),sc=p("__constraints"),
Gb=p("__data"),Za=p("__debug"),hc=p("__geometry"),Ja=p("__graph"),Gc=p("__hud"),Hc=p("__nodemat"),Bb=p("__objects");p("__particles");var nb=p("__physics"),Qb=p("__prerender"),Ic=p("__primitives"),Ca=p("__print"),Fa=p("__renderer"),ka=p("__scenegraph"),Oc=p("__sfx"),na=p("__shaders"),$a=p("__textures"),Ba=p("__util"),Ga=p("vec3"),pb=p("mat4"),Da=gc.o,ob=gc.Fb,Cb=gc.Nd,tc="ARMATURE CAMERA EMPTY LAMP MESH SPEAKER".split(" "),uc=["ARMATURE","EMPTY","MESH","SPEAKER"],vc="GRASS_MAP SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT COLOR_PICKING COLOR_PICKING_XRAY DEPTH OUTLINE_MASK WIREFRAME".split(" ");
a.CC=vc;var Kb="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT GOD_RAYS GOD_RAYS_COMBINE SKY LUMINANCE_TRUNCED".split(" "),Jb="MAIN_OPAQUE SSAO MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT".split(" "),Ib="SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT COLOR_PICKING COLOR_PICKING_XRAY DEPTH GOD_RAYS OUTLINE_MASK WIREFRAME".split(" "),Ta="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT".split(" "),
ab=0,ub=null,Ra=null,Ea=[],gb=null,vb=[],Qa=Math.PI/2;a.sf=0;a.$k=1;a.al=2;a.DATA_ID_ALL=-1;var tb=new Float32Array(2),ya=new Float32Array(3);new Float32Array(4);var wa=new Float32Array(4),wb=new Float32Array(4),qb=new Float32Array(16),xa=new Float32Array(24),ic=new Float32Array(24),aa=Sa.Gd(),xb=Sa.Gd(),Na=new Float32Array(3),za=0,Aa=-Infinity;a.set_active=function(a){Ra=a;Oc.gA(a)};a.Dz=function(a,b){var c=a.d,d=ka.Cw(c.fb);if(a==b){U(a,Ha.ry(),Ha.qy());for(var e=0;e<d.length;e++)a.d.ng.push(d[e])}else for(e=
a.jd[0],U(a,e.d.rg,e.d.rg),e=0;e<d.length;e++)b.d.ng.push(d[e]);d=S(a,Ib);for(e=0;e<d.length;e++)d[e].dj.set(Na);for(e=0;e<c.ng.length;e++)"SHADOW_CAST"==c.ng[e].type&&Fa.ii(c.ng[e])};a.Wg=b;a.lm=d;a.get_active=c;a.ga=function(){return Ra?!0:!1};a.Rj=function(a){return a.camera};a.ri=function(){return Ea};a.hy=function(){if(1==Ea.length)return Ea;for(var a=0;a<Ea.length;a++){var b=Ea[a].d.fb;Ja.O(b,function(b,c){for(var d=0;d<c.p.length;d++){for(var e=c.p[d].B.L,f=null,g=0;g<e.length;g++)if("SCENE"==
e[g].source&&e[g].Nn==Ea[a].name&&"COPY"!=c.type){Ca.error('Texture-scene loop detected. A scene is rendered to texture "'+e[g].name+'" yet this texture belongs to the same scene.');Ja.cg(gb,Ea[a]);f=c.p[d].B;break}f&&(f.L=[],f.Gb=[],ba.uB(f,null),ba.rb(f))}})}for(var c=[],a=0;a<Ea.length;a++)if(b=Ea[a],!b.jd.length){b=Ja.cg(gb,b);Ja.ix(gb,b);b=Ja.Os(gb,b,Ja.yo);b=Ja.bo(b);Ja.O(b,function(a,b){c.push(b)});break}return c};a.rd=function(b,c,d,f){for(var g=Ea,h=null,k=0;k<g.length;k++){var E=ea(g[k],
"ALL",a.DATA_ID_ALL);switch(b){case a.sf:h=e(c,E,!1,d);break;case a.$k:h=null;(E=e(c,E,!1,f))&&E.dupli_group&&(h=e(d,E.dupli_group.objects,!0,f));break;case a.al:for(var h=null,l=0;l<c.length;l++)if((h=e(c[l],E,0!=l,d))&&h.dupli_group)E=h.dupli_group.objects;else break}if(h)break}return h};a.ev=function(a,b,c){for(var d in uc){var e=uc[d],g=f(a,e),h=b.d.Kh,k=!1;for(d=0;d<c.length;d++)if(k=!0,c[d].d&&c[d].d.Tf){for(var E=0;E<h.length;E++)h[E]==c[d]&&(k=!1);k&&h.push(c[d])}e in b.va||(b.va[e]=[]);for(E=
0;E<g.length;E++)Ba.is_armature(g[E])&&g[E].proxy||(b.va.ALL.push(g[E]),b.va[e].push(g[E]))}};a.Zu=function(b,c){b.va={ALL:[]};for(var d in tc){var e=tc[d],g=f(b,e);b.va[e]=[];for(var E=0;E<g.length;E++)Ba.is_armature(g[E])&&g[E].proxy||(b.va.ALL.push(g[E]),b.va[e].push(g[E]))}b.jd=b.jd||[];b.d=b.d||{};b.fa=null;e=b.d;g=b.camera.d;d=b.b4w_shadow_settings;E=e.wd={};d.csm_resolution>Da.Kb?(E.csm_resolution=Da.Kb,Ca.error("Shadow map texture has unsupported size. Changed to "+Da.Kb+".")):E.csm_resolution=
d.csm_resolution;E.self_shadow_polygon_offset=d.self_shadow_polygon_offset;E.self_shadow_normal_offset=d.self_shadow_normal_offset;E.enable_csm=d.b4w_enable_csm;var T=ea(b,"LAMP",a.DATA_ID_ALL);if(T=Z(T)||T[0])E.Wm=T.na.type,E.dd=T.na.dd,E.distance=T.na.distance,"SPOT"!=E.Wm&&"POINT"!=E.Wm||!E.enable_csm||(Ca.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),E.enable_csm=!1);E.enable_csm?(E.csm_num=d.csm_num,E.csm_first_cascade_border=d.csm_first_cascade_border,E.first_cascade_blur_radius=
d.first_cascade_blur_radius,E.csm_last_cascade_border=d.csm_last_cascade_border,E.last_cascade_blur_radius=d.last_cascade_blur_radius,E.fade_last_cascade=d.fade_last_cascade,E.blend_between_cascades=d.blend_between_cascades):(E.csm_num=1,E.csm_first_cascade_border=d.csm_first_cascade_border,E.first_cascade_blur_radius=d.first_cascade_blur_radius,E.csm_last_cascade_border=d.csm_last_cascade_border,E.last_cascade_blur_radius=d.last_cascade_blur_radius,E.fade_last_cascade=!1,E.blend_between_cascades=
!1);e.Kh=[];for(d=0;d<c.length;d++)c[d].d&&c[d].d.Tf&&e.Kh.push(c[d]);E=b.world.b4w_fog_color;T=b.world.b4w_fog_density;d=u(b);e.$b=new Float32Array([E[0],E[1],E[2],T]);e.tg=q(b);e.Lk=w(b,e.tg);e.vo=C(b,e.Lk);e.br=ea(b,"LAMP",a.DATA_ID_ALL).length;e.$a=m(b);e.cz=d;e.ue=P(b);e.Su=z(b);e.vr=0;g.G[0].type!=La.Hb&&Da.anaglyph_use?(Ca.warn("Anaglyph stereo is disabled for the non-perspective camera"),E=!1):E=Da.anaglyph_use;e.anaglyph_use=E;e.Dn=Da.gi&&k(b);e.wD=b.world.b4w_fog_color;e.shore_smoothing=
h(b);e.zb=n(b);e.Bv=B(b);e.fz=y(b);e.Jv=r(b);e.uy=A(b);e.sz=t(b);e.Me=F(b);e.Qg=Da.Qg&&(0<g.dof_distance||g.Yd);e.mb=l(b);e.jh=Da.jh&&b.b4w_enable_motion_blur;e.Mg=Da.Mg&&b.b4w_enable_color_correction;e.antialiasing=Da.antialiasing&&b.b4w_enable_antialiasing;e.Ig=Da.Ig&&b.b4w_enable_bloom&&e.tg;e.ff=Da.ff&&b.b4w_enable_ssao;e.VA=x(b);e.Xg=Da.Xg&&b.b4w_enable_god_rays&&e.tg;e.fc=I(b,d);e.$w=Da.gi;e.aw=H(b);e.outline=J(b);e.Le=K(b);e.Cm=b.world.b4w_render_glow_over_blend;d=b.jd.sort(function(a,b){return b.d.rg-
a.d.rg});e.fb=ka.Bw(e,g,d);e.ng=[];e.lk=!1;e.ln=!1;Ea.push(b);gb||(gb=Ja.create());Ja.s(gb,b)};a.Ml=f;a.zm=function(a){return a.d.fb};a.Dx=function(a){Ja.O(a,function(b,c){var d=null;switch(c.type){case "POSTPROCESSING":d=ba.Hp(c.yk);break;case "SSAO":d=ba.Iw(c);break;case "SSAO_BLUR":d=ba.Jw(c);break;case "DEPTH_PACK":d=ba.rw();break;case "REFRACT":case "COPY":d=ba.Hp("NONE");break;case "GOD_RAYS":ka.Ga(a,c,"WIREFRAME")||ka.Ga(a,c,"MAIN_BLEND")||ka.Ga(a,c,"GOD_RAYS");d=ba.vw(c.Or,c.of,c.Bh);break;
case "GOD_RAYS_COMBINE":ka.Ga(a,c,"WIREFRAME")||ka.Ga(a,c,"MAIN_BLEND");ka.Ga(a,c,"GOD_RAYS");d=ba.ww();break;case "MOTION_BLUR":d=ba.zw();break;case "DOF":var d=ba.sw(),e=ka.Ga(a,c,"POSTPROCESSING"),f=ka.Ga(a,e,"POSTPROCESSING");ka.Nb(e,c.i.dof_power);ka.Nb(f,c.i.dof_power);break;case "OUTLINE":var d=ba.Aw(),e=ka.Ga(a,c,"POSTPROCESSING"),f=ka.Ga(a,e,"POSTPROCESSING"),g=ka.Ga(a,f,"POSTPROCESSING"),h=ka.Ga(a,g,"POSTPROCESSING");ka.Nb(f,c.vl);ka.Nb(e,c.vl);ka.Nb(h,c.im*c.Fi);ka.Nb(g,c.im*c.Fi);break;
case "GLOW_COMBINE":d=ba.uw();break;case "COMPOSITING":d=ba.pw();break;case "ANTIALIASING":d=ba.lw();break;case "SMAA_RESOLVE":case "SMAA_EDGE_DETECTION":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_NEIGHBORHOOD_BLENDING":d=ba.Gw(c.type);break;case "ANAGLYPH":d=ba.jw();break;case "SKY":d=ba.Fw();break;case "LUMINANCE":d=ba.xw();break;case "AVERAGE_LUMINANCE":d=ba.mw();break;case "LUMINANCE_TRUNCED":d=ba.yw();break;case "BLOOM_BLUR":d=ba.nw();break;case "BLOOM":d=ka.Ga(a,c,"BLOOM_BLUR");e=ka.Ga(a,
d,"BLOOM_BLUR");ka.Nb(d,c.bloom_blur);ka.Nb(e,c.bloom_blur);d=ba.ow();break;case "VELOCITY":d=ba.Mw();break;case "ANCHOR_VISIBILITY":d=ba.kw()}d&&(e=G(Bb.Ij("NONE"),d),R(d),c.p.push(e),N(a,c,d),ga(d))})};a.append_object=function(a,b,c){switch(b.type){case "MESH":var d=a.d.fb,e=b.d;!ka.Ba(d,"SHADOW_CAST")&&e.Yb&&(e.Yb=!1);e=S(a,vc);c&&(nb.has_physics(b)&&nb.append_object(b,a),a.va.ALL.push(b),a.va[b.type].push(b),b.za&&b.za.dupli_group.objects&&(b.origin_name=b.name,b.za.dupli_group.objects.push(b)));
for(var f=0;f<e.length;f++)L(e[f],b,d,a,c);break;case "LAMP":b.na.index=a.d.vr++;c=S(a,Kb);for(d=0;d<c.length;d++)c[d].eg++;V(b,a)}};a.remove_object=function(a){if(!a.d.Pm)return!1;var b=c();Gb.Cz(b,a,!1);var d=b.va.ALL.indexOf(a);-1!=d&&b.va.ALL.splice(d,1);d=b.va[a.type].indexOf(a);-1!=d&&b.va[a.type].splice(d,1);a.za&&a.za.dupli_group.objects&&(d=a.za.dupli_group.objects.indexOf(a),-1!=d&&a.za.dupli_group.objects.splice(d,1));sc.Ov(a)&&sc.remove(a);return!0};a.IC=L;a.Fn=function(a){a.d.lk=!0};
a.Zx=function(a,b){for(var c=a.d.wd,d=new Float32Array(c.csm_num),e=0;e<c.csm_num;e++)d[e]=La.Ow(c,b,e);return d};a.hide_object=function(a){a.d.Zg=!0};a.show_object=function(a){a.d.Zg=!1};a.is_hidden=function(a){return a.d.Zg};a.Mz=function(a,b,c){b=b.d;a=S(a,vc);for(var d=0;d<a.length;d++)for(var e=a[d].p,f=e.length-1;0<=f;f--){var g=e[f];g.td==b&&(g.B&&c&&hc.wp(g.B.R),e.splice(f,1))}};a.check_object=function(a,b){return b.va[a.type]&&-1<b.va[a.type].indexOf(a)?!0:!1};a.IA=function(a){var b=a.va.LAMP;
if(b.length==a.d.vr){for(var c=[],d=0;d<b.length;d++)c[b[d].na.index]=d;for(d=0;d<c.length-1;d++)for(var e=d+1;e<c.length;e++){var f=b[c[d]].na,g=b[c[e]].na;if(g.wg&&g.lf&&(!f.wg||!f.lf)||!f.wg&&(g.wg||!f.lf&&g.lf))f=c[d],c[d]=c[e],c[e]=f}for(d=0;d<c.length;d++)b[c[d]].na.index=d,V(b[c[d]],a)}};a.ug=V;a.cleanup=function(){for(var a=0;a<Ea.length;a++){var b=Ea[a];Ja.O(b.d.fb,function(a,b){if("SINK"!=b.type){var c=b.i;Fa.Pz(c.be,c.eb,c.Lc,c.width,c.height);for(var c=b.p,d=0;d<c.length;d++){var e=c[d].B;
e&&ba.$v(e)}}});b.d.fb=[];b.d.ng=[]}Ra=ub=null;Ea.length=0;gb=null;vb.length=0;Na[0]=0;Na[1]=0;Na[2]=0};a.kr=function(a,b,c){a=La.px(a,a.Qa,a.Pa,null,!0);var d=Ic.Ix(a);a=Bb.Ij("DYNAMIC");a.bb=a.Pb={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.vb=a.Vc=Sa.zv();var e=a.vb.Da;a.zf=a.yf=Sa.Ql([e,0,0],[0,e,0],[0,0,e],a.vb.F);c=ba.Ew(d,c);b.p.push(G(a,c))};a.Ia=ea;a.MD=function(a){return[a.frame_start,a.frame_end]};a.qs=function(a,b,c){Ha.zA(a,b,c);Ra&&U(Ra,a,b)};a.cB=S;a.ca=
fa;a.get_environment_colors=function(a){a=S(a,Kb)[0];var b=a.Ne,c=a.rf,d=[],e=[];d[0]=b[0];d[1]=b[1];d[2]=b[2];e[0]=c[0];e[1]=c[1];e[2]=c[2];return[a.Je,d,e]};a.set_environment_colors=function(a,b,c,d){a=S(a,Kb);for(var e=0;e<a.length;e++){var f=a[e];isNaN(b)||(f.Je=b);c&&f.Ne.set(c);d&&f.rf.set(d);f.ia=!0}};a.get_sky_params=function(a){if(a=fa(a,"SKY")){var b={};b.color=Array(3);Ga.copy(a.uh,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;
b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.set_sky_params=function(a,b){var c=fa(a,"SKY");c&&("number"==typeof b.procedural_skydome&&(c.procedural_skydome=b.procedural_skydome),
"number"==typeof b.use_as_environment_lighting&&(c.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&c.uh.set(b.color),"number"==typeof b.rayleigh_brightness&&(c.rayleigh_brightness=b.rayleigh_brightness),"number"==typeof b.mie_brightness&&(c.mie_brightness=b.mie_brightness),"number"==typeof b.spot_brightness&&(c.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(c.scatter_strength=b.scatter_strength),"number"==typeof b.rayleigh_strength&&(c.rayleigh_strength=
b.rayleigh_strength),"number"==typeof b.mie_strength&&(c.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(c.rayleigh_collection_power=b.rayleigh_collection_power),"number"==typeof b.mie_collection_power&&(c.mie_collection_power=b.mie_collection_power),"number"==typeof b.mie_distribution&&(c.mie_distribution=b.mie_distribution),c.ia=!0,c.kk=!0,ha(a,c))};a.get_fog_color_density=function(a,b){var c=b||[],d=S(a,Jb)[0].$b;c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];return c};a.set_fog_color_density=
function(a,b){for(var c=S(a,Jb),d=0;d<c.length;d++){var e=c[d];e.$b.set(b);e.ia=!0}};a.get_ssao_params=function(a){var b=fa(a,"SSAO");a=fa(a,"SSAO_BLUR");if(!b)return null;var c=b.p[0].B,d={};d.ssao_quality=ba.wb(c,"SSAO_QUALITY")[1];d.ssao_hemisphere=b.ssao_hemisphere;d.ssao_blur_depth=a.ssao_blur_depth;d.hp=a.ssao_blur_discard_value;d.radius_increase=b.yh;d.influence=b.xh;d.dist_factor=b.wh;d.ssao_only=b.ssao_only;d.ssao_white=ba.wb(c,"SSAO_WHITE")[1];return d};a.set_ssao_params=function(a,b){var c=
fa(a,"SSAO"),d=fa(a,"SSAO_BLUR");if(!c)return Ca.error("SSAO is not enabled on the scene"),0;if("string"==typeof b.ssao_quality){var e=c.p[0].B;ba.ja(e,"SSAO_QUALITY",b.ssao_quality);ba.rb(e,!0)}"number"==typeof b.ssao_hemisphere&&(e=c.p[0].B,ba.ja(e,"SSAO_HEMISPHERE",b.ssao_hemisphere),ba.rb(e,!0));"number"==typeof b.ssao_blur_depth&&(e=d.p[0].B,ba.ja(e,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),ba.rb(e,!0));"number"==typeof b.ssao_blur_discard_value&&(d.ssao_blur_discard_value=b.ssao_blur_discard_value);
"number"==typeof b.yh&&(c.yh=b.yh);"number"==typeof b.xh&&(c.xh=b.xh);"number"==typeof b.wh&&(c.wh=b.wh);if("number"==typeof b.ssao_only){c=fa(a,"MAIN_OPAQUE");c.ssao_only=b.ssao_only;for(var f=0;f<c.p.length;f++)e=c.p[f].B,ba.ja(e,"SSAO_ONLY",b.ssao_only),ba.rb(e,!0)}"number"==typeof b.ssao_white&&(e=c.p[0].B,ba.ja(e,"SSAO_WHITE",b.ssao_white),ba.rb(e,!0));c.ia=!0;d.ia=!0};a.get_dof_params=function(a){a=fa(a,"DOF");if(!a)return null;var b={};b.dof_distance=a.i.dof_distance;b.dof_front=a.i.dof_front;
b.dof_rear=a.i.dof_rear;b.dof_power=a.i.dof_power;b.Yd=a.i.Yd;return b};a.set_dof_params=ia;a.get_god_rays_params=function(a){var b=S(a,["GOD_RAYS"]);a=fa(a,"GOD_RAYS_COMBINE");if(!b||!a)return null;var c={};c.god_rays_max_ray_length=b[0].gh;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=ba.wb(b[0].p[0].B,"STEPS_PER_PASS")[1];return c};a.set_god_rays_params=function(a,b){var c=S(a,["GOD_RAYS"]),d=fa(a,"GOD_RAYS_COMBINE");if(!c||!d)return Ca.error("God Rays are not enabled on the scene"),
0;"number"==typeof b.god_rays_intensity&&(d.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var e=b.god_rays_max_ray_length,f=0;f<c.length;f++)c[f].gh=e,c[f].Ck=e/c[f].Bh/(f+1),c[f].ia=!0;if("number"==typeof b.god_rays_steps)for(var g=na.t(b.god_rays_steps,1),e=c[0].gh,f=0;f<c.length;f++){c[f].Bh=g;c[f].Ck=e/g/(f+1);c[f].ia=!0;var h=c[f].p[0].B;ba.ja(h,"STEPS_PER_PASS",g);ba.rb(h,!0)}d.ia=!0};a.get_bloom_params=function(a){var b=fa(a,"LUMINANCE_TRUNCED");
a=fa(a,"BLOOM");if(!b||!a)return null;var c={};c.bloom_key=b.bloom_key;c.bloom_edge_lum=b.bloom_edge_lum;c.bloom_blur=a.bloom_blur;return c};a.set_bloom_params=sa;a.get_glow_material_params=function(a){a=fa(a,"GLOW_COMBINE");if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.set_glow_material_params=ra;a.get_wind_params=
function(){var a=Na,b=Ga.length(a);if(0==b)return null;var c={};c.wind_dir=180*Math.atan(a[0]/a[2])/Math.PI;c.wind_strength=b;return c};a.set_wind_params=function(b,c){for(var d=ea(b,"ALL",a.DATA_ID_ALL),e=0;e<d.length;e++){var f=d[e];if("EMPTY"===f.type&&f.field&&"WIND"===f.field.type)var g=f}if(!g)return Ca.error("There is no wind on the scene"),0;d=g.d;"number"==typeof c.wind_dir&&(ya=[0,c.wind_dir/180*Math.PI,-Math.PI/2],Ba.euler_to_quat(ya,wb),d.quat.set(wb),ua(g));"number"==typeof c.wind_strength&&
(d.qm=c.wind_strength,ua(g));ma(b)};a.bA=function(a){a.d.ln=!0};a.get_water_surface_level=Q;a.get_water_mat_params=function(a,b){var c=fa(a,"MAIN_OPAQUE");if(c&&(b.waves_height=c.qf,b.waves_length=c.Bg,c.gd)){b.water_fog_density=c.gd[3];var d=b.water_fog_color=[];d[0]=c.gd[0];d[1]=c.gd[1];d[2]=c.gd[2]}};a.set_water_params=function(a,b){var c=fa(a,"MAIN_OPAQUE");if(!c||!c.$a)return Ca.error("set_water_params() - no water parameters on the scene"),null;c=c.$a;"number"==typeof b.dst_noise_scale0&&(c.dst_noise_scale0=
b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);"number"==typeof b.dst_noise_freq0&&(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(c.dir_noise_freq=
b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);"number"==typeof b.dst_min_fac&&(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(c.Rg=b.water_dynamic);for(var d=S(a,Ta),e=0;e<d.length;e++){var f=d[e];"number"==typeof b.water_fog_density&&c.$b&&(f.gd[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.$b&&f.gd.set(b.water_fog_color);"number"==typeof b.waves_height&&
(f.qf=b.waves_height);"number"==typeof b.waves_length&&(f.Bg=b.waves_length);f.ia=!0}};a.get_shore_dist=function(a,b){var c=fa(Ra,"MAIN_OPAQUE");if(!c.Vk)return 100;var d=c.hh,e=c.pf,f=(a[0]-c.bf[0])/c.cf[0],g=(c.bf[1]+a[2])/c.cf[1],f=f+.5,g=g+.5;if(1<f||0>f||1<g||0>g)e=1;else return c=d*Ba.nq(Ra.d.Hn,c.th,f,g),e=(e-a[1])*b,e=Math.sqrt(c*c+e*e)};a.update=function(a,b){for(var d=c().camera.d,e=0;e<Ea.length;e++){var f=Ea[e],g=f.d.fb;if(f.d.$a)var h=d.h[1]-Q(d.h[0],d.h[2]);for(var k=f.d.Kh,E=0;E<k.length;E++){var l=
k[E].d,m=l.La,n=l.Ug+l.ra;if(m){var T=Math.round(m.currentTime*l.ac),q=l.ra/l.ac;if(T<l.ra-(Da.Sf?5:0)||k[E].d.vg&&T>n)m.currentTime=q;!l.vg&&T>n&&m.pause();2<=m.readyState&&!m.paused&&$a.MB(l)}else if(l.qh){m=Math.min(l.qh.length,l.Ug+l.ra);if(l.me<l.ra||l.vg&&l.me>=m)l.me=l.ra;!l.vg&&l.me>=m&&(l.rh=!1);m=Math.round(a*Cb.Ha/l.ac)*l.ls;m!=ab&&l.rh&&($a.JB(l),l.me++);ab=m}}Ja.O(g,function(b,c){-1<Ib.indexOf(c.type)&&(c.time=a);f.d.$a&&(c.Dl=h)})}for(e=0;e<Ea.length;e++)if(f=Ea[e],E=f.d,d=E.ng,E.lk&&
(qa(f),E.lk=!1),E.ln&&(va(f),E.ln=!1),d.length){f.b4w_enable_motion_blur&&M(E.fb,b);if(E.outline){for(var u=0,e=0;e<f.va.MESH.length;e++)E=f.va.MESH[e],u+=E.d.$c,-1!=vb.indexOf(E)&&Xb(E,a);Ja.O(f.d.fb,function(a,b){"OUTLINE"===b.type&&(b.cm=u)})}g=null;for(E=0;E<d.length;E++)"OUTLINE_MASK"==d[E].type&&(g=E);for(E=0;E<d.length;E++)k=d[E],Qb.vn(k),null!==g&&ca(k,d[g]),Fa.ii(k)}Da.show_hud_debug_info&&Gc.DA(Ea,b)};a.xm=function(a){var b=[];Ja.O(a.d.fb,function(a,c){b.push(c)});return b};a.apply_outline_anim=
function(a,b,c,d){a.Ou={$n:0,zr:b,Qc:c,es:d};-1==vb.indexOf(a)&&vb.push(a)};a.clear_outline_anim=function(a){a.d.$c=0;a=vb.indexOf(a);-1!=a&&vb.splice(a,1)};a.aD=function(){vb=[]};a.get_cam_water_depth=function(){var a=fa(Ra,"MAIN_BLEND"),b=Ra;return a||b.d.$a?a.Dl:null};a.get_object_data_id=function(a){return a.d.pc};a.dt=ma;a.xA=function(a,b){switch(b){case "WM_NONE":a.Xa=!1;break;case "WM_OPAQUE_WIREFRAME":case "WM_TRANSPARENT_WIREFRAME":case "WM_FRONT_BACK_VIEW":case "WM_DEBUG_SPHERES":for(var c=
0;c<a.p.length;c++)a.p[c].B.wireframe_mode=Za.Go[b];a.Xa=!0}a.Fa="WM_TRANSPARENT_WIREFRAME"==b;a.ia=!0};a.wA=function(a,b){for(var c=0;c<a.p.length;c++)a.p[c].B.wireframe_edge_color=b,a.ia=!0};a.Po=function(a,b){for(var c=0;c<b.length;c++)a.va.ALL.push(b[c]),a.va.MESH.push(b[c])};a.at=ua;a.pick_object=function(c,d){var e=b();if(!e)return Ca.error("No active scene"),null;var f=fa(e,"COLOR_PICKING");if(f){var g=Ha.El(c,d,tb,f.i);Qb.vn(f);Fa.ii(f);var h=fa(e,"COLOR_PICKING_XRAY");h?(Qb.vn(h),Fa.ii(h),
f=h.i):f=f.i;g[1]=f.height-g[1];h=Fa.cs(f.be,g[0],g[1]);g=ea(e,"MESH",a.DATA_ID_ALL);for(f=0;f<g.length;f++){var k=g[f].d,E=k.Gj;if(E&&3>Math.abs(255*E[0]-h[0])&&3>Math.abs(255*E[1]-h[1])&&3>Math.abs(255*E[2]-h[2]))return k.Fb&&k.yr&&(ob.outlining_overview_mode?(sb(ob.Ue),k.$c=ob.$c,a.apply_outline_anim(g[f],ob.pk,ob.qk,ob.rk)):(sb(e.b4w_outline_color),k.$c=e.b4w_outline_factor,e=k.Ei,a.apply_outline_anim(g[f],e.pk,e.qk,e.rk))),g[f]}}else Ca.error("Object Selection is not available on the scene");
return null};a.set_outline_color=sb;a.ty=function(){return Na};a.jy=function(b){var c=[];b=ea(b,"MESH",a.DATA_ID_ALL);for(var d=0;d<b.length;d++){var e=b[d];e.d.qg&&c.push(e)}return c};a.get_meta_tags=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.rB=function(){for(var b=Ra,c=ea(b,"MESH",a.DATA_ID_ALL),d=0;d<c.length;d++)for(var e=c[d].n,f=0;f<e.length;f++){var g=e[f];if("MAIN"==g.type||"NODES"==g.type)Y(b,g),ba.rb(g)}};
a.$s=function(a,b){var c=b.d.vb.F,d=a.d.zb?a.d.zb.Kj[b.d.nc]:null;if(d){var e=ya;Ga.negate(c,e);for(c=0;6>c;c++){var f=d.di[c],g=d.Ul[c],h=d.i;pb.translate(Ba.wt[c],e,f);pb.multiply(h.sa,f,h.Ed);Ba.jm(h.Ed,g)}}};a.tv=function(a,b){b.d.zb&&(a.d.ec=b.d.zb.Ki[a.d.vc].i.ec)};a.ct=function(a,b){var c=b.d.zb.Dk[a],d=b.d.zb.Ki[a].i;Ba.mB(c.d.h,c.d.quat,Ba.AXIS_Y,d.ec);La.vA(d,b.camera)};a.marker_frame=function(a,b){return a.timeline_markers[b]}};b4w.module.__physics=function(a,p){function b(a,c){for(var d=a.Ic,e=0;e<d.length;e++)d[e].d.Tk&&c.push(d[e]),b(d[e],c)}function d(a,b){for(var c=a.m.p,d=0;d<c.length;d++)for(var e=c[d].Sa,f=0;f<e.Zb.length;f++){var g=e.Zb[f];"ANY"!=g.Na&&b!=g.Na||y(g)}}function c(a,b){if(Z)switch(a){case z.Ft:Z.m.st=!0;z.C(z.lu,Date.now()-performance.now(),ga.Zc,ga.Bl?ja.fq:0);break;case z.Gt:I.Xy("URANIUM:",b.slice(1));break;case z.Bt:I.error(b);break;case z.Ct:P.fbmsg.apply(this,b.slice(1));break;case z.Lt:var c=
e(b.body_id);if(c){var d=b.trans,g=b.quat,h=b.linvel,k=b.angvel,c=c.m;c.Vl=b.time;L.set_sep(d,1,g,c.Wl);X.copy(h,c.hr);X.copy(k,c.Qo)}break;case z.It:(d=e(b.chassis_hull_body_id))&&L.set_sep(b.trans,1,b.quat,d.k.Ni[b.prop_ind]);break;case z.Dt:if(g=e(b[1]))d=b[4],g=g.Jc.yj[b[2]],G.set_translation(g,b[3]),G.set_rotation(g,d),G.u(g);break;case z.Mt:if(c=e(b[1]))c.k.speed=b[2];break;case z.xt:f(Z,b.body_id_a|0,b.body_id_b|0,b.result,null,null,0);break;case z.zt:f(Z,b.body_id_a|0,b.body_id_b|0,b.result,
b.coll_point,b.coll_norm,b.coll_dist);break;case z.yt:if(c=e(b[1]))d=c.m,d.Ef&&d.Ef(b[2]);break;case z.Bo:case z.Jt:if(d=Z.m.nh[b.id])if(g=e(b.body_id_hit),a==z.Bo)h=d.callback,h(d.id,b.hit_fract,g,b.hit_time);else{var h=b.hit_fract,k=b.hit_time,c=b.hit_pos,l=d.callback;c?l(d.id,h,g,k,c,b.hit_norm):l(d.id,h,g,k)}break;case z.Kt:t(id);break;case z.Ht:console.log("Physics message ping: ",performance.now()-b[1]);break;case z.Et:qa=b[1];break;case z.At:console.log(b[1]);break;default:I.error("Wrong message: "+
a)}}function e(a){return la[a]||null}function f(a,b,c,d,f,g,h){a=a.m.p;for(var k=0;k<a.length;k++)for(var l=a[k].Sa,m=0;m<l.Zb.length;m++){for(var n=l.Zb[m],q=n.Ve,u=!1,t=0;t<q.length;t++){var p=q[t];if(p[0]===b&&p[1]===c){n.tk[t]=d;u=!0;break}}if(u){u=n.tk;for(t=q=0;t<u.length;t++)q=q||u[t];f&&n.wl!=b&&(t=f,u=g,p=h,t[0]+=u[0]*p,t[1]+=u[1]*p,t[2]+=u[2]*p,u[0]*=-1,u[1]*=-1,u[2]*=-1);n.callback(q,q?n.wl==b?e(c):e(b):null,f,g,h)}}}function g(){ea.body++;return ea.body}function k(a){if("ANY"==a)return 0;
var b=ha.indexOf(a);return-1==b?(ha.push(a),ha.length-1):b}function q(a){return{S:a,en:0,dk:!1,df:!0,fE:!1,is_character:!1,Ky:!1,Hj:null,Na:"",$h:0,dD:{},Zb:[],Ef:null,Vl:0,Wl:new Float32Array([0,0,0,1,0,0,0,1]),hr:new Float32Array(3),Qo:new Float32Array(3),Cj:new Float32Array(3),Bj:new Float32Array(4)}}function h(a,b){switch(a){case "BOX":var c=b.Pb;break;case "CYLINDER":c=b.sl;break;case "CONE":c=b.rl;break;case "SPHERE":c=b.Vc;break;case "CAPSULE":c=b.ql}return c}function m(a){if(!a)return null;
var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===typeof a.F&&(b.center=a.F);"number"===typeof a.Da&&(b.radius=a.Da);"number"===typeof a.height&&(b.height=a.height);return b}function u(a,b,c,d){var e=a.d.h,f=b.d.T,g=new Float32Array(16);R.invert(f,g);f=new Float32Array(3);
X.transformMat4(e,g,f);switch(b.k.type){case 10:b=b.b4w_vehicle_settings;a=a.d.Pb;z.C(z.Pt,c,f,b.suspension_rest_length,b.roll_influence,(a.max_y-a.min_y)/2,d);break;case 20:z.C(z.Ot,c,f,a.JE)}}function n(a){return a.m&&a.m.Hj?!0:!1}function w(a,b,c,d,e,f,g,h,k,l){var m;ea.Cp++;m=ea.Cp.toString(16);z.C(z.Wt,m,a,h,b.m.S,c,d,e.m.S,f,g,k,l);b.m.Hj=m}function x(a){var b=a.m;if(b&&(0===b.en||!0===b.dk||!1===b.df||"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type)&&(a.d.h[0]!=a.m.Cj[0]||a.d.h[1]!=a.m.Cj[1]||a.d.h[2]!=
a.m.Cj[2]||a.d.quat[0]!=a.m.Bj[0]||a.d.quat[1]!=a.m.Bj[1]||a.d.quat[2]!=a.m.Bj[2])){a.m.Cj.set(a.d.h);a.m.Bj.set(a.d.quat);var b=a.m,c=z.vq(z.kj);c.body_id=a.m.S;c.trans=a.d.h;"DYNAMIC"===b.type?(c.quat=U,Y.identity(U)):c.quat=a.d.quat;z.C(z.kj,c)}a=a.Ic;for(b=0;b<a.length;b++)x(a[b])}function B(a,b,c,d,e){e=e||new Float32Array(3);a=a.d.quat;e[0]=b;e[1]=c;e[2]=d;X.transformQuat(e,a,e)}function y(a){var b=a.Ve,c=a.tk,d=a.wl,e=[],f=a.Na,g=Z;if(!e)throw"At least one destination required";for(var h=0;h<
g.m.p.length;h++){var k=g.m.p[h];if("ANY"==f||k.Sa.Na==f)k=k.Sa.S,e&&-1==e.indexOf(k)&&e.push(k)}for(f=0;f<e.length;f++)g=e[f],d<g&&!r(b,d,g)?(b.push([d,g]),c.push(0)):d>g&&!r(b,g,d)&&(b.push([g,d]),c.push(0));z.C(z.Nt,d);z.C(z.Vt,b,a.ld)}function r(a,b,c){for(var d=0;d<a.length;d++)if(a[d][0]==b&&a[d][1]==c)return!0;return!1}function A(a){a.m&&a.m.Ef&&(a=a.m,z.C(z.hu,a.S),a.Ef=null)}function t(a){var b=Z.m;b.nh[a]&&(delete b.nh[a],b.Bn.splice(b.Bn.indexOf,1),z.C(z.pu,a))}function F(a,b){if(b.Ah){var c=
a.m.S,d=b.Sg*b.eq,e=b.Yh*b.jp,f=-b.zh*b.Sn*2*Math.PI/b.Ks;b.Sq&&(f*=-1);switch(b.type){case 10:z.C(z.Cu,c,d,e,f);break;case 20:z.C(z.Bu,c,d,e,f)}}}function C(a){return a.b4w_vehicle&&"CHASSIS"==a.b4w_vehicle_settings.part?!0:!1}function l(a){return a.b4w_vehicle&&"HULL"==a.b4w_vehicle_settings.part?!0:!1}function H(a){return a.b4w_character?!0:!1}function J(a){return a.b4w_floating&&"MAIN_BODY"==a.b4w_floating_settings.part?!0:!1}var K=p("__config");p("__constraints");var I=p("__print"),P=p("__debug"),
z=p("__ipc");p("__renderer");var N=p("__scenes"),G=p("__transform"),L=p("__tsr"),O=p("__util"),W=p("__version"),X=p("vec3"),Y=p("quat"),R=p("mat4"),ga=K.Sa,ja=K.o,qa=0,v=null,Z=null,la={},V=[],ha=[],ea={body:0,Cp:0,$r:0},pa=new Float32Array(3),U=new Float32Array(4),S=new Float32Array(4),fa=new Float32Array(16),ia=new Float32Array(8),sa=new Float32Array(8);a.Ey=function(a){if(Z)I.warn("Multiple physics scenes are currently not supported");else{a.m={st:!1,p:[],nh:{},Bn:[]};var b=ga.$i+W.timestamp();
I.log("%cLOAD PHYSICS","color: #0a0",b,"Max FPS: "+ga.Zc);v=new Worker(b);z.init(v,c);Z=a}};a.Vv=function(a){return a.m?a.m.st:!0};a.cleanup=function(){if(Z){v.terminate();Z=v=null;la={};V.length=0;ha.length=0;for(var a in ea)ea[a]=0}};a.append_object=function(a,c){var e=a.d;if(!e)throw"No object render: "+a.name;if(a.parent&&e.Tk)return null;var f=[];e.Tk&&b(a,f);var T=c.m.p;if(C(a)||l(a)||H(a)||J(a)||a.b4w_collision){var t,p=a,r=e.Sr,x=p.d,U=p.game,v=g();if("CAMERA"==p.type)var G=U.use_collision_bounds?
U.collision_bounds_type:"BOX",B=h(G,x),y=x.oi,A=x.ji,y=.5,A=0;else"EMPTY"==p.type?(G="EMPTY",B=null,A=y=0):(G=U.use_collision_bounds?U.collision_bounds_type:"BOX",B=h(G,x),y=x.oi,A=x.ji);var L=x.h,ia=x.quat,K=U.use_ghost,W=U.use_sleep,sa=U.mass,P=U.velocity_min,ga=U.velocity_max,ea=U.damping,ha=U.rotation_damping,nb=p.b4w_collision_id,ja=k(nb),pa=U.collision_margin,Ca=U.collision_group,Fa=U.collision_mask,ka=x.Vc.Da,qa=m(B),na=p.b4w_correct_bounding_offset,$a;var Ba=G;if(f.length){var Ga=[],pb={};
pb.quat=new Float32Array([0,0,0,1]);pb.trans=new Float32Array(3);pb.worker_bounding=qa;pb.bounding_type=Ba;Ga.push(pb);R.invert(x.T,fa);Y.invert(x.quat,S);for(var Da=0;Da<f.length;Da++){var ob={},Cb=f[Da],tc=Cb.game.collision_bounds_type,uc=new Float32Array(4),vc=new Float32Array(3);X.transformMat4(Cb.d.h,fa,vc);Y.multiply(S,Cb.d.quat,uc);ob.trans=vc;ob.quat=uc;ob.bounding_type=tc;ob.worker_bounding=m(h(tc,Cb.d));Ga.push(ob)}$a=Ga}else $a=[];z.C(z.St,v,L,ia,r,K,W,sa,P,ga,ea,ha,ja,pa,Ca,Fa,G,qa,ka,
y,A,$a,na);la[v]=p;V.push(p);var Kb=q(v);Kb.type=r;Kb.en=sa;Kb.dk=K;Kb.Na=nb;Kb.$h=ja;t=Kb;a.m=t;var Jb={B:null,Sa:t};T.push(Jb);d(c,t.Na)}else for(var Ib=a.n||[],Ta=0;Ta<Ib.length;Ta++){var ab=Ib[Ta],ub;if(ub="PHYSICS"==ab.type){var Ra;a:{for(var Ea=c.m.p,gb=0;gb<Ea.length;gb++){var vb=Ea[gb].B;if(vb&&vb.id==ab.id){Ra=!0;break a}}Ra=!1}ub=!Ra}if(ub)if(ab.Cc.K)if(ab.of&&c.d.$a){var Qa=ab,tb=Z,ya=N.ca(tb,"MAIN_OPAQUE");z.C(z.au,ya.pf);if(ya.$a&&Qa.hC){var wa={};wa.dst_noise_scale0=Qa.dst_noise_scale0;
wa.dst_noise_scale1=Qa.dst_noise_scale1;wa.dst_noise_freq0=Qa.dst_noise_freq0;wa.dst_noise_freq1=Qa.dst_noise_freq1;wa.dir_min_shore_fac=Qa.dir_min_shore_fac;wa.dir_freq=Qa.dir_freq;wa.dir_noise_scale=Qa.dir_noise_scale;wa.dir_noise_freq=Qa.dir_noise_freq;wa.dir_min_noise_fac=Qa.dir_min_noise_fac;wa.dst_min_fac=Qa.dst_min_fac;wa.waves_hor_fac=Qa.waves_hor_fac;var wb=ya.qf,qb=ya.Bg;ya.Vk?z.C(z.Do,wa,ya.cf[0],ya.cf[1],ya.bf[0],ya.bf[1],ya.hh,wb,qb,ya.th,tb.d.Hn):z.C(z.Do,wa,0,0,0,0,0,wb,qb,0,null)}}else{var xa;
if(ab.QB){var ic=a,aa=ab,xb=g(),Na=aa.Cc,za=Na.A[0].a_position,Aa=Na.ea||null,jb=aa.Na,Kc=k(jb);z.C(z.Yt,xb,za,Aa,ic.d.h,Kc,aa.zp,aa.yp,aa.Ap);var Xa=q(xb);Xa.dk=!0;Xa.Na=jb;Xa.$h=Kc;xa=Xa}else{var Rb=a,hb=ab,Lb=g(),jc=hb.Cc,Yb=jc.A[0].a_position,wc=jc.ea||null,bb=Rb.d.h,Zb=hb.oi,Pc=hb.ji,xc=hb.Na,D=k(xc);z.C(z.$t,Lb,Yb,wc,bb,Zb,Pc,D,hb.zp,hb.yp,hb.Ap);var Mb=q(Lb);Mb.Na=xc;Mb.$h=D;xa=Mb}t=xa;Jb={B:ab,Sa:t};T.push(Jb);d(c,t.Na)}else I.error("Object "+a.name+" has collision material with no assigned vertices")}if(C(a)||
l(a)){var Ia=a,Ua=Ia.m.S;C(Ia)?(Ia.k.type=10,z.C(z.Tt,Ua,Ia.k.fB,Ia.k.hB,Ia.k.gB,Ia.k.jC,Ia.k.ez)):l(Ia)&&(Ia.k.type=20,z.C(z.Rt,Ua,Ia.k.nm,Ia.k.qo,Ia.k.ro));if(Ia.k.mg){var yb=Ia.k.mg;switch(Ia.k.type){case 10:u(yb[1],Ia,Ua,!0);u(yb[0],Ia,Ua,!0);u(yb[3],Ia,Ua,!1);u(yb[2],Ia,Ua,!1);break;case 20:for(var da=0;da<yb.length;da++)u(yb[da],Ia,Ua,!1)}}F(a,a.k)}else if(H(a)){var kc=a.d,kb=a.m,cb=kc.Pb.max_y-kc.Pb.min_y,lc=kb.S,ta=a.b4w_character_settings,rb=ta.walk_speed,zb=ta.run_speed,ed=ta.step_height,
Oa=ta.jump_strength,Nb=ta.waterline,Qc=O.bx(a);z.C(z.Ut,lc,Qc,cb,rb,zb,ed,Oa,Nb);kb.is_character=!0}else if(J(a)){var db=a,$b=db.m.S;z.C(z.Xt,$b,db.Jc.nm,db.Jc.qo,db.Jc.ro);if(db.Jc.yj)for(var ac=db.Jc.yj,mc=0;mc<ac.length;mc++){var nc=ac[mc],Rc=nc.d.h,Zc=db.d.T,bc=new Float32Array(16);R.invert(Zc,bc);var $c=new Float32Array(3);X.transformMat4(Rc,bc,$c);z.C(z.Qt,$b,$c,nc.Dv)}db.m.Ky=!0}for(Ta=0;Ta<V.length;Ta++)if(a=V[Ta],a.m){var lb=a;if(!n(lb))for(var Lc=0;Lc<lb.constraints.length;Lc++){var eb=
lb.constraints[Lc],yc=eb.target,ib=eb.pivot_type;if("RIGID_BODY_JOINT"==eb.type&&yc.m){var oc=new Float32Array([eb.pivot_x,eb.pivot_y,eb.pivot_z]),Ab,Ma=new Float32Array([eb.axis_x,eb.axis_y,eb.axis_z]);Ab=O.euler_to_quat(Ma,new Float32Array(4));var Db=R.fromRotationTranslation(Ab,oc,new Float32Array(16)),zc=R.multiply(lb.d.T,Db,new Float32Array(16)),Eb=R.invert(yc.d.T,new Float32Array(16)),Sb=R.multiply(Eb,zc,Eb),Ac=O.fh(Sb),Hb=O.matrix_to_quat(Sb),Va=eb,Pa={};Pa.use_limit_x=Va.use_limit_x;Pa.use_limit_y=
Va.use_limit_y;Pa.use_limit_z=Va.use_limit_z;Pa.use_angular_limit_x=Va.use_angular_limit_x;Pa.use_angular_limit_y=Va.use_angular_limit_y;Pa.use_angular_limit_z=Va.use_angular_limit_z;Pa.limit_max_x=Va.limit_max_x;Pa.limit_min_x=Va.limit_min_x;Pa.limit_max_y=Va.limit_max_y;Pa.limit_min_y=Va.limit_min_y;Pa.limit_max_z=Va.limit_max_z;Pa.limit_min_z=Va.limit_min_z;Pa.limit_angle_max_x=Va.limit_angle_max_x;Pa.limit_angle_min_x=Va.limit_angle_min_x;Pa.limit_angle_max_y=Va.limit_angle_max_y;Pa.limit_angle_min_y=
Va.limit_angle_min_y;Pa.limit_angle_max_z=Va.limit_angle_max_z;Pa.limit_angle_min_z=Va.limit_angle_min_z;w(ib,lb,oc,Ab,yc,Ac,Hb,Pa,null,null)}}}};a.tx=e;a.update=function(){for(var a=0;a<V.length;a++){var b=V[a],c=b.m;if(c.df&&c.Vl){var d=performance.now()/1E3-c.Vl,d=Math.min(d,10/ga.Zc),d=d-1/ga.Zc;ja.kz&&(d=0);var e=ia;L.Fy(c.Wl,d,c.hr,c.Qo,ia);G.tA(b,e);G.u(b);x(b);if(b.k)for(var c=b,d=c.k.mg,e=c.d.Ab,f=ia,g=0;g<d.length;g++){var h=d[g];L.multiply(e,c.k.Ni[g],f);G.set_tsr(h,f);G.u(h)}b.k&&b.k.Ah&&
(c=b.k,d=c.Ah)&&(e=b.k.Ls,h=fa,f=b.d.h,g=b.d.quat,O.eo(b.k.Ms,g,f,h),O.fh(h,d.d.h),O.matrix_to_quat(h,d.d.quat),h=U,O.fo(e,g,f,h),e=S,Y.setAxisAngle(h,-c.zh*c.Sn*2*Math.PI,e),Y.multiply(e,d.d.quat,d.d.quat),G.u(d));b.k&&b.k.Pn&&(c=b.k,d=c.Pn)&&(f=b.k.Fs,e=fa,g=b.d.h,h=b.d.quat,O.eo(b.k.Gs,h,g,e),O.fh(e,d.d.h),O.matrix_to_quat(e,d.d.quat),e=U,O.fo(f,h,g,e),f=S,g=Math.abs(c.speed)*c.Es,g>c.gn&&(g=c.gn),Y.setAxisAngle(e,-g,f),Y.multiply(f,d.d.quat,d.d.quat),G.u(d));b.k&&b.k.Wn&&(c=b.k,d=c.Wn)&&(e=b.k.Ss,
h=fa,f=b.d.h,g=b.d.quat,O.eo(b.k.Ts,g,f,h),O.fh(h,d.d.h),O.matrix_to_quat(h,d.d.quat),b=U,O.fo(e,g,f,b),e=S,Y.setAxisAngle(b,-Math.abs(c.Sg)*c.Pp,e),Y.multiply(e,d.d.quat,d.d.quat),G.u(d))}}if(a=Z)a=N.ca(a,"MAIN_OPAQUE"),a.$a&&0<a.$a.waves_height&&(b=X.length(a.dj),z.C(z.Au,a.time*b))};a.Px=function(){return Z};a.pause=function(){Z&&z.C(z.mu)};a.resume=function(){Z&&z.C(z.qu)};a.enable_simulation=function(a){a=a.m;if(!a)throw"No object physics";if(!a.df){var b=a.S;a.df=!0;z.C(z.ku,b)}};a.disable_simulation=
function(a){a=a.m;if(!a)throw"No object physics";if(a.df){var b=a.S;a.df=!1;z.C(z.ju,b)}};a.has_physics=function(a){return a.m?!0:!1};a.has_dynamic_physics=function(a){return(a=a.m)&&a.df&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.en&&0==a.dk?!0:!1};a.has_simulated_physics=function(a){return(a=a.m)&&a.df?!0:!1};a.set_gravity=function(a,b){z.C(z.zu,a.m.S,b)};a.yy=n;a.apply_constraint=w;a.clear_constraint=function(a){a=a.m;z.C(z.ou,a.Hj);a.Hj=null};a.pull_to_constraint_pivot=function(b,c,d,e,f,
g){c=L.create_sep(c,1,d,ia);f=L.create_sep(f,1,g,sa);L.invert(c,c);L.multiply(f,c,c);G.get_tsr(e,f);L.multiply(f,c,c);G.set_tsr(b,c);G.u(b);a.set_transform(b,b.d.h,b.d.quat)};a.set_transform=function(a,b,c){L.set_sep(a.d.h,1,a.d.quat,a.m.Wl);var d=z.vq(z.kj);d.body_id=a.m.S;d.trans=b;d.quat=c;z.C(z.kj,d)};a.sync_transform=x;a.apply_velocity=function(a,b,c,d){B(a,b,c,d,pa);a=a.m.S;b=Math.abs(0);c=Math.abs(0);d=Math.abs(0);var e=Math.abs(pa[0]),f=Math.abs(pa[1]),g=Math.abs(pa[2]);pa[0]=e?pa[0]/e*Math.max(e,
b):0;pa[1]=f?pa[1]/f*Math.max(f,c):0;pa[2]=g?pa[2]/g*Math.max(g,d):0;z.C(z.Fo,a,pa[0],pa[1],pa[2])};a.apply_velocity_world=function(a,b,c,d){z.C(z.Fo,a.m.S,b,c,d)};a.apply_force=function(a,b,c,d){B(a,b,c,d,pa);z.C(z.bu,a.m.S,pa[0],pa[1],pa[2])};a.apply_torque=function(a,b,c,d){B(a,b,c,d,pa);z.C(z.du,a.m.S,pa[0],pa[1],pa[2])};a.set_character_move_dir=function(a,b,c){z.C(z.tu,a.m.S,b,c)};a.set_character_move_type=function(a,b){z.C(z.uu,a.m.S,b)};a.set_character_walk_velocity=function(a,b){z.C(z.yu,
a.m.S,b)};a.set_character_run_velocity=function(a,b){z.C(z.wu,a.m.S,b)};a.set_character_fly_velocity=function(a,b){z.C(z.ru,a.m.S,b)};a.character_jump=function(a){z.C(z.fu,a.m.S)};a.character_rotation_inc=function(a,b,c){z.C(z.gu,a.m.S,b,c)};a.set_character_rotation=function(a,b,c){z.C(z.vu,a.m.S,b,c)};a.set_character_rotation_h=function(a,b){z.C(z.su,a.m.S,b)};a.set_character_rotation_v=function(a,b){z.C(z.xu,a.m.S,b)};a.append_collision_test=function(a,b,c,d){a=a.m;var e=a.S;b=b||"ANY";for(var f=
0;f<a.Zb.length;f++){var g=a.Zb[f];if(g.Na==b&&g.callback==c)return}g={wl:e,ld:d||!1,Na:b,callback:c,Ve:[],tk:[]};a.Zb.push(g);y(g)};a.remove_collision_test=function(a,b,c){a=a.m;b=b||"ANY";for(var d=0;d<a.Zb.length;d++){var e=a.Zb[d];if(e.Na==b&&e.callback==c){a.Zb.splice(d,1);d--;for(var e=e.Ve,f=Z.m.p,g=0;g<f.length;g++)for(var h=f[g].Sa,k=0;k<h.Zb.length;k++)for(var l=h.Zb[k],m=0;m<l.Ve.length;m++)for(var n=l.Ve[m],q=0;q<e.length;q++){var u=e[q];n[0]==u[0]&&n[1]==u[1]&&(e.splice(q,1),q--)}e.length&&
z.C(z.Eo,e)}}};a.apply_collision_impulse_test=function(a,b){a.m&&a.m.Ef&&A(a);var c=a.m;z.C(z.cu,c.S);c.Ef=b};a.clear_collision_impulse_test=A;a.append_ray_test=function(a,b,c,d,e,f,g,h,l){var m;ea.$r++;m=ea.$r;d=d||"ANY";a={id:m,S:a?a.m.S:0,M:new Float32Array(b),la:new Float32Array(c),Na:d,$h:k(d),$o:f,Fv:g,ld:h,Yj:l,callback:e};b=Z.m;m=a.id;b.nh[m]=a;b.Bn.push(a);z.C(z.Zt,a.id,a.S,a.M,a.la,a.$h,a.$o,a.Fv,a.ld,a.Yj);return m};a.remove_ray_test=t;a.change_ray_test_from_to=function(a,b,c){var d=Z.m.nh[a];
d&&!d.$o&&(d.M.set(b),d.la.set(c),z.C(z.eu,a,b,c))};a.Uq=function(a){return Z.m.nh[a]?!0:!1};a.vehicle_throttle=function(a,b){var c=a.k;c.Sg=b;F(a,c)};a.vehicle_steer=function(a,b){var c=a.k;c.zh=b;F(a,c)};a.vehicle_brake=function(a,b){var c=a.k;c.Yh=b;F(a,c)};a.is_vehicle_chassis=C;a.is_vehicle_hull=l;a.Jy=function(a){if(!a.b4w_vehicle)return!1;a=a.b4w_vehicle_settings.part;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.Hy=function(a){return a.b4w_vehicle?
"BOB"==a.b4w_vehicle_settings.part?!0:!1:!1};a.Ly=function(a){return a.b4w_floating?"BOB"==a.b4w_floating_settings.part?!0:!1:!1};a.Xq=function(a){return a.b4w_vehicle&&"STEERING_WHEEL"==a.b4w_vehicle_settings.part?!0:!1};a.Wq=function(a){return a.b4w_vehicle&&"SPEEDOMETER"==a.b4w_vehicle_settings.part?!0:!1};a.Yq=function(a){return a.b4w_vehicle&&"TACHOMETER"==a.b4w_vehicle_settings.part?!0:!1};a.get_vehicle_speed=function(a){return a.k.speed};a.kC=function(a){switch(a){case "WHEEL_FRONT_LEFT":return 0;
case "WHEEL_FRONT_RIGHT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.is_character=H;a.eE=J;a.dy=function(){return qa};a.Tw=function(){z.C(z.iu)};a.Lz=function(a){var b=V.indexOf(a);-1==b&&I.error("Object "+a.name+" doesn't have bounding physics");for(var c=Z,d=a.m.S,e=c.m.p,f=[],g=0;g<e.length;g++)for(var h=e[g].Sa,k=0;k<h.Zb.length;k++)for(var l=h.Zb[k],m=0;m<l.Ve.length;m++){var n=l.Ve[m];if(n[0]==d||n[1]==d)l.Ve.splice(m,1),l.tk.splice(m,1),m--,f.push(n)}f.length&&
z.C(z.Eo,f);a.m&&a.m.Ef&&A(a);delete la[d];V.splice(b,1);a=c.m.p;for(b=0;b<a.length;b++)a[b].Sa.S==d&&(a.splice(b,1),b--);z.C(z.nu,d)}};b4w.module.__data=function(a,p){function b(a,b){if(a)for(var c=la(a,b.id),d=0;d<c.length;d++){var e=c[d];"MESH"==e.type&&delete e.data.submeshes}Bb[b.id]=null;nb[b.id]=null}function d(a,b,c){var d;a instanceof ArrayBuffer&&(a=sa.Aq(a));d=a.width;a=a.height;M.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf(Qb)&&c&&M.warn("image",b,"is not from app root.")}function c(a,b,c,d,e,f){d=b.q;if(!d)throw"Nothing requested";ca.enqueue([[d,ca.AT_JSON,
d]],function(d,f,g,h){if(d){M.log("%cLOAD METADATA","color: #616",h);f=Ha.XA(d.b4w_format_version);switch(Ha.kt(f,Za.Ci)){case -1:f[0]<Za.Ci[0]?Ha.pa("JSON version is too old relative to B4W engine: "+Ha.Wk(f)+", required: "+Ha.Wk(Za.Ci)+". Reexport scene with the latest B4W addon to fix it."):M.warn("JSON version is a bit old relative to B4W engine: "+ +Ha.Wk(f)+", required: "+Ha.Wk(Za.Ci)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>
Za.Ci[0]?Ha.pa("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):M.warn("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}Za.cn=f;for(var k in d)a[k]=d[k];(d=a.binaries[0].binfile)?b.dp=d:(Q.us(b,"load_binaries"),Q.us(b,"prepare_bindata"));if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)M.lx(a.b4w_export_errors[d]);if(a.b4w_export_warnings)for(d=
0;d<a.b4w_export_warnings.length;d++)M.mx(a.b4w_export_warnings[d]);e(b,c)}else Q.Lo(b)},null,function(a){f(b,c,a)})}function e(a,b,c,d,e,f){d=ja(b.q)+b.dp;if(!d)throw"Binary data is missing";ca.enqueue([[d,ca.AT_ARRAYBUFFER,d]],function(d,f,g,h){d?(M.log("%cLOAD BINARY","color: #616",h),a.bin_data=d,e(b,c)):Q.Lo(b)},null,function(a){f(b,c,a)})}function f(a,b,c,d,e){d=a.bin_data;var f=a.binaries[0],h=a.objects,k=a.meshes;a=a.actions;for(var E=Ha.Qv(),l=["indices"],m=["normal","tangent"],n=["color",
"group"],T=["position","texcoord","texcoord2"],q=0;q<k.length;q++)for(var u=k[q].submeshes,t=0;t<u.length;t++)for(var p in u[t]){var w=u[t][p][1];if(-1!=l.indexOf(p)){var r=4*u[t][p][0]+f["int"],x=u[t],va=p,M=d;if(E)var S=new Uint32Array(M,r,w);else for(var S=new Uint32Array(w),M=new DataView(M),v=0;v<w;v++)S[v]=M.getUint32(r+4*v,!0);x[va]=S}else if(-1!=T.indexOf(p))r=4*u[t][p][0]+f["float"],u[t][p]=g(d,r,w,E);else if(-1!=m.indexOf(p)){r=2*u[t][p][0]+f["short"];x=u[t];va=p;M=d;S=new Float32Array(w);
M=new DataView(M);for(v=0;v<w;v++)S[v]=M.getInt16(r+2*v,!0)/32767;x[va]=S}else if(-1!=n.indexOf(p)){r=2*u[t][p][0]+f.ushort;x=u[t];va=p;M=d;S=new Float32Array(w);M=new DataView(M);for(v=0;v<w;v++)S[v]=M.getUint16(r+2*v,!0)/65535;x[va]=S}}for(p=0;p<h.length;p++)for(k=h[p].particle_systems,l=0;l<k.length;l++)m=k[l],m.transforms=g(d,4*m.transforms[0]+f["float"],m.transforms[1],E);for(h=0;h<a.length;h++){p=a[h];var k=p.fcurves,l=p.frame_range,n=l[0],T=l[1],q=U.Tx(n,T),l=null,t=u=!1,G;for(G in k)u|=-1<
G.indexOf("rotation_euler"),t|=-1<G.indexOf("rotation_quaternion");m=[];for(G in k)if(u&&t&&-1<G.indexOf("rotation_euler"))delete k[G];else{var w=k[G],fa;for(fa in w)r=w[fa],x=g(d,f["float"]+4*r.bin_data_pos[0],r.bin_data_pos[1],E),va=new Float32Array(q),null===l&&(l=new Int8Array(q)),U.nv(r,x,va,l,n,T),r.kc=va;-1<G.indexOf("rotation_euler")&&(U.sx(k[G]),m.push(G))}for(n=0;n<m.length;n++)T=m[n],q=T.replace("euler","quaternion"),k[q]=k[T],delete k[T];p.Ku=l}e(b,c)}function g(a,b,c,d){if(d)d=new Float32Array(a,
b,c);else{d=new Float32Array(c);a=new DataView(a);for(var e=0;e<c;e++)d[e]=a.getFloat32(b+4*e,!0)}return d}function k(a,b,c,d,e){0===b.id&&(Ic=a);var f=a.cameras,g=a.groups,k=a.materials,E=a.meshes,l=a.node_groups,m=a.objects,n=a.particles,u=a.scenes,t=a.speakers,p=a.textures,w=a.worlds;l||(M.warn('"node_groups" datablock undefined. reexport main scene.'),l=a.node_groups=[]);for(var r="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),
S={},v=0;v<r.length;v++)for(var G=a[r[v]],fa=0;fa<G.length;fa++){var Q=G[fa];S[Q.uuid]=Q}for(var y=0;y<u.length;y++){for(var C=u[y],A=C.objects,F=0;F<A.length;F++)B(A,F,S);C.camera&&B(C,"camera",S);C.world&&B(C,"world",S)}for(y=0;y<g.length;y++)for(var ma=g[y].objects,F=0;F<ma.length;F++)B(ma,F,S);for(y=0;y<m.length;y++){var L=m[y];L.dupli_group&&B(L,"dupli_group",S);L.parent&&B(L,"parent",S);if(L.animation_data){var z=L.animation_data;z.action&&B(z,"action",S);if(z.nla_tracks)for(F=0;F<z.nla_tracks.length;F++)for(var ca=
z.nla_tracks[F],ba=0;ba<ca.strips.length;ba++)ca.strips[ba].action&&B(ca.strips[ba],"action",S)}switch(L.type){case "MESH":if(!L.data)throw"mesh not found for object "+L.name;B(L,"data",S);for(var ia=L.modifiers,F=0;F<ia.length;F++){var H=ia[F];"ARMATURE"==H.type?B(H,"object",S):"CURVE"==H.type&&B(H,"object",S)}var O=L.particle_systems;if(O)for(F=0;F<O.length;F++)B(O[F],"settings",S);break;case "ARMATURE":B(L,"data",S);for(var Sa=L.pose.bones,J=L.data.bones,F=0;F<Sa.length;F++){var sb=Sa[F];sb.bone=
J[sb.bone];for(var gc=sb.parent_recursive,ba=0;ba<gc.length;ba++)gc[ba]=Sa[gc[ba]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":B(L,"data",S)}var W=L.constraints;if(W)for(F=0;F<W.length;F++){var sa=W[F];sa.target&&B(sa,"target",S)}var ra=L.lod_levels;if(ra)for(F=0;F<ra.length;F++){var N=ra[F];N.object&&B(N,"object",S)}}for(y=0;y<E.length;y++)for(var R=E[y].materials,F=0;F<R.length;F++)B(R,F,S);for(y=0;y<k.length;y++){for(var D=k[y],X=D.texture_slots,F=0;F<X.length;F++)B(X[F],"texture",
S);var P=D.node_tree;P&&x(P,S)}for(y=0;y<l.length;y++)(P=l[y].node_tree)&&x(P,S);for(y=0;y<p.length;y++){var Y=p[y],nb=Y.type;"IMAGE"!=nb&&"ENVIRONMENT_MAP"!=nb||B(Y,"image",S)}for(y=0;y<f.length;y++){var ga=f[y];ga.dof_object&&B(ga,"dof_object",S)}for(y=0;y<t.length;y++){var ka=t[y];ka.sound&&B(ka,"sound",S);if(ka.animation_data&&(z=ka.animation_data,z.action&&B(z,"action",S),z.nla_tracks))for(F=0;F<z.nla_tracks.length;F++)for(ca=z.nla_tracks[F],ba=0;ba<ca.strips.length;ba++)ca.strips[ba].action&&
B(ca.strips[ba],"action",S)}for(y=0;y<n.length;y++){for(var kb=n[y],X=kb.texture_slots,F=0;F<X.length;F++)B(X[F],"texture",S);kb.dupli_group&&B(kb,"dupli_group",S);kb.dupli_object&&B(kb,"dupli_object",S)}for(y=0;y<w.length;y++)if(X=w[y].texture_slots)for(F=0;F<X.length;F++)B(X[F],"texture",S);Xb.Nv(a);for(var cb=a.textures,lc=q(a)?a.scenes[0].b4w_anisotropic_filtering:h().b4w_anisotropic_filtering,ta=0;ta<cb.length;ta++)q(a)||"SCENE"!=cb[ta].b4w_source_type||(cb[ta].b4w_source_id=""),La.Kw(cb[ta],
lc,a.scenes,b.id);for(var rb={},Za=a.objects,ea=0;ea<Za.length;ea++){var Oa=Za[ea];if("MESH"===Oa.type&&!Oa.particle_systems.length)for(var ja=Oa.data,ha=ja.name,Z=ja.submeshes,Fa=ja.materials,hc=0;hc<Z.length;hc++)0!==Z[hc].base_length||rb[ha]||(Fa[hc]&&M.warn('material "'+Fa[hc].name+'" is not assigned to any face (object "'+Oa.name+'").'),rb[ha]=!0)}for(var Bb=a.meshes,Ca=0;Ca<Bb.length;Ca++){var pa=Bb[Ca];pa.materials.length||pa.uv_textures.length&&M.warn('mesh "'+pa.name+'" has a UV map but has no exported material.')}a.materials.push({name:"DEFAULT",
use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],diffuse_intensity:1,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,
b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[]});
for(var qa=a.meshes,Qb=Ha.keysearch("name","DEFAULT",a.materials),Hc=0;Hc<qa.length;Hc++){var Ga=qa[Hc];0==Ga.materials.length&&Ga.materials.push(Qb)}for(var Ba=a.actions,Oc=b.id,$a=0;$a<Ba.length;$a++){var ib=Ba[$a];ib.Mu=Oc;U.Uu(ib)}for(var oc=a.scenes,Ab=0;Ab<oc.length;Ab++){for(var Ma=oc[Ab],Db=ua.Ml(Ma,"ALL"),zc=[],Eb=0;Eb<Db.length;Eb++)for(var Sb=Db[Eb].particle_systems,Ac=0;Ac<Sb.length;Ac++){var Hb=Sb[Ac].settings;if("HAIR"==Hb.type)if("OBJECT"==Hb.render_type)T.Sk(Hb.dupli_object,!0);else if("GROUP"==
Hb.render_type){for(var Va=Hb.dupli_group,Pa=ua.Ml(Ma,"EMPTY"),Ob=0;Ob<Pa.length;Ob++)Pa[Ob].dupli_group==Va&&zc.push(Pa[Ob]);for(Ob=0;Ob<Va.objects.length;Ob++)T.Sk(Va.objects[Ob],!0)}else M.warn("render type",Hb.render_type,"not supported for particle systems ("+Hb.name+").")}for(Eb=0;Eb<zc.length;Eb++)I(zc[Eb],[Ma])}V(a,b.id);for(var Sc=a.scenes,Pb=0;Pb<Sc.length;Pb++){for(var ld=Sc[Pb],Bc=[],ad=[],fd=Sc[Pb].objects,Tb=0;Tb<fd.length;Tb++){var ud=fd[Tb];K(fd,ud,Bc,ad);var pd=ud.dupli_group;if(pd)for(var Tc=
pd.objects,cc=0;cc<Tc.length;cc++)K(Tc,Tc[cc],Bc,ad)}for(Tb=0;Tb<ad.length;Tb++)I(ad[Tb],[ld]);for(Tb=0;Tb<Bc.length;Tb++)Ha.hv(Bc[Tb][0],Bc[Tb][1])}V(a,b.id);var fb=la(a,b.id);Xb.sv(fb,a.scenes);for(ta=0;ta<fb.length;ta++){var Uc=fb[ta];!q(a)&&Uc.parent&&-1<na.indexOf(Uc.parent.type)&&(Uc.parent="");T.Sk(Uc,!1);Uc.d.pc=b.id}for(var qd=0;qd<fb.length;qd++){var Vc=fb[qd];if("MESH"==Vc.type){var Cc=U.get_first_armature_object(Vc);if(Cc){var pc=Cc.d;if(pc.Be){var Dc=Vc.d.Kc,bd=[],rd;for(rd in Dc){var md=
Dc[rd];bd.push(4*md.fi,4*md.ip)}pc.nr.push(bd)}pc.Kk.push(Vc.d)}}}for(var Mc=-1,sd=-1,gd=U.uq(),qc=0;qc<fb.length;qc++){var Ec=fb[qc],Fb=Ec.d;if(Ha.is_mesh(Ec)&&Fb.bh){var Wc=Fb.ie;Wc>Mc&&(Mc=Wc);gd>=Wc&&Wc>sd&&(sd=Wc)}}for(qc=0;qc<fb.length;qc++)Ec=fb[qc],Fb=Ec.d,Ha.is_mesh(Ec)&&Fb.bh&&(Fb.ni=!0,Mc<gd?Fb.ie=Mc:Fb.ie<=gd?Fb.ie=sd:(M.warn('too many bones for "'+Ec.name+'" / '+Fb.ie+" bones (max "+gd+" with blending, "+2*gd+" without blending). Blending between frames will be disabled."),Fb.ie=Mc,Fb.ni=
!1),Fb.ni=Fb.ni&&!Gc.gq);for(var Xc=0;Xc<fb.length;Xc++){var Ub=fb[Xc];if(Ha.is_mesh(Ub)){var cd=Ub.lod_levels.length;if(cd)for(var Yc=Ub,Vb=0;Vb<cd;Vb++){var Fc=Ub.lod_levels[Vb].object;if(!Fc){Yc.d.gk=!0;Yc.d.Re=Ub.lod_levels[Vb].distance;break}Fc.d.$f=Ub.d.$f;Yc.d.Re=Ub.lod_levels[Vb].distance;Fc.d.Ai=Ub.lod_levels[Vb].distance;if(Ub.lod_levels[Vb+1])Fc.d.Re=Ub.lod_levels[Vb+1].distance;else{Fc.d.gk=!0;Fc.d.Re=1E4;break}Yc.d.gk=!1;Yc=Fc}}}for(var hd=0;hd<fb.length;hd++){var oa=fb[hd];if(oa.b4w_vehicle){var Wa=
oa.b4w_vehicle_settings;if("CHASSIS"==Wa.part){oa.k={};oa.k.eq=Wa.force_max;oa.k.jp=Wa.brake_max;oa.k.fB=Wa.suspension_compression;oa.k.hB=Wa.suspension_stiffness;oa.k.gB=Wa.suspension_damping;oa.k.jC=Wa.wheel_friction;oa.k.zE=Wa.roll_influence;oa.k.ez=Wa.max_suspension_travel_cm;oa.k.Sg=0;oa.k.Yh=1;oa.k.zh=0;oa.k.speed=0;oa.k.mg=[];oa.k.Ni=[];oa.k.Ah=null;for(var jd=oa.za?oa.za.dupli_group.objects:fb,rc=0;rc<jd.length;rc++){var Ka=jd[rc];if(Ka.b4w_vehicle){var Ya=Ka.b4w_vehicle_settings;if(va.Jy(Ka)&&
Wa.name==Ya.name){var vd=va.kC(Ka.b4w_vehicle_settings.part);oa.k.mg[vd]=Ka;oa.k.Ni[vd]=new Float32Array(8)}else if(va.Xq(Ka)&&Wa.name==Ya.name){oa.k.Ah=Ka;oa.k.Sn=Ya.steering_max;oa.k.Ks=Ya.steering_ratio;oa.k.Sq=Ya.inverse_control;var mb=Gb.invert(oa.d.T,new Float32Array(16)),dc=Gb.multiply(mb,Ka.d.T,mb);oa.k.Ms=dc;var Nc=new Float32Array([1,0,0,0]);sc.transformMat4(Nc,dc,Nc);oa.k.Ls=Nc}else if(va.Wq(Ka)&&Wa.name==Ya.name){oa.k.Pn=Ka;oa.k.Es=Ya.speed_ratio;oa.k.gn=Ya.max_speed_angle;var mb=Gb.invert(oa.d.T,
new Float32Array(16)),Wb=Gb.multiply(mb,Ka.d.T,mb);oa.k.Gs=Wb;var ec=new Float32Array([1,0,0,0]);sc.transformMat4(ec,Wb,ec);oa.k.Fs=ec}else if(va.Yq(Ka)&&Wa.name==Ya.name){oa.k.Wn=Ka;oa.k.Pp=Ya.delta_tach_angle;var mb=Gb.invert(oa.d.T,new Float32Array(16)),dd=Gb.multiply(mb,Ka.d.T,mb);oa.k.Ts=dd;var fc=new Float32Array([1,0,0,0]);sc.transformMat4(fc,dd,fc);oa.k.Ss=fc}}}if(4!=oa.k.mg.length)throw"Not enough wheels for chassis "+oa.name;}else if("HULL"==Wa.part){oa.k={};oa.k.mg=[];oa.k.Ni=[];oa.k.eq=
Wa.force_max;oa.k.jp=Wa.brake_max;oa.k.nm=Wa.floating_factor;oa.k.qo=Wa.water_lin_damp;oa.k.ro=Wa.water_rot_damp;oa.k.Sg=0;oa.k.Yh=1;oa.k.zh=0;oa.k.speed=0;oa.k.Ah=null;for(var td=oa.za?oa.za.dupli_group.objects:fb,rc=0;rc<td.length;rc++)Ka=td[rc],Ka.b4w_vehicle&&(Ya=Ka.b4w_vehicle_settings,va.Hy(Ka)&&Wa.name==Ya.name?(oa.k.mg.push(Ka),oa.k.Ni.push(new Float32Array(8))):va.Xq(Ka)&&Wa.name==Ya.name?(oa.k.Ah=Ka,oa.k.Sn=Ya.steering_max,oa.k.Ks=Ya.steering_ratio,oa.k.Sq=Ya.inverse_control,mb=Gb.invert(oa.d.T,
new Float32Array(16)),dc=Gb.multiply(mb,Ka.d.T,mb),oa.k.Ms=dc,Nc=new Float32Array([1,0,0,0]),sc.transformMat4(Nc,dc,Nc),oa.k.Ls=Nc):va.Wq(Ka)&&Wa.name==Ya.name?(oa.k.Pn=Ka,oa.k.Es=Ya.speed_ratio,oa.k.gn=Ya.max_speed_angle,mb=Gb.invert(oa.d.T,new Float32Array(16)),Wb=Gb.multiply(mb,Ka.d.T,mb),oa.k.Gs=Wb,ec=new Float32Array([1,0,0,0]),sc.transformMat4(ec,Wb,ec),oa.k.Fs=ec):va.Yq(Ka)&&Wa.name==Ya.name&&(oa.k.Wn=Ka,oa.k.Pp=Ya.delta_tach_angle,mb=Gb.invert(oa.d.T,new Float32Array(16)),dd=Gb.multiply(mb,
Ka.d.T,mb),oa.k.Ts=dd,fc=new Float32Array([1,0,0,0]),sc.transformMat4(fc,dd,fc),oa.k.Ss=fc))}}}for(var nd=0;nd<fb.length;nd++){var Jc=fb[nd];if(Jc.b4w_floating){var od=Jc.b4w_floating_settings;if("MAIN_BODY"==od.part){Jc.Jc={};Jc.Jc.nm=od.floating_factor;Jc.Jc.qo=od.water_lin_damp;Jc.Jc.ro=od.water_rot_damp;Jc.Jc.yj=[];for(var yd=Jc.za?Jc.za.dupli_group.objects:fb,wd=0;wd<yd.length;wd++){var kd=yd[wd];if(kd.b4w_floating){var zd=kd.b4w_floating_settings;va.Ly(kd)&&od.name==zd.name&&(Jc.Jc.yj.push(kd),
kd.Dv=kd.b4w_floating_settings.synchronize_position)}}}}}for(ta=0;ta<a.scenes.length;ta++){var xd=a.scenes[ta];Ja.enabled&&xd.b4w_enable_physics&&(q(a)||!va.has_physics(h())&&xd==ua.lm(a))&&va.Ey(xd)}e(b,c)}function q(a){return a==Ic?!0:!1}function h(){return ua.lm(Ic.scenes)}function m(a,b,c,d,e){!q(a)&&1<a.scenes.length&&(a.scenes=[ua.lm(a.scenes)],M.warn("loading data contains multiple scenes.","Only the first one will be loaded."));d=h();-1==Gc.Ha&&(Gc.Ha=d.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(d),
1),a.scenes.unshift(d));for(var f=0;f<a.scenes.length;f++){var g=a.scenes[f];if(q(a)&&!g.camera)throw"Scene check failed: No camera";for(var k=ua.Ml(g,"MESH"),E=0;E<k.length;E++){var l=k[E],m=Xb.kv(l);m&&(a.meshes.push(m),l.data=m)}for(var E=la(a,b.id),l=a.meshes,m=l.slice(0),n=0;n<E.length;n++){var T=E[n];"MESH"==T.type&&(T=m.indexOf(T.data),-1<T&&m.splice(T,1))}for(n=0;n<m.length;n++)l.splice(l.indexOf(m[n]),1);q(a)?(ua.Zu(g,a.textures),g.d.Kh.length&&(b.Jm=!0),g.b4w_enable_audio&&ba.Wo(g),E=ua.zm(g),
l=g.b4w_batch_grid_size):(ua.ev(g,d,a.textures),g.b4w_enable_audio&&!d.j&&ba.Wo(d),E=ua.zm(d),l=d.b4w_batch_grid_size);m=[];S.Lx(E,l,k,d.d.vo,d.d.Lk,m,d.d.br);q(a)?(ua.Po(g,m),ua.Dx(E)):ua.Po(d,m)}d=a.materials;if(hc.Yl&&Za.et)for(a=0;a<d.length;a++){k=d[a];E=k.texture_slots;for(f=0;f<E.length;f++)if(l=E[f],m=l.texture,"IMAGE"==m.type||"ENVIRONMENT_MAP"==m.type)g=m.image,g.jc||(-1<g.filepath.indexOf(".dds")?g.jc=!0:(g.jc=!m.b4w_disable_compression&&!l.use_map_normal&&"ENVIRONMENT_MAP"!=m.type&&!m.b4w_shore_dist_map&&
"MOVIE"!=g.source,g.jc&&(g.filepath+=".dds")));if(f=k.node_tree)for(k=f.nodes,f=0;f<k.length;f++)g=k[f],"TEXTURE"==g.type&&(E=g.texture)&&(g=E.image)&&!g.jc&&(g.jc=E.d.qj&&!E.b4w_disable_compression&&"MOVIE"!=g.source,g.jc&&(g.filepath+=".dds"))}else for(a=a.images,d=0;d<a.length;d++)f=a[d],f.jc=Boolean("FILE"==f.source&&-1<f.filepath.indexOf(".dds"));e(b,c)}function u(a,b,c,d,e){d=a.groups;a=a.objects;for(var f={},g={},h={},k={},E=0;E<d.length;E++){var l=d[E];f[l.uuid]=l;h[l.uuid]=l}for(E=0;E<a.length;E++)l=
a[E],g[l.uuid]=l,k[l.uuid]=l;n(a,null,k,h);for(var m in h)m in f||d.push(h[m]);for(m in k)m in g||a.push(k[m]);e(b,c)}function n(a,b,c,d){for(var e=[],f=0;f<a.length;f++){var g=a[f],h=c[g.uuid];if(g=h.proxy){b&&-1==e.indexOf(g.uuid)&&e.push(g.uuid);for(var k=c[g.uuid],l=k.constraints,g=0;g<l.length;g++){var m=Ha.Df(l[g]);m.name+="_CLONE";h.constraints.push(m)}"b4w_proxy_inherit_anim"in h&&!h.b4w_proxy_inherit_anim||(h.animation_data&&(k.animation_data=Ha.Df(h.animation_data)),k.b4w_use_default_animation=
h.b4w_use_default_animation,k.b4w_auto_skel_anim=h.b4w_auto_skel_anim,k.b4w_anim_behavior=h.b4w_anim_behavior,k.b4w_cyclic_animation=h.b4w_cyclic_animation)}}for(f=0;f<e.length;f++)h=Ha.Am(a,"uuid",e[f]),-1<h&&a.splice(h,1);e={};for(f=0;f<a.length;f++)g=a[f],h=c[g.uuid],b&&(l=Ha.Df(h),h="origin_name"in h?h.origin_name:h.name,l.name=b+"*"+h,l.origin_name=h,w(l),c[l.uuid]=l,e[g.uuid]=l.uuid,g.uuid=l.uuid),h=c[g.uuid],h.dupli_group&&(g=h.dupli_group,l=d[g.uuid],k=Ha.Df(l),k.name=Ha.Qk(l.name+"_CLONE"),
k.uuid=E.Mq("Group"+k.name),d[k.uuid]=k,g.uuid=k.uuid,n(k.objects,h.name,c,d));if(b)for(f=0;f<a.length;f++){g=a[f];h=c[g.uuid];h.parent&&h.parent.uuid in e?h.parent.uuid=e[h.parent.uuid]:h.parent&&(M.warn("Object's \""+h.name+'" parent is not in dupli group. Disabling parenting.'),h.parent=null);l=h.constraints;for(g=0;g<l.length;g++)b=l[g],b.target&&b.target.uuid in e&&(b.target.uuid=e[b.target.uuid]);b=h.modifiers;for(g=0;g<b.length;g++)d=b[g],d.object&&d.object.uuid in e&&(d.object.uuid=e[d.object.uuid]);
if((h=h.lod_levels)&&h.length)for(g=0;g<h.length;g++)b=h[g],b.object&&b.object.uuid in e&&(b.object.uuid=e[b.object.uuid])}for(var T in e)Ca[T]=e[T]}function w(a){a.uuid=E.Mq("Object"+a.name)}function x(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var e=c[d];"TEXTURE"==e.type&&e.texture&&B(e,"texture",b);"LAMP"==e.type&&e.lamp&&(e.lamp.uuid in Ca&&(e.lamp.uuid=Ca[e.lamp.uuid]),b[e.lamp.uuid]||(e.lamp=null));"GROUP"==e.type&&e.node_group&&B(e,"node_group",b)}e=a.links;for(d=0;d<e.length;d++){var f=e[d];
y(f,"from_node",c);y(f,"to_node",c);r(f,"from_socket",f.from_node.outputs);r(f,"to_socket",f.to_node.inputs)}if(c=a.animation_data)if(c.action&&B(c,"action",b),c.nla_tracks)for(d=0;d<c.nla_tracks.length;d++)for(e=c.nla_tracks[d],f=0;f<e.strips.length;f++)e.strips[f].action&&B(e.strips[f],"action",b)}function B(a,b,c){(c=c[a[b].uuid])||M.error("Dangling link found:",b,a);a[b]=c}function y(a,b,c){c=Ha.keysearch("name",a[b].name,c);a[b]=c}function r(a,b,c){c=Ha.keysearch("identifier",a[b].identifier,
c);a[b]=c}function A(a,b,c,e,f,g){if(!Za.do_not_load_resources){for(var h=ja(b.q),k=a.images,l={},E=[],m=0;m<k.length;m++){var n=k[m],T=n.uuid;if("FILE"===n.source||"MOVIE"===n.source){var q=t(n,a.textures);if(!q.length)M.warn("image ",n.name," has no users.");else if(!q[0].b4w_shore_dist_map){q=v(h+n.filepath);if("FILE"===n.source){var u=n.jc?ca.AT_ARRAYBUFFER:ca.AT_IMAGE_ELEMENT;hc.hn&&Za.Uk&&(q=ca.Wi(q),"dds"==q[1]?(q=ca.Wi(q[0]),q=q[0]+".min50."+q[1]+".dds"):q=q[0]+".min50."+q[1])}else"MOVIE"===
n.source&&(Za.Sc?(q=ca.Wi(q),q=q[0]+".altconv.seq",u=ca.gj):(q=ca.Wi(q),u=ba.detect_video_container(q[1]),q=u!=q[1]?q[0]+".altconv."+u:q[0]+"."+u,u=ca.hj));E.push([T,u,q]);l[T]=n}}}E.length?(e.Nq=0,ca.enqueue(E,function(f,h,k,m){if(f){if(k==ca.hj||k==ca.gj){if(k==ca.hj)var n=f.videoWidth,T=f.videoHeight;else n=f.images[0].width,T=f.images[0].height;M.log("%cLOAD VIDEO "+n+"x"+T,"color: #"+(2048<n||2048<T?"a00":1024<n||1024<T?"aa0":"0a0"),m);-1==m.indexOf(Qb)&&M.warn("video",m,"is not from app root.")}else d(f,
m,!0);h=l[h];m=t(h,a.textures);for(n=0;n<m.length;n++){var T=m[n],q=T.image.filepath;k==ca.gj?(T.d.ls=f.ac,La.Zi(T.d,f.images,h.jc,q,b.id)):La.Zi(T.d,f,h.jc,q,b.id)}}f=++e.Nq/E.length;g(b,c,f)},function(){M.log("%cLOADED ALL IMAGES","color: #0a0");f(b,c)})):f(b,c)}}function t(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];e.image===a&&c.push(e)}return c}function F(a,b,c,d,e,f){if(!Za.do_not_load_resources){a=la(a,b.id);for(var g=ja(b.q),h=[],k={},E=0;E<a.length;E++){var l=a[E];if(C(l)){var m=l.data.sound,
n=m.uuid;"BACKGROUND_MUSIC"==ba.Bm(l)?(n=Ha.vm(),b.Im=!0):"NONE"!=ba.Bm(l)&&Za.Qq&&(b.Mm=!0);if(!(n in k)){k[n]=[];m=v(g+m.filepath);switch(ba.Cs(l)){case ba.Zk:var T=ca.AT_AUDIOBUFFER;break;case ba.wo:T=ca.AT_AUDIO_ELEMENT}var m=ca.Wi(m),q=ba.detect_audio_container(m[1]),m=q!=m[1]?m[0]+".altconv."+q:m[0]+"."+q;h.push([n,T,m])}k[n].push(l)}}h.length?ca.enqueue(h,function(a,e,g,l){if(a)for(M.log("%cLOAD SOUND","color: #0aa",l),-1==l.indexOf(Qb)&&M.warn("sound",l,"is not from app root."),e=k[e],g=0;g<
e.length;g++)ba.KB(e[g],a);a=++d.JA/h.length;f(b,c,a)},function(){M.log("%cLOADED ALL SOUNDS","color: #0aa");e(b,c)}):e(b,c)}}function C(a){return ba.fe(a)&&ba.Cs(a)!=ba.xo?!0:!1}function l(a,b){for(var c=ua.Ia(a,"SPEAKER",ua.DATA_ID_ALL),d=0;d<c.length;d++){var e=c[d];ba.fe(e)&&(ba.is_cyclic(e)||b)&&ba.play_def(e)}}function H(a){a=a.d.Kh;for(var b=0;b<a.length;b++)Za.Sc&&a[b].use_auto_refresh?a[b].d.rh=!0:a[b].d.La&&a[b].use_auto_refresh&&a[b].d.La.play()}function J(a,b,c,d,e){sb.start();M.log("%cSTART NLA",
"color: #0a0");e(b,c)}function K(a,b,c,d){if(b.lod_levels&&b.lod_levels.length)for(var e=b.lod_levels.length,f=0;f<e;f++){var g=b.lod_levels[f],h=g.object;if(h){var k=Ha.Fj(h);k.name=b.name+"_LOD_"+String(f+1);w(k);k.lod_levels=[];c.push([a,k]);d.push(h);g.object=k}}}function I(a,b){for(var c=0;c<b.length;c++){for(var d=b[c].objects,e=0;e<d.length;e++){var f=d[e].dupli_group;f&&(f=f.objects,g=f.indexOf(a),-1<g&&f.splice(g,1))}var g=d.indexOf(a);-1<g&&d.splice(g,1)}}function P(a,b,c,d,e){d=!0;for(var f=
0;f<a.scenes.length;f++)if(!va.Vv(a.scenes[f])){d=!1;break}d&&(e(b,c),M.log("%cPHYSICS READY","color: #0a0"))}function z(a,b,c,d,e){d=h();for(var f=0;f<a.scenes.length;f++){var g=a.scenes[f],k=q(a)?va.has_physics(g):va.has_physics(d)||va.has_physics(g);q(a)||(g=d);for(var l=0;l<$a.length;l++)for(var E=ua.Ia(g,$a[l],ua.DATA_ID_ALL),m=0;m<E.length;m++){var n=E[m];n.d.pc==b.id&&Ja.enabled&&k&&(va.append_object(n,g),b.an&&va.has_physics(n)&&va.disable_simulation(n))}}e(b,c)}function N(a,b,c,e,f){var g=
{};e=[];for(var h=a.scenes,k=0;k<a.scenes.length;k++){var l=h[k];if(l.d.$a&&(l=l.d.$a.Jk)&&"FILE"===l.source){var E=l.uuid,m=v(ja(b.q)+l.filepath);e.push([E,l.jc?ca.AT_ARRAYBUFFER:ca.AT_IMAGE_ELEMENT,m]);g[E]=l}}e.length?ca.enqueue(e,function(c,e,f,k){if(c){d(c,k,!0);e=g[e];k=t(e,a.textures);for(f=0;f<k.length;f++){var l=k[f];La.Zi(l.d,c,e.jc,l.image.filepath,b.id)}for(f=0;f<h.length;f++)if(k=h[f],k.d.$a.Jk===e){var E=c,m=document.createElement("canvas"),l=e.size[0],n=e.size[1];m.width=l;m.height=
n;m=m.getContext("2d");m.drawImage(E,0,0);E=m.getImageData(0,0,l,n).data;m=new Float32Array(4);m[0]=1/16581375;m[1]=1/65025;m[2]=1/255;m[3]=1;for(var l=l*n,n=new Float32Array(l),T=0;T<l;T++)n[T]=m[1]*E[4*T+2]+m[2]*E[4*T+3];k.d.Hn=n}}},function(){f(b,c)}):f(b,c)}function G(a,b,c,e,f){if(Za.antialiasing&&Za.smaa){e=a.scenes[0];a=[];for(var g=["SMAA_EDGE_DETECTION","SMAA_BLENDING_WEIGHT_CALCULATION","SMAA_NEIGHBORHOOD_BLENDING","SMAA_RESOLVE"],h=0;h<g.length;h++){var k=ua.ca(e,g[h]);k&&a.push(k)}if(a.length){e=
[];h=ca.AT_IMAGE_ELEMENT;e.push(["SEARCH_TEXTURE",h,fa.Tb.smaa_search_texture_path]);e.push(["AREA_TEXTURE",h,fa.Tb.smaa_area_texture_path]);for(h=0;h<a.length;h++)if(g=a[h],"SMAA_BLENDING_WEIGHT_CALCULATION"==g.type){a=g.ka;for(h=0;h<a.length;h++)if(g=a[h],"u_search_tex"==g.la)var l=g.ta;else if("u_area_tex"==g.la)var E=g.ta;break}e.length?ca.enqueue(e,function(a,c,e,f){a&&(d(a,f,!1),c="SEARCH_TEXTURE"==c?l:E,c.source="IMAGE",c.ap=!0,La.Zi(c,a,-1!=f.indexOf(".dds")?1:0,f,b.id),La.Gn(c,La.r,La.r))},
function(){f(b,c)}):f(b,c)}else f(b,c)}else f(b,c)}function L(a,b,c,d){for(c=0;c<a.scenes.length;c++){var e=a.scenes[c];q(a)||(e=h());for(var f=ua.Ia(e,"LAMP",ua.DATA_ID_ALL),g=0;g<f.length;g++){var k=f[g];k.d.pc==b.id&&(b.an&&Ha.is_mesh(k)&&ua.hide_object(k),d.hl.push({ks:e,obj:k}))}f=ua.Ia(e,"ALL",ua.DATA_ID_ALL);for(g=0;g<f.length;g++)k=f[g],"LAMP"!=k.type&&k.d.pc==b.id&&(b.an&&Ha.is_mesh(k)&&ua.hide_object(k),d.hl.push({ks:e,obj:k}))}}function O(a,b,c,d,e,f){e=d.hl;var g=d.xr;e.length?(a=e[g].obj,
g=e[g].ks,ua.append_object(g,a,!1),-1!=Ba.indexOf(a.type)&&g.b4w_enable_audio&&ba.append_object(a,g),pa.is_anchor(a)&&pa.append(a),d=++d.xr/e.length,"LAMP"==a.type&&ua.IA(g),null!=a.d.nc&&ua.$s(g,a),a.d.yc&&"PLANE"==a.d.ke&&g.d.zb&&(ua.tv(a,g),ua.ct(a.d.vc,g))):d=1;f(b,c,d)}function W(a,b,c,d,e){if(q(a)){d=ua.hy();for(var f=ua.Wg(),g=0;g<d.length;g++){var k=d[g];ua.Dz(k,f);k.b4w_use_nla&&sb.HB(k,k.b4w_nla_cyclic,b.id)}ua.set_active(f)}else ua.dt(h());a=la(a,b.id);T.FB(a);e(b,c)}function X(a,b,c,d,
e){if(q(a))for(d=0;d<a.scenes.length;d++)a.scenes[d].b4w_use_nla||H(a.scenes[d]),l(a.scenes[d]);else a.scenes[0].b4w_use_nla||H(h()),l(h());e(b,c)}function Y(a,b,c,d,e){Za.Sf&&(b.Jm||b.Im||b.Mm)?Fa||R(a,e,b,c):e(b,c)}function R(a,b,c,d){var e=Ga.parentElement;Oc=e.style.zIndex;e.style.zIndex="999";Fa=document.createElement("div");Fa.style.position="relative";Fa.style.height="88px";Fa.style.width="88px";var f=Math.round(Ga.offsetWidth/2-44);Fa.style.top=Math.round(Ga.offsetHeight/2-44).toString()+
"px";Fa.style.left=f.toString()+"px";Fa.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
Fa.style.backgroundSize="88px";ka=document.createElement("div");ka.style.position="relative";ka.style.height=Ga.offsetHeight.toString()+"px";ka.style.width=Ga.offsetWidth.toString()+"px";ka.style.background="rgba(0, 0, 0, 0.5)";ka.style.zIndex="999";e.appendChild(ka);ka.appendChild(Fa);Fa.addEventListener("click",function(){c.Jm&&(La.play(),La.pause(),La.reset());if(c.Im){if(q(a))for(var e=0;e<a.scenes.length;e++)l(a.scenes[e],!0);else l(h(),!0);ba.pause()}c.Mm&&ba.xz();ga();b(c,d)},!1)}function ga(){if(Fa){var a=
Ga.parentElement;a.style.zIndex=Oc;ka.removeChild(Fa);a.removeChild(ka);Fa=ka=null;Oc=0}}function ja(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function qa(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var c=[],d=0;d<a.length;d++){var e=a[d];""!=e&&"."!=e&&(".."!=e||!b&&!c.length||c.length&&".."==c[c.length-1]?c.push(e):c.length&&c.pop())}a=c.join("/");for(d=0;d<b;d++)a="/"+a;return a||"."}function v(a){var b=
a.split("://",2);return 1<b.length?(b[1]=qa(b[1]),b.join("://")):qa(a)}function Z(a,b,c){U.is_animated(b)&&U.remove(b);ua.clear_outline_anim(b);va.has_physics(b)&&va.Lz(b);ia.check_sensor_manifold(b)&&ia.remove_sensor_manifold(b);ua.Mz(a,b,c);ba.fe(b)&&ba.LA(b);pa.is_anchor(b)&&pa.remove(b)}function la(a,b){nb[b]||V(a,b);return nb[b]}function V(a,b){for(var c=a.scenes,d=[],e=0;e<c.length;e++)ha(c[e].objects,0,q(a),d);nb[b]=[];for(e=0;e<d.length;e++)for(var c=d[e],f=0;f<c.length;f++)for(var g=c[f],
h=0;h<g.length;h++)nb[b].push(g[h])}function ha(a,b,c,d){d[b]=d[b]||[];for(var e=d[b],f=0;f<a.length;f++){var g=a[f],h=ea(g);e[h]=e[h]||[];(c||-1==na.indexOf(g.type))&&-1==e[h].indexOf(g)&&e[h].push(g);(g=g.dupli_group)&&ha(g.objects,b+1,c,d)}}function ea(a){return(a=a.parent||U.get_first_armature_object(a))?1+ea(a):0}var pa=p("__anchors"),U=p("__animation"),S=p("__batch"),fa=p("__config"),ia=p("__controls"),sa=p("__dds"),ra=p("__extensions");p("__lights");var Q=p("__loader"),ca=p("__assets"),E=p("__md5"),
T=p("__objects"),va=p("__physics"),M=p("__print"),Xb=p("__reformer"),ma=p("__renderer"),ua=p("__scenes"),sb=p("__nla"),ba=p("__sfx"),Sa=p("__shaders"),La=p("__textures"),gc=p("__nodemat"),Ha=p("__util");p("__transform");var sc=p("vec4"),Gb=p("mat4"),Za=fa.o,hc=fa.Od,Ja=fa.Sa,Gc=fa.Nd,Hc=fa.cd,Bb=null,nb=null,Qb="",Ic=!1,Ca={},Fa=null,ka=null,Oc=0,na=["LAMP","CAMERA"],$a=["MESH","CAMERA","EMPTY"],Ba=["SPEAKER"],Ga=null;a.is_primary_loaded=function(a){return Q.is_primary_loaded(a)};a.update=function(){Q.IB(Bb)};
a.yA=function(a){Ga=a};a.EB=function(a,b){if(Fa){ka.style.height=b.toString()+"px";ka.style.width=a.toString()+"px";var c=Math.round(a/2-44);Fa.style.top=Math.round(b/2-44).toString()+"px";Fa.style.left=c.toString()+"px"}};a.load=function(a,d,g,h,l){var E={load_main:{Ta:Q.we,ab:!1,J:[],gb:!1,ib:500,yb:!1,cb:c},duplicate_objects:{Ta:Q.hd,ab:!1,J:["load_main"],gb:!1,ib:50,yb:!1,cb:u},load_binaries:{Ta:Q.we,ab:!1,J:["load_main"],gb:!1,ib:500,yb:!1,cb:e},prepare_bindata:{Ta:Q.hd,ab:!1,J:["duplicate_objects",
"load_binaries"],gb:!1,ib:0,yb:!1,cb:f},prepare_root_datablocks:{Ta:Q.hd,ab:!1,J:["duplicate_objects","prepare_bindata"],gb:!1,ib:150,yb:!1,cb:k},prepare_root_scenes:{Ta:Q.hd,ab:!1,J:["prepare_root_datablocks"],gb:!1,ib:350,yb:!1,cb:m},load_smaa_textures:{Ta:Q.we,ab:!0,J:["prepare_root_scenes"],gb:!1,ib:10,yb:!0,cb:G},load_shoremap:{Ta:Q.we,ab:!0,J:["prepare_root_scenes"],gb:!1,ib:10,yb:!0,cb:N},load_textures:{Ta:Q.we,ab:!0,J:["prepare_root_scenes"],gb:!0,ib:500,yb:!1,cb:A,Cf:{Nq:0}},wait_physics_workers:{Ta:Q.we,
ab:!0,J:["load_shoremap"],gb:!1,ib:20,yb:!1,Bf:P},add_physics_objects:{Ta:Q.hd,ab:!1,J:["wait_physics_workers"],gb:!1,ib:20,yb:!1,cb:z},add_objects:{Ta:Q.hd,ab:!1,J:["add_physics_objects"],gb:!1,ib:800,yb:!1,cb:L,Bf:O,Zh:W,Cf:{hl:[],xr:0}},load_speakers:{Ta:Q.we,ab:!0,J:["add_objects"],gb:!0,ib:30,yb:!1,cb:F,Cf:{JA:0}},mobile_media_start:{Ta:Q.hd,ab:!Za.Sf,J:["load_textures","load_speakers"],gb:!0,ib:5,yb:!1,cb:Y,Bf:Y},synchronize_media:{Ta:Q.hd,ab:!0,J:["mobile_media_start"],gb:!0,ib:70,yb:!1,cb:X},
start_nla:{Ta:Q.hd,ab:!0,J:["mobile_media_start"],gb:!1,ib:5,yb:!1,cb:J}},n=Q.yq();n||(n=Q.Dw(),Bb={},nb={},Ca={});Bb[n.Cd.length]={};return Q.Lw(E,a,d,g,b,h||Hc.Yo,Za.do_not_load_resources,l)};a.unload=function(a){var b=Q.yq();if(!b||!b.Cd.length||a&&!Q.jB(b.Cd[a]))M.error("Unable to unload data!");else{if(0==a)M.log("%cUNLOAD ALL","color: #00a"),pa.cleanup(),U.cleanup(),ba.cleanup(),sb.cleanup(),ua.cleanup(),Q.cleanup(),va.cleanup(),T.cleanup(),Ha.cleanup(),ma.cleanup(),gc.cleanup(),Sa.cleanup(),
ia.cleanup(),ra.cleanup(),ca.cleanup(),La.cleanup(),nb=null,Ca={},Ic=!1,Bb=null;else{M.log("%cUNLOAD DATA "+a,"color: #00a");U.Kz(a);for(var b=ua.ri(),c=0;c<b.length;c++)for(var d=b[c],e=ua.Ia(d,"ALL",ua.DATA_ID_ALL),f=e.length-1;0<=f;f--){var g=e[f];if(g.d.pc==a){Z(d,g,!0);e.splice(f,1);var h=ua.Ia(d,g.type,ua.DATA_ID_ALL),g=h.indexOf(g);-1!=g&&h.splice(g,1)}}}ga()}};a.Cz=Z;a.set_debug_resources_root=function(a){Qb=a}};b4w.module.__batch=function(a,p){function b(a){a={type:a,Ka:"",id:0,Nz:0,mh:"",L:[],Gb:[],Pc:[],ai:[],zg:null,sb:{},Xb:null,pb:null,Xo:[],uc:null,R:null,Kc:null,Dd:!1,Ng:!1,Lp:!1,wireframe_mode:0,num_vertices:0,num_triangles:0,Zq:0,$q:0,Bq:0,Dm:0,bc:new Float32Array(3),mc:new Float32Array(16),Fa:!1,Bp:!1,W:!1,ue:!1,Ja:!1,yg:!1,nd:!1,Ac:!1,hc:!1,Yb:!1,Vb:!1,Mb:!1,yc:!1,mb:!1,Wr:!1,Zd:R.Ph,ve:R.Kd,Jf:!1,wn:"",DE:"",Cq:!1,Gq:0,Dq:0,Hq:0,Iq:0,Fq:new Float32Array(3),Eq:new Float32Array(3),Pf:!1,Md:0,$d:0,
Ge:1,og:0,Ds:0,vh:1,kg:0,Fe:0,ze:1,tr:0,jn:0,fg:0,ds:0,qc:Array(2),ic:new Float32Array(3),jf:new Float32Array(3),yd:new Float32Array(3),Mc:new Float32Array(4),Yc:new Float32Array(4),dh:null,Vm:null,Tm:null,Sm:null,Um:null,of:!1,water_dynamic:!1,so:!1,ot:!1,pt:0,qt:0,nt:0,Oh:.1,shallow_water_col_fac:0,shore_water_col_fac:0,foam_factor:0,dq:new Float32Array(2),cq:new Float32Array(2),om:new Float32Array(2),shallow_water_col:new Float32Array(3),shore_water_col:new Float32Array(3),dg:null,Cn:!1,Jr:0,Fr:0,
qn:0,Ir:0,Lr:0,Kr:0,Gr:0,Hr:0,rn:0,Cr:0,Br:0,Nr:0,Er:0,sk:new Float32Array(3),Mr:new Float32Array(8),Dr:new Float32Array(16)};a.Mc[3]=1;a.Bp=!0;a.W=!0;return a}function d(a){switch(a.type){case "MAIN":case "NODES":case "PARTICLES":a.Ka=a.Fa?a.ue?"XRAY":"BLEND":"OPAQUE";break;case "DEPTH":a.Ka="DEPTH";break;case "COLOR_ID":a.Ka=a.ue?"COLOR_ID_XRAY":"COLOR_ID"}}function c(a,b){for(var c=[],d=ha.Ba(b,"SHADOW_CAST"),f=ha.Ba(b,"MAIN_PLANE_REFLECT"),g=ha.Ba(b,"MAIN_CUBE_REFLECT"),h=ha.Ba(b,"OUTLINE_MASK"),
k=ha.Ba(b,"COLOR_PICKING"),l=0;l<a.n.length;l++){var m=a.n[l],n=null;"DEPTH"==m.type&&d&&m.Ac&&(n=e(m),n.Ka="SHADOW_CAST");"MAIN"!=m.type&&"NODES"!=m.type&&"PARTICLES"!=m.type||!f&&!g||m.Fa||!m.Vb||(n=e(m),n.Ka="REFLECT");"COLOR_ID"==m.type&&(h&&k?(n=e(m),n.Ka="OUTLINE"):h&&!k&&(m.Ka="OUTLINE"));n&&(n.Jf=!0,I(n,a.d.id),c.push(n))}a.n.push.apply(a.n,c)}function e(a){var b=a.R,c=a.uc;a.R=null;a.uc=null;var d=qa.iw(a);a.R=b;d.R=b;a.uc=c;d.uc=c;return d}function f(a,b,c){for(var d=[],e=0;e<a.length;e++){var f=
a[e],g=f.d,h=q(f.data.b4w_bounding_box),l=f.data.b4w_bounding_cylinder_radius,m=f.data.b4w_bounding_sphere_radius,n=f.data.b4w_bounding_sphere_center,u=f.data.b4w_bounding_ellipsoid_axes,t=f.data.b4w_bounding_ellipsoid_center;if(g.kd){var m=Math.max(Math.abs(h.max_x),Math.abs(h.min_x)),l=Math.max(Math.abs(h.max_y),Math.abs(h.min_y)),p=Math.max(Math.abs(h.max_z),Math.abs(h.min_z)),p=Math.sqrt(m*m+l*l+p*p),m=Math.sqrt(m*m+l*l);h.max_x=h.max_y=h.max_z=p;h.min_x=h.min_y=h.min_z=-p;l=m;m=p;n[0]=n[1]=n[2]=
0;u[0]=u[1]=u[2]=p;t[0]=t[1]=t[2]=0}g.Pb=h;p=L.xl(h,g.T);g.bb=p;var p=g,w=l;p.sl=L.Gp(w,h);p.ql=L.Ep(l,h);p.rl=L.Fp(w,h);n=L.Rl(m,n);g.Vc=n;n=L.zl(n,g.T);g.vb=n;u=L.Ql([u[0],0,0],[0,u[1],0],[0,0,u[2]],t);g.yf=u;u=L.yl(u,g.Ab);g.zf=u;d=d.concat(k(f,g,b,c))}return d}function g(a,b,c,d){for(var e=[],f=[],g={},h=0;h<a.length;h++){var l=a[h],m=l.d,n=q(l.data.b4w_bounding_box),u=L.xl(n,m.T),t=L.Rl(l.data.b4w_bounding_sphere_radius,l.data.b4w_bounding_sphere_center),p=L.zl(t,m.T),w=l.data.b4w_bounding_ellipsoid_axes,
w=L.Ql([w[0],0,0],[0,w[1],0],[0,0,w[2]],l.data.b4w_bounding_ellipsoid_center),r=L.yl(w,m.Ab);m.Pb=n;m.bb=u;m.Vc=t;m.vb=p;m.yf=w;m.zf=r;n={};n.Ac=m.Ac;n.hc=m.hc;n.Yb=m.Yb;n.qg=m.qg;n.ok=m.ok;n.Fb=m.Fb;n.nk=m.nk;n.Ei=m.Ei;n.Vb=m.Vb;n.Mb=m.Mb;n.yc=m.yc;n.nc=m.nc;n.vc=m.vc;n.ke=m.ke;n.Af=m.Af;n.Gc=m.Gc;n.ge=m.ge;n.Jb=m.Jb;n.kd=m.kd;n.Xh=m.Xh;n.Wh=m.Wh;n.mb=m.mb;n.Pg=m.Pg;n.Mj=m.Mj;n.he=m.he;n.bg=m.bg;n.hk=m.hk;n.tc=m.tc;n.ag=m.ag;n.ik=m.ik;n.nd=m.nd;u=m.vb.F;n.vy=0==c?[0,0]:[Math.floor(u[0]/c),Math.floor(u[2]/
c)];n.Re=m.Re;n.Ai=m.Ai;n.$f=m.$f;m=JSON.stringify(n);g[m]=g[m]||[];g[m].push(l)}for(var x in g){n=JSON.parse(x);c=g[x];var l=qa.Ij("STATIC"),v;for(v in n)l[v]=n[v];l.pc=a[0].d.pc;l.Fd=0;l.te=0;l.Vd=0;l.Ud=0;l.Qd=0;l.Zg=!1;for(h=0;h<c.length;h++)m=c[h],0==h?(l.bb=S.qa(m.d.bb),l.vb=S.qa(m.d.vb),l.yf=S.qa(m.d.yf),l.zf=S.qa(m.d.zf)):(L.Vp(l.bb,m.d.bb),L.kx(l.vb,m.d.vb));l.Pb=S.qa(l.bb);l.Vc=S.qa(l.vb);f.push({Wb:l,je:c})}for(a=0;a<f.length;a++)for(g=f[a].Wb,h=f[a].je,x=0;x<h.length;x++){v=h[x];c=k(v,
g,b,d);v.d.kd&&!v.d.cp?(l=U.create(),U.set_trans(v.d.h,l)):(l=v.d,l=U.create_sep(l.h,l.scale,l.quat));m={};if(g.Gc||g.kd)m.au_center_pos=[l[0],l[1],l[2]];g.Gc&&(m.au_wind_bending_amp=[v.d.Fd],m.au_wind_bending_freq=[v.b4w_wind_bending_freq],m.au_detail_bending_amp=[v.b4w_detail_bending_amp],m.au_detail_bending_freq=[v.b4w_detail_bending_freq],m.au_branch_bending_amp=[v.b4w_branch_bending_amp]);for(n=0;n<c.length;n++)p=c[n].Wb,u=c[n].Cc,t=c[n].B,p.ek?p.kd?R.$A(u,l):R.Ps(u,l):("COLOR_ID"==t.type&&(p=
c[n].Wb=v.d,t.mh=v.uuid,F(t,p),I(t,S.Jg(p,0))),u=R.Ps(u,l),R.ZA(u,m));e=e.concat(c)}return e}function k(a,c,d,e){for(var f=[],g=h(d,c),k=S.Jg(c,0),n=a.data,q=n.materials,u=0;u<g.length;u++){var t=g[u];if(!a.b4w_do_not_render||"PHYSICS"==t)for(var p=0;p<q.length;p++){var w=q[p];if(("LENS_FLARES"!=w.name||0!=e)&&!R.Jq(n,p)){var r=b(t);if(K(r,w)){r.Zd=c.Dd||c.nd?R.ij:R.Ph;F(r,c);for(var x=r,U=a.particle_systems,G=0;G<U.length;G++){var Q=U[G].settings.b4w_vcol_from_name,y=U[G].settings.b4w_vcol_to_name;
""!==Q&&""!==y&&(x.sb[Q]={Mf:!1,src:[{name:Q,Nc:7}]})}"DYNAMIC"==c.type&&(r.mh=a.uuid);I(r,k);x=R.Zp(n,p,r.ai,r.Kc,r.sb,r.zg);"LENS_FLARES"==w.name&&(x=v.Bz(x));f.push({B:r,Cc:x,Oc:[w.name],Wb:c,ad:[a]})}}}}g=a.particle_systems;if(0<g.length&&f.length){t=e=!1;for(u=0;u<g.length&&(p=g[u],w=p.settings,w.use_render_emitter&&(e=!0),"HAIR"!=w.type||"OBJECT"!=w.render_type&&"GROUP"!=w.render_type&&p.transforms.length||(t=!0),!e||!t);u++);u=f[0].B.sb;if(t)if(1<q.length){q={};for(t=0;t<g.length;t++)w=g[t].settings,
"HAIR"!=w.type||"OBJECT"!=w.render_type&&"GROUP"!=w.render_type||(p=w.b4w_vcol_from_name,w=w.b4w_vcol_to_name,""!==p&&""!==w&&(q[p]=S.qa(u[p])));"a_bending_col_main"in u&&(q.a_bending_col_main=S.qa(u.a_bending_col_main));"a_bending_col_detail"in u&&(q.a_bending_col_detail=S.qa(u.a_bending_col_detail));n=R.$p(n,[],q)}else n=f[0].Cc;else n=null;q=[];g=a.particle_systems;t=a.data;for(p=0;p<g.length;p++)if(w=g[p],r=w.settings,r.count)if("EMITTER"==r.type){if("DYNAMIC"==c.type){x=b("PARTICLES");U=t.materials;
G=w.settings.material-1;G>=U.length&&(X.warn('Wrong material used for rendering particle system "'+w.name+'"'),G=0);U=U[G];"HALO"===w.settings.render_type&&(x.Pf=!0);m(x,U);F(x,c);G=x;Q=w;switch(Q.settings.b4w_billboard_align){case "VIEW":l(G,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":l(G,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":l(G,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":l(G,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:throw"Wrong billboard align value";
}l(G,"BILLBOARD",0);ea.v(G.pb,"WORLD_SPACE","WORLD"==Q.settings.b4w_coordinate_system?1:0);x.nd=!0;x.mh=a.name+"_"+r.uuid;x.wn=w.name;I(x,k);x.uc=w;r=v.Hx(x,t,w,a.d.Ab);v.iA(x,w,U);q.push({B:x,Cc:r,Oc:[U.name],Wb:c,ad:[a]})}}else if("HAIR"==r.type){x=S.$j(w.seed);r.b4w_dynamic_grass&&(c.Pg=!0);var B=la.tp(ra.cn)&&!r.b4w_initial_rand_rotation&&!r.b4w_hair_billboard,C=4;B&&(C=8);if(w.transforms.length)var A=w.transforms;else for(var U=R.wm(n,r.count,!1,x),A=new Float32Array(U.length*C),L=0;L<U.length;L++)G=
.75+.5*S.Rc(x),A[L*C]=U[L][0],A[L*C+1]=U[L][1],A[L*C+2]=U[L][2],A[L*C+3]=G,B&&(A[L*C+4]=1,A[L*C+5]=0,A[L*C+6]=0,A[L*C+7]=0);U=ha.Ba(d,"GRASS_MAP")?!0:!1;if("OBJECT"==r.render_type)G=[h(d,r.dupli_object.d,!0)],w=J(a,c,u,n,[r.dupli_object],G,[A],r,w,U,x,!1),q=q.concat(w);else if("GROUP"==r.render_type){Q=r.dupli_group.objects;y=!1;G=[];for(L=0;L<Q.length;L++){var z=h(d,r.dupli_group.objects[L].d,!0);G.push(z)}if(r.use_whole_group){for(var y=A,A=Q,L=B,B=C,C={},z=new Float32Array([0,0,0,1]),ca=0;ca<y.length;ca+=
B)for(var ia=0;ia<A.length;ia++){var H=fa.create();fa.scale(A[ia].d.h,A[ia].d.scale,H);var O=fa.clone([y[ca],y[ca+1],y[ca+2]]);C[ia]||(C[ia]=new Float32Array(y.length));L&&(C[ia][ca+4]=z[0]=y[ca+4],C[ia][ca+5]=z[1]=y[ca+5],C[ia][ca+6]=z[2]=y[ca+6],C[ia][ca+7]=z[3]=y[ca+7],S.xn(z,z),S.nB(H,z,H));fa.add(O,H,O);C[ia][ca]=O[0];C[ia][ca+1]=O[1];C[ia][ca+2]=O[2];C[ia][ca+3]=y[ca+3]}A=C;y=!0}else if(r.use_group_count){H=Q;O=r.dupli_weights;L=x;z={};ca=[];for(ia=0;ia<H.length;ia++)for(var W=H[ia],W=W.origin_name||
W.name,sa=0;sa<O.length;sa++){var N=O[sa];W==N.name.split(": ")[0]&&ca.push(N)}O.length!=ca.length&&X.error("dupli weights match failed");for(ia=0;ia<A.length;ia+=C){var P,O=ca;P=[0];for(H=0;H<O.length;H++)P[H+1]=P[H]+O[H].count;O=P[P.length-1]*S.Rc(L);for(H=W=0;H<P.length;H++)if(O>=P[H]&&O<P[H+1]){W=H;break}P=W;z[P]=z[P]||[];z[P].push(A[ia],A[ia+1],A[ia+2],A[ia+3]);B&&z[P].push(A[ia+4],A[ia+5],A[ia+6],A[ia+7])}for(P in z)z[P]=new Float32Array(z[P]);A=z}else{L=x;z=Q.length;ca={};for(ia=0;ia<A.length;ia+=
C){var Y=Math.floor(z*S.Rc(L));ca[Y]=ca[Y]||[];ca[Y].push(A[ia],A[ia+1],A[ia+2],A[ia+3]);B&&ca[Y].push(A[ia+4],A[ia+5],A[ia+6],A[ia+7])}for(Y in ca)ca[Y]=new Float32Array(ca[Y]);A=ca}w=J(a,c,u,n,Q,G,A,r,w,U,x,y);q=q.concat(w)}"INSTANCE"==r.b4w_wind_bend_inheritance&&a.d.Gc&&X.warn('Emitter object "'+a.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else throw"Unknown particle settings type";
a=q;f=e?f.concat(a):a}return f}function q(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}}function h(a,b,c){var d=["MAIN","NODES","NODES_GLOW"];(b.qg&&ha.Ba(a,"COLOR_PICKING")||b.Fb&&ha.Ba(a,"OUTLINE_MASK"))&&!c&&d.push("COLOR_ID");ha.Ba(a,"WIREFRAME")&&d.push("WIREFRAME");d.push("PHYSICS");(ha.Ba(a,"DEPTH")||ha.Ba(a,"SHADOW_CAST"))&&d.push("DEPTH");ha.Ba(a,"GRASS_MAP")&&d.push("GRASS_MAP");if(b.hc||b.Mb)for(a=null,b.hc&&(a="MAIN NODES NODES_GLOW COLOR_ID PHYSICS WIREFRAME".split(" ")),
b.Mb&&(b=["COLOR_ID","PHYSICS","DEPTH","WIREFRAME"],a=null!==a?S.ov(a,b):b),b=a,a=0;a<b.length;a++)c=d.indexOf(b[a]),-1!==c&&d.splice(c,1);return d}function m(a,b){var c;switch(a.type){case "MAIN":if(b.b4w_do_not_render||b.use_nodes)c=!1;else{n(a,b);c=b.game_settings.alpha_blend;a.ue=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.fg=b.offset_z;a.jf.set([1,1,1]);var d=b.texture_slots;ia.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Mc);switch(b.name){case "LENS_FLARES":z(a,
"special_lens_flares.glslv","special_lens_flares.glslf");C(a,"a_position");C(a,"a_texcoord");var e=w(d[0],null);N(a,e);break;default:z(a,"main.glslv","main.glslf");var f=x("use_map_color_diffuse",d),g=x("use_map_color_spec",d),h=x("use_map_normal",d),k=x("use_map_mirror",d),m=x("use_stencil",d);c=f[0];g=g[0];h=h[0];k=k[0];f=f[1];d=m[0]&&x("use_rgb_to_intensity",d)[0];if(c){switch(c.blend_type){case "MIX":l(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":l(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MULTIPLY")}e=w(c,null);N(a,e,"u_colormap0");a.Fe=c.diffuse_color_factor;a.ze=c.use_map_alpha?c.alpha_factor:0;a.jf.set(c.scale)}m=c&&c==g;g&&(m||(e=w(g,null),N(a,e,"u_specmap0")),a.Ds=g.specular_color_factor);if(h&&(C(a,"a_normal"),C(a,"a_tangent"),e=w(h,null),N(a,e,"u_normalmap0"),a.tr=h.normal_factor,e=h.texture,e.b4w_use_map_parallax&&ra.Hi)){var q=ea.t(e.b4w_parallax_steps),t=ea.t(e.b4w_parallax_lod_dist);l(a,"PARALLAX",1);l(a,"PARALLAX_STEPS",q);l(a,"PARALLAX_LOD_DIST",t);
a.kg=e.b4w_parallax_scale}k&&(e=w(k,null),N(a,e,"u_mirrormap"),a.jn=k.mirror_factor);if(k=c&&f&&d?1:0)e=w(f,null),N(a,e,"u_colormap1"),e=w(d,null),N(a,e,"u_stencil0");(e=c||g||h)&&a.jf.set(e.scale);l(a,"TEXTURE_SPEC",void 0==g?0:1);l(a,"ALPHA_AS_SPEC",m?1:0);l(a,"TEXTURE_STENCIL_ALPHA_MASK",k);C(a,"a_position");C(a,"a_normal");(c||g||h)&&C(a,"a_texcoord");if(b.b4w_water){a.of=!0;a.so=b.b4w_water_shore_smoothing;a.water_dynamic=b.b4w_water_dynamic;k=b.texture_slots;z(a,"special_water.glslv","special_water.glslf");
C(a,"a_position");C(a,"a_texcoord");C(a,"a_normal");C(a,"a_tangent");ra.rt?(C(a,"a_polyindex"),a.W=!0,a.wireframe_edge_color=[0,0,0],l(a,"DEBUG_WIREFRAME",1)):l(a,"DEBUG_WIREFRAME",0);e=x("use_map_normal",k);m=x("use_map_mirror",k)[0];e.length&&(q=w(e[0]),N(a,q,"u_normalmap0"),a.Oh=b.b4w_water_norm_uv_velocity);l(a,"NUM_NORMALMAPS",e.length);a.dg=Array(e.length);for(q=0;q<e.length;q++)a.dg[q]=new Float32Array(2),a.dg[q].set([e[q].scale[0],e[q].scale[1]]);m&&(e=w(m),N(a,e,"u_mirrormap"),a.jn=m.mirror_factor);
m=null;for(q=0;q<k.length;q++){var p=k[q];if(!0===p.texture.b4w_water_foam){m=p;break}}m&&ra.Tg?(l(a,"FOAM",1),e=w(m),N(a,e,"u_foam"),a.foam_factor=b.b4w_foam_factor,a.dq.set(m.texture.b4w_foam_uv_freq),a.cq.set(m.texture.b4w_foam_uv_magnitude),a.om[0]=m.scale[0],a.om[1]=m.scale[1]):l(a,"FOAM",0);for(q=0;q<k.length;q++)if(p=k[q],!0===p.texture.b4w_shore_dist_map){var U=p;break}U&&ra.il?(U=w(U),N(a,U,"u_shore_dist_map"),l(a,"SHORE_PARAMS",1),U=p.texture.b4w_shore_boundings,l(a,"MAX_SHORE_DIST",ea.t(p.texture.b4w_max_shore_dist)),
l(a,"SHORE_MAP_SIZE_X",ea.t(U[0]-U[1])),l(a,"SHORE_MAP_SIZE_Y",ea.t(U[2]-U[3])),l(a,"SHORE_MAP_CENTER_X",ea.t((U[0]+U[1])/2)),l(a,"SHORE_MAP_CENTER_Y",ea.t((U[2]+U[3])/2))):l(a,"SHORE_PARAMS",0);b.b4w_generated_mesh&&ra.gi?(l(a,"GENERATED_MESH",1),a.ot=!0,a.pt=b.b4w_water_num_cascads,a.qt=b.b4w_water_subdivs,a.nt=b.b4w_water_detailed_dist):l(a,"GENERATED_MESH",0);if(b.b4w_water_dynamic){var p=ea.t(b.b4w_water_dst_noise_scale0),U=ea.t(b.b4w_water_dst_noise_scale1),k=ea.t(b.b4w_water_dst_noise_freq0),
m=ea.t(b.b4w_water_dst_noise_freq1),e=ea.t(b.b4w_water_dir_min_shore_fac),q=ea.t(b.b4w_water_dir_freq),t=ea.t(b.b4w_water_dir_noise_scale),S=ea.t(b.b4w_water_dir_noise_freq),v=ea.t(b.b4w_water_dir_min_noise_fac),G=ea.t(b.b4w_water_dst_min_fac),fa=ea.t(b.b4w_water_waves_hor_fac);l(a,"DST_NOISE_SCALE_0",p);l(a,"DST_NOISE_SCALE_1",U);l(a,"DST_NOISE_FREQ_0",k);l(a,"DST_NOISE_FREQ_1",m);l(a,"DIR_MIN_SHR_FAC",e);l(a,"DIR_FREQ",q);l(a,"DIR_NOISE_SCALE",t);l(a,"DIR_NOISE_FREQ",S);l(a,"DIR_MIN_NOISE_FAC",
v);l(a,"DST_MIN_FAC",G);l(a,"WAVES_HOR_FAC",fa)}y(a,b);r(a,b);a.shallow_water_col.set(b.b4w_shallow_water_col);a.shore_water_col.set(b.b4w_shore_water_col);a.shallow_water_col_fac=b.b4w_shallow_water_col_fac;a.shore_water_col_fac=b.b4w_shore_water_col_fac;l(a,"ABSORB",ea.t(b.b4w_water_absorb_factor));l(a,"SSS_STRENGTH",ea.t(b.b4w_water_sss_strength));l(a,"SSS_WIDTH",ea.t(b.b4w_water_sss_width))}"HALO"===b.type&&(p=b.halo,z(a,"halo.glslv","halo.glslf"),l(a,"NUM_RINGS",p.ring_count),l(a,"NUM_LINES",
p.line_count),l(a,"NUM_STARS",p.star_tip_count),l(a,"SKY_STARS",b.b4w_halo_sky_stars?1:0),a.ai=["a_position"],a.Gq=p.size,a.Dq=p.hardness/20,a.Fq.set(p.b4w_halo_rings_color),a.Eq.set(p.b4w_halo_lines_color),a.Hq=1/b.b4w_halo_stars_blend_height,a.Iq=b.b4w_halo_stars_min_height,a.Cq=!0);l(a,"TEXCOORD",0);l(a,"NORMAL_TEXCOORD",0);c&&u(a,c,"TEXTURE_COLOR0_CO");f&&u(a,f,"TEXTURE_COLOR1_CO");d&&u(a,d,"TEXTURE_STENCIL_ALPHA_MASK_CO");g&&u(a,g,"TEXTURE_SPEC_CO");h&&u(a,h,"TEXTURE_NORM_CO");l(a,"SHADELESS",
b.use_shadeless?1:0);a.yg=b.use_shadeless}c=b.game_settings.alpha_blend;l(a,"ALPHA","OPAQUE"===c?0:1);l(a,"ALPHA_CLIP","CLIP"===c?1:0);l(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);b.use_vertex_color_paint?(l(a,"VERTEX_COLOR",1),C(a,"a_color")):l(a,"VERTEX_COLOR",0);a.Md=b.ambient;a.Ge=b.diffuse_intensity;a.$d=b.emit;a.yd.set(b.specular_color);a.vh=b.specular_alpha;y(a,b);r(a,b);b.b4w_wettable?l(a,"WETTABLE",1):l(a,"WETTABLE",0);B(a,b);a.Cn=b.b4w_refractive;a.ds=b.b4w_refr_bump;c=!0}break;
case "NODES":c=A(a,b);break;case "NODES_GLOW":c=A(a,b,!0);break;case "DEPTH":if("LENS_FLARES"===b.name||b.b4w_water||b.b4w_do_not_render||"HALO"===b.type)c=!1;else if(n(a,b),a.Fa)c=!1;else{z(a,"depth.glslv","depth.glslf");C(a,"a_position");C(a,"a_normal");g=b.game_settings.alpha_blend;l(a,"ALPHA","OPAQUE"===g?0:1);a.jf.set([1,1,1]);if((c=x("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===g){a.jf.set(c.scale);l(a,"TEXTURE_COLOR",1);C(a,"a_texcoord");if("IMAGE"==c.texture.d.source||"ENVIRONMENT_MAP"==
c.texture.d.source)g=w(c),N(a,g,"u_colormap0");"NONE"==c.texture.d.source&&(g=w(c),N(a,g,"u_colormap0"))}else l(a,"TEXTURE_COLOR",0);c=!0}break;case "PHYSICS":b.b4w_collision?(a.QB=b.b4w_use_ghost,a.Na=b.b4w_collision_id,a.zp=b.b4w_collision_margin,a.yp=b.b4w_collision_group,a.Ap=b.b4w_collision_mask,a.oi=b.physics.friction,a.ji=b.physics.elasticity,c=!0):b.b4w_water?(a.of=!0,a.hC=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=
b.b4w_water_dst_noise_freq0,a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,c=!0):c=!1;break;case "COLOR_ID":if("LENS_FLARES"===b.name||b.b4w_do_not_render||"HALO"===b.type)c=!1;else{n(a,b);a.ve=R.Kd;a.W=
!0;a.Fa=!1;g=b.game_settings.alpha_blend;a.ue=b.b4w_render_above_all&&"OPAQUE"!=g&&"CLIP"!=g;z(a,"color_id.glslv","color_id.glslf");C(a,"a_position");g=b.game_settings.alpha_blend;l(a,"ALPHA","OPAQUE"===g?0:1);a.jf.set([1,1,1]);if((c=x("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===g){a.jf.set(c.scale);l(a,"TEXTURE_COLOR",1);C(a,"a_texcoord");if("IMAGE"==c.texture.d.source||"ENVIRONMENT_MAP"==c.texture.d.source)g=w(c),N(a,g,"u_colormap0");"NONE"==c.texture.d.source&&(g=w(c),N(a,g,"u_colormap0"))}else l(a,
"TEXTURE_COLOR",0);c=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?c=!1:(n(a,b),a.Fa=!1,a.ve=R.Kd,a.W=!0,z(a,"grass_map.glslv","grass_map.glslf"),C(a,"a_position"),c=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,g=b.b4w_dynamic_grass_color?b.b4w_dynamic_grass_color:null,a.sb.a_grass_size={Mf:!0,src:[]},c?(a.sb.a_grass_size.src.push({name:c,Nc:4}),l(a,"DYNAMIC_GRASS_SIZE",1)):l(a,"DYNAMIC_GRASS_SIZE",0),a.sb.a_grass_color={Mf:!0,src:[]},g?(a.sb.a_grass_color.src.push({name:g,
Nc:7}),l(a,"DYNAMIC_GRASS_COLOR",1)):l(a,"DYNAMIC_GRASS_COLOR",0),c=!0);break;case "WIREFRAME":"LENS_FLARES"===b.name||b.b4w_water||b.b4w_do_not_render||"HALO"===b.type?c=!1:(z(a,"wireframe.glslv","wireframe.glslf"),C(a,"a_position"),C(a,"a_normal"),C(a,"a_polyindex"),a.W=!0,a.wireframe_mode=0,a.wireframe_edge_color=[0,0,0],c=!0);break;case "PARTICLES":if(b.b4w_do_not_render)c=!1;else{c=b.texture_slots;if(a.Pf)z(a,"particles_color.glslv","particles_color.glslf");else if(z(a,"particles_texture.glslv",
"particles_texture.glslf"),c=x("use_map_color_diffuse",c)[0]){l(a,"TEXTURE_COLOR",1);switch(c.blend_type){case "MIX":l(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":l(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.Fe=c.diffuse_color_factor;a.ze=c.use_map_alpha?c.alpha_factor:0;c=w(c);N(a,c)}ia.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Mc);a.Md=b.ambient;a.Ge=b.diffuse_intensity;a.$d=b.emit;a.yd.set(b.specular_color);a.vh=b.specular_alpha;
C(a,"a_position");C(a,"a_normal");c=b.game_settings.alpha_blend;l(a,"ALPHA","OPAQUE"===c?0:1);l(a,"ALPHA_CLIP","CLIP"===c?1:0);l(a,"PARTICLES_SHADELESS",b.use_shadeless?1:0);y(a,b);r(a,b);n(a,b);c=b.game_settings.alpha_blend;a.ue=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.fg=b.offset_z;c=!0}break;default:throw"Wrong batch type: "+a.type;}return c}function u(a,b,c){switch(b.texture_coords){case "UV":case "ORCO":l(a,c,"TEXTURE_COORDS_UV_ORCO");l(a,"TEXCOORD",1);break;case "NORMAL":l(a,c,"TEXTURE_COORDS_NORMAL");
l(a,"NORMAL_TEXCOORD",1);break;default:l(a,c,0)}}function n(a,b){var c=b.game_settings,d=c.alpha_blend;switch(d){case "ALPHA_SORT":a.Fa=!0;a.ve=R.Ho;a.W=!0;break;case "ALPHA":a.Fa=!0;a.ve=R.Kd;a.W=!0;break;case "CLIP":a.Fa=!1;a.ve=R.Kd;a.W=!0;break;case "ADD":a.Fa=!0;a.ve=R.Kd;a.W=!1;break;case "OPAQUE":a.Fa=!1;a.ve=R.Kd;a.W=!0;break;default:throw Error("Unknown alpha blend mode: "+d);}a.Ja=c.use_backface_culling}function w(a,b){var c=a.texture,d=c.d,c=c.image;d&&b&&c&&pa.Zi(d,b,c.jc,c.filepath);
return d}function x(a,b){for(var c=[],d=b.length,e=0;e<d;e++){var f=b[e];1==f[a]&&f.texture&&f.texture.d&&c.push(f)}return c}function B(a,b){var c=b.raytrace_transparency;a.Yc[0]=c.fresnel;a.Yc[1]=1-c.fresnel_factor/5;c=b.raytrace_mirror;a.og=c.reflect_factor;a.Yc[2]=c.fresnel;a.Yc[3]=1-c.fresnel_factor/5}function y(a,b){var c,d=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":l(a,"SPECULAR_SHADER","SPECULAR_PHONG");c=b.specular_hardness;break;case "WARDISO":l(a,"SPECULAR_SHADER","SPECULAR_WARDISO");
c=b.specular_slope;break;case "TOON":l(a,"SPECULAR_SHADER","SPECULAR_TOON");c=b.specular_toon_size;d=b.specular_toon_smooth;break;case "BLINN":l(a,"SPECULAR_SHADER","SPECULAR_BLINN");c=b.specular_ior;d=b.specular_hardness;break;default:X.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),c=b.specular_hardness}a.ic[0]=b.specular_intensity;a.ic[1]=c;a.ic[2]=d}function r(a,b){switch(b.diffuse_shader){case "LAMBERT":l(a,"DIFFUSE_SHADER","DIFFUSE_LAMBERT");a.qc[0]=0;a.qc[1]=
0;break;case "OREN_NAYAR":l(a,"DIFFUSE_SHADER","DIFFUSE_OREN_NAYAR");a.qc[0]=b.roughness;a.qc[1]=0;break;case "FRESNEL":l(a,"DIFFUSE_SHADER","DIFFUSE_FRESNEL");a.qc[0]=b.diffuse_fresnel;a.qc[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":l(a,"DIFFUSE_SHADER","DIFFUSE_MINNAERT");a.qc[0]=b.darkness;a.qc[1]=0;break;case "TOON":l(a,"DIFFUSE_SHADER","DIFFUSE_TOON");a.qc[0]=b.diffuse_toon_size;a.qc[1]=b.diffuse_toon_smooth;break;default:X.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+
b.name+'")'),a.qc[0]=0,a.qc[1]=0}}function A(a,b,c){if(!b.use_nodes||b.b4w_do_not_render)return!1;var d=ja.bw(b.node_tree,c?S.vm():b.uuid,!1,b.name,c);if(!d)return X.error('Failed to create node graph for material "'+b.name+'", disable nodes'),t(a,b),!0;z(a,"main.glslv","main.glslf");l(a,"NODES",1);l(a,"NODES_GLOW",c?1:0);c=b.game_settings.alpha_blend;l(a,"ALPHA","OPAQUE"===c?0:1);l(a,"ALPHA_CLIP","CLIP"===c?1:0);l(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);C(a,"a_position");b.use_orco_tex_coord&&
C(a,"a_orco_tex_coord");n(a,b);a.fg=b.offset_z;c=b.game_settings.alpha_blend;a.ue=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;ia.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Mc);a.$d=b.emit;a.Md=b.ambient;B(a,b);b.b4w_wettable?l(a,"WETTABLE",1):l(a,"WETTABLE",0);a.pb.nn=ja.cw(d);var e=!1;ga.O(d,function(b,c){switch(c.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var d=c.data.name,f=c.data.value;a.zg||(a.zg={});a.zg[f]=d;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":d=
c.data.name;a.sb[d]={Mf:!0,src:[{name:c.data.value}]};f=0;if("GEOMETRY_VC"==c.type)f=7;else for(var g=0;g<c.Ca.length;g++){var h="RGB".indexOf(c.Ca[g].identifier);-1<h&&(f|=1<<2-h)}a.sb[d].src[0].Nc=f;break;case "TEX_COORD_NO":case "GEOMETRY_NO":C(a,"a_normal");break;case "MATERIAL":case "MATERIAL_EXT":d=c.data.value;C(a,"a_normal");l(a,"DIFFUSE_SHADER","DIFFUSE_"+d.ax);l(a,"SPECULAR_SHADER","SPECULAR_"+d.OA);l(a,"SHADELESS_MAT",d.yg?1:0);a.yg=d.yg;a.vh=d.vh;e=!0;break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":d=
c.data.name;f=c.data.value;!1!==f.d.qj&&(f.d.qj="TEXTURE_ENVIRONMENT"!=c.type?!0:!1);N(a,f.d,d);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":l(a,"CALC_TBN_SPACE",1);C(a,"a_normal");C(a,"a_tangent");d=c.data.name;f=c.data.value;f.d.qj=!1;N(a,f.d,d);break;case "LAMP":c.data&&(a.dh=c.data);break;case "B4W_REFRACTION":a.Cn=!0}});e||(a.yg=!0);return!0}function t(a,b){z(a,"main.glslv","main.glslf");l(a,"SHADELESS",1);C(a,"a_position");C(a,"a_normal");ia.set(1,0,1,1,a.Mc);if(b){var c=b.game_settings.alpha_blend;
l(a,"ALPHA","OPAQUE"===c?0:1);l(a,"ALPHA_CLIP","CLIP"===c?1:0);l(a,"VERTEX_COLOR",0);a.fg=b.offset_z;n(a,b)}return!0}function F(a,b){if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.ek?l(a,"AU_QUALIFIER","attribute"):l(a,"AU_QUALIFIER","uniform"),l(a,"STATIC_BATCH",0)):(l(a,"AU_QUALIFIER","attribute"),l(a,"STATIC_BATCH",1));"WIREFRAME"==a.type&&(Y.ly()?l(a,"WIREFRAME_QUALITY",1):l(a,"WIREFRAME_QUALITY",0),a.Ng?(l(a,"DEBUG_SPHERE",1),a.Lp?l(a,"DEBUG_SPHERE_DYNAMIC",1):l(a,"DEBUG_SPHERE_DYNAMIC",0)):l(a,
"DEBUG_SPHERE",0),l(a,"ALPHA",1));b.Dd&&(a.Dd=b.Dd);b.Gc?(""!==b.ge?(a.sb.a_bending_col_main={Mf:!0,src:[{name:b.ge,Nc:4}]},C(a,"a_bending_col_main"),""!==b.Jb.fr&&""!==b.Jb.er&&""!==b.Jb.Ar?(a.sb.a_bending_col_detail={Mf:!0,src:[{name:b.Jb.fr,Nc:4},{name:b.Jb.er,Nc:2},{name:b.Jb.Ar,Nc:1}]},C(a,"a_bending_col_detail"),C(a,"a_normal"),l(a,"DETAIL_BEND",1)):l(a,"DETAIL_BEND",0),l(a,"MAIN_BEND_COL",1)):l(a,"MAIN_BEND_COL",0),l(a,"WIND_BEND",1)):l(a,"WIND_BEND",0);b.wj?l(a,"BEND_CENTER_ONLY",1):l(a,"BEND_CENTER_ONLY",
0);l(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.cp|0);b.kd?l(a,"BILLBOARD",1):l(a,"BILLBOARD",0);b.kd&&b.ek?l(a,"HAIR_BILLBOARD",1):l(a,"HAIR_BILLBOARD",0);b.Wh?l(a,"BILLBOARD_SPHERICAL",1):l(a,"BILLBOARD_SPHERICAL",0);switch(b.Xh){case "RANDOM":l(a,"BILLBOARD_RANDOM",1);l(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":l(a,"BILLBOARD_RANDOM",0);l(a,"BILLBOARD_JITTERED",1);break;default:l(a,"BILLBOARD_RANDOM",0),l(a,"BILLBOARD_JITTERED",0)}b.mb&&ra.il?l(a,"DYNAMIC_GRASS",1):l(a,"DYNAMIC_GRASS",0);a.mb=
b.mb;a.nd=b.nd;a.Ac=b.Ac;a.hc=b.hc;a.Yb=b.Yb&&!a.yg&&!(a.Fa&&ra.Qp);a.Vb=b.Vb;a.Mb=b.Mb;a.yc=b.yc;b.bh?(C(a,"a_influence"),l(a,"SKINNED",1),b.ni?l(a,"FRAMES_BLENDING",1):l(a,"FRAMES_BLENDING",0),l(a,"MAX_BONES",b.ie)):(l(a,"SKINNED",0),l(a,"FRAMES_BLENDING",0));b.Xk?(l(a,"VERTEX_ANIM",1),ra.lt?l(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):l(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):l(a,"VERTEX_ANIM",0);if(b.bh&&b.Xk)throw"Skinning and vertex animation are mutually exlusive";b.Mj?l(a,"DISABLE_FOG",
1):l(a,"DISABLE_FOG",0);b.Kc&&(a.Kc=b.Kc);if("NODES"==a.type||"NODES_GLOW"==a.type){for(var c=a.pb.nn,d=b.bg,e=b.ag,f=0;f<c.length;f++){var g=c[f];switch(g.id){case "VALUE":var h=g.uk[0];if(h)for(var k=0;k<d.length;k+=2)if(d[k]==h){g.Wd.push(["VALUE_IND",d[k+1]]);break}break;case "RGB":if(h=g.uk[0])for(k=0;k<e.length;k+=2)if(e[k]==h){g.Wd.push(["RGB_IND",e[k+1]]);break}}}l(a,"NUM_VALUES",b.he.length);l(a,"NUM_RGBS",b.tc.length)}}}function C(a,b){var c=a.ai;-1==c.indexOf(b)&&c.push(b)}function l(a,
b,c){ea.v(a.pb,b,c)}function H(a,b){if("PHYSICS"==a.type)a.Cc=b;else{var c=a.ve,d=a.Zd;a.Cq&&(b=R.qx(b));a.ot&&(b=Z.Mx(a.pt,a.qt,a.nt));c=R.bB(b,c,d,a.sb);a.R=c;a.nd||c.Zj||a.Dd||(c.Oe=null,c.ed=null);c=b.A.length;a.num_vertices=b.K*c;a:switch(a.Zd){case R.Ph:case R.jj:case R.ij:d=!0;break a;default:d=!1}d?R.My(b)?a.num_triangles=b.ea.length/3*c:a.num_triangles=b.K/3*c:a.num_triangles=0}}function J(a,c,d,e,f,g,h,k,m,l,n,q){var u=[],t=k.b4w_dynamic_grass;if(!l&&t)return u;for(var p="INSTANCE"==k.b4w_wind_bend_inheritance,
w="INSTANCE"==k.b4w_shadow_inheritance,r="INSTANCE"==k.b4w_reflection_inheritance,x=[],v=[],G=0;G<f.length;G++){var Q=f[G],y=S.Fj(c);y.kd=k.b4w_hair_billboard;y.Xh=k.b4w_hair_billboard_type;y.Wh="SPHERICAL"==k.b4w_hair_billboard_geometry;y.mb=t;y.ek=!0;y.he=Q.d.he;y.bg=Q.d.bg;y.tc=Q.d.tc;y.ag=Q.d.ag;p?(y.Gc=Q.d.Gc,y.ej=Q.d.ej,y.te=Q.d.te,y.Vd=Q.d.Vd,y.ge=Q.d.ge,y.Ud=Q.d.Ud,y.Qd=Q.d.Qd,y.Fd=Q.d.Fd,y.Jb=Q.d.Jb,y.wj=!1):(y.Gc=a.d.Gc,y.ej=a.d.ej,y.te=a.d.te,y.Vd=a.d.Vd,y.ge=a.d.ge,y.Ud=a.d.Ud,y.Qd=a.d.Qd,
y.Fd=a.d.Fd,y.Jb=a.d.Jb,y.wj=!0);w?(y.Ac=Q.d.Ac,y.hc=Q.d.hc,y.Yb=Q.d.Yb):(y.Ac=a.d.Ac,y.hc=a.d.hc,y.Yb=a.d.Yb);r?(y.Vb=Q.d.Vb,y.Mb=Q.d.Mb,y.yc=Q.d.yc,y.nc=Q.d.nc,y.vc=Q.d.vc,y.ke=Q.d.ke):(y.Vb=a.d.Vb,y.Mb=a.d.Mb,y.yc=a.d.yc,y.nc=a.d.nc,y.vc=a.d.vc,y.ke=a.d.ke);x.push(y);var B=h[G];B||(B=new Float32Array);q&&S.$j(m.seed,n);var C=new Float32Array(3),A=new Float32Array([0,0,0,1]),L=[],z=la.tp(ra.cn)&&!k.b4w_initial_rand_rotation&&!k.b4w_hair_billboard,H=4;z&&(H=8);for(var O=0;O<B.length;O+=H){C[0]=B[O];
C[1]=B[O+1];C[2]=B[O+2];var J=B[O+3]*Q.d.scale;if(k.b4w_initial_rand_rotation){switch(k.b4w_rotation_type){case "XYZ":var W=new Float32Array([S.Rc(n),S.Rc(n),S.Rc(n)]);fa.normalize(W,W);break;case "Z":W=new Float32Array([0,1,0]);break;default:throw"Unsupported random rotation type: "+k.b4w_rotation_type;}sa.setAxisAngle(W,k.b4w_rand_rotation_strength*(2*Math.PI*S.Rc(n)-Math.PI),A)}else z&&(A.set(B.subarray(O+4,O+8)),S.xn(A,A),k.use_whole_group||(k.use_rotation_dupli?sa.multiply(A,Q.d.quat,A):sa.multiply(A,
ca,A)));var N=U.create_sep(C,J,A);L.push(N)}v.push(L)}for(var P={},G=0;G<f.length;G++){var Y=g[G],y=x[G],V={};y.Gc&&(V.au_wind_bending_amp=[y.Fd],V.au_wind_bending_freq=[y.te],V.au_detail_bending_freq=[y.Vd],V.au_detail_bending_amp=[y.Ud],V.au_branch_bending_amp=[y.Qd],y.Fd=0,y.te=0,y.Vd=0,y.Ud=0,y.Qd=0);var ga=S.Jg(y,0),L=v[G];if(L.length)for(var ea=f[G].data,ja=ea.materials,O=0;O<ja.length;O++)if(!R.Jq(ea,O))for(var ha=0;ha<Y.length;ha++){var Z=b(Y[ha]),pa=ja[O];if(K(Z,pa)){Z.Zd=R.Ph;F(Z,y);Z.mh=
k.uuid;"JITTERED"==k.b4w_hair_billboard_type&&(Z.Zq=k.b4w_hair_billboard_jitter_amp,Z.$q=k.b4w_hair_billboard_jitter_freq);t&&(Z.Bq=k.b4w_dynamic_grass_scale_threshold);p||(delete Z.sb.a_bending_col_main,delete Z.sb.a_bending_col_detail);I(Z,ga);var qa=R.Zp(ea,O,Z.ai,Z.Kc,Z.sb,Z.zg),Ta=R.$y(qa,V,L),ab=Ta,ub=L;ab.H.au_center_pos=new Float32Array(3*ab.K);for(var Ra=ub.length,Ea=ab.K/Ra,gb=0;gb<Ra;gb++)for(var vb=ub[gb],Qa=3*Ea*gb,tb=0;tb<Ea;tb++)ab.H.au_center_pos[Qa+3*tb]=vb[0],ab.H.au_center_pos[Qa+
3*tb+1]=vb[1],ab.H.au_center_pos[Qa+3*tb+2]=vb[2];Ta=ab;if(y.Gc&&y.wj){var ya=Ta,wa=a.d.T;ya.H.a_emitter_center=new Float32Array(3*ya.K);var wb=ia.fromValues(0,0,0,1);ia.transformMat4(wb,wa,wb);for(var qb=0;qb<ya.K;qb++)ya.H.a_emitter_center[3*qb]=wb[0],ya.H.a_emitter_center[3*qb+1]=wb[1],ya.H.a_emitter_center[3*qb+2]=wb[2];Ta=ya}var xa=k.b4w_vcol_from_name,ic=k.b4w_vcol_to_name,aa=Z,xb=d,Na=!p,za=ea,Aa=[];if(""!==xa&&""!==ic){var jb,Kc=ic,Xa=aa.sb,Rb=[],hb=void 0;for(hb in Xa)for(var Lb=Xa[hb].src,
jc=0,Yb=0;Yb<Lb.length;Yb++){var wc=Lb[Yb].Nc;Kc==Lb[Yb].name&&Rb.push(hb,wc,jc);jc+=S.pg(wc)}jb=Rb;if(0<jb.length)for(var bb=0;bb<jb.length;bb+=3)Aa.push({ki:xa,Pj:7,vk:jb[bb],wk:jb[bb+1],Nj:jb[bb+2]});else R.xy(aa.ai,"a_color")&&ic==za.active_vcol_name&&Aa.push({ki:xa,Pj:7,vk:"a_color",wk:7,Nj:0})}Na&&("a_bending_col_main"in xb&&Aa.push({ki:"a_bending_col_main",Pj:4,vk:"a_bending_col_main",wk:4,Nj:0}),"a_bending_col_detail"in xb&&Aa.push({ki:"a_bending_col_detail",Pj:7,vk:"a_bending_col_detail",
wk:7,Nj:0}));for(var Zb=Ta,Pc=L,xc=e,D=Aa,Mb=Z.sb,Ia=!1,Ua=0;Ua<D.length;Ua++){var yb=D[Ua].ki,da=xc.H[yb];if(da&&0<da.length){Ia=!0;break}}if(Ia){var kc,kb=a.d.Pb,cb=xc.A[0].a_position,lc=Pc,ta=P,rb=new Float32Array(3),zb=new Float32Array(3),ed=new Uint32Array(lc.length);if(!("verts_indices"in ta)){ta.Sd=new Float32Array(3);ta.Pd=new Float32Array(3);ta.oo=new Uint32Array(cb.length/3);ta.Di=new Uint32Array(cb.length/3);ta.Sd[0]=(kb.max_x-kb.min_x)/20;ta.Sd[1]=(kb.max_y-kb.min_y)/20;ta.Sd[2]=(kb.max_z-
kb.min_z)/20;ta.Pd[0]=kb.min_x;ta.Pd[1]=kb.min_y;ta.Pd[2]=kb.min_z;for(var Oa=0;Oa<cb.length/3;Oa++){var Nb=S.trunc((cb[3*Oa]-ta.Pd[0])/ta.Sd[0]),Qc=S.trunc((cb[3*Oa+1]-ta.Pd[1])/ta.Sd[1]),db=S.trunc((cb[3*Oa+2]-ta.Pd[2])/ta.Sd[2]),Nb=S.clamp(Nb,0,19),Qc=S.clamp(Qc,0,19),db=S.clamp(db,0,19);ta.oo[Oa]=Oa;ta.Di[Oa]=db*Math.pow(20,2)+20*Qc+Nb}R.Bs(ta.Di,ta.oo,R.bl,!0);ta.Ag=new Uint32Array(Math.pow(20,3));for(Oa=0;Oa<ta.Di.length;Oa++)ta.Ag[ta.Di[Oa]]++;delete ta.Di;for(Oa=1;Oa<ta.Ag.length;Oa++)ta.Ag[Oa]+=
ta.Ag[Oa-1]}for(var $b=0;$b<lc.length;$b++){rb[0]=lc[$b][0];rb[1]=lc[$b][1];rb[2]=lc[$b][2];for(var ac=1E10,mc=-1,nc=S.trunc((rb[0]-ta.Pd[0])/ta.Sd[0]),Rc=S.trunc((rb[1]-ta.Pd[1])/ta.Sd[1]),Zc=S.trunc((rb[2]-ta.Pd[2])/ta.Sd[2]),nc=S.clamp(nc,0,19),Rc=S.clamp(Rc,0,19),Zc=S.clamp(Zc,0,19),bc=Zc*Math.pow(20,2)+20*Rc+nc,$c=ta.Ag[bc],lb=0==bc?0:ta.Ag[bc-1];lb<$c;lb++){var Lc=ta.oo[lb];zb[0]=cb[3*Lc];zb[1]=cb[3*Lc+1];zb[2]=cb[3*Lc+2];fa.sub(zb,rb,zb);var eb=fa.sqrLen(zb);eb<=ac&&(ac=eb,mc=Lc)}if(-1==mc)for(lb=
0;lb<cb.length/3;lb++)zb[0]=cb[3*lb],zb[1]=cb[3*lb+1],zb[2]=cb[3*lb+2],fa.sub(zb,rb,zb),eb=fa.sqrLen(zb),eb<=ac&&(ac=eb,mc=lb);ed[$b]=mc}kc=ed;for(var yc=Zb.K/Pc.length,Ua=0;Ua<D.length;Ua++){var ib=D[Ua].vk,oc=D[Ua].wk,yb=D[Ua].ki,Ab=D[Ua].Pj,da=xc.H[yb];switch(ib){case "a_bending_col_main":var Ma=1;break;case "a_bending_col_detail":Ma=3;break;case "a_color":Ma=3;break;default:for(var Db=Ma=0;Db<Mb[ib].src.length;Db++)Ma+=S.pg(Mb[ib].src[Db].Nc)}if(da&&0<da.length){var zc=S.pg(Ab),Eb=S.pg(oc),Sb=
Ab&oc,Ac=S.hs(Sb);Sb!=oc&&X.error("Wrong color extraction from "+yb+" to "+ib+".");if("a_bending_col_main"==ib||"a_bending_col_detail"==ib)Zb.H[ib]=new Float32Array(Zb.K*Eb);for(Db=0;Db<Pc.length;Db++){var Hb=kc[Db],Va=Hb*zc,Pa=Db*yc*Ma;if(-1!=Hb)for(var Ob=0;Ob<yc;Ob++)for(var Sc=Ob*Ma,Pb=0;Pb<Ac.length;Pb++)Ac[Pb]&&(Zb.H[ib][Pa+Sc+(D[Ua].Nj+S.Si(oc,Pb))]=da[Va+S.Si(Ab,Pb)])}}else Zb.H[ib]=new Float32Array(0)}}Ta=Zb;u.push({B:Z,Cc:Ta,Oc:[pa.name],Wb:y,ad:[a]})}}}return u}function K(a,b){var c=!0;
"NODES_GLOW"==a.type&&(c=ja.sp(b));return c=c&&m(a,b)}function I(a,b){for(var c=null,d=null,e=0;e<a.L.length;e++){var f=a.L[e].Rd;f&&(c||(c={}),c[e]=f,a.L[e].Rd=null);if(f=a.L[e].La)d||(d={}),d[e]=f,a.L[e].La=null}a.id=0;a.Nz=b;a.id=S.Jg(a,b);if(c)for(var g in c)a.L[g].Rd=c[g];if(d)for(g in d)a.L[g].La=d[g]}function P(a,c,d,e,f){var g=b("WIREFRAME");z(g,"wireframe.glslv","wireframe.glslf");g.wireframe_mode=0;g.Ng=!0;g.W=!0;g.mh=d;f&&(g.Lp=!0);F(g,c);I(g,S.Jg(c,0));e?(c=Z.lq(1,a.F),R.$z(c,[a.vf[0],
a.wf[1],a.xf[2]],a.F)):c=Z.lq(a.Da,a.F);R.Un(c,1,!0);c.H.a_polyindex=R.Yp(c);H(g,c);return g}function z(a,b,c){a.pb={bj:b,mi:c,He:[],Zm:[],nn:[]};ea.hA(a.pb)}function N(a,b,c){1==a.L.length&&0==a.Gb.length&&a.Gb.push("default0");c=c||"default"+String(a.L.length);-1==a.Gb.indexOf(c)&&(a.L.push(b),a.Gb.push(c));a.Xb&&V.Vo(a)}function G(a){if(!a.pb)throw"No shaders info for batch "+a.name;a.Xb=ea.Xx(a.pb);V.uv(a.Xb);V.Uo(a);V.Vo(a)}var L=p("__boundings"),O=p("__camera"),W=p("__config"),X=p("__print"),
Y=p("__extensions"),R=p("__geometry"),ga=p("__graph"),ja=p("__nodemat"),qa=p("__objects"),v=p("__particles"),Z=p("__primitives"),la=p("__reformer"),V=p("__renderer"),ha=p("__scenegraph"),ea=p("__shaders"),pa=p("__textures"),U=p("__tsr"),S=p("__util"),fa=p("vec3"),ia=p("vec4"),sa=p("quat"),ra=W.o,Q=["MAIN","NODES"],ca=new Float32Array([0,-Math.sqrt(.5),0,Math.sqrt(.5)]);a.WD=b;a.Lx=function(a,e,h,k,m,n,q){for(var u=[],t=[],p=[],r=0;r<h.length;r++){var x=h[r];qa.cc(x)?t.push(x):p.push(x)}r=[];r=r.concat(f(t,
a,q));t=r=r.concat(g(p,a,e,q));r=[];x=[];p={};for(e=0;e<t.length;e++){var U=t[e].B,G=t[e].Wb,v=null;if(U.id in p){var y=p[U.id],fa=x[y].B,B=x[y].Wb,A=null,F=null;for(q=0;q<U.L.length;q++){var ca=U.L[q].Rd;ca&&(A||(A={}),A[q]=ca,U.L[q].Rd=null);if(ca=U.L[q].La)F||(F={}),F[q]=ca,U.L[q].La=null}S.Ns(U,fa)&&S.Ns(G,B)&&(v=x[y]);if(A)for(q in A)U.L[q].Rd=A[q];if(F)for(q in F)U.L[q].La=F[q];if(!v){do U.id++;while(p[U.id])}}v||(v={B:U,Wb:t[e].Wb,ad:[],Vn:[],Oc:[]},p[U.id]=x.length,x.push(v));v.ad=v.ad.concat(t[e].ad);
t[e].Cc&&t[e].Cc.K&&v.Vn.push(t[e].Cc);v.Oc=v.Oc.length?v.Oc.concat(t[e].Oc):t[e].Oc;R.Bs(v.Oc,v.Vn,R.Eu,!1)}for(e=0;e<x.length;e++){t=x[e].Vn;if(0==t.length)q=S.lb(S.Qk("%empty"));else if(1==t.length)q=t[0];else{p=[];for(q=0;q<t.length;q++)R.Ny(t[q])||p.push(q);if(p.length<t.length)for(q=0;q<p.length;q++)R.Un(t[p[q]]);q=R.aB(t)}r.push({B:x[e].B,Wb:x[e].Wb,Cc:q,Oc:x[e].Oc,ad:x[e].ad})}u.push.apply(u,r);for(r=0;r<u.length;r++)u[r].B.Pc=u[r].Oc,H(u[r].B,u[r].Cc);for(r=0;r<u.length;r++)if(e=u[r].B,"STATIC"==
u[r].Wb.type&&"COLOR_ID"!=e.type)x=qa.Pq(S.Qk("%meta"),"MESH",!0),x.d=u[r].Wb,x.n=[e],n.push(x);else for(t=[],q=0;q<u[r].ad.length;q++)if(x=u[r].ad[q],-1==t.indexOf(x.name)){for(p=0;p<x.n.length;p++)if(x.n[p]==e)throw"Batch already exist in object";x.n.push(e);t.push(x.name)}if(ra.wireframe_debug){for(r=0;r<u.length;r++)if(e=u[r].Wb,"DYNAMIC"==e.type&&(x=u[r].ad[0],-1<Q.indexOf(u[r].B.type))){t=!1;for(q=0;q<x.n.length;q++)x.n[q].Ng&&(t=!0);t||(e=P(e.yf,e,x.name,!0,!0),x.n.push(e))}for(r=0;r<n.length;r++)x=
n[r],e=x.d,-1<Q.indexOf(x.n[0].type)&&(e=P(e.Vc,e,x.name,!1),x.n.push(e))}if(m.Oz||m.procedural_skydome){e=b("MAIN");z(e,"special_skydome.glslv","special_skydome.glslf");if(m.procedural_skydome)l(e,"PROCEDURAL_SKYDOME",1),e.Wr=!0;else{if(u=k.Kn){l(e,"WO_SKYTEX",1);r=w(k.ys,null);N(e,r,"u_sky");u.invert&&l(e,"MTEX_NEGATIVE",1);u.VB&&l(e,"MTEX_RGBTOINT",1);switch(u.fp){case "MIX":r=0;break;case "ADD":r=1;break;case "SUBTRACT":r=2;break;case "MULTIPLY":r=3;break;case "SCREEN":r=4;break;case "OVERLAY":r=
5;break;case "DIFFERENCE":r=6;break;case "DIVIDE":r=7;break;case "DARKEN":r=8;break;case "LIGHTEN":r=9;break;case "HUE":r=10;break;case "SATURATION":r=11;break;case "VALUE":r=12;break;case "COLOR":r=13;break;case "SOFT_LIGHT":r=14;break;case "LINEAR_LIGHT":r=15;break;default:X.warn('Unknown sky texture blend type"'+u.fp+'"'),r=0}l(e,"BLENDTYPE",r);u.RB&&l(e,"WOMAP_BLEND",1);u.SB&&l(e,"WOMAP_HORIZ",1);u.UB&&l(e,"WOMAP_ZENUP",1);u.TB&&l(e,"WOMAP_ZENDOWN",1)}k.WB&&l(e,"WO_SKYBLEND",1);k.XB&&l(e,"WO_SKYPAPER",
1);k.YB&&l(e,"WO_SKYREAL",1)}m.Vb&&(e.Vb=!0,m.Mb&&(e.Mb=!0));C(e,"a_position");e.fg=99999;k=Z.Jx();H(e,k);x=qa.Pq(S.Qk("%meta"),"MESH",!0);x.d=qa.Ij("DYNAMIC");x.d.Pg=!0;x.d.Pb=L.Gd();x.d.Vc=L.fj();x.d.bb=L.Gd();x.d.vb=L.fj();x.n=[e];n.push(x)}for(r=0;r<h.length;r++)for(q=0;q<h[r].n.length;q++)d(h[r].n[q]);for(r=0;r<n.length;r++)for(q=0;q<n[r].n.length;q++)d(n[r].n[q]);for(r=0;r<h.length;r++)c(h[r],a);for(r=0;r<n.length;r++)c(n[r],a)};a.iC=function(a,b,c){if(b)b=c*(b.max_y-b.min_y);else throw"No bounding box for mesh";
return 0==b?0:.5*(Math.sqrt(2*Math.sqrt(4*b*Math.tan(a/180*Math.PI)+1)+2)/2-1)/b};a.wv=q;a.Ux=w;a.uB=t;a.nl=function(a,b,c){c&&c.i.type==O.Hb&&l(a,"PERSPECTIVE_SHADOW_CAST",1);l(a,"CSM_SECTION0",0);l(a,"CSM_SECTION1",0);l(a,"CSM_SECTION2",0);l(a,"CSM_SECTION3",0);for(c=0;c<b.csm_num;c++)l(a,"CSM_SECTION"+String(c),1);l(a,"SHADOW_TEX_RES",ea.t(b.csm_resolution));l(a,"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?1:0);l(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)};a.ja=l;a.wb=function(a,
b){return ea.ay(a.pb,b)};a.tB=I;a.Hg=N;a.Sz=function(a,b,c){c=a.Gb.indexOf(c);-1<c&&(a.L[c]=b)};a.Ew=function(a,c){var d=b("MAIN");d.Fa=!0;ia.set(c[0],c[1],c[2],.5,d.Mc);d.Zd=R.jj;H(d,a);z(d,"main.glslv","main.glslf");l(d,"SHADELESS",1);G(d);return d};a.rb=G;a.Lv=function(a){return a.Xb.Ii.length?a.Xb.tn.u_cube_fog?!0:!1:!1};a.rw=function(){var a=b("DEPTH_PACK");a.Ja=!0;a.W=!1;var c=Z.nb();H(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");G(a);return a};a.Hp=function(a){var c=
b("POSTPROCESSING");z(c,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":l(c,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":l(c,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":l(c,"POST_EFFECT","POST_EFFECT_X_BLUR");break;case "Y_BLUR":l(c,"POST_EFFECT","POST_EFFECT_Y_BLUR");break;case "X_GLOW_BLUR":l(c,"POST_EFFECT","POST_EFFECT_X_GLOW_BLUR");break;case "Y_GLOW_BLUR":l(c,"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR");break;case "X_EXTEND":l(c,
"POST_EFFECT","POST_EFFECT_X_EXTEND");break;case "Y_EXTEND":l(c,"POST_EFFECT","POST_EFFECT_Y_EXTEND");break;default:throw"Wrong postprocessing effect: "+a;}c.Ja=!0;c.W=!1;a=Z.nb();H(c,a);G(c);return c};a.Iw=function(a){var c=b("SSAO");c.W=!1;c.Ja=!0;var d=Z.nb();H(c,d);z(c,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");l(c,"SSAO_QUALITY","SSAO_QUALITY_"+a.Is);l(c,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:0);a={texture:pa.Ox(a)};d={width:4,height:4,data:new Uint8Array([150,123,254,
0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};a=w(a,d);N(c,a,"u_ssao_special_tex");G(c);return c};a.Jw=function(a){var c=b("SSAO_BLUR");c.W=!1;c.Ja=!0;var d=Z.nb();H(c,d);z(c,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");l(c,"SSAO_BLUR_DEPTH",a.ssao_blur_depth?1:0);G(c);return c};a.sw=function(){var a=b("DOF");a.W=!1;a.Ja=!0;var c=
Z.nb();H(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");l(a,"DEPTH_RGBA",1);G(a);return a};a.Aw=function(){var a=b("OUTLINE");a.W=!1;a.Ja=!0;var c=Z.nb();H(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");G(a);return a};a.uw=function(){var a=b("GLOW_COMBINE");a.W=!1;a.Ja=!0;var c=Z.nb();H(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");G(a);return a};a.vw=function(a,c,d){var e=b("GOD_RAYS");e.W=!1;e.Ja=!0;var f=
Z.Ex();H(e,f);z(e,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");l(e,"DEPTH_RGBA",a?1:0);l(e,"WATER_EFFECTS",c?1:0);l(e,"STEPS_PER_PASS",ea.t(d,1));G(e);return e};a.ww=function(){var a=b("GOD_RAYS_COM");a.W=!1;a.Ja=!0;var c=Z.nb();H(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");G(a);return a};a.Fw=function(){var a=b("SKY");a.W=!1;a.Ja=!0;var c=Z.Fx();H(a,c);z(a,"procedural_skydome.glslv","procedural_skydome.glslf");l(a,"WATER_EFFECTS",1);
G(a);return a};a.lw=function(){var a=b("ANTIALIASING");a.W=!1;a.Ja=!0;var c=Z.nb();H(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");l(a,"AA_METHOD","AA_METHOD_FXAA_QUALITY");G(a);return a};a.Gw=function(a){var c=b("SMAA"),d=Z.nb();H(c,d);z(c,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");l(c,"AA_METHOD","AA_METHOD_SMAA_HIGH");l(c,"SMAA_PASS",a);l(c,"SMAA_PREDICATION",0);l(c,"SMAA_REPROJECTION",0);G(c);c.W=!1;c.Ja=!0;return c};a.pw=function(){var a=b("COMPOSITING");
a.W=!1;a.Ja=!0;var c=Z.nb();H(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");G(a);return a};a.zw=function(){var a=b("MOTION_BLUR");a.Ja=!0;a.W=!1;var c=Z.nb();H(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");G(a);return a};a.jw=function(){var a=b("ANAGLYPH");a.Ja=!0;a.W=!1;var c=Z.nb();H(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/anaglyph.glslf");G(a);return a};a.xw=function(){var a=b("LUMINANCE");a.W=!1;a.Ja=
!0;var c=Z.nb();H(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");G(a);return a};a.mw=function(){var a=b("LUMINANCE");a.W=!1;a.Ja=!0;var c=Z.nb();H(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");G(a);return a};a.yw=function(){var a=b("LUMINANCE_X_BLUR");a.W=!1;a.Ja=!0;var c=Z.nb();H(a,c);z(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");G(a);return a};a.nw=function(){var a=b("POSTPROCESSING");
a.Ja=!0;a.W=!1;var c=Z.nb();H(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");G(a);return a};a.ow=function(){var a=b("BLOOM");a.W=!1;a.Ja=!0;var c=Z.nb();H(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");G(a);return a};a.Mw=function(){var a=b("VELOCITY");a.W=!1;a.Ja=!0;var c=Z.nb();H(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");G(a);return a};a.kw=function(){var a=b("ANCHOR_VISIBILITY");a.W=!0;
a.Ja=!0;a.Zd=R.Ao;z(a,"anchors.glslv","anchors.glslf");var c=Z.kq(1);H(a,c);l(a,"ANCHOR_NUM",1);G(a);a.Li=new Float32Array([0,0,0]);return a};a.sB=function(a,b){var c=b.length/3;if(c!=a.Li.length/3){var d=Z.kq(c);H(a,d);l(a,"ANCHOR_NUM",c);G(a)}a.Li=b};a.ba=function(a,b,c){for(var d=0;d<a.n.length;d++)if(a.n[d].type==c&&!a.n[d].Jf&&-1!=a.n[d].Pc.indexOf(b))return a.n[d];return null};a.rc=function(a,b,c){for(var d=0;d<a.n.length;d++)if(a.n[d].type==c&&a.n[d].Jf&&-1!=a.n[d].Pc.indexOf(b))return a.n[d];
return null};a.ns=function(a,b){a.Mc.set(b.Mc);a.Ge=b.Ge;a.yd.set(b.yd);a.ic.set(b.ic);a.$d=b.$d;a.Md=b.Md;a.Fe=b.Fe;a.ze=b.ze;a.og=b.og;a.Yc.set(b.Yc);a.kg=b.kg;a.shallow_water_col.set(b.shallow_water_col);a.shallow_water_col_fac=b.shallow_water_col_fac;a.shore_water_col.set(b.shore_water_col);a.shore_water_col_fac=b.shore_water_col_fac;a.foam_factor=b.foam_factor;a.Oh=b.Oh};a.XC=function(a,b){for(var c=a.n,d=0;d<c.length;d++)if(c[d].type==b)return!0;return!1};a.$v=function(a){for(var b=a.L,c=0;c<
b.length;c++)pa.Zw(b[c].Va);R.wp(a.R)}};b4w.module.__nodemat=function(a,p){function b(a,b,c,l,q){if(b in sa)return sa[b];for(var u=V.create(),t=a.nodes,p=a.links,w=a.animation_data,r=0;r<t.length;r++)if(!A(u,t[r],0,w,l))return sa[b]=null;if(c&&-1==y(a,u,"GROUP_OUTPUT","group"))return null;r=Y(u);if(!R(u,p,r))return null;if(c)return u;for(r=0;r<p.length;r++){c=p[r];for(var t=g(c.from_node,u),x=g(c.to_node,u),U=0;U<t.length;U++)for(var S=0;S<x.length;S++){for(var v=t[U],G=x[S],Q=V.Ya(u,v),fa=V.Ya(u,G),C=u,F=fa,fa=[],L=c.from_socket.identifier,
z=c.to_socket.identifier,ca=Q.Ca,Q=0;Q<ca.length;Q++)if(ca[Q].identifier==L){fa.push(Q);break}F=F.J;for(Q=0;Q<F.length;Q++)if(F[Q].identifier==z){fa.push(Q);break}2==fa.length&&V.Uc(C,v,G,fa)}}f(u);a=q?y(a,u,"B4W_GLOW_OUTPUT","material",!0):y(a,u,"OUTPUT","material",!1,!0);-1==a&&(u=V.create(),a={data:null,Wd:[],Ra:[],J:[{default_value:new Float32Array([0,0,0]),identifier:"Color",is_linked:!1,name:"Color"},{default_value:1,identifier:"Alpha",is_linked:!1,name:"Alpha"}],Ca:[],type:"OUTPUT",Nh:[]},
V.sj(u,0,a),a=0);k(u);u=V.Os(u,a,V.yo);d(u);m(u);n(u);h(u);B(u);e(u,w,l);return sa[b]=u}function d(a){V.O(a,function(b,d){for(var e=d.J,f=d.Ca,g=0;g<e.length;g++)c(a,e[g],b,g,1);for(g=0;g<f.length;g++)c(a,f[g],b,g,0)})}function c(a,b,c,d,e){if(b.Eb){var f=!0;V.re(a,function(a,b,g){if(!e&&a==c&&g[0]==d||e&&b==c&&g[1]==d)f=!1});f&&(b.Eb=!1)}}function e(a,b,c){var d=[];V.re(a,function(e,f,g){var h=V.Ya(a,e),k=V.Ya(a,f),h=ea.is_vector(h.Ca[g[0]].Aa),k=ea.is_vector(k.J[g[1]].Aa);if(h!=k){var m,l={default_value:[0,
0,0],identifier:"Vector",is_linked:!0,name:"Vector"},n={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};h&&!k?m=r("vector_to_scalar","B4W_VECTOSCAL",[l],[n]):!h&&k&&(m=r("scalar_to_vector","B4W_SCALTOVEC",[n],[l]));A(a,m,0,b,c);d.push([e,f,a.X[a.X.length-2],g])}});for(var e=0;e<d.length;++e)V.Xe(a,d[e][0],d[e][1],-1),V.Uc(a,d[e][0],d[e][2],[d[e][3][0],0]),V.Uc(a,d[e][2],d[e][1],[0,d[e][3][1]])}function f(a){var b=[];V.O(a,function(c,d){switch(d.type){case "B4W_TRANSLUCENCY":V.re(a,function(a,
e,f){a==c&&"Translucency"==d.Ca[f[0]].name&&b.push(a,e,[f[0]+1,f[1]+1])})}});for(var c=0;c<b.length;c+=3)V.Uc(a,b[c],b[c+1],b[c+2])}function g(a,b){var c=[];V.O(b,function(b,d){d.name==a.name&&c.push(b)});if(c.length)return c;throw"Node not found";}function k(a){var b=[];V.O(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var d=b[c],e=b[c+1];if("B4W_PARALLAX"==e.type){var f=q(a,d);if(-1!=f){var g=V.Tj(a,f,0);V.Xe(a,f,d,-1);-1!=g&&V.Xe(a,g,f,-1);
d=V.Ya(a,f);e.data=d.data;e.Ra[0]=d.Ra[0];V.ph(a,f)}e.J.splice(1,1)}else if("REROUTE"==e.type){for(var e=V.Tj(a,d,0),h=V.ig(a,d),f=[],g=[],k=[],m=0;m<h;m++){var l=V.Of(a,d,m),n=g.indexOf(l);-1!=n?k[n]+=1:(g.push(l),k.push(1),f.push(d,l))}if(-1!=e)for(h=V.Nf(a,e,d,0)[0],m=0;m<g.length;m++)for(l=0;l<k[m];l++)n=V.Nf(a,d,g[m],l)[1],V.Uc(a,e,g[m],[h,n]);for(m=0;m<f.length;m+=2)V.Xe(a,f[m],f[m+1],-1)}}}function q(a,b){for(var c=a.oa,d=0;d<c.length;d+=3)if(c[d+1]==b&&1==c[d+2][1])return c[d];return-1}function h(a){var b=
[],c="",d="";V.O(a,function(a,e){if("GEOMETRY_UV"==e.type||"UVMAP"==e.type||"TEX_COORD_UV"==e.type){b.push(a,e);var f=e.data.value;c?c==f||d||(d=f):c=f}});if(!(3>b.length||4==b.length&&b[1].data.value!=b[3].data.value)){var e={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},f={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"},g=r("merged_uv","UV_MERGED",[],[e,f]);g.uv_layer=c;A(a,g,0,null,"");var h=a.X[a.X.length-2],g=a.X[a.X.length-1];if(d){e=r("merged_uv",
"UV_MERGED",[],[e,f]);e.uv_layer=d;A(a,e,0,null,"");var k=a.X[a.X.length-2],e=a.X[a.X.length-1]}else e=null;for(var f=-1,m=null,l=0;l<b.length;l+=2){var n=b[l],q=b[l+1];x(q,b[1])?(f=h,m=g):e&&(f=k,m=e);for(var u=[],t=V.ig(a,n),p=0;p<t;p++){var w=V.Of(a,n,p),U=V.Nf(a,n,w,0);u.push(n,w,U);U=U.splice(0,U.length);switch(q.type){case "GEOMETRY_UV":U[0]=0;m.Ca[0].Eb=!0;break;case "UVMAP":case "TEX_COORD_UV":U[0]=1,m.Ca[1].Eb=!0}V.Uc(a,f,w,U)}for(var p=0;p<u.length;p+=3)V.Xe(a,u[p],u[p+1],0);V.ph(a,n)}}}
function m(a){var b=[];V.O(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type||b.push(a,c)});for(var c=[],d=0;d<b.length;d+=2){for(var e=b[d],f=b[d+1],g=!0,h=0;h<c.length;h++){var k=c[h];if(w(f,k.lc)){g=[];h=V.ig(a,e);for(n=0;n<h;n++){var m=V.Of(a,e,n),l=V.Nf(a,e,m,0);g.push(e,m,l);V.Uc(a,k.id,m,l)}for(var n=0;n<g.length;n+=3)V.Xe(a,g[n],g[n+1],0);V.ph(a,e);g=!1;break}}g&&(k=
{id:e,lc:f},c.push(k))}}function u(a){for(var b={},c=0;c<a.X.length;c+=2){var d=a.X[c];b[d]=[]}for(c=0;c<a.oa.length;c+=3){var e=a.oa[c],f=a.oa[c+1];b[f].push(e);b[f].push(b[e])}for(d in b)b[d]=JSON.stringify(b[d]).match(/\d+/g)||[],b[d]=b[d].map(function(a){return parseInt(a)});return b}function n(a){var b=[];V.O(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var c=u(a),d=[],e=0;e<b.length;e+=2){for(var f=b[e],g=b[e+1],h=!0,k=0;k<d.length;k++){var m=
d[k];if(!(3<=m.ih.length||!w(g,m.lc)||-1<c[f].indexOf(m.id)||-1<c[m.id].indexOf(f))){for(var l=!1,n=0;n<m.ih.length;n++){var q=m.ih[n].id;if(-1<c[f].indexOf(q)||-1<c[q].indexOf(f)){l=!0;break}}if(!l){for(var k=[],q=V.Oq(a,f),t={},n=0;n<q;n++)l=V.Tj(a,f,n),l in t||(t[l]=0),h=V.Nf(a,l,f,t[l]++),k.push(l,f,h);for(var q=[],t=V.ig(a,f),p={},n=0;n<t;n++)l=V.Of(a,f,n),l in p||(p[l]=0),h=V.Nf(a,f,l,p[l]++),q.push(f,l,h);h=k.concat(q);for(n=0;n<h.length;n+=3)V.Xe(a,h[n],h[n+1],0);V.ph(a,f);n={id:f,lc:g,fx:k,
gx:q};m.ih.push(n);h=!1;break}}}h&&(m={id:f,lc:g,ih:[]},d.push(m))}for(e=0;e<d.length;e++){m=d[e];c=m.ih.length;for(k=0;k<c;k++){g=m.ih[k];n=g.lc;f=g.fx;g=g.gx;m.lc.J[k+1].Eb=n.J[0].Eb;m.lc.J[k+1].Aa=n.J[0].Aa;m.lc.Ca[2*(k+1)].Eb=n.Ca[0].Eb;m.lc.Ca[2*(k+1)].Aa=n.Ca[0].Aa;m.lc.Ca[2*(k+1)+1].Eb=n.Ca[1].Eb;m.lc.Ca[2*(k+1)+1].Aa=n.Ca[1].Aa;for(n=0;n<f.length;n+=3)l=f[n],h=f[n+2],h[1]+=k+1,V.Uc(a,l,m.id,h);for(n=0;n<g.length;n+=3)l=g[n+1],h=g[n+2],h[0]+=2*(k+1),V.Uc(a,m.id,l,h);m.lc.Wd.push(["USE_uv"+
(k+2),1])}V.ph(a,m.id);V.sj(a,m.id,m.lc)}}}function w(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":return!0;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value==b.data.value;default:return!1}}function x(a,b){var c=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=c.indexOf(a.type)&&-1!=c.indexOf(b.type)?a.data.value==b.data.value:
!1}function B(a){var b=[];V.O(a,function(a,c){"GEOMETRY_VC"==c.type&&b.push(a,c)});for(var c=0;c<b.length;c+=2){for(var d=b[c],e=b[c+1],f=!1,g=[],h=[],k=[[],[],[]],m=V.ig(a,d),l=0;l<m;l++){var n=V.Of(a,d,l);if("SEPRGB"!=V.Ya(a,n).type){f=!1;break}g.push(d,n);for(var q={},u=V.ig(a,n),f=0;f<u;f++){var t=V.Of(a,n,f);t in q||(q[t]=0);var p=V.Nf(a,n,t,q[t]++);g.push(n,t);k[p[0]].push(d,t,p)}h.push(n);f=!0}if(f){for(l=d=m=0;l<k.length;l++)k[l].length&&(m++,d|=1<<2-l);if(m){e.type+=m;e.Ca=[];for(l=0;l<k.length;l++)if(k[l].length)for(e.Ca.push({Aa:0,
identifier:"RGB"[l],Eb:!0,name:"RGB"[l]}),f=0;f<k[l].length;f+=3)k[l][f+2][0]=ea.Si(d,l);for(l=0;l<g.length;l+=2)V.Xe(a,g[l],g[l+1],0);for(l=0;l<h.length;l++)V.ph(a,h[l]);for(l=0;l<k.length;l++)for(f=0;f<k[l].length;f+=3)V.Uc(a,k[l][f],k[l][f+1],k[l][f+2])}}}}function y(a,b,c,d,e,f){a=a.nodes;for(var h=null,k=0;k<a.length;k++){var l=a[k];e?"GROUP"==l.type&&l.node_tree_name==c&&(h=l):l.type==c&&(h=l)}return h?g(h,b)[0]:(f||la.error('No "'+c+'" node in node '+d),-1)}function r(a,b,c,d){return{name:a,
type:b,inputs:c,outputs:d}}function A(a,b,c,d,e){var f=b.name,g=b.type,h=[],k=[],m=[],n=[],q=null,u=[];switch(g){case "BSDF_ANISOTROPIC":case "BSDF_DIFFUSE":case "BSDF_GLOSSY":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "EMISSION":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BUMP":case "NORMAL_MAP":case "VECT_TRANSFORM":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_IMAGE":case "TEX_ENVIRONMENT":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_VORONOI":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "LAYER_WEIGHT":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "PARTICLE_INFO":case "HAIR_INFO":case "OBJECT_INFO":case "SCRIPT":k=
L(b);m=O(b);la.warn(g+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":case "MIX_SHADER":k=L(b);m=O(b);break;case "UVMAP":var q=l("param_"+g+"_a"),p=l("param_"+g+"_v");h.push(W(q));h.push(W(p));m=O(b);n.push(W(p));q={name:q,value:b.uv_layer};break;case "UV_MERGED":q=l("param_"+g+"_a");p=l("param_"+g+"_v");h.push(W(q));h.push(W(p));m.push(z(b,"UV_geom"));m.push(z(b,"UV_cycles"));n.push(W(p));q={name:q,value:b.uv_layer};break;case "CAMERA":k=[];m=O(b);break;case "COMBRGB":case "COMBHSV":k=
L(b);m=O(b);break;case "CURVE_RGB":k=L(b);m=O(b);la.warn("CURVE_RGB node is not fully supported.");break;case "CURVE_VEC":k=L(b);m=O(b);la.warn("CURVE_VEC node is not fully supported.");break;case "GEOMETRY":if(!H(b))return!0;g=J(b,c);if(!g)return la.error("Geometry output is not supported"),!1;switch(g){case "GEOMETRY_UV":if(!b.uv_layer)return la.error('Missing uv layer in node "',b.name,'"'),!1;q=l("param_GEOMETRY_UV_a");p=l("param_GEOMETRY_UV_v");h.push(W(q));h.push(W(p));m.push(z(b,"UV"));n.push(W(p));
q={name:q,value:b.uv_layer};break;case "GEOMETRY_VC":if(!b.color_layer)return la.error("Missing vertex color layer in node ",b.name),!1;q=l("param_GEOMETRY_VC_a");p=l("param_GEOMETRY_VC_v");h.push(W(q));h.push(W(p));m.push(z(b,"Vertex Color"));n.push(W(p));q={name:q,value:b.color_layer};break;case "GEOMETRY_NO":m.push(z(b,"Normal"));break;case "GEOMETRY_FB":m.push(z(b,"Front/Back"));break;case "GEOMETRY_VW":m.push(z(b,"View"));break;case "GEOMETRY_GL":m.push(z(b,"Global"));break;case "GEOMETRY_LO":m.push(z(b,
"Local"));break;case "GEOMETRY_OR":p=l("param_GEOMETRY_OR_v"),h.push(W(p)),m.push(z(b,"Orco")),n.push(W(p))}break;case "TEX_COORD":if(!H(b))return!0;g=K(b,c);if(!g)return la.error("Texture coordinate output is not supported"),!1;switch(g){case "TEX_COORD_UV":q=l("param_TEX_COORD_UV_a");p=l("param_TEX_COORD_UV_v");h.push(W(q));h.push(W(p));m.push(z(b,"UV"));n.push(W(p));q={name:q,value:b.uv_layer};break;case "TEX_COORD_NO":m.push(z(b,"Normal"));break;case "TEX_COORD_GE":p=l("param_TEX_COORD_GE_v");
h.push(W(p));m.push(z(b,"Generated"));n.push(W(p));break;case "TEX_COORD_OB":m.push(z(b,"Object"));la.warn('Output "Object" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_CA":m.push(z(b,"Camera"));break;case "TEX_COORD_WI":m.push(z(b,"Window"));la.warn('Output "Window" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_RE":m.push(z(b,"Reflection")),la.warn('Output "Reflection" of node "Texture Coordinate" doesn\'t supported fully.')}break;
case "GROUP":p=b.node_tree_name;switch(p){case "B4W_LINEAR_TO_SRGB":if(!t(b,[1],[1])){q=F(b,e);break}g="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!t(b,[1],[1])){q=F(b,e);break}g="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!t(b,[1],[1])){q=F(b,e);break}g="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!t(b,[1,1],[1])){q=F(b,e);break}g="B4W_REFLECT";break;case "B4W_REFRACTION":if(!t(b,[1,0],[1])){q=F(b,e);break}g="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!t(b,
[1,1,0,0,0],[1])){q=F(b,e);break}var g="B4W_PARALLAX",r=l("temp_texture");n.push(W(r));break;case "B4W_CLAMP":if(!t(b,[1],[1])){q=F(b,e);break}g="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!t(b,[0,0,0,0,0],[0])){q=F(b,e);break}g="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!t(b,[],[0])){q=F(b,e);break}g="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!t(b,[0,0,0],[0])){q=F(b,e);break}g="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":g="B4W_GLOW_OUTPUT";break;default:q=F(b,e)}k=L(b);m=O(b);"B4W_TRANSLUCENCY"==
p&&(p=G("TranslucencyParams","TranslucencyParams",[0,0,0,0]),p.Eb=m[0].Eb,m.push(p));break;case "LAMP":q=b.lamp;if(!q)return la.error("There is no lamp in node: "+b.name),!1;m.push(z(b,"Color"));m.push(z(b,"Light Vector"));m.push(z(b,"Distance"));m.push(z(b,"Visibility Factor"));q.uuid in ra?u.push(["LAMP_INDEX",String(ra[q.uuid])]):(ra[q.uuid]=Q,u.push(["LAMP_INDEX",String(Q++)]));q=ra;break;case "NORMAL":k=L(b);m=O(b);p=z(b,"Normal");n.push(W(l("param_NORMAL_Normal"),p.Aa,3));break;case "MAPPING":p=
b.vector_type;g="MAPPING";k.push(P(b,"Vector"));m.push(z(b,"Vector"));var r=b.rotation,w=b.scale,x=b.translation,v=S.create(),y=ea.jx(r),B=new Float32Array([w[0],0,0,0,w[1],0,0,0,w[2]]);S.multiply(y,B,v);v=ea.bz(v,fa.create());switch(p){case "POINT":v[12]=x[0];v[13]=x[1];v[14]=x[2];break;case "TEXTURE":v[12]=x[0];v[13]=x[1];v[14]=x[2];v=fa.invert(v,v);break;case "NORMAL":fa.invert(v,v),fa.transpose(v,v)}switch(p){case "NORMAL":u.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":u.push(["MAPPING_TRS_MATRIX",
ha.t(v,16)]);break;case "POINT":0!==U.length(r)?u.push(["MAPPING_TRS_MATRIX",ha.t(v,16)]):(0!==U.length(w)&&u.push(["MAPPING_SCALE",ha.t(w,3)]),0!==U.length(x)&&u.push(["MAPPING_TRANSLATION",ha.t(x,3)]));break;case "VECTOR":0!==U.length(r)?u.push(["MAPPING_TRS_MATRIX",ha.t(v,16)]):0!==U.length(w)&&u.push(["MAPPING_SCALE",ha.t(w,3)])}b.use_min&&u.push(["MAPPING_MIN_CLIP",ha.t(b.min,3)]);b.use_max&&u.push(["MAPPING_MAX_CLIP",ha.t(b.max,3)]);break;case "MATERIAL":case "MATERIAL_EXT":q=P(b,"Color");q.Aa.splice(3);
k.push(q);(q=P(b,"Alpha"))?k.push(q):k.push(G("Alpha","Alpha",1));q=P(b,"Spec");q.Aa.splice(3);k.push(q);p=P(b,"Normal");p.Aa.splice(3);k.push(p);m.push(z(b,"Color"));m.push(z(b,"Alpha"));m.push(z(b,"Normal"));"MATERIAL_EXT"==g&&((q=P(b,"Emit"))?k.push(q):k.push(G("Emit","Emit",0)),q=P(b,"Translucency"),q.Aa=0,q.name="Translucency",q.identifier="Translucency",q?k.push(q):k.push(G(q.name,q.identifier,q.Aa)),q=P(b,"Translucency"),q.Aa=[0,0,0,0],q.name="TranslucencyParams",q.identifier="TranslucencyParams",
q?k.push(q):k.push(G(q.name,q.identifier,q.Aa)),q=P(b,"Reflectivity"),r=P(b,"Ray Mirror"),q?r="Reflectivity":r?(q=r,r="Ray Mirror"):r="Reflectivity",q?k.push(q):k.push(G(r,r,0)),(q=P(b,"SpecTra"))?k.push(q):k.push(G("SpecTra","SpecTra",0)),m.push(z(b,"Diffuse")),m.push(z(b,"Spec")));r=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":q=b.specular_hardness;break;case "WARDISO":q=b.specular_slope;break;case "TOON":q=b.specular_toon_size;r=b.specular_toon_smooth;break;default:la.error("unsupported specular shader: "+
b.specular_shader+' (material "'+b.material_name+'")'),q=b.specular_hardness}switch(b.diffuse_shader){case "LAMBERT":x=w=0;break;case "OREN_NAYAR":w=b.roughness;x=0;break;case "FRESNEL":w=b.diffuse_fresnel;x=b.diffuse_fresnel_factor;break;default:la.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),x=w=0}n.push(W(l("param_MATERIAL_diffuse"),[w,x],2));n.push(W(l("param_MATERIAL_spec"),[b.specular_intensity,q,r],3));q={name:b.name,value:{OA:b.specular_shader,
ax:b.diffuse_shader,yg:b.use_shadeless,vh:b.specular_alpha}};p.Eb&&u.push(["USE_MATERIAL_NORMAL",1]);b.use_diffuse&&u.push(["USE_MATERIAL_DIFFUSE",1]);b.use_specular&&u.push(["USE_MATERIAL_SPECULAR",1]);break;case "MATH":switch(b.operation){case "ADD":g="MATH_ADD";break;case "SUBTRACT":g="MATH_SUBTRACT";break;case "MULTIPLY":g="MATH_MULTIPLY";break;case "DIVIDE":g="MATH_DIVIDE";break;case "SINE":g="MATH_SINE";break;case "COSINE":g="MATH_COSINE";break;case "TANGENT":g="MATH_TANGENT";break;case "ARCSINE":g=
"MATH_ARCSINE";break;case "ARCCOSINE":g="MATH_ARCCOSINE";break;case "ARCTANGENT":g="MATH_ARCTANGENT";break;case "POWER":g="MATH_POWER";break;case "LOGARITHM":g="MATH_LOGARITHM";break;case "MINIMUM":g="MATH_MINIMUM";break;case "MAXIMUM":g="MATH_MAXIMUM";break;case "ROUND":g="MATH_ROUND";break;case "LESS_THAN":g="MATH_LESS_THAN";break;case "GREATER_THAN":g="MATH_GREATER_THAN";break;case "MODULO":g="MATH_MODULO";break;case "ABSOLUTE":g="MATH_ABSOLUTE";break;default:return la.error("Unsupported MATH operation: "+
b.operation),!1}u.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);k=L(b);m=O(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":g="MIX_RGB_MIX";break;case "ADD":g="MIX_RGB_ADD";break;case "MULTIPLY":g="MIX_RGB_MULTIPLY";break;case "SUBTRACT":g="MIX_RGB_SUBTRACT";break;case "SCREEN":g="MIX_RGB_SCREEN";break;case "DIVIDE":g="MIX_RGB_DIVIDE";break;case "DIFFERENCE":g="MIX_RGB_DIFFERENCE";break;case "DARKEN":g="MIX_RGB_DARKEN";break;case "LIGHTEN":g="MIX_RGB_LIGHTEN";break;case "OVERLAY":g="MIX_RGB_OVERLAY";
break;case "DODGE":g="MIX_RGB_DODGE";break;case "BURN":g="MIX_RGB_BURN";break;case "HUE":g="MIX_RGB_HUE";break;case "SATURATION":g="MIX_RGB_SATURATION";break;case "VALUE":g="MIX_RGB_VALUE";break;case "COLOR":g="MIX_RGB_COLOR";break;case "SOFT_LIGHT":g="MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":g="MIX_RGB_LINEAR_LIGHT";break;default:return la.error("Unsupported MIX_RGB blend type: "+b.blend_type),!1}u.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);k=L(b);m=O(b);break;case "OUTPUT":k=L(b);m=[];
break;case "RGB":p=e+"%join%"+b.name;p={name:"-1",value:p};n.push(p);m.push(z(b,"Color"));break;case "SEPRGB":case "SEPHSV":k=L(b);m=O(b);break;case "TEXTURE":g=I(b);if("TEXTURE_EMPTY"==g)m.push(z(b,"Color")),m.push(z(b,"Normal")),m.push(z(b,"Value"));else if("TEXTURE_ENVIRONMENT"==g)k.push(P(b,"Vector")),m.push(z(b,"Color")),m.push(z(b,"Value"));else{if("TEXTURE_NORMAL"==g&&"ENVIRONMENT_MAP"==b.texture.type)return la.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),!1;for(w=0;4>w;++w)w?
(q=G("Vector"+w,"Vector"+w,[0,0,0]),"TEXTURE_COLOR"==g&&(p=G("Color"+w,"Color"+w,[0,0,0]),r=G("Value"+w,"Value"+w,0)),"TEXTURE_NORMAL"==g&&(p=G("Normal"+w,"Normal"+w,[0,0,0]),r=G("Value"+w,"Value"+w,0))):(q=P(b,"Vector"),"TEXTURE_COLOR"==g&&(p=z(b,"Color"),r=z(b,"Value")),"TEXTURE_NORMAL"==g&&(p=z(b,"Normal"),r=z(b,"Value"))),k.push(q),m.push(p),m.push(r)}r=l("param_TEXTURE_texture");n.push(W(r));q={name:r,value:b.texture};break;case "VALTORGB":k=L(b);m=O(b);la.warn("VALTORGB node is not fully supported.");
break;case "VALUE":g="VALUE";p=e+"%join%"+b.name;p={name:"-1",value:p};n.push(p);m.push(z(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":g="VECT_MATH_ADD";break;case "SUBTRACT":g="VECT_MATH_SUBTRACT";break;case "AVERAGE":g="VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":g="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":g="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":g="VECT_MATH_NORMALIZE";break;default:return la.error("Unsupported VECT_MATH operation: "+b.operation),!1}k=L(b);
m=O(b);break;default:k=L(b),m=O(b)}f={name:f,type:g,Nh:h,J:k,Ca:m,Ra:n,data:q,Wd:u};V.sj(a,V.jq(a),f);if(!(f="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type)){a:{f=b.outputs;for(h=g=0;h<f.length;h++)if(f[h].is_linked&&g++>c){f=!0;break a}f=!1}f=!f}return f||A(a,b,++c,d,e)?!0:!1}function t(a,b,c){for(var d=a.inputs,e=a.outputs,f=a.node_tree_name,g=0;g<b.length;g++){var h=d[g],k=b[g];if(!h||h.default_value instanceof Array!=k)return la.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),
!1}for(g=0;g<c.length;g++)if(b=e[g],d=c[g],!b||b.default_value instanceof Array!=d)return la.warn('Wrong outputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1;return!0}function F(a,c){var d=a.node_group.node_tree,e={},f;for(f in d)if("links"==f||"nodes"==f){e[f]=[];for(var g=0;g<d[f].length;g++){e[f][g]={};for(var h in d[f][g])if("links"==f){e[f][g][h]={};for(var k in d[f][g][h])e[f][g][h][k]=C(d[f][g][h][k])}else e[f][g][h]=C(d[f][g][h])}}else e[f]=C(d[f]);
d=a.node_tree_name;if("B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==d)f=r("Group input","GROUP_INPUT",[],a.inputs),g=r("Group output","GROUP_OUTPUT",a.outputs,[]),h=null,h="B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==d&&(ca.quality==pa.P_LOW||ca.pm)?{from_node:f,from_socket:f.outputs[1],to_node:g,to_socket:g.inputs[0]}:{from_node:f,from_socket:f.outputs[0],to_node:g,to_socket:g.inputs[0]},e.nodes=[f,g],e.links=[h];d=a.name;f=e.nodes;g=e.links;for(h=0;h<f.length;h++)f[h].name=X(f[h].type,d,f[h].name);for(h=
0;h<g.length;h++)g[h].from_node.name=X(g[h].from_node.type,d,g[h].from_node.name),g[h].to_node.name=X(g[h].to_node.type,d,g[h].to_node.name);return{lz:b(e,a.node_group.uuid,!0,c),mz:e.links}}function C(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?ea.Fj(a):a}function l(a){ia[a]||(ia[a]=0);var b=a+ia[a],b=b.replace(/ /g,"_").replace(/\//g,"_");ia[a]++;return b}function H(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function J(a,b){for(var c=a.outputs,
d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";case "Normal":return"GEOMETRY_NO";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";default:return null}}}function K(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "Camera":return"TEX_COORD_CA";
case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function I(a){if(!a.texture)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,d=!1,e=!1,f=0;f<b.length;f++){var g=b[f];if(g.is_linked)switch(g.identifier){case "Color":c=!0;break;case "Normal":d=!0;break;case "Value":e=!0;break;default:throw"Unknown texture output";}}if(c)return d&&
la.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(d)return"TEXTURE_NORMAL";if(e)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function P(a,b){for(var c=a.inputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return N(e)}return null}function z(a,b){for(var c=a.outputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return N(e)}return null}function N(a){var b=
a.name,c=a.identifier,d=a.is_linked;a=a.default_value;a=ea.is_vector(a)?a.slice(0):a;return{name:b,identifier:c,Eb:d,Aa:a}}function G(a,b,c){return{name:a,identifier:b,Eb:!1,Aa:c}}function L(a){for(var b=[],c=0;c<a.inputs.length;c++){var d=N(a.inputs[c]);d.Aa.length&&d.Aa.splice(3);b.push(d)}return b}function O(a){for(var b=[],c=0;c<a.outputs.length;c++){var d=N(a.outputs[c]);b.push(d)}return b}function W(a,b,c){b=null===b||void 0===b?null:ha.t(b,c);return{name:a,value:b}}function X(a,b,c){return"GROUP_INPUT"==
a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function Y(a){var b=[];V.O(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function R(a,b,c){for(var d=0;d<c.length;d++){var e=c[d].data.lz,f=c[d].data.mz;if(!e)return!1;V.O(e,function(b,c){V.sj(a,V.jq(a),c)});for(e=0;e<f.length;e++)b.push(f[e]);Z(c[d],b,a)}return!0}function ga(a,b,c,d,e,f){switch(a.type){case "GROUP":a.name==b&&d.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||e.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+
"*GO*")||f.push(c)}}function ja(a,b,c){for(var d=[],e=0;e<c.length;e++){for(var f=c[e],g=null,h=0;h<b.length;h++)if(f.from_socket.identifier==b[h].to_socket.identifier){g=b[h];break}g?(f.from_node=g.from_node,f.from_socket=g.from_socket):d.push(f)}for(e=0;e<b.length;e++)a.splice(a.indexOf(b[e]),1);return d}function qa(a,b){if(b.length)for(var c=b[0].from_node.name,d=0;d<a.length;d++)a[d].from_node.name==c&&b.push(a[d])}function v(a,b,c,d){for(var e=0;e<d.length;e++){for(var f=d[e],h,k=0;k<c.J.length;k++)if(f.from_socket.identifier==
c.J[k].identifier){h=c.J[k].Aa;break}for(var k=f,m=b,l=h,n=g(k.to_node,m),q=0;q<n.length;q++)for(var u=V.Ya(m,n[q]),p=0;p<u.J.length;p++)if(u.J[p].identifier==k.to_socket.identifier){u.J[p].Aa=l;break}f=a.indexOf(f);-1!=f&&a.splice(f,1)}}function Z(a,b,c){for(var d=a.name,e=[],f=[],g=[],h=[],k=0;k<b.length;k++){var m=b[k];ga(m.from_node,d,m,e,g,h);ga(m.to_node,d,m,f,g,h)}f=ja(b,f,g);e=ja(b,h,e);qa(b,f);v(b,c,a,f);if(e.length){var l;V.O(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(d+"*GO*")||
(l=b)});v(b,c,l,e)}}var la=p("__print"),V=p("__graph"),ha=p("__shaders"),ea=p("__util"),pa=p("__config"),U=p("vec3");p("vec4");var S=p("mat3"),fa=p("mat4"),ia={},sa={},ra={},Q=0;new Float32Array(4);var ca=pa.o;a.bw=b;a.cw=function(a){var b=[],c={};ia={};var d=V.bo(a);V.O(d,function(a,d){var e;e=[];for(var f=[],g=[],h=[],k=[],m=[],n=0;n<d.J.length;n++){var q=d.J[n];if(q.Eb)e.push(null),f.push(null);else{e.push(l("in_"+d.type+"_"+q.identifier));var u=ha.t(q.Aa,0);ca.rs&&(0<=d.type.indexOf("MIX_RGB_")&&
("Color1"==q.identifier||"Color2"==q.identifier||"Fac"==q.identifier)||0<=d.type.indexOf("MATH_")&&("Value"==q.identifier||"Value_001"==q.identifier)||0<=d.type.indexOf("VECT_MATH_")&&"Vector_001"==q.identifier)&&(q=u,q=q.replace(/(,)/g,"$1 "),q=q.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1ZERO_VALUE_NODES$3"),q=q.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1UNITY_VALUE_NODES$3"),u=q=q.replace(/\s+/g,""));f.push(u)}}for(n=0;n<d.Ca.length;n++)q=d.Ca[n],q.Eb?g.push(null):g.push(l("out_"+d.type+
"_"+q.identifier));for(n=0;n<d.Ra.length;n++)q=d.Ra[n],h.push(q.name),k.push(q.value);for(n=0;n<d.Nh.length;n++)m.push(d.Nh[n].name);e={id:d.type,J:e,Nm:f,Ca:g,Ra:h,uk:k,Nh:m,Wd:JSON.parse(JSON.stringify(d.Wd))};b.push(e);c[a]=e});V.re(d,function(a,b,e){var f=V.Ya(d,a);V.Ya(d,b);var g=f.Ca[e[0]];a=c[a].Ca;b=c[b].J;f=a[e[0]]||l("out_"+f.type+"_"+g.identifier);a[e[0]]=f;b[e[1]]=f});return b};a.sp=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];if("GROUP"==
c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};a.cleanup=function(){for(var a in sa)delete sa[a];for(var b in ra)delete ra[b];Q=0}};b4w.module.__animation=function(a,p){function b(a,b){var c=a.D[b];c&&c.mm&&c.li&&(c.li=!1,c.mm(a))}function d(a,b,c){c=a.D[c];c.type=30;var d=b.frame_start,e=b.frame_end-d+1;c.start=d;c.length=e;c.oc=d;c.Fg=b.name;for(e=d=0;e<a.data.b4w_vertex_anim.length;e++){var f=a.data.b4w_vertex_anim[e];if(f==b)break;else d+=f.frame_end-f.frame_start+1}c.jt=d}function c(a,b,c){a=a.D[c];a.type=50;a.Fg=b.name;c=b.settings;a.start=c.frame_start;a.length=c.frame_end-a.start;b.settings.b4w_cyclic||(a.length+=c.lifetime);
a.uc=b}function e(a){return a.replace(/_B4W_BAKED$/,"")}function f(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:v.pa("Wrong animation behavior")}}function g(a){var b=[];a=a.data.materials;for(var c=0;c<a.length;c++){var d=a[c].node_tree;d&&k(d,b)}return b}function k(a,b){if(a.animation_data){var c=a.animation_data.action;c&&v.qd(c.fcurves)&&b.push(c)}for(var c=a.nodes,d=0;d<c.length;d++){var e=c[d];e.node_group&&(e=e.node_group.node_tree)&&
k(e,b)}}function q(a){return v.is_mesh(a)&&a.d.Xk?!0:!1}function h(a){a=a.modifiers;for(var b=0;b<a.length;b++){var c=a[b];if("ARMATURE"==c.type)return c.object}return null}function m(a,b,c){if(-1==b)for(b=0;8>b;b++){var d=a[b];d&&c(d)}else(d=a[b])&&c(d)}function u(a,c,d,e){t(a,c,d,e);b(a,d);a.d.Be&&(l(a,c),C(a,c))}function n(a,b,c){var d=b.frame_range,e=b.d,f=a.D[c];f.Fg=b.name;f.gl=d;f.No=e.wz;f.Mo=e.yv;f.Ej=e.Ej;f.start=d[0];f.length=d[1]-d[0];f.oc=d[0];d=v.qd(e.zj);if(v.is_armature(a)&&d){f.type=
10;var g=w(a,b);g||(g=H(a,b,y(a)),a.Ld.push(b,g));f.h=g.h;f.ya=g.ya;var f=a.d,g=f.Kk,h=a.D[c],e=h.In,k;a:{k=f.ts;for(var m=0;m<k.length;m+=2)if(b==k[m]){k=k[m+1];break a}k=null}if(k)h.In=k;else{for(h=0;h<g.length;h++)k=H(a,b,g[h].Kc),e.push(k);f.ts.push(b,e)}f.Be&&(b=f.Pk,c>b[1]?(f=b[1],b[1]=c,b[0]=f):c>b[0]&&c<b[1]&&(b[0]=c),x(a))}else if(ga.fe(a)&&(e.Ra.volume||e.Ra.pitch))f.volume=e.Ra.volume||null,f.pitch=e.Ra.pitch||null,f.type=40;else if("MESH"==a.type&&A(b)){f.type=60;e=w(a,b);if(!e){e=[];
h=[];k=[];var m=[],l=b.d,n=a.d.hk,q=a.d.ik;for(g in l.Ra){var u=b.name+"%join%"+g;r(g,u,l,h,e,n);r(g,u,l,m,k,q)}e={$B:e,values:h,Tz:k,Uz:m};a.Ld.push(b,e)}f.qr=e.$B;f.sr=e.values;f.pr=e.Tz;f.rr=e.Uz}else if(g=e.Ra.tsr){f.type=20;e=w(a,b);if(!e){e=b.d.wr;h=[];k=[];for(m=0;m<e;m++)h.push(g.subarray(8*m,8*m+4)),k.push(g.subarray(8*m+4,8*m+8));e={h:h,ya:k};a.Ld.push(b,e)}f.h=e.h;f.ya=e.ya;X.Yg(a)&&X.LB(a,f.h,f.ya)}else return R.warn('Incompatible action "'+b.name+'" has been applied to object "'+a.name+
'"'),!1;v.is_armature(a)&&!d&&B(a,c);return!0}function w(a,b){for(var c=a.Ld,d=0;d<c.length;d+=2)if(b==c[d])return c[d+1];return null}function x(a){var b=a.d.Pk;if(-1!=b[0]&&-1!=b[1]){var c=a.D;a=c[b[1]].oc;var d=Math.floor(a),e=a-d,b=c[b[0]];a=b.oc;d=Math.floor(a);b.oc=d+e}}function B(a,b){var c=a.d.Pk,d=c[1];c[0]=-1;c[1]=-1;if(-1!=b)for(var e=a.D;0<=d;d--){var f=e[d];if(f&&10==f.type)if(d>c[1])c[1]=d;else{d>c[0]&&(c[1]=d);break}}}function y(a){var b=a.data.bones;a=a.pose.bones;for(var c={},d=0;d<
b.length;d++){var e=b[d].name;c[e]={ip:d,fi:d,un:v.Am(a,"name",e),mt:-1}}return c}function r(a,b,c,d,e,f){for(var g=0;g<f.length;g+=2)b==f[g]&&(e.push(f[g+1]),d.push(new Float32Array(c.Ra[a])))}function A(a){a=a.d;for(var b in a.Ra)if(-1!=b.indexOf("nodes"))return!0;return!1}function t(a,b,c,d){if((c=a.D[c])&&null!=c.type&&(c.play||d)){var e=a.d;d=c.oc;var f=c.start,g=c.length;d+=c.speed*b*ha.Ha;var h=c.type,k=c.speed;if(0<=k&&d>=f+g||0>k&&d<f)switch(c.li=!0,c.behavior){case 10:d=0<=k?(d-f)%g+f:f+
g-1E-6;break;case 20:d=0<=k?f:f+g-1E-6;c.play=!1;break;case 30:d=0<=k?f+g-1E-6:f,c.play=!1}c.oc=d;switch(h){case 10:if(!e.Be){d=F(c,d,ea);b=d[0];f=d[1];d=d[2];e.xc=c.ya[b];e.wc=c.ya[f];e.Fc=c.h[b];e.Ec=c.h[f];e.Kf=d;e=e.Kk;c=c.In;for(g=0;g<e.length;g++)h=e[g],k=c[g],h.xc=k.ya[b],h.wc=k.ya[f],h.Fc=k.h[b],h.Ec=k.h[f],h.Kf=d;ja.u(a)}break;case 20:h=d=F(c,d,ea);(e=pa)||(e=new Float32Array(4));var f=h[0],g=h[1],h=h[2],k=c.h,m=k[f][1],l=k[f][2],n=k[g][1],q=k[g][2];e[0]=(1-h)*k[f][0]+h*k[g][0];e[1]=(1-h)*
m+h*n;e[2]=(1-h)*l+h*q;f=d;(g=S)||(g=new Float32Array(4));h=c.ya;la.slerp(h[f[0]].subarray(0,4),h[f[1]].subarray(0,4),f[2],g);f=g;g=d[2];h=c.h;d=(1-g)*h[d[0]][3]+g*h[d[1]][3];c.co&&(g=U,ja.get_translation(a,g),v.smooth_v(e,g,b,c.co,e));c.yn&&(g=fa,ja.get_rotation(a,g),v.As(f,g,b,c.yn,f));c=c.Ej;c[0]&&ja.set_translation(a,e);c[1]&&ja.set_rotation(a,f);c[2]&&ja.set_scale(a,d);ja.u(a);Y.sync_transform(a);break;case 30:(a=ea)||(a=Array(3));f=d-c.start;0>f&&(f=0);f>=c.length&&(f=c.length);b=Math.floor(f);
d=b+1;f-=b;10!=c.behavior&&d==c.length&&(d=--b,f=1);c=c.jt;a[0]=b+c;a[1]=d+c;a[2]=f;d=ea;e.ko=d[0];e.it=d[2];break;case 40:d=F(c,d,ea);b=d[0];e=d[1];d=d[2];c.volume&&ga.set_volume(a,(1-d)*c.volume[b]+d*c.volume[e]);c.pitch&&ga.playrate(a,(1-d)*c.pitch[b]+d*c.pitch[e]);break;case 50:X.sA(c.uc,d/ha.Ha);break;case 60:d=F(c,d,ea);b=d[0];e=d[1];d=d[2];k=c.sr;m=c.qr;f=c.rr;c=c.pr;for(g=0;g<m.length;g++)l=k[g],h=m[g],a.d.he[h]=(1-d)*l[b]+d*l[e];for(g=0;g<c.length;g++)k=f[g],h=c[g],k=V.lerp(k.subarray(3*
b,3*b+3),k.subarray(3*e,3*e+3),d,pa),a.d.tc[h]=k[0],a.d.tc[h+1]=k[1],a.d.tc[h+2]=k[2];break;default:v.pa("Unknown animation type:"+h)}}}function F(a,b,c){c||(c=Array(3));var d=a.gl[0],e=a.gl[1]-d;b-=d;0>b&&(b=0);b>=e&&(b=e);b/=a.No;e=Math.floor(b);a=a.Mo[e]?b-e:0;c[0]=e;c[1]=e+1;c[2]=a;return c}function C(a,b){var c=a.d,d=c.Ae,e=c.Pk,f=e[0],e=e[1];if(-1!=e){if(-1!=f){var g=a.D[f];if(g.play||0==b)var h=F(g,g.oc,ea),k=h[0],m=h[1],h=h[2],l=g.ya[k],n=g.ya[m],k=g.h[k],m=g.h[m];else d=1}else d=1;e=a.D[e];
if(e.play||0==b)var h=F(e,e.oc,ea),q=h[0],u=h[1],h=h[2];else if(-1!=f&&g.play)d=0;else return;f=e.ya[q];g=e.ya[u];q=e.h[q];e=e.h[u];if(1==d)c.xc.set(f),c.wc.set(g),c.Fc.set(q),c.Ec.set(e);else if(0==d)c.xc.set(l),c.wc.set(n),c.Fc.set(k),c.Ec.set(m);else{for(u=0;u<l.length;u+=4){for(var p=S,t=fa,w=0;4>w;w++)p[w]=l[u+w],t[w]=f[u+w];la.slerp(p,t,d,p);for(w=0;4>w;w++)c.xc[u+w]=p[w];for(w=0;4>w;w++)p[w]=n[u+w],t[w]=g[u+w];la.slerp(p,t,d,p);for(w=0;4>w;w++)c.wc[u+w]=p[w]}v.ep(k,q,d,c.Fc);v.ep(m,e,d,c.Ec)}ja.u(a);
d=c.Kk;l=c.nr;for(u=0;u<d.length;u++){n=d[u];k=l[u];for(m=0;m<k.length;m+=2)for(q=k[m],f=k[m+1],g=0;4>g;g++)n.xc[q+g]=c.xc[f+g],n.wc[q+g]=c.wc[f+g],n.Fc[q+g]=c.Fc[f+g],n.Ec[q+g]=c.Ec[f+g];n.Kf=h}}}function l(a,b){var c=a.d,d=c.Ae,e=c.kl;if(0!=e){var d=c.jl-d,f=e*b;v.sign(d)==v.sign(e)&&Math.abs(f)<Math.abs(d)?c.Ae+=f:(c.Ae=c.jl,c.kl=0)}}function H(a,b,c){for(var d=a.pose.bones,e=[],f=[],g=b.d.wr,h=0;h<g;h++){for(var k=0;k<d.length;k++){var m=d[k],l=qa.create(),n=b.d.zj[m.name];n&&qa.copy(n.subarray(8*
h,8*h+8),l);m.Jo=l;m.oj=!1}k=J(a,c);e.push(k.h);f.push(k.ya)}return{h:e,ya:f}}function J(a,b){var c=[],d=[],e=a.pose.bones,f=new Float32Array(4),g=new Float32Array(4),h;for(h in b){var k=b[h],m=k.fi,l=e[k.un],k=f,n=g,q=l.Lu,u=q[q.length-1],p=u.fl;u.oj||qa.identity(p);for(u=q.length-1;0<=u;u--){var l=q[u],t=l.fl;if(l.oj)p=t;else{var w=l.Ko,r=l.Jo;qa.invert(w,ia);qa.multiply(r,ia,ia);qa.multiply(w,ia,ia);qa.multiply(p,ia,t);p=t;l.oj=!0}}l=l.fl;k[0]=l[0];k[1]=l[1];k[2]=l[2];k[3]=l[3];n[0]=l[4];n[1]=
l[5];n[2]=l[6];n[3]=l[7];la.normalize(n,n);for(k=0;4>k;k++)n=4*m+k,c[n]=f[k],d[n]=g[k]}c=new Float32Array(c);d=new Float32Array(d);return{h:c,ya:d}}function K(a){var b=[0,0,0],c;for(c in a)"location"==c?b[0]=1:"rotation_quaternion"==c?b[1]=1:"scale"==c&&(b[2]=1);return b}function I(a,b,c,d,e,f,g){var h=a+(b-a)/2,k=P(h,d,e,f,g)-c;return.02>Math.abs(k)?h:0<k?I(a,h,c,d,e,f,g):I(h,b,c,d,e,f,g)}function P(a,b,c,d,e){var f=1-a;return b*f*f*f+3*c*f*f*a+3*d*f*a*a+e*a*a*a}function z(a,b){if(!a.D.length)for(var c=
0;8>c;c++)a.D.push(null);a.D[b]={type:null,Fg:null,gl:null,No:0,Mo:null,Ej:null,ya:null,h:null,In:[],play:!1,behavior:20,oc:0,start:0,length:0,co:0,yn:0,li:!1,jt:null,speed:1,volume:null,pitch:null,sr:[],qr:[],rr:[],pr:[]};a.Ld=a.Ld||[];-1==sa.indexOf(a)&&sa.push(a)}function N(a,b){ja.u(a);Y.sync_transform(a);u(a,0,b,!0)}function G(a,b,e){e=e||0;if(v.is_mesh(a)){var f=v.keysearch("name",b,a.data.b4w_vertex_anim);if(f)return z(a,e),d(a,f,e),N(a,e),!0;if((f=v.keysearch("name",b,a.particle_systems))&&
"EMITTER"==f.settings.type)return z(a,e),c(a,f,e),N(a,e),!0}if(f=v.keysearch("name",b,ra)||v.keysearch("name",b+"_B4W_BAKED",ra)){z(a,e);if(n(a,f,e))return N(a,e),!0;a.D[e]=null}R.error('Unsupported object: "'+a.name+'" or animation name: "'+b+'"');return!1}function L(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c.use_nodes&&d&&O(d))return!0}return!1}function O(a){if(a.animation_data)return!0;a=a.nodes;for(var b=0;b<
a.length;b++){var c=a[b];if(c.node_group&&(c=c.node_group.node_tree)&&O(c))return!0}return!1}var W=p("__config"),X=p("__particles"),Y=p("__physics"),R=p("__print");p("__scenes");var ga=p("__sfx"),ja=p("__transform"),qa=p("__tsr"),v=p("__util"),Z=p("__reformer");p("mat4");var la=p("quat");p("vec4");var V=p("vec3"),ha=W.Nd;a.OBJ_ANIM_TYPE_NONE=0;a.OBJ_ANIM_TYPE_ARMATURE=10;a.OBJ_ANIM_TYPE_OBJECT=20;a.OBJ_ANIM_TYPE_VERTEX=30;a.OBJ_ANIM_TYPE_SOUND=40;a.OBJ_ANIM_TYPE_PARTICLES=50;a.OBJ_ANIM_TYPE_MATERIAL=
60;a.SLOT_0=0;a.SLOT_1=1;a.SLOT_2=2;a.SLOT_3=3;a.SLOT_4=4;a.SLOT_5=5;a.SLOT_6=6;a.SLOT_7=7;a.SLOT_ALL=-1;a.AB_CYCLIC=10;a.AB_FINISH_RESET=20;a.AB_FINISH_STOP=30;var ea=Array(3),pa=new Float32Array(3),U=new Float32Array(3),S=new Float32Array(4),fa=new Float32Array(4),ia=new Float32Array(8);new Float32Array(16);var sa=[],ra=[];a.uq=function(){return v.trunc((W.o.mr-50)/4)};a.frame_to_sec=function(a){return a/ha.Ha};a.update=function(a){for(var c=0;c<sa.length;c++){for(var d=sa[c],e=0;8>e;e++)t(d,a,
e);d.d.Be&&(l(d,a),C(d,a))}for(c=0;c<sa.length;c++)for(d=sa[c],e=0;8>e&&d.D.length;e++)b(d,e)};a.mq=function(){return ra};a.get_anim_names=function(a){var b=[];if(q(a))for(var c=0;c<a.data.b4w_vertex_anim.length;c++)b.push(a.data.b4w_vertex_anim[c].name);var d,c=[];for(d=0;d<ra.length;d++){var f=ra[d],h=f.d;v.qd(f.d.zj)?"ARMATURE"==a.type&&c.push(f):h.Ra.volume||h.Ra.pitch?ga.fe(a)&&c.push(f):!A(f)&&v.qd(f.fcurves)&&c.push(f)}"MESH"==a.type&&(c=c.concat(g(a)));d=c;for(c=0;c<d.length;c++)b.push(e(d[c].name));
if(X.Yg(a)&&X.Hm(a))for(c=0;c<a.particle_systems.length;c++)b.push(a.particle_systems[c].name);return b};a.YA=e;a.get_anim_type=function(a,b){var c=a.D[b];return c?c.type:0};a.apply_def=function(a){var b=0,e,h=[];if((e=a.animation_data)&&e.action&&(e=e.action,v.qd(e.fcurves))){var k=v.qd(e.d.zj);"ARMATURE"!=a.type&&k||h.push(e)}ga.fe(a)&&a.data.animation_data&&a.data.animation_data.action&&h.push(a.data.animation_data.action);"MESH"==a.type&&(h=h.concat(g(a)));e=h;for(h=0;h<e.length;h++)k=e[h],z(a,
b),n(a,k,b)?(N(a,b),a.D[b].behavior=f(a.b4w_anim_behavior),b++):a.D[b]=null;e=a.particle_systems;for(h=0;h<e.length;h++){var k=e[h],m=k.settings;"EMITTER"==m.type&&(z(a,b),c(a,k,b),N(a,b),a.D[b].behavior=f(a.b4w_anim_behavior),m.b4w_cyclic&&(a.D[b].behavior=10),b++)}q(a)&&(z(a,b),d(a,a.data.b4w_vertex_anim[0],b),N(a,b),a.D[b].behavior=f(a.b4w_anim_behavior))};a.get_first_armature_object=h;a.play=function(a,b,c){m(a.D,c,function(a){a.play=!0;a.mm=b?b:null;a.li=!1});a.d.Be&&x(a)};a.stop=function(a,
b){m(a.D,b,function(a){a.play=!1;a.mm=null;a.li=!1})};a.is_play=function(a,b){var c=a.D[b];return c?c.play:!1};a.set_current_frame_float=function(a,b,c){var d=a.D;if(-1==c)for(c=0;8>c;c++){var e=d[c];e&&(e.oc=b,u(a,0,c,!0))}else if(e=d[c])e.oc=b,u(a,0,c,!0)};a.get_current_frame_float=function(a,b){var c=a.D[b];return c&&c.oc?c.oc:0};a.is_cyclic=function(a,b){var c=a.D[b];return c&&10==c.behavior};a.set_behavior=function(a,b,c){m(a.D,c,function(a){a.behavior=b})};a.get_behavior=function(a,b){var c=
a.D[b];return c&&c.behavior};a.apply_smoothing=function(a,b,c,d){m(a.D,d,function(a){a.co=b||0;a.yn=c||0})};a.remove_slot_animation=function(a,b){if(-1==b)for(var c=0;8>c;c++)a.D[c]=null;else a.D[b]=null;a.d.Be&&B(a,b)};a.update_object_animation=u;a.bk=function(a){if("ARMATURE"==a.type||h(a))return!0;var b=a.animation_data;return b&&b.action||"SPEAKER"==a.type&&a.data.animation_data&&a.data.animation_data.action||X.Yg(a)&&X.Hm(a)||"MESH"==a.type&&a.data.b4w_vertex_anim.length||L(a)?!0:!1};a.is_animated=
function(a){return Boolean(a.D.length)};a.Gv=y;a.lp=J;a.Uu=function(a){function b(a,c){for(var d=0;d<c;d++){var e=a.subarray(8*d+4,8*d+8);la.normalize(e,e)}}function c(a,b){if(-1<a.indexOf("location"))var d=0,e=b;else-1<a.indexOf("rotation_quaternion")?(d=4,e=0==b?3:b-1):-1<a.indexOf("scale")?(d=3,e=0):(d=0,e=b);return d+e}function d(a,b,c,e,h){if(-1<c.search(f)){a=b;c=c.split('"')[1];var k=g}else 8==h?(c="tsr",k=g):k=1<h?new Float32Array(h):0;if(!a[c]){h=a;b=c;if("object"==typeof k&&k.length)for(var m=
k.length,l=new Float32Array(e*m),n=0;n<e;n++)for(var q=0;q<m;q++)l[n*m+q]=k[q];else if("number"==typeof k)for(l=new Float32Array(e),n=0;n<e;n++)l[n]=k;else v.pa("Wrong storage default value");h[b]=l}return a[c]}a.d={};var e=a.d;e.wz=1/ha.Lf;var f=new RegExp(/pose.bones\[\".+\"\]/g),g=qa.create(),h=a.fcurves,k={},m={},l=0,n;for(n in h){var q=h[n],u;for(u in q){var p=q[u],t=p.kc;Z.Kv(p,a);p=p.num_channels;l||(l=t.length);for(var p=d(k,m,n,l,p),w=p.length/l,r=c(n,u|0),x=0;x<l;x++)p[x*w+r]=t[x]}}for(var U in k)"tsr"==
U&&b(k[U],l);for(var S in m)b(m[S],l);e.Ra=k;e.zj=m;e.yv=a.Ku;e.wr=l;e.Ej="tsr"in k?K(h):null;ra.push(a)};a.Tx=function(a,b){return(b-a)*ha.Lf+1};a.nv=function(a,b,c,d,e,f){var g,h,k=new Float32Array(2),m=new Float32Array(2),l=new Float32Array(2),n=new Float32Array(2),q=b[1],u=b[2],p=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var t=0,w=0,r=null;e<=f;e++)if(e<q)for(var x=0;x<ha.Lf;x++)c[t++]=u;else if(e>p)for(x=0;x<ha.Lf;x++)c[t++]=a;else{var U=b[w],S=3;0===U&&(S+=2);0===r&&(S+=2);var G=
2===U?0:1;if(b[w+1]==b[w+S+1])r=U,w+=S;else{x=0;e==b[w+1]&&(G&&(d[t]=1),c[t]=b[w+2],t++,x++);if(e==p)for(;x<ha.Lf;x++)c[t++]=a;else for(k[0]=b[w+1],k[1]=b[w+2],0!==U?(m[0]=0,m[1]=0):0===r?(m[0]=b[w+5],m[1]=b[w+6]):(m[0]=b[w+3],m[1]=b[w+4]),0!==U?(l[0]=0,l[1]=0):(l[0]=b[w+S+3],l[1]=b[w+S+4]),n[0]=b[w+S+1],n[1]=b[w+S+2];x<ha.Lf;x++){var y=e+x/ha.Lf;switch(U){case 0:g=k;h=m;var fa=l,B=n,A=[],C=[],F=void 0,L=void 0,z=void 0,F=void 0;A[0]=g[0]-h[0];A[1]=g[1]-h[1];C[0]=B[0]-fa[0];C[1]=B[1]-fa[1];z=B[0]-
g[0];F=Math.abs(A[0]);L=Math.abs(C[0]);0!=F+L&&F+L>z&&(F=z/(F+L),h[0]=g[0]-F*A[0],h[1]=g[1]-F*A[1],fa[0]=B[0]-F*C[0],fa[1]=B[1]-F*C[1]);G&&(d[t]=1);c[t]=P(I(0,1,y,k[0],m[0],l[0],n[0]),k[1],m[1],l[1],n[1]);t++;break;case 1:h=k[0];fa=k[1];g=B=(n[1]-fa)/(n[0]-h);h=fa-B*h;G&&(d[t]=1);c[t]=g*y+h;t++;break;case 2:G&&(d[t]=1);c[t]=b[w+2];t++;break;default:v.pa("Unknown keyframe intepolation mode: "+U)}}e+1==b[w+S+1]&&(r=U,w+=S)}}};a.uD=function(a){for(var b=0;b<a.length;b++)if(a[b].HC)return a[b];return!1};
a.apply=G;a.iv=function(a,b,c){c=c||0;var d=v.keysearch("uuid",b,ra);if(d){z(a,c);if(n(a,d,c)){N(a,c);return}a.D[c]=null}R.error('Unsupported object: "'+a.name+'" or animation uuid: "'+b+'"')};a.aC=function(a,b){var c=v.keysearch("name",b,ra)||v.keysearch("name",b+"_B4W_BAKED",ra);return c?v.qd(c.fcurves)?!0:!1:v.keysearch("name",b,a.particle_systems)?!0:!1};a.get_slot_num_by_anim=function(a,b){for(var c=a.D,d=0;d<c.length;d++){var f=c[d];if(f&&e(f.Fg)==e(b))return d}return-1};a.Rx=function(a,b){var c=
a.D[b];return c&&c.Fg?e(c.Fg):null};a.remove=function(a){a.D.length=0;a=sa.indexOf(a);-1!=a&&sa.splice(a,1)};a.Kz=function(a){for(var b=ra.length-1;0<=b;b--)ra[b].Mu==a&&ra.splice(b,1)};a.apply_to_first_empty_slot=function(a,b){if(!a.D.length)return G(a,b,0)?0:-1;for(var c=0;c<a.D.length;c++)if(!a.D[c])return G(a,b,c)?c:-1};a.set_skel_mix_factor=function(a,b,c){a.d.kl=(b-a.d.Ae)/c;a.d.jl=b};a.set_speed=function(a,b,c){m(a.D,c,function(a){a.speed=b})};a.get_speed=function(a,b){return a.D[b].speed};
a.get_anim_start_frame=function(a,b){return a.D[b].start};a.get_anim_length=function(a,b){return a.D[b].length};a.wy=L;a.cleanup=function(){sa.length=0;ra.length=0};a.sx=function(a){var b=(a[0]||a[1]||a[2]).kc.length,c=S,d=pa,e=Boolean(a[0]);e||(a[0]={kc:new Float32Array(b),num_channels:8});var f=Boolean(a[1]);f||(a[1]={kc:new Float32Array(b),num_channels:8});var g=Boolean(a[2]);g||(a[2]={kc:new Float32Array(b),num_channels:8});a[3]={kc:new Float32Array(b),num_channels:8};for(var h=0;h<b;h++)d[0]=
e?a[0].kc[h]:0,d[1]=f?a[1].kc[h]:0,d[2]=g?a[2].kc[h]:0,v.euler_to_quat(d,c),a[0].kc[h]=c[3],a[1].kc[h]=c[0],a[2].kc[h]=c[1],a[3].kc[h]=c[2]}};b4w.module.__time=function(a,p){p("__util");var b=0,d=0,c=[],e=0,f=[];a.os=function(a){b=a;d=performance.now();for(a=0;a<c.length;a++){var e=c[a];b>e.gm&&(c.splice(a,1),a--,e.callback())}for(a=0;a<f.length;a++){var e=f[a],q=1-(e.gm-b)/e.duration,q=Math.min(q,1);e.callback(e.M+q*(e.la-e.M));1==q&&(f.splice(a,1),a--)}};a.get_timeline=function(){return b};a.set_timeout=function(a,f){var q;e++;q=e;c.push({id:q,callback:a,gm:b+(performance.now()-d+f)/1E3});return q};a.clear_timeout=function(a){for(var b=
0;b<c.length;b++)if(c[b].id==a){c.splice(b,1);break}};a.animate=function(a,c,d,e){d/=1E3;f.push({callback:e,M:a,la:c,gm:b+d,duration:d});e(a)};a.reset=function(){d=b=0;e=c.length=0}};b4w.module.__transform=function(a,p){function b(a,b){var c=a.d;c.h[0]=b[0];c.h[1]=b[1];c.h[2]=b[2];c.scale=b[3];c.quat[0]=b[4];c.quat[1]=b[5];c.quat[2]=b[6];c.quat[3]=b[7]}function d(a){var b=a.d,n=q.Wg();"CAMERA"==a.type&&e.io(a);f.BB(a,C);"CAMERA"==a.type&&e.yB(a);var p=b.h,t=b.scale,r=b.quat;m.set_sep(p,t,r,b.Ab);var B=b.T;y.identity(B);y.fromQuat(r,B);"CAMERA"!=a.type&&u.Zz(B,t,B);B[12]=p[0];B[13]=p[1];B[14]=p[2];y.invert(B,b.Rq);a.D.length&&k.Hm(a)&&k.CB(a);b.Pb&&b.bb&&(c.xl(b.Pb,B,b.bb),c.zl(b.Vc,
B,b.vb),c.yl(b.yf,b.Ab,b.zf),b.Ac&&q.Fn(n),null!=b.nc&&n&&q.$s(n,a));if(n&&n.d.zb)for(B=n.d.zb.Dk,t=0;t<B.length;t++)if(B[t]==a){q.ct(t,n);break}switch(a.type){case "SPEAKER":h.NA(a,C);break;case "CAMERA":e.zB(a);n&&q.Rj(n)==a&&h.Wy(n,p,r,C);break;case "LAMP":g.DB(a);n&&q.ug(a,n);break;case "EMPTY":a.field&&q.at(a);break;case "MESH":p=a.modifiers;r=null;for(t=0;t<p.length;t++)B=p[t],"ARMATURE"==B.type&&(r=B.object);r&&(m.invert(r.d.Ab,F),m.multiply(F,b.Ab,F),w.set(F[0],F[1],F[2],F[3],b.ml),x.set(F[4],
F[5],F[6],F[7],b.ll))}"LAMP"!=a.type&&"CAMERA"!=a.type||!n||(q.Fn(n),q.bA(n));a=a.Ic;for(t=0;t<a.length;t++)d(a[t]);b.sm=!0}var c=p("__boundings"),e=p("__camera"),f=p("__constraints"),g=p("__lights"),k=p("__particles"),q=p("__scenes"),h=p("__sfx"),m=p("__tsr"),u=p("__util"),n=p("vec3"),w=p("vec4"),x=p("quat"),B=p("mat3"),y=p("mat4"),r=new Float32Array(3),A=new Float32Array(4),t=new Float32Array(9),F=new Float32Array(8),C=0;a.SPACE_WORLD=0;a.SPACE_LOCAL=1;a.update=function(a){C=a};a.set_translation=
function(a,b){f.de(a)==f.Hd?m.set_trans(b,f.ce(a)):a.d.h.set(b)};a.get_translation=function(a,b){f.de(a)==f.Hd?n.copy(m.get_trans_view(f.ce(a)),b):n.copy(a.d.h,b)};a.set_rotation=function(a,b){f.de(a)==f.Hd?m.set_quat(b,f.ce(a)):a.d.quat.set(b)};a.get_rotation=function(a,b){f.de(a)==f.Hd?x.copy(m.get_quat_view(f.ce(a)),b):x.copy(a.d.quat,b)};a.set_rotation_euler=function(a,b){if(f.de(a)==f.Hd){var c=u.euler_to_quat(b,A);m.set_quat(c,f.ce(a))}else u.euler_to_quat(b,a.d.quat)};a.set_scale=function(a,
b){f.de(a)==f.Hd?m.set_scale(b,f.ce(a)):a.d.scale=b};a.get_scale=function(a){return f.de(a)==f.Hd?m.get_scale(f.ce(a)):a.d.scale};a.get_tsr=function(a,b){if(f.de(a)==f.Hd)m.copy(f.ce(a),b);else{var c=a.d;m.set_sep(c.h,c.scale,c.quat,b)}};a.set_tsr=function(a,c){f.de(a)==f.Hd?m.copy(c,f.ce(a)):b(a,c)};a.tA=b;a.get_object_size=function(a){var b=a.d,c=a.data.b4w_bounding_box;a=b.scale*(c.max_x-c.min_x);var d=b.scale*(c.max_y-c.min_y),b=b.scale*(c.max_z-c.min_z);return.5*Math.sqrt(a*a+d*d+b*b)};a.get_object_center=
function(a,b,c){c||(c=new Float32Array(3));b?(b=a.d,n.copy(b.vb.F,c)):(b=a.d,a=a.data.b4w_bounding_box,c[0]=(a.max_x+a.min_x)/2,c[1]=(a.max_y+a.min_y)/2,c[2]=(a.max_z+a.min_z)/2,n.transformMat4(c,b.T,c));return c};a.move_local=function(a,b,c,d){a=a.d;r[0]=b;r[1]=c;r[2]=d;b=B.fromMat4(a.T,t);n.transformMat3(r,b,r);n.add(a.h,r,a.h)};a.u=d;a.distance=function(a,b){return n.dist(a.d.h,b.d.h)};a.qz=function(a,b){return n.dist(a.d.h,b)};a.get_object_bounding_box=function(a){return{max_x:a.d.bb.max_x,min_x:a.d.bb.min_x,
max_y:a.d.bb.max_y,min_y:a.d.bb.min_y,max_z:a.d.bb.max_z,min_z:a.d.bb.min_z}}};b4w.module.__tsr=function(a,p){function b(a,b,c,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=b;d[4]=c[0];d[5]=c[1];d[6]=c[2];d[7]=c[3]}function d(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],k=b[4],q=b[5],p=b[6];b=b[7];var t=a[0]*g,F=a[1]*g,C=a[2]*g;a=b*t+q*C-p*F;var g=b*F+p*t-k*C,l=b*C+k*F-q*t,t=-k*t-q*F-p*C;c[0]=a*b+t*-k+g*-p-l*-q;c[1]=g*b+t*-q+l*-k-a*-p;c[2]=l*b+t*-p+a*-q-g*-k;c[0]+=d;c[1]+=e;c[2]+=f;return c}var c=p("__util"),e=p("vec3"),f=p("quat"),g=p("mat4"),k=new Float32Array(3),q=new Float32Array(4);
new Float32Array(16);a.create=function(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a};a.from_values=function(a,b,c,d,e,f,g,k){var q=new Float32Array(8);q[0]=a;q[1]=b;q[2]=c;q[3]=d;q[4]=e;q[5]=f;q[6]=g;q[7]=k;return q};a.copy=function(a,b){b.set(a)};a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.create_sep=function(a,c,d,e){e||(e=new Float32Array(8));b(a,c,d,e);return e};a.set_sep=b;a.set_trans=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2]};a.set_scale=
function(a,b){b[3]=a};a.set_transcale=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.set_quat=function(a,b){b[4]=a[0];b[5]=a[1];b[6]=a[2];b[7]=a[3]};a.get_trans_view=function(a){return a.subarray(0,3)};a.get_scale=function(a){return a[3]};a.get_quat_view=function(a){return a.subarray(4)};a.invert=function(a,b){var c=1/a[3];if(!c)return null;var d=a[0],e=a[1],g=a[2];q[0]=a[4];q[1]=a[5];q[2]=a[6];q[3]=a[7];f.invert(q,q);var k=q[0],p=q[1],r=q[2],A=q[3],d=d*c,e=e*c,t=g*c,g=A*d+p*t-r*e,F=A*e+
r*d-k*t,C=A*t+k*e-p*d,d=-k*d-p*e-r*t;b[0]=-(g*A+d*-k+F*-r-C*-p);b[1]=-(F*A+d*-p+C*-k-g*-r);b[2]=-(C*A+d*-r+g*-p-F*-k);b[3]=c;b[4]=k;b[5]=p;b[6]=r;b[7]=A;return b};a.to_mat4=function(a,b){var c=a[3];g.fromRotationTranslation(a.subarray(4),a.subarray(0,3),b);for(var d=0;12>d;d++)b[d]*=c;return b};a.from_mat4=function(a,d){var e=c.fh(a,k),f=c.fn(a),g=c.matrix_to_quat(a,q);b(e,f,g,d);return d};a.multiply=function(a,b,c){d(b,a,c);c[3]=a[3]*b[3];var e=a[4],f=a[5],g=a[6];a=a[7];var k=b[4],q=b[5],p=b[6];
b=b[7];c[4]=e*b+a*k+f*p-g*q;c[5]=f*b+a*q+g*k-e*p;c[6]=g*b+a*p+e*q-f*k;c[7]=a*b-e*k-f*q-g*p;return c};a.transform_vec3=d;a.transform_vec3_inv=function(a,b,c){var d=b[3],e=a[0]-b[0],f=a[1]-b[1],g=a[2]-b[2];a=b[4];var k=b[5],q=b[6];b=b[7];var p=a*a+k*k+q*q+b*b,p=p?1/p:0;a=-a*p;k=-k*p;q=-q*p;b*=p;var p=b*e+k*g-q*f,t=b*f+q*e-a*g,F=b*g+a*f-k*e,e=-a*e-k*f-q*g;c[0]=p*b+e*-a+t*-q-F*-k;c[1]=t*b+e*-k+F*-a-p*-q;c[2]=F*b+e*-q+p*-k-t*-a;c[0]/=d;c[1]/=d;c[2]/=d;return c};a.transform_vectors=function(a,b,c,d){d||
(d=0);var e=a.length,f=b[0],g=b[1],k=b[2],q=b[3],p=b[4],t=b[5],F=b[6];b=b[7];for(var C=0;C<e;C+=3){var l=a[C]*q,H=a[C+1]*q,J=a[C+2]*q,K=b*l+t*J-F*H,I=b*H+F*l-p*J,P=b*J+p*H-t*l,l=-p*l-t*H-F*J;c[d+C]=K*b+l*-p+I*-F-P*-t;c[d+C+1]=I*b+l*-t+P*-p-K*-F;c[d+C+2]=P*b+l*-F+K*-t-I*-p;c[d+C]+=f;c[d+C+1]+=g;c[d+C+2]+=k}return c};a.transform_dir_vectors=function(a,b,c,d){d||(d=0);var e=a.length,f=b[3],g=b[4],k=b[5],q=b[6];b=b[7];for(var p=0;p<e;p+=3){var t=a[p]*f,F=a[p+1]*f,C=a[p+2]*f,l=b*t+k*C-q*F,H=b*F+q*t-g*
C,J=b*C+g*F-k*t,t=-g*t-k*F-q*C;c[d+p]=l*b+t*-g+H*-q-J*-k;c[d+p+1]=H*b+t*-k+J*-g-l*-q;c[d+p+2]=J*b+t*-q+l*-k-H*-g}return c};a.transform_dir_vec3=function(a,b,c){var d=b[3],e=b[4],f=b[5],g=b[6];b=b[7];var k=a[0]*d,q=a[1]*d,p=a[2]*d;a=b*k+f*p-g*q;var d=b*q+g*k-e*p,t=b*p+e*q-f*k,k=-e*k-f*q-g*p;c[0]=a*b+k*-e+d*-g-t*-f;c[1]=d*b+k*-f+t*-e-a*-g;c[2]=t*b+k*-g+a*-f-d*-e;return c};a.transform_tangents=function(a,b,c,d){d||(d=0);var e=a.length,f=b[3],g=b[4],k=b[5],q=b[6];b=b[7];for(var p=0;p<e;p+=4){var t=a[p]*
f,F=a[p+1]*f,C=a[p+2]*f,l=b*t+k*C-q*F,H=b*F+q*t-g*C,J=b*C+g*F-k*t,t=-g*t-k*F-q*C;c[d+p]=l*b+t*-g+H*-q-J*-k;c[d+p+1]=H*b+t*-k+J*-g-l*-q;c[d+p+2]=J*b+t*-q+l*-k-H*-g;c[d+p+3]=a[p+3]}return c};a.translate=function(a,b,c){var d=a[3],e=a[4],f=a[5],g=a[6],k=a[7],q=b[0]*d,p=b[1]*d,t=b[2]*d;b=k*q+f*t-g*p;var d=k*p+g*q-e*t,F=k*t+e*p-f*q,q=-e*q-f*p-g*t;c[0]=a[0]+b*k+q*-e+d*-g-F*-f;c[1]=a[1]+d*k+q*-f+F*-e-b*-g;c[2]=a[2]+F*k+q*-g+b*-f-d*-e;c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];return c};a.interpolate=
function(a,b,c,d){d||(d=new Float32Array(8));e.lerp(a.subarray(0,3),b.subarray(0,3),c,d.subarray(0,3));var g=a[3];d[3]=g+c*(b[3]-g);f.slerp(a.subarray(4),b.subarray(4),c,d.subarray(4));return d};a.rD=function(a,b,c,d){d||(d=new Float32Array(8));var e=a.subarray(0,3),g=b.subarray(0,3),k=d.subarray(0,3);k[0]=g[0]*(c+1)-e[0]*c;k[1]=g[1]*(c+1)-e[1]*c;k[2]=g[2]*(c+1)-e[2]*c;d[3]=b[3]*(c+1)-a[3]*c;a=a.subarray(4);b=b.subarray(4);e=d.subarray(4);e[0]=b[0]*(c+1)-a[0]*c;e[1]=b[1]*(c+1)-a[1]*c;e[2]=b[2]*(c+
1)-a[2]*c;e[3]=b[3]*(c+1)-a[3]*c;f.normalize(e,e);return d};a.Fy=function(a,b,c,d,e){e[0]=a[0]+b*c[0];e[1]=a[1]+b*c[1];e[2]=a[2]+b*c[2];e[3]=a[3];c=d[0];var f=d[1];d=d[2];var g=a[4],k=a[5],q=a[6],p=a[7];e[4]=.5*(c*p+f*q-d*k);e[5]=.5*(f*p+d*g-c*q);e[6]=.5*(d*p+c*k-f*g);e[7]=.5*(-c*g-f*k-d*q);e[4]=a[4]+e[4]*b;e[5]=a[5]+e[5]*b;e[6]=a[6]+e[6]*b;e[7]=a[7]+e[7]*b;a=e[4];b=e[5];c=e[6];f=e[7];a=a*a+b*b+c*c+f*f;0<a&&(a=1/Math.sqrt(a),e[4]*=a,e[5]*=a,e[6]*=a,e[7]*=a)}};b4w.module.__util=function(a,p){function b(a,b,c){for(var d=[],e=c.length,f=0;f<e;f++){var g=c[f];g[a]==b&&d.push(g)}return d}function d(a){return 0<a?1:0>a?-1:0}function c(a,b){var d=a instanceof Array?[]:{},e;for(e in a)d[e]=!a[e]||"object"!=typeof a[e]||-1!=b.indexOf(a[e])||a[e]instanceof Float32Array?a[e]:c(a[e],b);return d}function e(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=Math.sqrt(b*b+c*c+d*d),f=1/f;a[0]=b*f;a[1]=c*f;a[2]=d*f;a[3]=e*f}function f(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]}
function g(a,b){var c=b;switch(typeof a){case "number":return k(a,c);case "string":return q(a,c);case "boolean":return k(a|0,c);case "function":case "undefined":return k(0,c);case "object":if(a){var d=a instanceof Array;if(a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength)for(d=0;d<a.length;d++)c=k(a[d],c);else if(d)for(d=0;d<a.length;d++)c=g(a[d],c);else for(var e in a)c=g(a[e],c)}else c=k(0,c)}return c}function k(a,b){var c=b;W[0]=a;c=(c<<5)-c+X[0];c&=c;c=(c<<5)-c+X[1];return c&c}function q(a,
b){for(var c=b,d=0;d<a.length;d++)c=(c<<5)-c+a.charCodeAt(d),c&=c;return c}function h(a){return(34*a+1)*a%289}function m(a){return a-Math.floor(a)}function u(a){return n((34*a+5)*a)}function n(a){return a-289*Math.floor(a/289)}function w(a){return a-7*Math.floor(a/7)}function x(a,b,c){a-=b;c-=b;return b+(a-Math.floor(a/c)*c)}function B(a){return x(a,0,2*Math.PI)}function y(a,b){if(a&&b){var c=a instanceof Array,d=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength,e=b.buffer instanceof ArrayBuffer&&
"undefined"!==b.byteLength;if(c!=b instanceof Array||d!=e)return!1;if(c){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(!r(a[c],b[c]))return!1}else if(d){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!=b[c])return!1}else{for(var f in a)if(!r(a[f],b[f]))return!1;for(f in b)if(!(f in a))return!1}return!0}return!(a||b)}function r(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return y(a,b);default:return!0}}
var A=p("__print"),t=p("vec3"),F=p("vec4"),C=p("quat"),l=p("mat3"),H=p("mat4"),J=0,K={},I=new Float32Array(3),P=new Float32Array(3),z=new Float32Array(4),N=new Float32Array(4),G=new Float32Array(9),L=new Float32Array(16),O=new Float32Array(16),W=new Float64Array(1),X=new Uint32Array(W.buffer),Y=new Float32Array([0,0,0]),R=new Float32Array([0,0,0,1]),ga=new Float32Array([0,0,0,1,0,0,0,1]),ja=new Float32Array([1,0,0]),qa=new Float32Array([0,1,0]),v=new Float32Array([0,0,1]),Z=new Float32Array([-1,0,
0]),la=new Float32Array([0,-1,0]),V=new Float32Array([0,0,-1]),ha=Math.floor(44488.07041494893),ea=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.Ju=Y;a.Du=R;a.EC=ga;a.AXIS_X=ja;a.AXIS_Y=qa;a.AXIS_Z=v;a.AXIS_MX=Z;a.AXIS_MY=
la;a.AXIS_MZ=V;a.wt=ea;a.keyfind=b;a.ux=function(a,b){var c=a.length,d=new Float32Array(c+b.length);d.set(a);d.set(b,c);return d};a.pB=function(a,b){var c=a.length,d=new Uint32Array(c+b.length);d.set(a);d.set(b,c);return d};a.Qv=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};a.ov=function(a,b){var c=[],d={},e=b.length,f,g;for(f=0;f<e;f++)d[b[f]]=!0;e=a.length;for(f=0;f<e;f++)g=a[f],g in d&&c.push(g);return c};a.sign=d;a.hE=function(a,b,c){for(var d=c.length,
e=0;e<d;e++)if(c[e][a]==b)return!0;return!1};a.keysearch=function(a,b,c){for(var d=0;d<c.length;d++){var e=c[d];if(e[a]===b)return e}return null};a.gE=function(a,b,c,d,e){for(var f=0;f<e.length;f++){var g=e[f];if(g[a]==b&&g[c]==d)return g}return null};a.Am=function(a,b,c){for(var d=0;d<a.length;d++)if(a[d][b]==c)return d;return-1};a.hv=function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return;a.push(b)};a.$C=function(a){for(var b=0;b<a.length-1;b++)for(var c=a[b],d=b+1;d<a.length;d++)if(c==a[d])return!1;
return!0};a.tE=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d];e.type==b&&c.push(e)}return c};a.rE=function(a,c){var d=b("name",c,a);1<d.length&&A.error("obj_by_name(): name resolution ambiguity");return d};a.sE=function(a,c){var d=b("name",c,a),e=d.length;1<e&&A.error("obj_by_name(): name resolution ambiguity");if(0>=e)return[];for(var f=[],g=0;g<e;g++){var h=d[g];if("EMPTY"==h.type&&h.dupli_group)for(var h=h.dupli_group.objects,k=0;k<h.length;k++)f.push(h[k])}return d=d.concat(f)};a.lB=
function(a,b,c,d){d||(d=new Float32Array(16));H.identity(d);d[12]=a;d[13]=b;d[14]=c};var pa=1;a.Gz=function(){pa=(69069*pa+5)%Math.pow(2,32);return Math.round(pa/65536)%32768/32767};a.UA=function(a){pa=a};a.Rc=function(a){var b=a[0]%ha*48271-3399*Math.floor(a[0]/ha);a[0]=0<b?b:b+2147483647;return(a[0]-1)/2147483646};a.$j=function(a,b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.euler_to_quat=function(a,b){b||(b=new Float32Array(4));var c=Math.cos(a[1]/2),d=Math.cos(a[2]/2),e=Math.cos(a[0]/2),f=Math.sin(a[1]/
2),g=Math.sin(a[2]/2),h=Math.sin(a[0]/2);b[0]=f*g*e+c*d*h;b[1]=f*d*e+c*g*h;b[2]=c*g*e-f*d*h;b[3]=c*d*e-f*g*h;return b};a.jx=function(a){var b=l.create(),c=Math.cos(a[0]),d=Math.cos(a[1]),e=Math.cos(a[2]),f=Math.sin(a[0]),g=Math.sin(a[1]);a=Math.sin(a[2]);var h=c*e,k=c*a,m=f*e,n=f*a;b[0]=d*e;b[1]=d*a;b[2]=-g;b[3]=g*m-k;b[4]=g*n+h;b[5]=d*f;b[6]=g*h+n;b[7]=g*k-m;b[8]=d*c;return b};a.quat_to_euler=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=e*e,h=c*d+e*f;.499999<h?(b[0]=0,b[1]=2*Math.atan2(c,f),b[2]=
Math.PI/2):-.499999>h?(b[0]=0,b[1]=-2*Math.atan2(c,f),b[2]=-Math.PI/2):(b[0]=Math.atan2(2*c*f-2*d*e,1-2*c*c-2*g),b[1]=Math.atan2(2*d*f-2*c*e,1-2*d*d-2*g),b[2]=Math.asin(2*c*d+2*e*f));return b};a.quat_to_dir=function(a,b,c){c||(c=new Float32Array(3));t.transformQuat(b,a,c);return c};a.mD=function(a,b,c){c||(c=new Float32Array(4));a=t.normalize(a,I);var d=t.dot(b,a);a=t.cross(b,a,P);d=Math.acos(d);c[0]=a[0]*Math.sin(d/2);c[1]=a[1]*Math.sin(d/2);c[2]=a[2]*Math.sin(d/2);c[3]=Math.cos(d/2);return c};a.mB=
function(a,b,c,d){d||(d=new Float32Array(4));t.transformQuat(c,b,d);d[3]=-t.dot(a,d)};a.bx=function(a){var b=a.d.quat;switch(a.type){case "CAMERA":I[0]=0;I[1]=-1;I[2]=0;t.transformQuat(I,b,I);P[0]=0;P[1]=0;P[2]=-1;break;case "MESH":I[0]=0;I[1]=0;I[2]=1;t.transformQuat(I,b,I);P[0]=0;P[1]=0;P[2]=1;break;case "EMPTY":I[0]=0,I[1]=1,I[2]=0,t.transformQuat(I,b,I),P[0]=0,P[1]=1,P[2]=0}I[1]=0;t.normalize(I,I);a=t.dot(I,P);return Math.acos(a)*(0<-I[0]*P[2]?-1:1)};a.ep=function(a,b,c,d){if(0!=c){d=d||[];for(var e=
0;e<a.length;e++)d[e]=(1-c)*a[e]+c*b[e]}};a.ME=function(){J++;return J.toString(16)};a.Qk=function(a){K[a]||(K[a]=0);var b=a+K[a];K[a]++;return b};a.Wc=function(){return{a_position:new Float32Array(0),a_tangent:new Float32Array(0),a_normal:new Float32Array(0)}};a.lb=function(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)};return{name:a,K:0,ea:null,A:[],H:b,V:[]}};a.Df=function(a){return JSON.parse(JSON.stringify(a))};a.bD=function(a,b){var d=[],
e;for(e in b){var f=b[e];if(f)for(var g=0;g<f.length;g++)d.push(f[g])}return c(a,d)};a.qa=function(b){var c=b instanceof Array?[]:{},d;for(d in b)c[d]=b[d]&&"object"==typeof b[d]?b[d]instanceof Float32Array?new Float32Array(b[d]):b[d]instanceof Uint32Array?new Uint32Array(b[d]):b[d]instanceof Uint16Array?new Uint16Array(b[d]):a.qa(b[d]):b[d];return c};a.Fj=function(a){var b=a instanceof Array?[]:{},c;for(c in a)b[c]=a[c]&&"object"==typeof a[c]?a[c]instanceof Float32Array?new Float32Array(a[c]):a[c]instanceof
Uint32Array?new Uint32Array(a[c]):a[c]instanceof Uint16Array?new Uint16Array(a[c]):a[c]instanceof Array?a[c].slice(0):a[c]:a[c];return b};a.is_mesh=function(a){return"MESH"===a.type?!0:!1};a.ck=function(a){return"EMPTY"===a.type?!0:!1};a.is_armature=function(a){return"ARMATURE"===a.type?!0:!1};a.matrix_to_quat=function(a,b){b||(b=new Float32Array(4));l.fromMat4(a,G);var c=G[0],d=G[3],e=G[6],f=G[1],g=G[4],h=G[7],k=G[2],m=G[5],n=G[8],c=Math.sqrt(c*c+d*d+e*e)||1,f=Math.sqrt(f*f+g*g+h*h)||1,k=Math.sqrt(k*
k+m*m+n*n)||1;G[0]/=c;G[3]/=c;G[6]/=c;G[1]/=f;G[4]/=f;G[7]/=f;G[2]/=k;G[5]/=k;G[8]/=k;C.fromMat3(G,b);return b};a.fh=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.fn=function(a){z[0]=.577350269189626;z[1]=.577350269189626;z[2]=.577350269189626;z[3]=0;F.transformMat4(z,a,z);return F.length(z)};a.jm=function(a,b){var c=b.left,d=b.right,f=b.top,g=b.bottom,h=b.Qa,k=b.Pa;c[0]=a[3]+a[0];c[1]=a[7]+a[4];c[2]=a[11]+a[8];c[3]=a[15]+a[12];d[0]=a[3]-a[0];d[1]=a[7]-a[4];
d[2]=a[11]-a[8];d[3]=a[15]-a[12];f[0]=a[3]-a[1];f[1]=a[7]-a[5];f[2]=a[11]-a[9];f[3]=a[15]-a[13];g[0]=a[3]+a[1];g[1]=a[7]+a[5];g[2]=a[11]+a[9];g[3]=a[15]+a[13];h[0]=a[3]+a[2];h[1]=a[7]+a[6];h[2]=a[11]+a[10];h[3]=a[15]+a[14];k[0]=a[3]-a[2];k[1]=a[7]-a[6];k[2]=a[11]-a[10];k[3]=a[15]-a[14];e(c);e(d);e(f);e(g);e(h);e(k)};a.PA=function(a,b,c){return c<-f(a,b.left)||c<-f(a,b.right)||c<-f(a,b.top)||c<-f(a,b.bottom)||c<-f(a,b.Qa)||c<-f(a,b.Pa)?!0:!1};a.hx=function(a,b,c,d,e){g=t.dot(c,b.Pa);h=t.dot(d,b.Pa);
k=t.dot(e,b.Pa);g=Math.sqrt(g*g+h*h+k*k);if(g<-f(a,b.Qa)||g<-f(a,b.Pa))return!0;var g=t.dot(c,b.left),h=t.dot(d,b.left),k=t.dot(e,b.left);if(Math.sqrt(g*g+h*h+k*k)<-f(a,b.left))return!0;g=t.dot(c,b.right);h=t.dot(d,b.right);k=t.dot(e,b.right);if(Math.sqrt(g*g+h*h+k*k)<-f(a,b.right))return!0;g=t.dot(c,b.top);h=t.dot(d,b.top);k=t.dot(e,b.top);if(Math.sqrt(g*g+h*h+k*k)<-f(a,b.top))return!0;g=t.dot(c,b.bottom);h=t.dot(d,b.bottom);k=t.dot(e,b.bottom);return Math.sqrt(g*g+h*h+k*k)<-f(a,b.bottom)?!0:!1};
a.We=function(a,b,c,d){d||(d=0);for(var e=a.length,f=0;f<e;f+=3){var g=a[f],h=a[f+1],k=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*k+b[12];c[d+f+1]=b[1]*g+b[5]*h+b[9]*k+b[13];c[d+f+2]=b[2]*g+b[6]*h+b[10]*k+b[14]}};a.dC=function(a,b,c){for(var d=0,d=0,e=a.length,f=0;f<e;f+=3){var g=a[f],h=a[f+1],k=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*k;c[d+f+1]=b[1]*g+b[5]*h+b[9]*k;c[d+f+2]=b[2]*g+b[6]*h+b[10]*k}};a.iB=function(a,b,c){for(var d=0,d=0,e=a.length,f=0;f<e;f+=4){var g=a[f],h=a[f+1],k=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*
k;c[d+f+1]=b[1]*g+b[5]*h+b[9]*k;c[d+f+2]=b[2]*g+b[6]*h+b[10]*k;c[d+f+3]=a[f+3]}};a.bC=function(a,b,c){c||(c=new Float32Array(3));z[0]=a[0];z[1]=a[1];z[2]=a[2];z[3]=0;F.transformMat4(z,b,z);c[0]=z[0];c[1]=z[1];c[2]=z[2]};a.vD=function(a,b){var c=a.length;if(!c)throw"flatten(): Wrong or empty array";var d=a[0].length;if(!d)throw"flatten(): Wrong or empty subarray";b||(b=new Float32Array(c*d));for(var e=0;e<c;e++)for(var f=0;f<d;f++)b[e*d+f]=a[e][f];return b};a.cC=function(a){for(var b=[],c=0;c<a.length;c+=
3){var d=new Float32Array([a[c],a[c+1],a[c+2]]);b[c/3]=d}return b};a.xj=function(b,c,d,e){if(e<d)return d;var f=d+Math.floor((e-d)/2);return b[f]>c?a.xj(b,c,d,f-1):b[f]<c?a.xj(b,c,f+1,e):f};a.De=function(a,b){for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0};a.cD=function(a,b,c){for(var d=0;d<a.length;d++)if(Math.abs(a[d]-b[d])>c)return!1;return!0};a.Zz=function(a,b,c){c||(c=new Float32Array(16));for(var d=0;12>d;d++)c[d]=a[d]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15]};a.eo=function(a,
b,c,d){d||(d=new Float32Array(16));b=H.fromRotationTranslation(b,c,L);H.multiply(b,a,d)};a.transform_vec3=function(a,b,c,d,e){e||(e=new Float32Array(3));c=H.fromRotationTranslation(c,d,L);1!==b&&(d=H.identity(O),b=t.set(b,b,b,I),H.scale(d,b,d),H.multiply(c,d,c));t.transformMat4(a,c,e);return e};a.fo=function(a,b,c,d){d||(d=new Float32Array(4));b=H.fromRotationTranslation(b,c,L);F.transformMat4(a,b,d)};a.ZD=function(a,b,c,d,e){e||(e=new Float32Array(3));b=H.fromRotationTranslation(c,d,L);H.invert(b,
b);t.transformMat4(a,b,e);return e};a.KE=function(a,b,c){c||(c=new Float32Array(16));H.fromRotationTranslation(b,a,c);a=a[3];for(b=0;12>b;b++)c[b]*=a;return c};a.qE=function(b,c,d){a.fh(b,c);c[3]=a.fn(b);a.matrix_to_quat(b,d)};a.KC=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return JSON.stringify(b)};a.Vz=function(a,b,c,d){d||(d=new Float32Array(3));t.subtract(b,a,I);t.transformQuat(I,c,I);t.subtract(b,I,d)};a.Gx=function(){I[0]=0;I[1]=0;I[2]=0;var a=new Float32Array(16),b=new Float32Array(16),
c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16);H.lookAt(I,[-1,0,0],[0,-1,0],a);H.scale(a,[-1,1,1],a);H.scale(a,[-1,1,-1],b);H.lookAt(I,[0,-1,0],[0,0,-1],c);H.scale(c,[1,1,-1],c);H.scale(c,[1,-1,-1],d);H.lookAt(I,[0,0,-1],[0,-1,0],e);H.scale(e,[-1,1,1],e);H.scale(e,[-1,1,-1],f);return[a,b,c,d,e,f]};a.Kx=function(){I[0]=0;I[1]=0;I[2]=0;var a=new Float32Array(16),b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=
new Float32Array(16);H.lookAt(I,[1,0,0],[0,-1,0],a);H.scale(a,[-1,1,-1],b);H.lookAt(I,[0,1,0],[0,0,1],c);H.scale(c,[1,-1,-1],d);H.lookAt(I,[0,0,1],[0,-1,0],e);H.scale(e,[-1,1,-1],f);return[a,b,c,d,e,f]};a.Jg=function(a,b){return g(a,b)};a.hash_code=g;a.SD=q;a.pE=function(a,b,c){var d=b[0],e=b[1];b=b[2];var f,g,h,k,l,m,n,q,u,p,t,w;if(!c||a===c)return a[12]=a[0]*d+a[4]*e+a[8]*b+a[12],a[13]=a[1]*d+a[5]*e+a[9]*b+a[13],a[14]=a[2]*d+a[6]*e+a[10]*b+a[14],a[15]=a[3]*d+a[7]*e+a[11]*b+a[15],a;f=a[0];g=a[1];
h=a[2];k=a[3];l=a[4];m=a[5];n=a[6];q=a[7];u=a[8];p=a[9];t=a[10];w=a[11];c[0]=f;c[1]=g;c[2]=h;c[3]=k;c[4]=l;c[5]=m;c[6]=n;c[7]=q;c[8]=u;c[9]=p;c[10]=t;c[11]=w;c[12]=f*d+l*e+u*b+a[12];c[13]=g*d+m*e+p*b+a[13];c[14]=h*d+n*e+t*b+a[14];c[15]=k*d+q*e+w*b+a[15];return c};a.bz=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.quat_to_angle_axis=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*
a[1]+a[2]*a[2];0<c?(b[3]=2*Math.acos(a[3]),c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.Bk=function(a){return a*Math.PI/180};a.Xw=function(a){return 180*a/Math.PI};a.Mn=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],c=Math.floor(a[0]+b),d=Math.floor(a[1]+b),e=.211324865405187*c+.211324865405187*d,b=a[0]-c+e;a=a[1]-d+e;var f=b>a?1:0,g=1-f,e=b+.211324865405187-f,k=a+
.211324865405187-g,l=b+-.577350269189626,n=a+-.577350269189626,c=c%289,d=d%289,q=h(h(d)+c),g=h(h(d+g)+c+f),u=h(h(d+1)+c+1),c=Math.max(.5-(b*b+a*a),0),d=Math.max(.5-(e*e+k*k),0),f=Math.max(.5-(l*l+n*n),0),p=2*m(.024390243902439*q)-1,t=2*m(.024390243902439*g)-1,w=2*m(.024390243902439*u)-1,q=Math.abs(p)-.5,g=Math.abs(t)-.5,u=Math.abs(w)-.5,p=p-Math.floor(p+.5),t=t-Math.floor(t+.5),w=w-Math.floor(w+.5),c=c*c*c*c*(1.79284291400159-.85373472095314*(p*p+q*q)),d=d*d*d*d*(1.79284291400159-.85373472095314*
(t*t+g*g)),f=f*f*f*f*(1.79284291400159-.85373472095314*(w*w+u*u));return 130*(c*(p*b+q*a)+d*(t*e+g*k)+f*(w*l+u*n))};a.rp=function(a){var b=1/7,c=b/2,d=n(Math.floor(a[0])),e=n(Math.floor(a[1])),f=m(a[0]);a=m(a[1]);var g=f-.5,h=f-1.5,f=a-.5;a-=1.5;var k=u(d),l=u(d+1),q=k,d=l,k=u(k+e),l=u(l+e),q=u(q+e+1),d=u(d+e+1),e=g+.7*(w(k)*b+c),p=h+.7*(w(l)*b+c),g=g+.7*(w(q)*b+c),h=h+.7*(w(d)*b+c),k=f+.7*(w(Math.floor(k*b))*b+c),f=f+.7*(w(Math.floor(l*b))*b+c),q=a+.7*(w(Math.floor(q*b))*b+c),b=a+.7*(w(Math.floor(d*
b))*b+c);return Math.min(e*e+k*k,p*p+f*f,g*g+q*q,h*h+b*b)};a.quat_project=function(a,b,c,d,e){e||(e=new Float32Array(4));a=t.transformQuat(b,a,I);b=c[0];var f=c[1];c=c[2];G[0]=f*f+c*c;G[1]=-f*b;G[2]=-c*b;G[3]=-b*f;G[4]=b*b+c*c;G[5]=-c*f;G[6]=-b*c;G[7]=-f*c;G[8]=b*b+f*f;t.transformMat3(a,G,a);t.normalize(a,a);C.rotationTo(d,a,e);return e};a.cam_quat_to_mesh_quat=function(a,b){b||(b=new Float32Array(4));var c=z,d=N,c=C.setAxisAngle([0,1,0],Math.PI,C.create()),d=C.setAxisAngle([1,0,0],Math.PI/2,C.create());
C.multiply(c,d,c);C.multiply(a,c,b);return b};a.cleanup=function(){J=0;K={}};a.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)};a.smooth=function(a,b,c,d){c=Math.exp(-c/d);return(1-c)*a+c*b};a.smooth_v=function(a,b,c,d,e){e||(e=new Float32Array(a.length));c=Math.exp(-c/d);for(d=0;d<e.length;d++)e[d]=(1-c)*a[d]+c*b[d];return e};a.As=function(a,b,c,d,e){e||(e=new Float32Array(a.length));C.slerp(a,b,Math.exp(-c/d),e)};a.$D=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?
!0:!1};a.is_vector=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};a.correct_cam_quat_up=function(a,b){var c=l.fromQuat(a,G);P[0]=0;P[1]=1;P[2]=0;I[0]=c[3];I[1]=c[4];I[2]=c[5];var d=t.cross(P,I,I);t.normalize(d,d);var e=c[7];!b&&0<e&&(d[0]*=-1,d[1]*=-1,d[2]*=-1);P[0]=c[0];P[1]=c[1];P[2]=c[2];t.normalize(P,P);C.rotationTo(P,d,N);C.multiply(N,a,a)};a.nq=function(a,b,c,d){c=c*b-.5;var e=d*b-.5;d=c-Math.floor(c);var f=e-Math.floor(e);
c=Math.floor(c);var e=Math.floor(e),g=b-1,h=a[e*b+c],k=a[e*b+Math.min(c+1,g)],l=a[Math.min(e+1,g)*b+c];a=a[Math.min(e+1,g)*b+Math.min(c+1,g)];return(h*(1-d)+k*d)*(1-f)+(l*(1-d)+a*d)*f};a.pg=function(a){for(var b=0,c=0;3>c;c++)0<(a&1<<c)&&b++;return b};a.hs=function(a){for(var b=[0,0,0],c=0;3>c;c++)0<(a&1<<c)&&(b[2-c]=1);return b};a.Si=function(a,b){var c=0;(1==b||2==b)&&0<(a&4)&&c++;2==b&&0<(a&2)&&c++;return c};a.vm=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=
16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.qd=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b};a.random_from_array=function(a){if(!a.length)return null;var b=Math.floor(Math.random()*a.length);return a[b]};a.xz_direction=function(a,b,c){c||(c=new Float32Array(3));c[0]=a[0]-b[0];c[1]=0;c[2]=a[2]-b[2];t.normalize(c,c)};a.nB=function(a,b,c){var d=a[0],e=a[1];a=a[2];var f=b[0],g=b[1],h=b[2];b=b[3];var k=g*a-h*e,l=h*d-f*a,m=f*e-g*d,n=g*m-h*l,h=h*k-f*m,f=f*l-g*k;c[0]=
d+2*k*b+2*n;c[1]=e+2*l*b+2*h;c[2]=a+2*m*b+2*f};a.assert=function(a){if(!a)throw Error("Assertion failed");};a.pa=function(a){a&&A.error.apply(A,arguments);throw"panic: see above for possible error messages";};a.angle_wrap_periodic=x;a.angle_wrap_0_2pi=B;a.ym=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.Ns=function(a,b){for(var c in a){var d=!0,e=a[c],f=b[c];switch(typeof e){case "number":case "string":case "boolean":d=e==f;break;case "object":d=y(e,f)}if(!d)return!1}return!0};a.xn=function(a,
b){var c=a[0],d=a[2],e=a[3];b[0]=a[1];b[1]=d;b[2]=e;b[3]=c};a.iq=function(a){a+=1;132651<a&&A.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;var c=Math.floor(a/51);return new Float32Array([b/51,c/51,a%51/51])};a.line_plane_intersect=function(a,b,c,d,e){z.set(a);z[3]=b;N.set(d);N[3]=0;a=F.dot(z,N);if(0==a)return null;N.set(c);N[3]=1;a=-F.dot(z,N)/a;e[0]=c[0]+a*d[0];e[1]=c[1]+a*d[1];e[2]=c[2]+a*d[2];return e};a.eD=function(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b};a.Xz=function(a,
b,c){var d=t.dot(a,b);-.9999999>d?(t.cross(ja,a,I),1E-6>t.length(I)&&t.cross(qa,a,I),t.normalize(I,I),C.setAxisAngle(I,Math.PI,c)):(t.cross(a,b,I),c.set(I),c[3]=1+d,C.normalize(c,c));return c};a.Ce=function(a,b,c){if(b==c)return c-a;a=B(a);b=B(b);c=B(c);var d=Math.abs(b-c);if(.001>d||.001>Math.abs(d-2*Math.PI))return 0;b=2*Math.PI-b;c=B(c+b);a=B(a+b);return a>c?(c-=a,a=2*Math.PI-a,-c>a?a:c):0};a.smooth_step=function(a){return a*a*(3-2*a)};a.pv=function(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<
b.length;d++)if(b[d]==a[c])return!0;return!1};a.hD=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=0;return b};a.kt=function(a,b){for(var c=Math.max(a.length,b.length),e=0;e<c;e++){var f=d((e>=a.length?0:a[e])-(e>=b.length?0:b[e]));if(f)return f}return 0};a.Wk=function(a){return a.join(".")};a.XA=function(a){return a.split(".").map(function(a){return a|0})};a.Hs=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2)};a.$m=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=
Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b}};b4w.module.__sfx=function(a,p){function b(){var a=window.AudioContext||window.webkitAudioContext;if(a){a=new a;if(a.createGain)return a;B.warn("deprecated WebAudio implementation");return null}B.warn("WebAudio is not supported");return null}function d(a,b,d){var e=a.j;if("NONE"!=e.behavior){d||(d=0);var h=e.loop,l=e.pitch;if(e.src&&(h||0<=d)){e.pl=Math.floor(5E4*Math.random());var m=K.currentTime+b;e.Bc=m;e.state=20;c(a);"POSITIONAL"==e.behavior||"BACKGROUND_SOUND"==e.behavior?(b=K.createBufferSource(),
b.buffer=e.src,b.playbackRate.value=l,h?(e.qb&&e.qb.disconnect(),b.loop=!0,b.start(m),e.duration=0):(h=b.buffer?b.buffer.duration:0,d>h?(h=m+d+e.ae,b.loop=!0,b.start(m),b.stop(h),e.duration=d):(b.loop=!1,b.start(m),e.duration=h)),b.connect(e.dc),e.qb=b,f(e),g(e)):"BACKGROUND_MUSIC"==e.behavior&&(y.clear_timeout(e.tl),y.clear_timeout(e.ul),d=function(){var b=a.j,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.qb=b.qb||K.createMediaElementSource(c),b.qb.connect(b.dc),20==b.state&&(c.currentTime&&(c.currentTime=
0),c.play()))},0==b?d():e.tl=y.set_timeout(d,1E3*b),e.duration=h?0:w(a));k(e,m)}}}function c(a){var b=a.j;if(!b.dc){var c=a.d.h;a=a.d.quat;if(t.jk){var d=K.createBiquadFilter();d.type="peaking"}else d=null;var e=K.createGain();switch(b.behavior){case "POSITIONAL":var f=K.createPanner();"string"!=typeof f.panningModel?(f.panningModel=f.EQUALPOWER,f.distanceModel=f.INVERSE_DISTANCE):(f.panningModel="equalpower",f.distanceModel="inverse");f.setPosition(c[0],c[1],c[2]);b.Xm.set(c);c=F;r.quat_to_dir(a,
r.AXIS_MY,c);f.setOrientation(c[0],c[1],c[2]);b.direction.set(c);f.refDistance=b.dist_ref;f.maxDistance=b.dist_max;f.rolloffFactor=b.attenuation;f.coneInnerAngle=b.ew;f.coneOuterAngle=b.fw;f.coneOuterGain=b.gw;var g=K.createGain();g.gain.value=n(b);d?(f.connect(d),d.connect(g)):f.connect(g);g.connect(e);b.dc=f;if(b.Mh){var h=K.createGain();e.connect(h);h.connect(K?I.j.dc:null)}else h=null,e.connect(K?I.j.dc:null);break;case "BACKGROUND_SOUND":f=null;g=K.createGain();g.gain.value=n(b);d?(b.dc=d,d.connect(g)):
b.dc=g;g.connect(e);b.Mh?(h=K.createGain(),e.connect(h),h.connect(K?I.j.dc:null)):(h=null,e.connect(K?I.j.dc:null));break;case "BACKGROUND_MUSIC":h=f=null,g=K.createGain(),g.gain.value=n(b),d?(b.dc=d,d.connect(g)):b.dc=g,g.connect(e),e.connect(K?I.j.dc:null)}b.Gi=f;b.pd=d;b.Vg=g;b.If=e;b.Zr=h}}function e(a){var b=a.j,c=b.duration,b=b.delay+b.Yw*Math.random();d(a,b,c)}function f(a){a.Mh&&a.Zr.gain.cancelScheduledValues(a.Bc);a.Ji&&a.qb.playbackRate.cancelScheduledValues(a.Bc);a.cj=a.Bc}function g(a){if(a.Mh||
a.Ji){var b=a.Zr,c=a.qb,d=c.buffer?c.buffer.duration:0;if(d){var e=a.Bc;z[0]=a.pl;for(var f=0;5>f;){var g=a.pitch+a.Ji*r.Rc(z);if(e>=a.cj){if(a.Mh){var h=1-r.clamp(a.Mh,0,1)*Math.random();b.gain.setValueAtTime(h,e)}a.Ji&&c.playbackRate.setValueAtTime(g,e);f++}e+=d/g}a.cj=e-.001}}}function k(a,b){if(a.km||a.ae){var c=a.If;c.gain.cancelScheduledValues(b);a.km?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,b+a.km)):c.gain.setValueAtTime(1,b);a.ae&&!a.loop&&(c.gain.setValueAtTime(1,b+a.duration),
c.gain.linearRampToValueAtTime(0,b+a.duration+a.ae))}}function q(a){if("SPEAKER"!=a.type)throw"Wrong object type";var b=a.j;if(20==b.state||40==b.state){var c=b.If,d=K.currentTime;b.ae&&(c.gain.setValueAtTime(c.gain.value,d),c.gain.linearRampToValueAtTime(0,d+b.ae));"BACKGROUND_MUSIC"==b.behavior?b.src&&(y.clear_timeout(b.tl),y.clear_timeout(b.ul),b.ul=y.set_timeout(function(){var b=a.j.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},1E3*b.ae)):(c=b.qb,b.duration<c.buffer.duration?b.ae&&20==
b.state?c.stop(d+b.ae):20==b.state&&(c.stop(0),c.disconnect()):c.disconnect(),b.Bc=0,b.sn=0,b.Al=0);b.state=30}}function h(a){a=a.j;if(20==a.state){var b=K.currentTime;a.sn=b;if("BACKGROUND_MUSIC"==a.behavior){var c=a.src;c&&c.pause()}else{if(b>a.Bc){z[0]=a.pl;for(var d=a.qb.buffer.duration,e=a.Bc;e<b;)c=a.pitch+a.Ji*r.Rc(z),e+=d/c;c*=d/c-(e-b)}else c=0;a.Al=c;a.qb.stop(0);a.qb.disconnect();f(a)}a.state=40}}function m(a){var b=a.j;if(40==b.state){var c=K.currentTime;b.Bc+=c-b.sn;if("BACKGROUND_MUSIC"==
b.behavior)b.src.play();else{a=a.j;var d=K.createBufferSource();d.loop=a.qb.loop;d.buffer=a.qb.buffer;d.playbackRate.value=a.qb.playbackRate.value;a.Gi?d.connect(a.Gi):d.connect(a.Vg);a.qb=d;b.cj=c;b.qb.start(b.Bc,b.Al);g(b)}k(b,b.Bc);b.state=20}}function u(a){return!a.j||20!=a.j.state&&40!=a.j.state&&30!=a.j.state?!1:!0}function n(a){return a.muted?0:a.volume}function w(a){a=a.j;return(a=a.src)?a.duration:0}var x=p("__config"),B=p("__print"),y=p("__time"),r=p("__util"),A=p("vec3"),t=x.cd;a.xo=10;
a.Zk=20;a.wo=30;var F=new Float32Array(3),C=new Float32Array(3),l=new Float32Array(3),H=[],J=[],K=null,I=null,P=[],z=[1],N=null;a.init=function(){var a=document.createElement("audio"),c=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(H.push("ogg"),H.push("ogv")),""!=a.canPlayType("audio/mpeg")&&H.push("mp3"),""!=a.canPlayType("audio/mp4")&&(H.push("mp4"),H.push("m4v")),""!=a.canPlayType("audio/webm")&&H.push("webm"));c.canPlayType&&(""!=c.canPlayType("video/ogg")&&
J.push("ogv"),""!=c.canPlayType("video/mp4")&&J.push("m4v"),""!=c.canPlayType("video/webm")&&J.push("webm"));(K=t.to?b():null)&&B.log("%cINIT WEBAUDIO: "+K.sampleRate+"Hz","color: #00a")};a.Wo=function(a){var b={Yf:new Float32Array(3),ir:new Float32Array(3),eh:new Float32Array(3)};a.j=b;if(K){var c=K.createGain(),d=K.createGain();b.Vg=c;b.If=d;c.connect(d);d.connect(K.destination);if(a.b4w_enable_dynamic_compressor){var d=K.createDynamicsCompressor(),e=a.b4w_dynamic_compressor_settings;d.threshold.value=
e.threshold;d.knee.value=e.knee;d.ratio.value=e.ratio;d.attack.value=e.attack;d.release.value=e.release;d.connect(c);b.bi=d;b.dc=d}else b.bi=null,b.dc=c;c=K.listener;b.Og=x.o.Hl;b.Og||(c.dopplerFactor=a.audio_doppler_factor,c.speedOfSound=a.audio_doppler_speed);b.muted=!1;b.volume=1;b.Hf=0}};a.gA=function(a){I=a};a.detect_audio_container=function(a){a||(a="ogg");return-1<H.indexOf(a)?a:"ogg"==a&&-1<H.indexOf("mp4")?"mp4":"mp3"==a&&-1<H.indexOf("ogg")?"ogg":"mp4"==a&&-1<H.indexOf("ogg")?"ogg":"ogv"==
a&&-1<H.indexOf("m4v")?"m4v":"webm"==a&&-1<H.indexOf("m4v")?"m4v":"m4v"==a&&-1<H.indexOf("webm")?"webm":""};a.detect_video_container=function(a){a||(a="webm");return-1<J.indexOf(a)?a:"ogv"==a&&-1<J.indexOf("m4v")?"m4v":"webm"==a&&-1<J.indexOf("m4v")?"m4v":"m4v"==a&&-1<J.indexOf("webm")?"webm":""};a.append_object=function(a){if("SPEAKER"!=a.type)throw"Wrong speaker object";var b=a.data;a.j={};switch(b.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":a.j.behavior=K?b.b4w_behavior:"NONE";break;
case "BACKGROUND_MUSIC":var c=a.j,d;K?(window.MediaElementAudioSourceNode?d=!0:(B.warn("MediaElementAudioSourceNode not found"),d=!1),d=d?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):d="NONE";c.behavior=d;break;default:throw"Wrong speaker behavior";}b.sound||(a.j.behavior="NONE");a.j.Og=b.b4w_disable_doppler&&x.o.Hl;a.j.muted=b.muted;a.j.volume=b.volume;a.j.pitch=b.pitch;a.j.attenuation=b.attenuation;a.j.dist_ref=b.distance_reference;a.j.dist_max=b.distance_max||1E4;a.j.ew=b.cone_angle_inner;a.j.fw=b.cone_angle_outer;
a.j.gw=b.cone_volume_outer;a.j.cyclic=b.b4w_cyclic_play;a.j.loop=b.b4w_loop;a.j.delay=b.b4w_delay;a.j.Yw=b.b4w_delay_random;a.j.Mh=b.b4w_volume_random;a.j.Ji=b.b4w_pitch_random;a.j.km=b.b4w_fade_in;a.j.ae=b.b4w_fade_out;a.j.Bc=0;a.j.sn=0;a.j.Al=0;a.j.duration=0;a.j.cj=0;a.j.pl=1;a.j.src=null;a.j.state=10;a.j.Xm=new Float32Array(3);a.j.direction=new Float32Array(3);a.j.On=new Float32Array(3);a.j.tl=-1;a.j.ul=-1;a.j.Hf=0;P.push(a)};a.Cs=function(b){if("SPEAKER"!=b.type)throw"Wrong object type";switch(b.j.behavior){case "POSITIONAL":return a.Zk;
case "BACKGROUND_SOUND":return a.Zk;case "BACKGROUND_MUSIC":return a.wo;case "NONE":return a.xo;default:throw"Wrong speaker behavior";}};a.KB=function(a,b){var c=a.j;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;case "NONE":break;default:throw"Wrong speaker behavior";}};a.xz=function(){var a=K.createBufferSource();a.buffer=K.createBuffer(1,22050,22050);a.connect(K.destination);a.start(0)};a.Uw=function(a,b,c){K?K.decodeAudioData(a,b,c):c()};a.LA=
function(a){q(a);delete a.j;P.splice(P.indexOf(a),1)};a.cleanup=function(){for(var a=0;a<P.length;a++){var b=P[a].j;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():b.qb&&b.qb.disconnect()}I&&I.j&&(a=I.j,a.Yf[0]=0,a.Yf[1]=0,a.Yf[2]=0,a.eh[0]=0,a.eh[1]=0,a.eh[2]=0);I=null;P.splice(0);N=null};a.update=function(a){if(K&&0!=P.length){for(var b=0;b<P.length;b++){var c=P[b],d=c.j,f=K.currentTime;K&&!d.loop&&d.cyclic&&20==d.state&&d.duration&&d.Bc+d.duration<f&&e(c);20==d.state&&3>d.cj-f&&g(d)}N&&N.oe.length&&
(-1==N.Ma||a>N.Oo+N.Sp[N.Ma])&&(b=N,-1<b.Ma&&q(b.oe[b.Ma]),-1==b.Ma&&b.random?c=Math.round(Math.random()*(b.oe.length-1)):b.random?(c=1+Math.round(Math.random()*(b.oe.length-2)),c=(b.Ma+c)%b.oe.length):c=(b.Ma+1)%b.oe.length,e(b.oe[c]),b.Ma=c,b.Oo=a)}};a.play=d;a.play_def=e;a.stop=q;a.is_play=function(a){return 20==a.j.state};a.KA=h;a.MA=m;a.playrate=function(a,b){var c=a.j;c.pitch=b;!u(a)||"POSITIONAL"!=c.behavior&&"BACKGROUND_SOUND"!=c.behavior||(c.qb.playbackRate.value=b,f(c),g(c))};a.get_playrate=
function(a){return a.j.pitch};a.cyclic=function(a,b){a.j.cyclic=Boolean(b)};a.is_cyclic=function(a){return a.j.cyclic};a.Wy=function(a,b,c,d){if(K&&a.j){var e=F;e[0]=0;e[1]=-1;e[2]=0;A.transformQuat(e,c,e);C[0]=0;C[1]=0;C[2]=-1;A.transformQuat(C,c,C);c=K.listener;c.setPosition(b[0],b[1],b[2]);c.setOrientation(e[0],e[1],e[2],C[0],C[1],C[2]);a.j.ir.set(e);!a.j.Og&&d&&(l[0]=(b[0]-a.j.Yf[0])/d,l[1]=(b[1]-a.j.Yf[1])/d,l[2]=(b[2]-a.j.Yf[2])/d,r.smooth_v(l,a.j.eh,d,.3,l),c.setVelocity(l[0],l[1],l[2]),a.j.eh.set(l));
a.j.Yf.set(b)}};a.listener_reset_speed=function(a,b){if(K&&I.j&&!I.j.Og){var c=F;b?c.set(b):c.set(I.j.ir);A.scale(c,a,c);K.listener.setVelocity(c[0],c[1],c[2]);I.j.eh.set(c)}};a.NA=function(a,b){var c=a.j;if(u(a)&&"POSITIONAL"==c.behavior){var d=a.d.h,e=c.Gi;e.setPosition(d[0],d[1],d[2]);var f=F;r.quat_to_dir(a.d.quat,r.AXIS_MY,f);e.setOrientation(f[0],f[1],f[2]);f=c.Xm;!c.Og&&b&&(C[0]=(d[0]-f[0])/b,C[1]=(d[1]-f[1])/b,C[2]=(d[2]-f[2])/b,r.smooth_v(C,c.On,b,.3,C),e.setVelocity(C[0],C[1],C[2]),c.On.set(C));
f.set(d)}};a.speaker_reset_speed=function(a,b,c){var d=a.j;if(u(a)&&"POSITIONAL"==d.behavior&&!d.Og){var e=F;c?e.set(c):e.set(d.direction);A.scale(e,b,e);d.Gi.setVelocity(e[0],e[1],e[2]);d.On.set(e);d.Xm.set(a.d.h)}};a.fe=function(a){return a.j?!0:!1};a.Bm=function(a){return a.j.behavior};a.check_active_speakers=function(){for(var a=0;a<P.length;a++)if(u(P[a]))return!0;return!1};a.pA=function(a){var b=I.j;b&&(b.volume=a,K&&(b.Vg.gain.value=n(b)))};a.fy=function(){var a=I.j;return a?a.volume:0};a.set_volume=
function(a,b){var c=a.j;c.volume=b;u(a)&&(c.Vg.gain.value=n(c))};a.get_volume=function(a){return a.j.volume};a.mute=function(a,b){a.j.muted=Boolean(b);u(a)&&(a.j.Vg.gain.value=n(a.j))};a.is_muted=function(a){return a.j.muted};a.jz=function(a){var b=I.j;b&&(b.muted=Boolean(a),K&&(b.Vg.gain.value=n(b)))};a.Oy=function(){var a=I.j;return a?a.muted:!1};a.get_speaker_objects=function(){return P};a.pause=function(){for(var a=0;a<P.length;a++)h(P[a])};a.resume=function(){for(var a=0;a<P.length;a++)m(P[a])};
a.set_compressor_params=function(a,b){if(a.j&&a.j.bi){var c=a.j.bi;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=b.attack;c.release.value=b.release}};a.get_compressor_params=function(a){if(!a.j||!a.j.bi)return null;a=a.j.bi;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.duck=function(a,b,c){if(u(a)){a=a.j;var d=a.If,e=K.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(b,
e+c);a.Hf=c}};a.unduck=function(a){if(u(a)){a=a.j;var b=a.If,c=K.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Hf);a.Hf=0}};a.dx=function(a,b){if(K){var c=I.j,d=c.If,e=K.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(a,e+b);c.Hf=b}};a.qB=function(){if(K){var a=I.j,b=a.If,c=K.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Hf);a.Hf=0}};a.apply_playlist=function(a,b,c){N={Ma:-1,Oo:0,random:c,
oe:[],Sp:[]};for(c=0;c<a.length;c++){var d=a[c],e=w(d);0==e?B.warn("Ignoring speaker with zero duration: "+d.name):(q(d),d.j.cyclic=!1,N.oe.push(d),N.Sp.push(e+b))}};a.get_duration=w;a.clear_playlist=function(){if(N)for(var a=N.oe,b=0;b<a.length;b++)q(a[b]);N=null};a.get_positional_params=function(a){return(a=a.j)&&"POSITIONAL"==a.behavior?{dist_ref:a.dist_ref,dist_max:a.dist_max,attenuation:a.attenuation}:null};a.set_positional_params=function(a,b){var c=a.j;if(c&&"POSITIONAL"==c.behavior){c.dist_ref=
b.dist_ref;c.dist_max=b.dist_max;c.attenuation=b.attenuation;var d=c.Gi;d&&(d.refDistance=c.dist_ref,d.maxDistance=c.dist_max,d.rolloffFactor=c.attenuation)}};a.set_filter_params=function(a,b){var c=a.j;c&&c.pd&&(c.pd.frequency.value=b.freq,c.pd.Q.value=b.Q,c.pd.gain.value=b.gain)};a.get_filter_params=function(a){return(a=a.j)&&a.pd?{freq:a.pd.frequency.value,Q:a.pd.Q.value,gain:a.pd.gain.value}:null};a.get_filter_freq_response=function(a,b,c,d){a=a.j;if(!a||!a.pd)return null;a.pd.getFrequencyResponse(b,
c,d)}};b4w.module.vec3=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array,b=Math.random;a.create=function(){var a=new p(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new p(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,e){var f=new p(3);f[0]=a;f[1]=b;f[2]=e;return f};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,e,f){f[0]=a;f[1]=b;f[2]=e;return f};a.add=function(a,b,e){e[0]=a[0]+b[0];e[1]=a[1]+b[1];e[2]=a[2]+b[2];return e};
a.subtract=function(a,b,e){e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=a[2]-b[2];return e};a.sub=a.subtract;a.multiply=function(a,b,e){e[0]=a[0]*b[0];e[1]=a[1]*b[1];e[2]=a[2]*b[2];return e};a.mul=a.multiply;a.divide=function(a,b,e){e[0]=a[0]/b[0];e[1]=a[1]/b[1];e[2]=a[2]/b[2];return e};a.div=a.divide;a.min=function(a,b,e){e[0]=Math.min(a[0],b[0]);e[1]=Math.min(a[1],b[1]);e[2]=Math.min(a[2],b[2]);return e};a.max=function(a,b,e){e[0]=Math.max(a[0],b[0]);e[1]=Math.max(a[1],b[1]);e[2]=Math.max(a[2],b[2]);return e};
a.scale=function(a,b,e){e[0]=a[0]*b;e[1]=a[1]*b;e[2]=a[2]*b;return e};a.scaleAndAdd=function(a,b,e,f){f[0]=a[0]+b[0]*e;f[1]=a[1]+b[1]*e;f[2]=a[2]+b[2]*e;return f};a.distance=function(a,b){var e=b[0]-a[0],f=b[1]-a[1],g=b[2]-a[2];return Math.sqrt(e*e+f*f+g*g)};a.dist=a.distance;a.squaredDistance=function(a,b){var e=b[0]-a[0],f=b[1]-a[1],g=b[2]-a[2];return e*e+f*f+g*g};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],e=a[1];a=a[2];return Math.sqrt(b*b+e*e+a*a)};a.len=a.length;a.squaredLength=
function(a){var b=a[0],e=a[1];a=a[2];return b*b+e*e+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var e=a[0],f=a[1],g=a[2],e=e*e+f*f+g*g;0<e&&(e=1/Math.sqrt(e),b[0]=a[0]*e,b[1]=a[1]*e,b[2]=a[2]*e);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,e){var f=a[0],g=a[1];a=a[2];var k=b[0],q=b[1];b=b[2];e[0]=g*b-a*q;e[1]=
a*k-f*b;e[2]=f*q-g*k;return e};a.lerp=function(a,b,e,f){var g=a[0],k=a[1];a=a[2];f[0]=g+e*(b[0]-g);f[1]=k+e*(b[1]-k);f[2]=a+e*(b[2]-a);return f};a.random=function(a,c){a=a||1;var e=2*b()*Math.PI,f=2*b()-1,g=Math.sqrt(1-f*f)*a;c[0]=Math.cos(e)*g;c[1]=Math.sin(e)*g;c[2]=f*a;return c};a.transformMat4=function(a,b,e){var f=a[0],g=a[1];a=a[2];var k=b[3]*f+b[7]*g+b[11]*a+b[15],k=k||1;e[0]=(b[0]*f+b[4]*g+b[8]*a+b[12])/k;e[1]=(b[1]*f+b[5]*g+b[9]*a+b[13])/k;e[2]=(b[2]*f+b[6]*g+b[10]*a+b[14])/k;return e};a.transformMat3=
function(a,b,e){var f=a[0],g=a[1];a=a[2];e[0]=f*b[0]+g*b[3]+a*b[6];e[1]=f*b[1]+g*b[4]+a*b[7];e[2]=f*b[2]+g*b[5]+a*b[8];return e};a.transformQuat=function(a,b,e){var f=a[0],g=a[1],k=a[2];a=b[0];var q=b[1],h=b[2];b=b[3];var m=b*f+q*k-h*g,u=b*g+h*f-a*k,n=b*k+a*g-q*f,f=-a*f-q*g-h*k;e[0]=m*b+f*-a+u*-h-n*-q;e[1]=u*b+f*-q+n*-a-m*-h;e[2]=n*b+f*-h+m*-q-u*-a;return e};a.rotateX=function(a,b,e,f){var g=[],k=[];g[0]=a[0]-b[0];g[1]=a[1]-b[1];g[2]=a[2]-b[2];k[0]=g[0];k[1]=g[1]*Math.cos(e)-g[2]*Math.sin(e);k[2]=
g[1]*Math.sin(e)+g[2]*Math.cos(e);f[0]=k[0]+b[0];f[1]=k[1]+b[1];f[2]=k[2]+b[2];return f};a.rotateY=function(a,b,e,f){var g=[],k=[];g[0]=a[0]-b[0];g[1]=a[1]-b[1];g[2]=a[2]-b[2];k[0]=g[2]*Math.sin(e)+g[0]*Math.cos(e);k[1]=g[1];k[2]=g[2]*Math.cos(e)-g[0]*Math.sin(e);f[0]=k[0]+b[0];f[1]=k[1]+b[1];f[2]=k[2]+b[2];return f};a.rotateZ=function(a,b,e,f){var g=[],k=[];g[0]=a[0]-b[0];g[1]=a[1]-b[1];g[2]=a[2]-b[2];k[0]=g[0]*Math.cos(e)-g[1]*Math.sin(e);k[1]=g[0]*Math.sin(e)+g[1]*Math.cos(e);k[2]=g[2];f[0]=k[0]+
b[0];f[1]=k[1]+b[1];f[2]=k[2]+b[2];return f};a.forEach=function(){var b=a.create();return function(a,e,f,g,k,q){e||(e=3);f||(f=0);for(g=g?Math.min(g*e+f,a.length):a.length;f<g;f+=e)b[0]=a[f],b[1]=a[f+1],b[2]=a[f+2],k(b,q,b),a[f]=b[0],a[f+1]=b[1],a[f+2]=b[2];return a}}();a.JC=function(b,c){var e=a.fromValues(b[0],b[1],b[2]),f=a.fromValues(c[0],c[1],c[2]);a.normalize(e,e);a.normalize(f,f);e=a.dot(e,f);return 1<e?0:Math.acos(e)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};"undefined"!==
typeof a&&(a.vec3=a)};
b4w.module.vec4=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array,b=Math.random;a.create=function(){var a=new p(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new p(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,e,f){var g=new p(4);g[0]=a;g[1]=b;g[2]=e;g[3]=f;return g};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,e,f,g){g[0]=a;g[1]=b;g[2]=e;g[3]=f;return g};a.add=function(a,b,e){e[0]=
a[0]+b[0];e[1]=a[1]+b[1];e[2]=a[2]+b[2];e[3]=a[3]+b[3];return e};a.subtract=function(a,b,e){e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=a[2]-b[2];e[3]=a[3]-b[3];return e};a.sub=a.subtract;a.multiply=function(a,b,e){e[0]=a[0]*b[0];e[1]=a[1]*b[1];e[2]=a[2]*b[2];e[3]=a[3]*b[3];return e};a.mul=a.multiply;a.divide=function(a,b,e){e[0]=a[0]/b[0];e[1]=a[1]/b[1];e[2]=a[2]/b[2];e[3]=a[3]/b[3];return e};a.div=a.divide;a.min=function(a,b,e){e[0]=Math.min(a[0],b[0]);e[1]=Math.min(a[1],b[1]);e[2]=Math.min(a[2],b[2]);e[3]=
Math.min(a[3],b[3]);return e};a.max=function(a,b,e){e[0]=Math.max(a[0],b[0]);e[1]=Math.max(a[1],b[1]);e[2]=Math.max(a[2],b[2]);e[3]=Math.max(a[3],b[3]);return e};a.scale=function(a,b,e){e[0]=a[0]*b;e[1]=a[1]*b;e[2]=a[2]*b;e[3]=a[3]*b;return e};a.scaleAndAdd=function(a,b,e,f){f[0]=a[0]+b[0]*e;f[1]=a[1]+b[1]*e;f[2]=a[2]+b[2]*e;f[3]=a[3]+b[3]*e;return f};a.distance=function(a,b){var e=b[0]-a[0],f=b[1]-a[1],g=b[2]-a[2],k=b[3]-a[3];return Math.sqrt(e*e+f*f+g*g+k*k)};a.dist=a.distance;a.squaredDistance=
function(a,b){var e=b[0]-a[0],f=b[1]-a[1],g=b[2]-a[2],k=b[3]-a[3];return e*e+f*f+g*g+k*k};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],e=a[1],f=a[2];a=a[3];return Math.sqrt(b*b+e*e+f*f+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],e=a[1],f=a[2];a=a[3];return b*b+e*e+f*f+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var e=a[0],f=a[1],g=a[2],k=a[3],e=e*e+f*f+g*g+k*k;0<e&&(e=1/Math.sqrt(e),b[0]=a[0]*e,b[1]=a[1]*e,b[2]=a[2]*e,b[3]=a[3]*e);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,e,f){var g=a[0],k=a[1],q=a[2];a=a[3];f[0]=g+e*(b[0]-g);f[1]=k+e*(b[1]-k);f[2]=q+e*(b[2]-q);f[3]=a+e*(b[3]-a);return f};a.random=function(d,c){d=d||1;c[0]=b();c[1]=b();c[2]=b();c[3]=b();a.normalize(c,c);a.scale(c,d,c);return c};a.transformMat4=function(a,b,e){var f=a[0],
g=a[1],k=a[2];a=a[3];e[0]=b[0]*f+b[4]*g+b[8]*k+b[12]*a;e[1]=b[1]*f+b[5]*g+b[9]*k+b[13]*a;e[2]=b[2]*f+b[6]*g+b[10]*k+b[14]*a;e[3]=b[3]*f+b[7]*g+b[11]*k+b[15]*a;return e};a.transformQuat=function(a,b,e){var f=a[0],g=a[1],k=a[2],q=b[0],h=b[1],m=b[2];b=b[3];var u=b*f+h*k-m*g,n=b*g+m*f-q*k,p=b*k+q*g-h*f,f=-q*f-h*g-m*k;e[0]=u*b+f*-q+n*-m-p*-h;e[1]=n*b+f*-h+p*-q-u*-m;e[2]=p*b+f*-m+u*-h-n*-q;e[3]=a[3];return e};a.forEach=function(){var b=a.create();return function(a,e,f,g,k,q){e||(e=4);f||(f=0);for(g=g?Math.min(g*
e+f,a.length):a.length;f<g;f+=e)b[0]=a[f],b[1]=a[f+1],b[2]=a[f+2],b[3]=a[f+3],k(b,q,b),a[f]=b[0],a[f+1]=b[1],a[f+2]=b[2],a[f+3]=b[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.vec4=a)};
b4w.module.quat=function(a,p){var b=p("vec3"),d=p("vec4"),c=p("mat3"),e="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new e(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var c=b.create(),d=b.fromValues(1,0,0),e=b.fromValues(0,1,0);return function(q,h,m){var u=b.dot(q,h);if(-.9999999>u)return b.cross(d,q,c),1E-6>b.length(c)&&b.cross(e,q,c),b.normalize(c,c),a.setAxisAngle(c,Math.PI,m),m;if(.9999999<u)return m[0]=0,m[1]=0,m[2]=0,m[3]=1,m;b.cross(q,
h,c);m[0]=c[0];m[1]=c[1];m[2]=c[2];m[3]=1+u;return a.normalize(m,m)}}();a.setAxes=function(){var b=c.create();return function(c,d,e,h){b[0]=d[0];b[3]=d[1];b[6]=d[2];b[1]=e[0];b[4]=e[1];b[7]=e[2];b[2]=-c[0];b[5]=-c[1];b[8]=-c[2];return a.normalize(a.fromMat3(b,h),h)}}();a.clone=d.clone;a.fromValues=d.fromValues;a.copy=d.copy;a.set=d.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,c){b*=.5;var d=Math.sin(b);c[0]=d*a[0];c[1]=d*a[1];c[2]=d*a[2];c[3]=Math.cos(b);
return c};a.add=d.add;a.multiply=function(a,b,c){var d=a[0],e=a[1],m=a[2];a=a[3];var u=b[0],n=b[1],p=b[2];b=b[3];c[0]=d*b+a*u+e*p-m*n;c[1]=e*b+a*n+m*u-d*p;c[2]=m*b+a*p+d*n-e*u;c[3]=a*b-d*u-e*n-m*p;return c};a.mul=a.multiply;a.scale=d.scale;a.rotateX=function(a,b,c){b*=.5;var d=a[0],e=a[1],m=a[2];a=a[3];var u=Math.sin(b);b=Math.cos(b);c[0]=d*b+a*u;c[1]=e*b+m*u;c[2]=m*b-e*u;c[3]=a*b-d*u;return c};a.rotateY=function(a,b,c){b*=.5;var d=a[0],e=a[1],m=a[2];a=a[3];var u=Math.sin(b);b=Math.cos(b);c[0]=d*
b-m*u;c[1]=e*b+a*u;c[2]=m*b+d*u;c[3]=a*b-e*u;return c};a.rotateZ=function(a,b,c){b*=.5;var d=a[0],e=a[1],m=a[2];a=a[3];var u=Math.sin(b);b=Math.cos(b);c[0]=d*b+e*u;c[1]=e*b-d*u;c[2]=m*b+a*u;c[3]=a*b-m*u;return c};a.calculateW=function(a,b){var c=a[0],d=a[1],e=a[2];b[0]=c;b[1]=d;b[2]=e;b[3]=Math.sqrt(Math.abs(1-c*c-d*d-e*e));return b};a.dot=d.dot;a.lerp=d.lerp;a.slerp=function(a,b,c,d){var e=a[0],m=a[1],u=a[2];a=a[3];var n=b[0],p=b[1],x=b[2];b=b[3];var B,y,r;y=e*n+m*p+u*x+a*b;0>y&&(y=-y,n=-n,p=-p,
x=-x,b=-b);1E-6<1-y?(B=Math.acos(y),r=Math.sin(B),y=Math.sin((1-c)*B)/r,c=Math.sin(c*B)/r):y=1-c;d[0]=y*e+c*n;d[1]=y*m+c*p;d[2]=y*u+c*x;d[3]=y*a+c*b;return d};a.invert=function(a,b){var c=a[0],d=a[1],e=a[2],m=a[3],u=c*c+d*d+e*e+m*m,u=u?1/u:0;b[0]=-c*u;b[1]=-d*u;b[2]=-e*u;b[3]=m*u;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};a.length=d.length;a.len=a.length;a.squaredLength=d.squaredLength;a.sqrLen=a.squaredLength;a.normalize=d.normalize;a.fromMat3=function(a,
b){var c=a[0]+a[4]+a[8];if(0<c)c=Math.sqrt(c+1),b[3]=.5*c,c=.5/c,b[0]=(a[5]-a[7])*c,b[1]=(a[6]-a[2])*c,b[2]=(a[1]-a[3])*c;else{var d=0;a[4]>a[0]&&(d=1);a[8]>a[3*d+d]&&(d=2);var e=(d+1)%3,m=(d+2)%3,c=Math.sqrt(a[3*d+d]-a[3*e+e]-a[3*m+m]+1);b[d]=.5*c;c=.5/c;b[3]=(a[3*e+m]-a[3*m+e])*c;b[e]=(a[3*e+d]+a[3*d+e])*c;b[m]=(a[3*m+d]+a[3*d+m])*c}return b};a.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.quat=a)};
b4w.module.mat3=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new p(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[4];d[4]=a[5];d[5]=a[6];d[6]=a[8];d[7]=a[9];d[8]=a[10];return d};a.clone=function(a){var d=new p(9);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];return d};a.copy=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=
a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];return d};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,d){if(d===a){var c=a[1],e=a[2],f=a[5];d[1]=a[3];d[2]=a[6];d[3]=c;d[5]=a[7];d[6]=e;d[7]=f}else d[0]=a[0],d[1]=a[3],d[2]=a[6],d[3]=a[1],d[4]=a[4],d[5]=a[7],d[6]=a[2],d[7]=a[5],d[8]=a[8];return d};a.invert=function(a,d){var c=a[0],e=a[1],f=a[2],g=a[3],k=a[4],q=a[5],h=a[6],m=a[7],u=a[8],n=u*k-q*m,p=-u*g+q*h,x=
m*g-k*h,B=c*n+e*p+f*x;if(!B)return null;B=1/B;d[0]=n*B;d[1]=(-u*e+f*m)*B;d[2]=(q*e-f*k)*B;d[3]=p*B;d[4]=(u*c-f*h)*B;d[5]=(-q*c+f*g)*B;d[6]=x*B;d[7]=(-m*c+e*h)*B;d[8]=(k*c-e*g)*B;return d};a.adjoint=function(a,d){var c=a[0],e=a[1],f=a[2],g=a[3],k=a[4],q=a[5],h=a[6],m=a[7],u=a[8];d[0]=k*u-q*m;d[1]=f*m-e*u;d[2]=e*q-f*k;d[3]=q*h-g*u;d[4]=c*u-f*h;d[5]=f*g-c*q;d[6]=g*m-k*h;d[7]=e*h-c*m;d[8]=c*k-e*g;return d};a.determinant=function(a){var d=a[3],c=a[4],e=a[5],f=a[6],g=a[7],k=a[8];return a[0]*(k*c-e*g)+a[1]*
(-k*d+e*f)+a[2]*(g*d-c*f)};a.multiply=function(a,d,c){var e=a[0],f=a[1],g=a[2],k=a[3],q=a[4],h=a[5],m=a[6],u=a[7];a=a[8];var n=d[0],p=d[1],x=d[2],B=d[3],y=d[4],r=d[5],A=d[6],t=d[7];d=d[8];c[0]=n*e+p*k+x*m;c[1]=n*f+p*q+x*u;c[2]=n*g+p*h+x*a;c[3]=B*e+y*k+r*m;c[4]=B*f+y*q+r*u;c[5]=B*g+y*h+r*a;c[6]=A*e+t*k+d*m;c[7]=A*f+t*q+d*u;c[8]=A*g+t*h+d*a;return c};a.mul=a.multiply;a.translate=function(a,d,c){var e=a[0],f=a[1],g=a[2],k=a[3],q=a[4],h=a[5],m=a[6],p=a[7];a=a[8];var n=d[0];d=d[1];c[0]=e;c[1]=f;c[2]=g;
c[3]=k;c[4]=q;c[5]=h;c[6]=n*e+d*k+m;c[7]=n*f+d*q+p;c[8]=n*g+d*h+a;return c};a.rotate=function(a,d,c){var e=a[0],f=a[1],g=a[2],k=a[3],q=a[4],h=a[5],m=a[6],p=a[7];a=a[8];var n=Math.sin(d);d=Math.cos(d);c[0]=d*e+n*k;c[1]=d*f+n*q;c[2]=d*g+n*h;c[3]=d*k-n*e;c[4]=d*q-n*f;c[5]=d*h-n*g;c[6]=m;c[7]=p;c[8]=a;return c};a.scale=function(a,d,c){var e=d[0];d=d[1];c[0]=e*a[0];c[1]=e*a[1];c[2]=e*a[2];c[3]=d*a[3];c[4]=d*a[4];c[5]=d*a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.Ax=function(a,d){d[0]=1;d[1]=0;d[2]=
0;d[3]=0;d[4]=1;d[5]=0;d[6]=a[0];d[7]=a[1];d[8]=1;return d};a.yx=function(a,d){var c=Math.sin(a),e=Math.cos(a);d[0]=e;d[1]=c;d[2]=0;d[3]=-c;d[4]=e;d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};a.zx=function(a,d){d[0]=a[0];d[1]=0;d[2]=0;d[3]=0;d[4]=a[1];d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};a.fromMat2d=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=0;d[3]=a[2];d[4]=a[3];d[5]=0;d[6]=a[4];d[7]=a[5];d[8]=1;return d};a.fromQuat=function(a,d){var c=a[0],e=a[1],f=a[2],g=a[3],k=c+c,q=e+e,h=f+f,c=c*k,m=e*k,e=e*q,p=f*k,n=
f*q,f=f*h,k=g*k,q=g*q,g=g*h;d[0]=1-e-f;d[3]=m-g;d[6]=p+q;d[1]=m+g;d[4]=1-c-f;d[7]=n-k;d[2]=p-q;d[5]=n+k;d[8]=1-c-e;return d};a.normalFromMat4=function(a,d){var c=a[0],e=a[1],f=a[2],g=a[3],k=a[4],q=a[5],h=a[6],m=a[7],p=a[8],n=a[9],w=a[10],x=a[11],B=a[12],y=a[13],r=a[14],A=a[15],t=c*q-e*k,F=c*h-f*k,C=c*m-g*k,l=e*h-f*q,H=e*m-g*q,J=f*m-g*h,K=p*y-n*B,I=p*r-w*B,p=p*A-x*B,P=n*r-w*y,n=n*A-x*y,w=w*A-x*r,x=t*w-F*n+C*P+l*p-H*I+J*K;if(!x)return null;x=1/x;d[0]=(q*w-h*n+m*P)*x;d[1]=(h*p-k*w-m*I)*x;d[2]=(k*n-q*
p+m*K)*x;d[3]=(f*n-e*w-g*P)*x;d[4]=(c*w-f*p+g*I)*x;d[5]=(e*p-c*n-g*K)*x;d[6]=(y*J-r*H+A*l)*x;d[7]=(r*C-B*J-A*F)*x;d[8]=(B*H-y*C+A*t)*x;return d};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.xx=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};"undefined"!==typeof a&&(a.mat3=a)};
b4w.module.mat4=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new p(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var d=new p(16);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.copy=function(a,d){d[0]=a[0];d[1]=
a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,d){if(d===a){var c=a[1],e=a[2],f=a[3],g=a[6],k=a[7],q=a[11];d[1]=a[4];d[2]=a[8];d[3]=a[12];d[4]=c;d[6]=a[9];d[7]=a[13];d[8]=e;d[9]=g;d[11]=a[14];d[12]=f;d[13]=k;
d[14]=q}else d[0]=a[0],d[1]=a[4],d[2]=a[8],d[3]=a[12],d[4]=a[1],d[5]=a[5],d[6]=a[9],d[7]=a[13],d[8]=a[2],d[9]=a[6],d[10]=a[10],d[11]=a[14],d[12]=a[3],d[13]=a[7],d[14]=a[11],d[15]=a[15];return d};a.invert=function(a,d){var c=a[0],e=a[1],f=a[2],g=a[3],k=a[4],q=a[5],h=a[6],m=a[7],p=a[8],n=a[9],w=a[10],x=a[11],B=a[12],y=a[13],r=a[14],A=a[15],t=c*q-e*k,F=c*h-f*k,C=c*m-g*k,l=e*h-f*q,H=e*m-g*q,J=f*m-g*h,K=p*y-n*B,I=p*r-w*B,P=p*A-x*B,z=n*r-w*y,N=n*A-x*y,G=w*A-x*r,L=t*G-F*N+C*z+l*P-H*I+J*K;if(!L)return null;
L=1/L;d[0]=(q*G-h*N+m*z)*L;d[1]=(f*N-e*G-g*z)*L;d[2]=(y*J-r*H+A*l)*L;d[3]=(w*H-n*J-x*l)*L;d[4]=(h*P-k*G-m*I)*L;d[5]=(c*G-f*P+g*I)*L;d[6]=(r*C-B*J-A*F)*L;d[7]=(p*J-w*C+x*F)*L;d[8]=(k*N-q*P+m*K)*L;d[9]=(e*P-c*N-g*K)*L;d[10]=(B*H-y*C+A*t)*L;d[11]=(n*C-p*H-x*t)*L;d[12]=(q*I-k*z-h*K)*L;d[13]=(c*z-e*I+f*K)*L;d[14]=(y*F-B*l-r*t)*L;d[15]=(p*l-n*F+w*t)*L;return d};a.adjoint=function(a,d){var c=a[0],e=a[1],f=a[2],g=a[3],k=a[4],q=a[5],h=a[6],m=a[7],p=a[8],n=a[9],w=a[10],x=a[11],B=a[12],y=a[13],r=a[14],A=a[15];
d[0]=q*(w*A-x*r)-n*(h*A-m*r)+y*(h*x-m*w);d[1]=-(e*(w*A-x*r)-n*(f*A-g*r)+y*(f*x-g*w));d[2]=e*(h*A-m*r)-q*(f*A-g*r)+y*(f*m-g*h);d[3]=-(e*(h*x-m*w)-q*(f*x-g*w)+n*(f*m-g*h));d[4]=-(k*(w*A-x*r)-p*(h*A-m*r)+B*(h*x-m*w));d[5]=c*(w*A-x*r)-p*(f*A-g*r)+B*(f*x-g*w);d[6]=-(c*(h*A-m*r)-k*(f*A-g*r)+B*(f*m-g*h));d[7]=c*(h*x-m*w)-k*(f*x-g*w)+p*(f*m-g*h);d[8]=k*(n*A-x*y)-p*(q*A-m*y)+B*(q*x-m*n);d[9]=-(c*(n*A-x*y)-p*(e*A-g*y)+B*(e*x-g*n));d[10]=c*(q*A-m*y)-k*(e*A-g*y)+B*(e*m-g*q);d[11]=-(c*(q*x-m*n)-k*(e*x-g*n)+p*
(e*m-g*q));d[12]=-(k*(n*r-w*y)-p*(q*r-h*y)+B*(q*w-h*n));d[13]=c*(n*r-w*y)-p*(e*r-f*y)+B*(e*w-f*n);d[14]=-(c*(q*r-h*y)-k*(e*r-f*y)+B*(e*h-f*q));d[15]=c*(q*w-h*n)-k*(e*w-f*n)+p*(e*h-f*q);return d};a.determinant=function(a){var d=a[0],c=a[1],e=a[2],f=a[3],g=a[4],k=a[5],q=a[6],h=a[7],m=a[8],p=a[9],n=a[10],w=a[11],x=a[12],B=a[13],y=a[14];a=a[15];return(d*k-c*g)*(n*a-w*y)-(d*q-e*g)*(p*a-w*B)+(d*h-f*g)*(p*y-n*B)+(c*q-e*k)*(m*a-w*x)-(c*h-f*k)*(m*y-n*x)+(e*h-f*q)*(m*B-p*x)};a.multiply=function(a,d,c){var e=
a[0],f=a[1],g=a[2],k=a[3],q=a[4],h=a[5],m=a[6],p=a[7],n=a[8],w=a[9],x=a[10],B=a[11],y=a[12],r=a[13],A=a[14];a=a[15];var t=d[0],F=d[1],C=d[2],l=d[3];c[0]=t*e+F*q+C*n+l*y;c[1]=t*f+F*h+C*w+l*r;c[2]=t*g+F*m+C*x+l*A;c[3]=t*k+F*p+C*B+l*a;t=d[4];F=d[5];C=d[6];l=d[7];c[4]=t*e+F*q+C*n+l*y;c[5]=t*f+F*h+C*w+l*r;c[6]=t*g+F*m+C*x+l*A;c[7]=t*k+F*p+C*B+l*a;t=d[8];F=d[9];C=d[10];l=d[11];c[8]=t*e+F*q+C*n+l*y;c[9]=t*f+F*h+C*w+l*r;c[10]=t*g+F*m+C*x+l*A;c[11]=t*k+F*p+C*B+l*a;t=d[12];F=d[13];C=d[14];l=d[15];c[12]=t*e+
F*q+C*n+l*y;c[13]=t*f+F*h+C*w+l*r;c[14]=t*g+F*m+C*x+l*A;c[15]=t*k+F*p+C*B+l*a;return c};a.mul=a.multiply;a.translate=function(a,d,c){var e=d[0],f=d[1];d=d[2];var g,k,q,h,m,p,n,w,x,B,y,r;a===c?(c[12]=a[0]*e+a[4]*f+a[8]*d+a[12],c[13]=a[1]*e+a[5]*f+a[9]*d+a[13],c[14]=a[2]*e+a[6]*f+a[10]*d+a[14],c[15]=a[3]*e+a[7]*f+a[11]*d+a[15]):(g=a[0],k=a[1],q=a[2],h=a[3],m=a[4],p=a[5],n=a[6],w=a[7],x=a[8],B=a[9],y=a[10],r=a[11],c[0]=g,c[1]=k,c[2]=q,c[3]=h,c[4]=m,c[5]=p,c[6]=n,c[7]=w,c[8]=x,c[9]=B,c[10]=y,c[11]=r,
c[12]=g*e+m*f+x*d+a[12],c[13]=k*e+p*f+B*d+a[13],c[14]=q*e+n*f+y*d+a[14],c[15]=h*e+w*f+r*d+a[15]);return c};a.scale=function(a,d,c){var e=d[0],f=d[1];d=d[2];c[0]=a[0]*e;c[1]=a[1]*e;c[2]=a[2]*e;c[3]=a[3]*e;c[4]=a[4]*f;c[5]=a[5]*f;c[6]=a[6]*f;c[7]=a[7]*f;c[8]=a[8]*d;c[9]=a[9]*d;c[10]=a[10]*d;c[11]=a[11]*d;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.rotate=function(a,d,c,e){var f=c[0],g=c[1];c=c[2];var k=Math.sqrt(f*f+g*g+c*c),q,h,m,p,n,w,x,B,y,r,A,t,F,C,l,H,J,K,I,P;if(1E-7>Math.abs(k))return null;
k=1/k;f*=k;g*=k;c*=k;q=Math.sin(d);h=Math.cos(d);m=1-h;d=a[0];k=a[1];p=a[2];n=a[3];w=a[4];x=a[5];B=a[6];y=a[7];r=a[8];A=a[9];t=a[10];F=a[11];C=f*f*m+h;l=g*f*m+c*q;H=c*f*m-g*q;J=f*g*m-c*q;K=g*g*m+h;I=c*g*m+f*q;P=f*c*m+g*q;f=g*c*m-f*q;g=c*c*m+h;e[0]=d*C+w*l+r*H;e[1]=k*C+x*l+A*H;e[2]=p*C+B*l+t*H;e[3]=n*C+y*l+F*H;e[4]=d*J+w*K+r*I;e[5]=k*J+x*K+A*I;e[6]=p*J+B*K+t*I;e[7]=n*J+y*K+F*I;e[8]=d*P+w*f+r*g;e[9]=k*P+x*f+A*g;e[10]=p*P+B*f+t*g;e[11]=n*P+y*f+F*g;a!==e&&(e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15]);
return e};a.rotateX=function(a,d,c){var e=Math.sin(d);d=Math.cos(d);var f=a[4],g=a[5],k=a[6],q=a[7],h=a[8],m=a[9],p=a[10],n=a[11];a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[4]=f*d+h*e;c[5]=g*d+m*e;c[6]=k*d+p*e;c[7]=q*d+n*e;c[8]=h*d-f*e;c[9]=m*d-g*e;c[10]=p*d-k*e;c[11]=n*d-q*e;return c};a.rotateY=function(a,d,c){var e=Math.sin(d);d=Math.cos(d);var f=a[0],g=a[1],k=a[2],q=a[3],h=a[8],m=a[9],p=a[10],n=a[11];a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],
c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[0]=f*d-h*e;c[1]=g*d-m*e;c[2]=k*d-p*e;c[3]=q*d-n*e;c[8]=f*e+h*d;c[9]=g*e+m*d;c[10]=k*e+p*d;c[11]=q*e+n*d;return c};a.rotateZ=function(a,d,c){var e=Math.sin(d);d=Math.cos(d);var f=a[0],g=a[1],k=a[2],q=a[3],h=a[4],m=a[5],p=a[6],n=a[7];a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[0]=f*d+h*e;c[1]=g*d+m*e;c[2]=k*d+p*e;c[3]=q*d+n*e;c[4]=h*d-f*e;c[5]=m*d-g*e;c[6]=p*d-k*e;c[7]=n*d-q*e;return c};
a.Ax=function(a,d){d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=a[0];d[13]=a[1];d[14]=a[2];d[15]=1;return d};a.zx=function(a,d){d[0]=a[0];d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=a[1];d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=a[2];d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.yx=function(a,d,c){var e=d[0],f=d[1];d=d[2];var g=Math.sqrt(e*e+f*f+d*d),k;if(1E-7>Math.abs(g))return null;g=1/g;e*=g;f*=g;d*=g;g=Math.sin(a);a=Math.cos(a);k=1-a;c[0]=e*e*k+a;c[1]=f*e*k+d*
g;c[2]=d*e*k-f*g;c[3]=0;c[4]=e*f*k-d*g;c[5]=f*f*k+a;c[6]=d*f*k+e*g;c[7]=0;c[8]=e*d*k+f*g;c[9]=f*d*k-e*g;c[10]=d*d*k+a;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.AD=function(a,d){var c=Math.sin(a),e=Math.cos(a);d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=e;d[6]=c;d[7]=0;d[8]=0;d[9]=-c;d[10]=e;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.BD=function(a,d){var c=Math.sin(a),e=Math.cos(a);d[0]=e;d[1]=0;d[2]=-c;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=c;d[9]=0;d[10]=e;d[11]=0;d[12]=0;d[13]=0;
d[14]=0;d[15]=1;return d};a.CD=function(a,d){var c=Math.sin(a),e=Math.cos(a);d[0]=e;d[1]=c;d[2]=0;d[3]=0;d[4]=-c;d[5]=e;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.fromRotationTranslation=function(a,d,c){var e=a[0],f=a[1],g=a[2],k=a[3],q=e+e,h=f+f,m=g+g;a=e*q;var p=e*h,e=e*m,n=f*h,f=f*m,g=g*m,q=k*q,h=k*h,k=k*m;c[0]=1-(n+g);c[1]=p+k;c[2]=e-h;c[3]=0;c[4]=p-k;c[5]=1-(a+g);c[6]=f+q;c[7]=0;c[8]=e+h;c[9]=f-q;c[10]=1-(a+n);c[11]=0;c[12]=d[0];c[13]=d[1];c[14]=d[2];
c[15]=1;return c};a.fromQuat=function(a,d){var c=a[0],e=a[1],f=a[2],g=a[3],k=c+c,q=e+e,h=f+f,c=c*k,m=e*k,e=e*q,p=f*k,n=f*q,f=f*h,k=g*k,q=g*q,g=g*h;d[0]=1-e-f;d[1]=m+g;d[2]=p-q;d[3]=0;d[4]=m-g;d[5]=1-c-f;d[6]=n+k;d[7]=0;d[8]=p+q;d[9]=n-k;d[10]=1-c-e;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.frustum=function(a,d,c,e,f,g,k){var q=1/(d-a),h=1/(e-c),m=1/(f-g);k[0]=2*f*q;k[1]=0;k[2]=0;k[3]=0;k[4]=0;k[5]=2*f*h;k[6]=0;k[7]=0;k[8]=(d+a)*q;k[9]=(e+c)*h;k[10]=(g+f)*m;k[11]=-1;k[12]=0;k[13]=0;k[14]=
g*f*2*m;k[15]=0;return k};a.perspective=function(a,d,c,e,f){a=1/Math.tan(a/2);var g=1/(c-e);f[0]=a/d;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=a;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=(e+c)*g;f[11]=-1;f[12]=0;f[13]=0;f[14]=2*e*c*g;f[15]=0;return f};a.wE=function(a,d,c,e){var f=Math.tan(a.NE*Math.PI/180),g=Math.tan(a.nD*Math.PI/180),k=Math.tan(a.iE*Math.PI/180);a=Math.tan(a.yE*Math.PI/180);var q=2/(k+a),h=2/(f+g);e[0]=q;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=h;e[6]=0;e[7]=0;e[8]=-((k-a)*q*.5);e[9]=(f-g)*h*.5;e[10]=c/
(d-c);e[11]=-1;e[12]=0;e[13]=0;e[14]=c*d/(d-c);e[15]=0;return e};a.ortho=function(a,d,c,e,f,g,k){var q=1/(a-d),h=1/(c-e),m=1/(f-g);k[0]=-2*q;k[1]=0;k[2]=0;k[3]=0;k[4]=0;k[5]=-2*h;k[6]=0;k[7]=0;k[8]=0;k[9]=0;k[10]=2*m;k[11]=0;k[12]=(a+d)*q;k[13]=(e+c)*h;k[14]=(g+f)*m;k[15]=1;return k};a.lookAt=function(b,d,c,e){var f,g,k,q,h,m,p,n,w=b[0],x=b[1];b=b[2];k=c[0];q=c[1];g=c[2];p=d[0];c=d[1];f=d[2];if(1E-7>Math.abs(w-p)&&1E-7>Math.abs(x-c)&&1E-7>Math.abs(b-f))return a.identity(e);d=w-p;c=x-c;p=b-f;n=1/Math.sqrt(d*
d+c*c+p*p);d*=n;c*=n;p*=n;f=q*p-g*c;g=g*d-k*p;k=k*c-q*d;(n=Math.sqrt(f*f+g*g+k*k))?(n=1/n,f*=n,g*=n,k*=n):k=g=f=0;q=c*k-p*g;h=p*f-d*k;m=d*g-c*f;(n=Math.sqrt(q*q+h*h+m*m))?(n=1/n,q*=n,h*=n,m*=n):m=h=q=0;e[0]=f;e[1]=q;e[2]=d;e[3]=0;e[4]=g;e[5]=h;e[6]=c;e[7]=0;e[8]=k;e[9]=m;e[10]=p;e[11]=0;e[12]=-(f*w+g*x+k*b);e[13]=-(q*w+h*x+m*b);e[14]=-(d*w+c*x+p*b);e[15]=1;return e};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+
a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.xx=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};"undefined"!==typeof a&&(a.mat4=a)};b4w.module.__gpp_eval=function(a){a.Rr=function(){function a(b,d,c,e,f,g){this.message=b;this.offset=e;this.zi=f;this.Lg=g;this.name="SyntaxError"}(function(a,d){function c(){this.constructor=a}c.prototype=d.prototype;a.prototype=new c})(a,Error);return{SyntaxError:a,parse:function(b){function d(a,b){switch(a){case "++":return++b;case "--":return--b;case "+":return+b;case "-":return-b;case "~":return~b;case "!":return!b}}function c(a){if(Mb!==a){Mb>a&&(Mb=0,Ia={zi:1,Lg:1,Ui:!1});var c=Ia,d,e;for(d=
Mb;d<a;d++)e=b.charAt(d),"\n"===e?(c.Ui||c.zi++,c.Lg=1,c.Ui=!1):"\r"===e||"\u2028"===e||"\u2029"===e?(c.zi++,c.Lg=1,c.Ui=!0):(c.Lg++,c.Ui=!1);Mb=a}return Ia}function e(a){D<Ua||(D>Ua&&(Ua=D,yb=[]),yb.push(a))}function f(){var a,c,d;a=D;c=R();c!==v?(c=g(),c!==v?(d=R(),d!==v?(da++,10===b.charCodeAt(D)?(d=jc,D++):(d=v,0===da&&e(Yb)),d===v&&(b.substr(D,2)===wc?(d=wc,D+=2):(d=v,0===da&&e(bb)),d===v&&(13===b.charCodeAt(D)?(d=Zb,D++):(d=v,0===da&&e(Pc)))),da--,d===v&&0===da&&e(Lb),d===v&&(d=null),d!==v?
a=c:(D=a,a=v)):(D=a,a=v)):(D=a,a=v)):(D=a,a=v);return a}function g(){var a,c,d,f,g,h,l,m;a=D;c=k();if(c!==v){d=[];f=D;g=R();g!==v?(44===b.charCodeAt(D)?(h=V,D++):(h=v,0===da&&e(ha)),h!==v?(l=R(),l!==v?(m=k(),m!==v?f=g=[g,h,l,m]:(D=f,f=v)):(D=f,f=v)):(D=f,f=v)):(D=f,f=v);for(;f!==v;)d.push(f),f=D,g=R(),g!==v?(44===b.charCodeAt(D)?(h=V,D++):(h=v,0===da&&e(ha)),h!==v?(l=R(),l!==v?(m=k(),m!==v?f=g=[g,h,l,m]:(D=f,f=v)):(D=f,f=v)):(D=f,f=v)):(D=f,f=v);d!==v?a=c=0==d.length?c:d[d.length-1]:(D=a,a=v)}else D=
a,a=v;return a}function k(){var a,c,d,f;a=D;c=q();c!==v?(d=R(),d!==v?(63===b.charCodeAt(D)?(d=ea,D++):(d=v,0===da&&e(pa)),d!==v?(d=R(),d!==v?(d=g(),d!==v?(f=R(),f!==v?(58===b.charCodeAt(D)?(f=U,D++):(f=v,0===da&&e(S)),f!==v?(f=R(),f!==v?(f=g(),f!==v?a=c?d:f:(D=a,a=v)):(D=a,a=v)):(D=a,a=v)):(D=a,a=v)):(D=a,a=v)):(D=a,a=v)):(D=a,a=v)):(D=a,a=v)):(D=a,a=v);a===v&&(a=q());return a}function q(){var a,b,c,d,e,f,g,k;a=D;b=h();if(b!==v){c=[];d=D;e=R();e!==v?(f=Y(),f!==v?(g=R(),g!==v?(k=h(),k!==v?d=e=[e,f,
g,k]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);for(;d!==v;)c.push(d),d=D,e=R(),e!==v?(f=Y(),f!==v?(g=R(),g!==v?(k=h(),k!==v?d=e=[e,f,g,k]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);if(c!==v)for(a=b,b=0;b<c.length;b++)a=a||c[b][3];else D=a,a=v}else D=a,a=v;return a}function h(){var a,b,c,d,e,f,g,h;a=D;b=m();if(b!==v){c=[];d=D;e=R();e!==v?(f=X(),f!==v?(g=R(),g!==v?(h=m(),h!==v?d=e=[e,f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);for(;d!==v;)c.push(d),d=D,e=R(),e!==v?(f=X(),f!==v?(g=R(),g!==v?(h=
m(),h!==v?d=e=[e,f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);if(c!==v)for(a=b,b=0;b<c.length;b++)a=a&&c[b][3];else D=a,a=v}else D=a,a=v;return a}function m(){var a,b,c,d,e,f,g,h;a=D;b=u();if(b!==v){c=[];d=D;e=R();e!==v?(f=W(),f!==v?(g=R(),g!==v?(h=u(),h!==v?d=e=[e,f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);for(;d!==v;)c.push(d),d=D,e=R(),e!==v?(f=W(),f!==v?(g=R(),g!==v?(h=u(),h!==v?d=e=[e,f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);if(c!==v)for(a=b,b=0;b<c.length;b++)a|=c[b][3];
else D=a,a=v}else D=a,a=v;return a}function u(){var a,b,c,d,e,f,g,h;a=D;b=n();if(b!==v){c=[];d=D;e=R();e!==v?(f=O(),f!==v?(g=R(),g!==v?(h=n(),h!==v?d=e=[e,f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);for(;d!==v;)c.push(d),d=D,e=R(),e!==v?(f=O(),f!==v?(g=R(),g!==v?(h=n(),h!==v?d=e=[e,f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);if(c!==v)for(a=b,b=0;b<c.length;b++)a^=c[b][3];else D=a,a=v}else D=a,a=v;return a}function n(){var a,b,c,d,e,f,g,h;a=D;b=w();if(b!==v){c=[];d=D;e=R();e!==v?(f=L(),
f!==v?(g=R(),g!==v?(h=w(),h!==v?d=e=[e,f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);for(;d!==v;)c.push(d),d=D,e=R(),e!==v?(f=L(),f!==v?(g=R(),g!==v?(h=w(),h!==v?d=e=[e,f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);if(c!==v)for(a=b,b=0;b<c.length;b++)a&=c[b][3];else D=a,a=v}else D=a,a=v;return a}function w(){var a,b,c,d,e,f,g,h;a=D;b=x();if(b!==v){c=[];d=D;e=R();e!==v?(f=G(),f!==v?(g=R(),g!==v?(h=x(),h!==v?d=e=[e,f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);for(;d!==v;)c.push(d),d=D,
e=R(),e!==v?(f=G(),f!==v?(g=R(),g!==v?(h=x(),h!==v?d=e=[e,f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);if(c!==v)for(a=b,b=0;b<c.length;b++)switch(c[b][1]){case "==":a=a==c[b][3];break;case "!=":a=a!=c[b][3]}else D=a,a=v}else D=a,a=v;return a}function x(){var a,b,c,d,e,f,g,h;a=D;b=B();if(b!==v){c=[];d=D;e=R();e!==v?(f=N(),f!==v?(g=R(),g!==v?(h=B(),h!==v?d=e=[e,f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);for(;d!==v;)c.push(d),d=D,e=R(),e!==v?(f=N(),f!==v?(g=R(),g!==v?(h=B(),h!==v?d=e=[e,
f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);if(c!==v)for(a=b,b=0;b<c.length;b++)switch(c[b][1]){case "<=":a=a<=c[b][3];break;case ">=":a=a>=c[b][3];break;case "<":a=a<c[b][3];break;case ">":a=a>c[b][3]}else D=a,a=v}else D=a,a=v;return a}function B(){var a,b,c,d,e,f,g,h;a=D;b=y();if(b!==v){c=[];d=D;e=R();e!==v?(f=z(),f!==v?(g=R(),g!==v?(h=y(),h!==v?d=e=[e,f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);for(;d!==v;)c.push(d),d=D,e=R(),e!==v?(f=z(),f!==v?(g=R(),g!==v?(h=y(),h!==v?d=e=[e,f,g,
h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);if(c!==v)for(a=b,b=0;b<c.length;b++)switch(c[b][1]){case "<<":a<<=c[b][3];break;case ">>":a>>=c[b][3]}else D=a,a=v}else D=a,a=v;return a}function y(){var a,b,c,d,e,f,g,h;a=D;b=r();if(b!==v){c=[];d=D;e=R();e!==v?(f=P(),f!==v?(g=R(),g!==v?(h=r(),h!==v?d=e=[e,f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);for(;d!==v;)c.push(d),d=D,e=R(),e!==v?(f=P(),f!==v?(g=R(),g!==v?(h=r(),h!==v?d=e=[e,f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);if(c!==v)for(a=
b,b=0;b<c.length;b++)switch(c[b][1]){case "+":a+=c[b][3];break;case "-":a-=c[b][3]}else D=a,a=v}else D=a,a=v;return a}function r(){var a,b,c,d,e,f,g,h;a=D;b=A();if(b!==v){c=[];d=D;e=R();e!==v?(f=I(),f!==v?(g=R(),g!==v?(h=A(),h!==v?d=e=[e,f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);for(;d!==v;)c.push(d),d=D,e=R(),e!==v?(f=I(),f!==v?(g=R(),g!==v?(h=A(),h!==v?d=e=[e,f,g,h]:(D=d,d=v)):(D=d,d=v)):(D=d,d=v)):(D=d,d=v);if(c!==v)for(a=b,b=0;b<c.length;b++)switch(c[b][1]){case "*":a*=c[b][3];break;case "/":a=
Math.floor(a/c[b][3]);break;case "%":a%=c[b][3]}else D=a,a=v}else D=a,a=v;return a}function A(){var a,c,f;a=D;b.substr(D,7)===fa?(c=fa,D+=7):(c=v,0===da&&e(ia));c!==v?(f=R(),f!==v?(f=F(),f!==v?a=f:(D=a,a=v)):(D=a,a=v)):(D=a,a=v);if(a===v){a=D;c=t();if(c!==v)if(f=R(),f!==v)if(b.substr(D,2)===Gc?(f=Gc,D+=2):(f=v,0===da&&e(Hc)),f===v&&(b.substr(D,2)===Bb?(f=Bb,D+=2):(f=v,0===da&&e(nb))),f!==v){a:{a=c;switch(f){case "++":c=++a;break a;case "--":c=--a;break a}c=void 0}a=c}else D=a,a=v;else D=a,a=v;else D=
a,a=v;a===v&&(a=t());a===v&&(a=D,b.substr(D,2)===Gc?(c=Gc,D+=2):(c=v,0===da&&e(Hc)),c===v&&(b.substr(D,2)===Bb?(c=Bb,D+=2):(c=v,0===da&&e(nb)),c===v&&(43===b.charCodeAt(D)?(c=Qb,D++):(c=v,0===da&&e(Ic)),c===v&&(45===b.charCodeAt(D)?(c=Ca,D++):(c=v,0===da&&e(Fa)),c===v&&(126===b.charCodeAt(D)?(c=ka,D++):(c=v,0===da&&e(Oc)),c===v&&(33===b.charCodeAt(D)?(c=na,D++):(c=v,0===da&&e($a))))))),c!==v?(f=R(),f!==v?(f=A(),f!==v?a=c=d(c,f):(D=a,a=v)):(D=a,a=v)):(D=a,a=v))}return a}function t(){var a,c,d;da++;
var f;a=D;48===b.charCodeAt(D)?(c=T,D++):(c=v,0===da&&e(va));if(c!==v)if(sb.test(b.charAt(D))?(c=b.charAt(D),D++):(c=v,0===da&&e(ba)),c!==v){c=D;d=[];f=l();if(f!==v)for(;f!==v;)d.push(f),f=l();else d=v;c=d!==v?b.substring(c,D):d;c!==v?a=c=parseInt("0x"+c):(D=a,a=v)}else D=a,a=v;else D=a,a=v;if(a===v){a=D;48===b.charCodeAt(D)?(c=T,D++):(c=v,0===da&&e(va));if(c===v)if(c=D,ma.test(b.charAt(D))?(d=b.charAt(D),D++):(d=v,0===da&&e(ua)),d!==v){var h;f=[];h=C();if(h!==v)for(;h!==v;)f.push(h),h=C();else f=
v;f===v&&(f=null);f!==v?c=d=[d,f]:(D=c,c=v)}else D=c,c=v;a=c!==v?b.substring(a,D):c;a!==v&&(a=parseInt(a))}da--;a===v&&0===da&&e(E);a===v&&(c=H(),c!==v&&(c=0),a=c,a===v&&(a=D,40===b.charCodeAt(D)?(c=sa,D++):(c=v,0===da&&e(ra)),c!==v?(c=R(),c!==v?(c=g(),c!==v?(d=R(),d!==v?(41===b.charCodeAt(D)?(d=Q,D++):(d=v,0===da&&e(ca)),d!==v?a=c:(D=a,a=v)):(D=a,a=v)):(D=a,a=v)):(D=a,a=v)):(D=a,a=v)));return a}function F(){var a,c,d,f,g;c=H();c!==v&&(c=0);a=c;if(a===v){c=[];f=d=D;da++;40===b.charCodeAt(D)?(g=sa,
D++):(g=v,0===da&&e(ra));g===v&&(41===b.charCodeAt(D)?(g=Q,D++):(g=v,0===da&&e(ca)));da--;g===v?f=void 0:(D=f,f=v);f!==v?(g=ja(),g!==v?d=f=[f,g]:(D=d,d=v)):(D=d,d=v);if(d!==v)for(;d!==v;)c.push(d),f=d=D,da++,40===b.charCodeAt(D)?(g=sa,D++):(g=v,0===da&&e(ra)),g===v&&(41===b.charCodeAt(D)?(g=Q,D++):(g=v,0===da&&e(ca))),da--,g===v?f=void 0:(D=f,f=v),f!==v?(g=ja(),g!==v?d=f=[f,g]:(D=d,d=v)):(D=d,d=v);else c=v;c!==v&&(c=1);a=c;a===v&&(a=D,40===b.charCodeAt(D)?(c=sa,D++):(c=v,0===da&&e(ra)),c!==v?(d=R(),
d!==v?(f=F(),f!==v?(g=R(),g!==v?(41===b.charCodeAt(D)?(c=Q,D++):(c=v,0===da&&e(ca)),c!==v?a=f:(D=a,a=v)):(D=a,a=v)):(D=a,a=v)):(D=a,a=v)):(D=a,a=v))}return a}function C(){var a;M.test(b.charAt(D))?(a=b.charAt(D),D++):(a=v,0===da&&e(Xb));return a}function l(){var a;Sa.test(b.charAt(D))?(a=b.charAt(D),D++):(a=v,0===da&&e(La));return a}function H(){var a,c;da++;c=a=D;da++;var d,f,g,h;d=D;b.substr(D,7)===fa?(f=fa,D+=7):(f=v,0===da&&e(ia));f!==v?(g=D,da++,h=K(),da--,h===v?g=void 0:(D=g,g=v),g!==v?d=f=
[f,g]:(D=d,d=v)):(D=d,d=v);da--;d===v?c=void 0:(D=c,c=v);if(c!==v){da++;c=D;d=J();if(d!==v){f=[];for(g=K();g!==v;)f.push(g),g=K();f!==v?c=d+=f.join(""):(D=c,c=v)}else D=c,c=v;da--;c===v&&0===da&&e(gc);c!==v?a=c:(D=a,a=v)}else D=a,a=v;da--;a===v&&0===da&&e(gc);return a}function J(){var a;hc.test(b.charAt(D))?(a=b.charAt(D),D++):(a=v,0===da&&e(Ja));a===v&&(36===b.charCodeAt(D)?(a=Ha,D++):(a=v,0===da&&e(sc)),a===v&&(95===b.charCodeAt(D)?(a=Gb,D++):(a=v,0===da&&e(Za))));return a}function K(){var a;a=
J();a===v&&(a=C());return a}function I(){var a,c,d,f;a=D;42===b.charCodeAt(D)?(c=Ba,D++):(c=v,0===da&&e(Ga));c===v&&(47===b.charCodeAt(D)?(c=pb,D++):(c=v,0===da&&e(Da)),c===v&&(37===b.charCodeAt(D)?(c=ob,D++):(c=v,0===da&&e(Cb))));c!==v?(d=D,da++,61===b.charCodeAt(D)?(f=tc,D++):(f=v,0===da&&e(uc)),da--,f===v?d=void 0:(D=d,d=v),d!==v?a=c:(D=a,a=v)):(D=a,a=v);return a}function P(){var a,c,d;a=D;43===b.charCodeAt(D)?(c=Qb,D++):(c=v,0===da&&e(Ic));c!==v?(c=D,da++,43===b.charCodeAt(D)?(d=Qb,D++):(d=v,
0===da&&e(Ic)),d===v&&(61===b.charCodeAt(D)?(d=tc,D++):(d=v,0===da&&e(uc))),da--,d===v?c=void 0:(D=c,c=v),c!==v?a="+":(D=a,a=v)):(D=a,a=v);a===v&&(a=D,45===b.charCodeAt(D)?(c=Ca,D++):(c=v,0===da&&e(Fa)),c!==v?(c=D,da++,45===b.charCodeAt(D)?(d=Ca,D++):(d=v,0===da&&e(Fa)),d===v&&(61===b.charCodeAt(D)?(d=tc,D++):(d=v,0===da&&e(uc))),da--,d===v?c=void 0:(D=c,c=v),c!==v?a="-":(D=a,a=v)):(D=a,a=v));return a}function z(){var a;b.substr(D,2)===vc?(a=vc,D+=2):(a=v,0===da&&e(Kb));a===v&&(b.substr(D,2)===Jb?
(a=Jb,D+=2):(a=v,0===da&&e(Ib)));return a}function N(){var a;b.substr(D,2)===Ta?(a=Ta,D+=2):(a=v,0===da&&e(ab));a===v&&(b.substr(D,2)===ub?(a=ub,D+=2):(a=v,0===da&&e(Ra)),a===v&&(60===b.charCodeAt(D)?(a=Ea,D++):(a=v,0===da&&e(gb)),a===v&&(62===b.charCodeAt(D)?(a=vb,D++):(a=v,0===da&&e(Qa)))));return a}function G(){var a;b.substr(D,2)===tb?(a=tb,D+=2):(a=v,0===da&&e(ya));a===v&&(b.substr(D,2)===wa?(a=wa,D+=2):(a=v,0===da&&e(wb)));return a}function L(){var a,c,d;a=D;38===b.charCodeAt(D)?(c=qb,D++):
(c=v,0===da&&e(xa));c!==v?(c=D,da++,38===b.charCodeAt(D)?(d=qb,D++):(d=v,0===da&&e(xa)),da--,d===v?c=void 0:(D=c,c=v),c!==v?a="&":(D=a,a=v)):(D=a,a=v);return a}function O(){var a,c,d;a=D;94===b.charCodeAt(D)?(c=ic,D++):(c=v,0===da&&e(aa));c!==v?(c=D,da++,94===b.charCodeAt(D)?(d=ic,D++):(d=v,0===da&&e(aa)),da--,d===v?c=void 0:(D=c,c=v),c!==v?a="^":(D=a,a=v)):(D=a,a=v);return a}function W(){var a,c,d;a=D;124===b.charCodeAt(D)?(c=xb,D++):(c=v,0===da&&e(Na));c!==v?(c=D,da++,124===b.charCodeAt(D)?(d=xb,
D++):(d=v,0===da&&e(Na)),da--,d===v?c=void 0:(D=c,c=v),c!==v?a="|":(D=a,a=v)):(D=a,a=v);return a}function X(){var a;b.substr(D,2)===za?(a=za,D+=2):(a=v,0===da&&e(Aa));a!==v&&(a="&&");return a}function Y(){var a;b.substr(D,2)===jb?(a=jb,D+=2):(a=v,0===da&&e(Kc));a!==v&&(a="||");return a}function R(){var a,b;a=[];for(b=ga();b!==v;)a.push(b),b=ga();return a}function ga(){var a;da++;Rb.test(b.charAt(D))?(a=b.charAt(D),D++):(a=v,0===da&&e(hb));da--;a===v&&0===da&&e(Xa);return a}function ja(){var a;b.length>
D?(a=b.charAt(D),D++):(a=v,0===da&&e(xc));return a}var qa=1<arguments.length?arguments[1]:{},v={},Z={start:f},la=f,V=",",ha={type:"literal",value:",",description:'","'},ea="?",pa={type:"literal",value:"?",description:'"?"'},U=":",S={type:"literal",value:":",description:'":"'},fa="defined",ia={type:"literal",value:"defined",description:'"defined"'},sa="(",ra={type:"literal",value:"(",description:'"("'},Q=")",ca={type:"literal",value:")",description:'")"'},E={type:"other",description:"number"},T="0",
va={type:"literal",value:"0",description:'"0"'},M=/^[0-9]/,Xb={type:"class",value:"[0-9]",description:"[0-9]"},ma=/^[1-9]/,ua={type:"class",value:"[1-9]",description:"[1-9]"},sb=/^[xX]/,ba={type:"class",value:"[xX]",description:"[xX]"},Sa=/^[0-9a-fA-F]/,La={type:"class",value:"[0-9a-fA-F]",description:"[0-9a-fA-F]"},gc={type:"other",description:"identifier"},Ha="$",sc={type:"literal",value:"$",description:'"$"'},Gb="_",Za={type:"literal",value:"_",description:'"_"'},hc=/^[a-zA-Z]/,Ja={type:"class",
value:"[a-zA-Z]",description:"[a-zA-Z]"},Gc="++",Hc={type:"literal",value:"++",description:'"++"'},Bb="--",nb={type:"literal",value:"--",description:'"--"'},Qb="+",Ic={type:"literal",value:"+",description:'"+"'},Ca="-",Fa={type:"literal",value:"-",description:'"-"'},ka="~",Oc={type:"literal",value:"~",description:'"~"'},na="!",$a={type:"literal",value:"!",description:'"!"'},Ba="*",Ga={type:"literal",value:"*",description:'"*"'},pb="/",Da={type:"literal",value:"/",description:'"/"'},ob="%",Cb={type:"literal",
value:"%",description:'"%"'},tc="=",uc={type:"literal",value:"=",description:'"="'},vc="<<",Kb={type:"literal",value:"<<",description:'"<<"'},Jb=">>",Ib={type:"literal",value:">>",description:'">>"'},Ta="<=",ab={type:"literal",value:"<=",description:'"<="'},ub=">=",Ra={type:"literal",value:">=",description:'">="'},Ea="<",gb={type:"literal",value:"<",description:'"<"'},vb=">",Qa={type:"literal",value:">",description:'">"'},tb="==",ya={type:"literal",value:"==",description:'"=="'},wa="!=",wb={type:"literal",
value:"!=",description:'"!="'},qb="&",xa={type:"literal",value:"&",description:'"&"'},ic="^",aa={type:"literal",value:"^",description:'"^"'},xb="|",Na={type:"literal",value:"|",description:'"|"'},za="&&",Aa={type:"literal",value:"&&",description:'"&&"'},jb="||",Kc={type:"literal",value:"||",description:'"||"'},Xa={type:"other",description:"whitespace"},Rb=/^[\t\x0B\f ]/,hb={type:"class",value:"[\\t\\v\\f ]",description:"[\\t\\v\\f ]"},Lb={type:"other",description:"end of line"},jc="\n",Yb={type:"literal",
value:"\n",description:'"\\n"'},wc="\r\n",bb={type:"literal",value:"\r\n",description:'"\\r\\n"'},Zb="\r",Pc={type:"literal",value:"\r",description:'"\\r"'},xc={type:"any",description:"any character"},D=0,Mb=0,Ia={zi:1,Lg:1,Ui:!1},Ua=0,yb=[],da=0,kc;if("startRule"in qa){if(!(qa.Js in Z))throw Error("Can't start parsing from rule \""+qa.Js+'".');la=Z[qa.Js]}kc=la();if(kc!==v&&D===b.length)return kc;kc!==v&&D<b.length&&e({type:"end",description:"end of input"});throw function(d,e,f){function g(a){var b=
1;for(a.sort(function(a,b){return a.description<b.description?-1:a.description>b.description?1:0});b<a.length;)a[b-1]===a[b]?a.splice(b,1):b++}function h(a,b){function c(a){function b(a){return a.charCodeAt(0).toString(16).toUpperCase()}return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(a){return"\\x0"+b(a)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(a){return"\\x"+
b(a)}).replace(/[\u0100-\u0FFF]/g,function(a){return"\\u0"+b(a)}).replace(/[\u1000-\uFFFF]/g,function(a){return"\\u"+b(a)})}var d=Array(a.length),e;for(e=0;e<a.length;e++)d[e]=a[e].description;d=1<a.length?d.slice(0,-1).join(", ")+" or "+d[a.length-1]:d[0];e=b?'"'+c(b)+'"':"end of input";return"Expected "+d+" but "+e+" found."}var k=c(f),l=f<b.length?b.charAt(f):null;null!==e&&g(e);return new a(null!==d?d:h(e,l),0,0,f,k.zi,k.Lg)}(null,yb,Ua);}}}()};b4w.module.__md5=function(a){function p(a,f){var q=a[0],h=a[1],m=a[2],p=a[3],q=d(q,h,m,p,f[0],7,-680876936),p=d(p,q,h,m,f[1],12,-389564586),m=d(m,p,q,h,f[2],17,606105819),h=d(h,m,p,q,f[3],22,-1044525330),q=d(q,h,m,p,f[4],7,-176418897),p=d(p,q,h,m,f[5],12,1200080426),m=d(m,p,q,h,f[6],17,-1473231341),h=d(h,m,p,q,f[7],22,-45705983),q=d(q,h,m,p,f[8],7,1770035416),p=d(p,q,h,m,f[9],12,-1958414417),m=d(m,p,q,h,f[10],17,-42063),h=d(h,m,p,q,f[11],22,-1990404162),q=d(q,h,m,p,f[12],7,1804603682),p=d(p,q,h,m,
f[13],12,-40341101),m=d(m,p,q,h,f[14],17,-1502002290),h=d(h,m,p,q,f[15],22,1236535329),q=c(q,h,m,p,f[1],5,-165796510),p=c(p,q,h,m,f[6],9,-1069501632),m=c(m,p,q,h,f[11],14,643717713),h=c(h,m,p,q,f[0],20,-373897302),q=c(q,h,m,p,f[5],5,-701558691),p=c(p,q,h,m,f[10],9,38016083),m=c(m,p,q,h,f[15],14,-660478335),h=c(h,m,p,q,f[4],20,-405537848),q=c(q,h,m,p,f[9],5,568446438),p=c(p,q,h,m,f[14],9,-1019803690),m=c(m,p,q,h,f[3],14,-187363961),h=c(h,m,p,q,f[8],20,1163531501),q=c(q,h,m,p,f[13],5,-1444681467),p=
c(p,q,h,m,f[2],9,-51403784),m=c(m,p,q,h,f[7],14,1735328473),h=c(h,m,p,q,f[12],20,-1926607734),q=b(h^m^p,q,h,f[5],4,-378558),p=b(q^h^m,p,q,f[8],11,-2022574463),m=b(p^q^h,m,p,f[11],16,1839030562),h=b(m^p^q,h,m,f[14],23,-35309556),q=b(h^m^p,q,h,f[1],4,-1530992060),p=b(q^h^m,p,q,f[4],11,1272893353),m=b(p^q^h,m,p,f[7],16,-155497632),h=b(m^p^q,h,m,f[10],23,-1094730640),q=b(h^m^p,q,h,f[13],4,681279174),p=b(q^h^m,p,q,f[0],11,-358537222),m=b(p^q^h,m,p,f[3],16,-722521979),h=b(m^p^q,h,m,f[6],23,76029189),q=
b(h^m^p,q,h,f[9],4,-640364487),p=b(q^h^m,p,q,f[12],11,-421815835),m=b(p^q^h,m,p,f[15],16,530742520),h=b(m^p^q,h,m,f[2],23,-995338651),q=e(q,h,m,p,f[0],6,-198630844),p=e(p,q,h,m,f[7],10,1126891415),m=e(m,p,q,h,f[14],15,-1416354905),h=e(h,m,p,q,f[5],21,-57434055),q=e(q,h,m,p,f[12],6,1700485571),p=e(p,q,h,m,f[3],10,-1894986606),m=e(m,p,q,h,f[10],15,-1051523),h=e(h,m,p,q,f[1],21,-2054922799),q=e(q,h,m,p,f[8],6,1873313359),p=e(p,q,h,m,f[15],10,-30611744),m=e(m,p,q,h,f[6],15,-1560198380),h=e(h,m,p,q,f[13],
21,1309151649),q=e(q,h,m,p,f[4],6,-145523070),p=e(p,q,h,m,f[11],10,-1120210379),m=e(m,p,q,h,f[2],15,718787259),h=e(h,m,p,q,f[9],21,-343485551);a[0]=q+a[0]&4294967295;a[1]=h+a[1]&4294967295;a[2]=m+a[2]&4294967295;a[3]=p+a[3]&4294967295}function b(a,b,c,d,e,f){b=(b+a&4294967295)+(d+f&4294967295)&4294967295;return(b<<e|b>>>32-e)+c&4294967295}function d(a,c,d,e,f,p,n){return b(c&d|~c&e,a,c,f,p,n)}function c(a,c,d,e,f,p,n){return b(c&e|d&~e,a,c,f,p,n)}function e(a,c,d,e,f,p,n){return b(d^(c|~e),a,c,f,
p,n)}var f="0123456789abcdef".split("");a.Mq=function(a){var b=a,c=b.length;a=[1732584193,-271733879,-1732584194,271733878];var d;for(d=64;d<=b.length;d+=64){for(var e=b.substring(d-64,d),u=[],n=void 0,n=0;64>n;n+=4)u[n>>2]=e.charCodeAt(n)+(e.charCodeAt(n+1)<<8)+(e.charCodeAt(n+2)<<16)+(e.charCodeAt(n+3)<<24);p(a,u)}b=b.substring(d-64);e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(d=0;d<b.length;d++)e[d>>2]|=b.charCodeAt(d)<<(d%4<<3);e[d>>2]|=128<<(d%4<<3);if(55<d)for(p(a,e),d=0;16>d;d++)e[d]=0;e[14]=8*
c;p(a,e);for(b=0;b<a.length;b++){c=a[b];d="";for(e=0;4>e;e++)d+=f[c>>8*e+4&15]+f[c>>8*e&15];a[b]=d}return a.join("")}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"void main ( ) { gl_FragColor = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={type:"group",a:[{type:"var",name:"ANCHOR_NUM",b:["0"]},{type:"textline",b:"attribute float a_index ; uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; void main ( ) { vec4 a ; a = u_view_matrix * vec4 ( u_position [ int ( a_index ) ] , 1.0 ) ; gl_Position = u_proj_matrix * a ; gl_PointSize = 4.0 ; }".split(" ")}]};
a["color_id.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform vec3 u_color_id ; uniform vec4 u_diffuse_color ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_OUTLINE"],group:{type:"group",
a:[{type:"textline",b:["uniform","float","u_outline_intensity",";"]}]}}]},{type:"textline",b:"void main ( ) { float b ;".split(" ")},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"b = ( texture2D ( u_sampler , a ) ) . a ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"b = u_diffuse_color . a ;".split(" ")}]}}]},{type:"textline",b:"if ( b < 0.5 ) discard ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["USE_OUTLINE"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["color_id.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},
{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",
a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; attribute vec3 a_normal ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","||","BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",
a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"textline",
b:"void main ( ) { mat4 ck ; vec3 cl , cm , cn , co ; cl = a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"cl = mix ( cl , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"cm = vec3 ( 0.0 ) ; cn = vec3 ( 0.0 ) ; co = vec3 ( 0.0 ) ; bv ( cl , cm , cn , co ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","||","BILLBOARD"],
group:{type:"group",a:[{type:"textline",b:["cm","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"cm = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"cn = ( u_model_matrix * vec4 ( cm , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","&&","!","STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"ck = ao ( u_camera_eye , cn , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"ck = ai ( u_camera_eye , cn , u_view_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","&&","BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"co = ( u_model_matrix * vec4 ( cm , 1.0 ) ) . xyz ; ck = ck * aa ( u_wind , u_time , u_jitter_amp , u_jitter_freq , co ) ;".split(" ")}]}}]},{type:"textline",b:"d cp = av ( cl - cm , cm , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , ck ) ; cp . b = cn ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"d cp = av ( cl , cm , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL","&&","DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:["co","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"co = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:"cj ( cp . a , cp . b , co ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"a = ay ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{type:"textline",b:"gl_Position = u_proj_matrix * u_view_matrix * vec4 ( cp . a , 1.0 ) ; }".split(" ")}]};a["depth.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"textline",b:["uniform","vec4","u_diffuse_color",";"]},{type:"condition",
a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MASK_GENERATION"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_perspective_cast_far_bound",";"]}]}}]},{type:"textline",b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",
c:["SHADOW_USAGE","==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MASK_GENERATION"],group:{type:"group",a:[{type:"textline",b:"varying vec4 ck ; varying vec4 cl ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",
a:[{type:"textline",b:["varying","vec4","cm",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cn",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","co",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","cp",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["!","SHADELESS"],group:{type:"group",a:[{type:"include",file:"procedural.glslf"},{type:"include",file:"shadow.glslf"}]}}]},{type:"textline",b:"void main ( ) { float eG ;".split(" ")},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"eG = ( texture2D ( u_sampler , a ) ) . a ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"eG = u_diffuse_color . a ;".split(" ")}]}}]},
{type:"textline",b:"if ( eG < 0.5 ) discard ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:"SHADOW_USAGE == NO_SHADOWS || SHADOW_USAGE == SHADOW_CASTING".split(" "),group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}},{type:"elif",c:["SHADOW_USAGE","==","SHADOW_MASK_GENERATION"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( eA ( ck . z ) , 1.0 , 1.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["depth.glslv"]={type:"group",
a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:"WIND_BEND && MAIN_BEND_COL && DETAIL_BEND || SHADOW_USAGE == SHADOW_MASK_GENERATION".split(" "),
group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","||","DYNAMIC_GRASS","||","BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],
group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",
a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",
b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS","||","BILLBOARD"],group:{type:"group",a:[{type:"textline",
b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD","&&","SHADOW_USAGE","==","SHADOW_CASTING"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_shadow_cast_billboard_view_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],
group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",
b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MASK_GENERATION"],group:{type:"group",a:[{type:"textline",b:"uniform float u_normal_offset ; uniform mat4 u_v_light_matrix ; uniform mat4 u_b_light_matrix ; uniform mat4 u_p_light_matrix0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],
group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MASK_GENERATION"],group:{type:"group",a:[{type:"textline",b:"varying vec4 ck ; varying vec4 cl ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cm",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cn",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","co",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",a:[{type:"textline",
b:["varying","vec3","cp",";"]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"textline",b:"void main ( ) { float fz ; vec2 fA ; vec4 fB , fC ; mat4 fD , fE ; vec3 fF , fG , fH , fI ; fF = a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"fF = mix ( fF , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"fG = vec3 ( 0.0 ) ; fH = vec3 ( 0.0 ) ; fI = vec3 ( 0.0 ) ; bv ( fF , fG , fH , fI ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","||","DYNAMIC_GRASS","||","BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["fG","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"fG = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],
group:{type:"group",a:[{type:"textline",b:"d fJ = fk ( fF , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , fG , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"fH = ( u_model_matrix * vec4 ( fG , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:"! HAIR_BILLBOARD && SHADOW_USAGE == SHADOW_CASTING".split(" "),
group:{type:"group",a:[{type:"textline",b:["fD","=","u_shadow_cast_billboard_view_matrix",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["fD","=","u_view_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","&&","!","STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"fE = ao ( u_camera_eye , fH , fD , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"fE = ai ( u_camera_eye , fH , fD ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","&&","BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"fI = ( u_model_matrix * vec4 ( fG , 1.0 ) ) . xyz ; fE = fE * aa ( u_wind , u_time , u_jitter_amp , u_jitter_freq , fI ) ;".split(" ")}]}}]},{type:"textline",b:"d fJ = av ( fF - fG , fG , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , fE ) ; fJ . b = fH ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"d fJ = av ( fF , fG , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL","&&","DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:["fI","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"fI = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:"cj ( fJ . a , fJ . b , fI ) ;".split(" ")}]}}]},{type:"textline",b:"fB = u_view_matrix * vec4 ( fJ . a , 1.0 ) ; fC = u_proj_matrix * fB ;".split(" ")},{type:"condition",a:[{type:"if",
c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:"fC . xy += u_subpixel_jitter * fC . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"a = ay ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MASK_GENERATION"],group:{type:"group",a:[{type:"textline",b:"fu ( fJ . a ) ; ck = fB ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_CASTING"],
group:{type:"group",a:[{type:"textline",b:"fA = ( u_proj_matrix * u_view_matrix [ 3 ] ) . xy ; fz = SHADOW_TEX_RES / 2.0 ; fA = floor ( fA * fz + 0.5 ) / fz - fA ; fC . xy += fA ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","fC",";","}"]}]};a["grass_map.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",
b:["varying","vec4","fz",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["varying","float","fz",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fz",";"]}]}}]}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",
a:[{type:"textline",b:["gl_FragColor","=","fz",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( fz , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , fz ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["}"]}]};
a["grass_map.glslv"]={type:"group",a:[{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_grass_size",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_grass_color",";"]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],
group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","&&","BILLBOARD_JITTERED"],
group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fz",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["varying","float","fz",";"]}]}}]}]}},{type:"else",group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fz",";"]}]}}]}]}}]},{type:"textline",b:"void main ( ) { vec4 fA ; mat4 fB ; vec3 fC ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"fC = ( u_model_matrix * vec4 ( vec3 ( 0.0 ) , 1.0 ) ) . xyz ; fB = ai ( u_camera_eye , fC , u_view_matrix ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WIND_BEND","&&","BILLBOARD_JITTERED"],
group:{type:"group",a:[{type:"textline",b:"fB = fB * aa ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",b:"d fD = av ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , fB ) ; fD . b = fC ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"d fD = av ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]},{type:"textline",b:"fA = u_proj_matrix * u_view_matrix * vec4 ( fD . a , 1.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:"fz = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["fz","=","a_grass_size",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["fz","=","a_grass_color",";"]}]}}]}]}}]},
{type:"textline",b:["gl_Position","=","fA",";","}"]}]};a["halo.glslf"]={type:"group",a:[{type:"var",name:"NUM_LINES",b:["0"]},{type:"var",name:"NUM_RINGS",b:["0"]},{type:"var",name:"NUM_STARS",b:["0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_intensity",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","&&","!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ; varying vec4 fH ;".split(" ")}]}}]}]}}]},{type:"textline",b:"varying vec2 a ; varying float fI ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_RINGS",
">","NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"const int fJ = NUM_RINGS ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"const int fJ = NUM_LINES ;".split(" ")}]}}]},{type:"textline",b:"float fL ( float fK ) { return fK - floor ( fK * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"void fU ( inout float fM , in float fN [ fJ ] , in float fO ) { float fP , fQ , fR , fS ; for ( int fT = 0 ; fT < NUM_RINGS ; fT ++ ) { fP = 40.0 * fN [ fT ] ; fQ = 300.0 * ( fL ( fP ) - 0.005 ) ; fR = fP ; fS = abs ( fR * ( u_halo_size * fQ - fO ) ) ; fM += 1.0 - min ( fS , 1.0 ) ; } }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"void gc ( inout float fV , in float fW [ fJ ] , in float fX ) { float fY , fZ , f_ , ga ; for ( int gb = 0 ; gb < NUM_LINES ; gb ++ ) { fY = fW [ gb ] ; fZ = fY ; f_ = 1000.0 * ( fL ( fY ) - 0.005 ) ; ga = 20.0 * abs ( fZ * a . x + f_ * a . y ) ; fV += 1.0 - min ( ga , 1.0 ) ; } fV *= fX ; }".split(" ")}]}}]},{type:"textline",b:"void gj ( inout float gd , in vec2 ge ) { float gf , gg , gh , gi ; gg = atan ( ge . y , ge . x ) ; gg *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; gh = cos ( gg ) ; gi = sin ( gg ) ; gg = ( gh * ge . x + gi * ge . y ) * ( gh * ge . y - gi * ge . x ) ; gf = abs ( gg ) ; if ( gf < 1.0 ) { gf = ( 0.01 * u_halo_size ) / ( gf ) ; gd *= sqrt ( min ( gf , 1.0 ) ) ; } } void main ( ) { vec3 gk ; float gl , gm , gn , go ; gl = ( a . x * a . x + a . y * a . y ) ; gm = sqrt ( gl ) ; gl = max ( 1.0 - gl , 0.0 ) ; gl = pow ( gl , u_halo_hardness ) ; gn = u_diffuse_color . a ;".split(" ")},
{type:"condition",a:[{type:"if",c:["NUM_RINGS","||","NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"float gp [ fJ ] ; for ( int gq = 0 ; gq < fJ ; gq ++ ) { gp [ gq ] = fract ( fI / ( float ( gq ) + 0.01 ) ) - 1.0 ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"go = 0.0 ; fU ( go , gp , gm ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"gm = 0.0 ; gc ( gm , gp , gl ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["NUM_STARS"],group:{type:"group",a:[{type:"textline",b:"gj ( gl , a ) ;".split(" ")}]}}]},{type:"textline",b:"gl *= gn ; gk = u_diffuse_color . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"go *= gl ; gk += u_halo_rings_color * go ; gl += go ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"gm *= gn ; gk += u_halo_lines_color * gm ; gl += gm ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:"gl *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","&&","!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:"go = u_halo_stars_blend * ( fH . y - u_halo_stars_height ) ; gl *= clamp ( go , 0.0 , 1.0 ) ; gl *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:"fD ( gk ) ; fG ( gk , gl ) ; gl_FragColor = vec4 ( gk , gl ) ; }".split(" ")}]};
a["halo.glslv"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:"attribute vec3 a_position ; attribute vec2 a_halo_bb_vertex ; uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ; uniform PRECISION float u_halo_size ; varying vec2 a ; varying float fI ;".split(" ")},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","&&","!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fH",";"]}]}}]},{type:"textline",b:"void main ( ) { vec4 fJ , fK ; mat4 fL , fM ; vec3 fN ; fN = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; a = a_halo_bb_vertex * 2.0 ; fI = fract ( fN . x + fN . y + fN . z ) ;".split(" ")},{type:"condition",a:[{type:"if",
c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:"fL = N ( fN , u_view_matrix ) ; fM = u_view_matrix ; fM [ 3 ] [ 0 ] = 0.0 ; fM [ 3 ] [ 1 ] = 0.0 ; fM [ 3 ] [ 2 ] = 0.0 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"fL = N ( fN , u_view_matrix ) ;".split(" ")}]}}]},{type:"textline",b:"fJ = vec4 ( a_halo_bb_vertex * 2.0 * u_halo_size , 0.0 , 1.0 ) ; fJ = fL * fJ ;".split(" ")},{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",
b:"fK = u_proj_matrix * fM * fJ ; fK . z = 0.99999 * fK . w ;".split(" ")},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","&&","!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["fH","=","fJ",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"fK = u_proj_matrix * u_view_matrix * fJ ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","fK",";","}"]}]};a["line.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform vec4 u_diffuse_color ; void main ( ) { gl_FragColor = u_diffuse_color ; }".split(" ")}]};
a["line.glslv"]={type:"group",a:[{type:"var",name:"NUM_POINTS",b:["0"]},{type:"textline",b:"attribute float a_point ; uniform vec3 u_line_points [ NUM_POINTS ] ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; void main ( ) { vec3 fJ ; fJ = u_line_points [ int ( a_point ) ] ; gl_Position = u_proj_matrix * u_view_matrix * vec4 ( fJ , 1.0 ) ; }".split(" ")}]};a["main.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",
b:["0"]},{type:"var",name:"NUM_VALUES",b:["0"]},{type:"var",name:"NUM_RGBS",b:["0"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"PARALLAX_STEPS",b:["0.0"]},{type:"var",name:"PARALLAX_LOD_DIST",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"fog.glslf"},{type:"condition",a:[{type:"if",c:["!",
"SHADELESS"],group:{type:"group",a:[{type:"include",file:"lighting.glslf"},{type:"include",file:"procedural.glslf"},{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"include",file:"caustics.glslf"}]}}]}]}}]},{type:"include",file:"gamma.glslf"},{type:"include",file:"math.glslv"},{type:"textline",b:["uniform","float","u_time",";"]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","&&","SKY_TEXTURE"],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube",
"u_sky_texture",";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT","&&","SKY_COLOR"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",a:[{type:"if",c:["!","SHADELESS"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",">","0"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","&&","CAUSTICS"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_sun_quaternion",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye_frag",";"]}]}}]},{type:"condition",a:[{type:"if",c:"NORMAL_TEXCOORD || REFLECTION_TYPE == REFL_PLANE || USE_NODE_B4W_VECTOR_VIEW".split(" "),group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_view_matrix_frag",
";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","||","!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_intensity",
";"]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","&&","CAUSTICS"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_direction",";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG","&&","PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["TEXTURE_SPEC","&&","!","ALPHA_AS_SPEC"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_STENCIL_ALPHA_MASK"],group:{type:"group",a:[{type:"textline",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE",
"==","REFL_PLANE"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","==","REFL_CUBE"],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","==","REFL_MIRRORMAP"],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",
a:[{type:"textline",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{type:"elif",c:["SHADOW_USAGE","==","SHADOW_MAPPING_BLEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_perspective_cast_far_bound",";"]}]}}]},{type:"textline",b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],
group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","||","USE_NODE_B4W_REFRACTION"],group:{type:"group",
a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]},{type:"condition",a:[{type:"if",c:["!","NODES","||","USE_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{type:"textline",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{type:"condition",a:[{type:"if",c:"REFLECTION_TYPE == REFL_PLANE || REFLECTION_TYPE == REFL_CUBE".split(" "),
group:{type:"group",a:[{type:"textline",b:["uniform","float","u_reflect_factor",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","==","REFL_MIRRORMAP"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","==","REFL_PLANE"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_LAMP"],
group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_VALUE"],group:{type:"group",a:[{type:"textline",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_RGB"],
group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_normal_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO"],group:{type:"group",a:[{type:"textline",
b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_SPEC"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{type:"textline",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","&&","PARALLAX"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_parallax_scale",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_refr_bump",";"]}]}}]}]}}]},{type:"textline",b:["varying","vec3","jV",";"]},{type:"condition",a:[{type:"if",c:"! NODES || USE_NODE_MATERIAL || USE_NODE_MATERIAL_EXT || USE_NODE_GEOMETRY_NO || CAUSTICS || CALC_TBN_SPACE || USE_NODE_TEX_COORD_NO".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec3","jW",";"]}]}}]},{type:"condition",a:[{type:"if",c:"NODES || ! DISABLE_FOG || ( TEXTURE_NORM_CO && PARALLAX ) || ( WATER_EFFECTS && CAUSTICS )".split(" "),
group:{type:"group",a:[{type:"textline",b:["varying","vec4","ck",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","||","CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","jX",";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","NODES"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","jY",";"]},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["VERTEX_COLOR","||","DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","jZ",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_BLEND"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cl",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cm",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying",
"vec4","cn",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","co",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:"REFLECTION_TYPE == REFL_PLANE || SHADOW_USAGE == SHADOW_MAPPING_OPAQUE || REFRACTIVE || USE_NODE_B4W_REFRACTION".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec3","cp",";"]}]}}]},{type:"condition",a:[{type:"if",c:"REFRACTIVE && ( ! NODES || USE_NODE_B4W_REFRACTION )".split(" "),group:{type:"group",
a:[{type:"textline",b:["varying","float","j_",";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","SHADELESS"],group:{type:"group",a:[{type:"include",file:"shadow.glslf"}]}}]},{type:"include",file:"mirror.glslf"},{type:"condition",a:[{type:"if",c:"REFRACTIVE && ( ! NODES || USE_NODE_B4W_REFRACTION )".split(" "),group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]},{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"include",
file:"nodes.glslf"}]}}]},{type:"textline",b:"void main ( ) { vec4 vW , vX , vY , vZ ; mat3 v_ ; vec2 wa , wb , wc , wd ; vec3 we , wf , wg , wh , wi , wj , wk , wl , wm ; float wn , wo , wp , wq , wr , ws , wt ;".split(" ")},{type:"condition",a:[{type:"if",c:"NODES || ! DISABLE_FOG || ( TEXTURE_NORM_CO && PARALLAX ) || ( WATER_EFFECTS && CAUSTICS )".split(" "),group:{type:"group",a:[{type:"textline",b:"wn = length ( ck ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",
a:[{type:"textline",b:"wo = jV . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:"WATER_EFFECTS || ! DISABLE_FOG || ( CAUSTICS && WATER_EFFECTS )".split(" "),group:{type:"group",a:[{type:"textline",b:["we","=","u_sun_intensity",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:"wf = normalize ( u_camera_eye_frag - jV ) ; vV ( wf , wg , wh , wi , wp , wq ) ; wh = wg ; wq = wq ; wg = wi ; wp = wp ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["wa","=","a",";"]}]}}]},{type:"textline",b:["wi","=","jW",";"]},{type:"condition",a:[{type:"if",c:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",a:[{type:"textline",b:"if ( gl_FrontFacing ) wi = wi ; else wi = - wi ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:"wj = cross ( wi , jX . xyz ) * jX . w ; v_ = mat3 ( jX . xyz , wj , wi ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"wb = normalize ( u_view_matrix_frag * vec4 ( jW , 0.0 ) ) . st ; wb = wb * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","&&","PARALLAX"],group:{type:"group",a:[{type:"textline",b:"if ( wn < PARALLAX_LOD_DIST ) { wr = clamp ( 0.5 * ( PARALLAX_LOD_DIST - wn ) , 0.0 , 1.0 ) ; wr = u_parallax_scale * wr ; wj = normalize ( jY * v_ ) ; ws = 1.0 / PARALLAX_STEPS ; wc = wj . xy * wr / ( PARALLAX_STEPS * wj . z ) ; wr = 1.0 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","==","TEXTURE_COORDS_NORMAL"],group:{type:"group",a:[{type:"textline",b:["wd","=","wb",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["wd","=","wa",";"]}]}}]},{type:"textline",b:"wt = texture2D ( u_normalmap0 , wd ) . a ; for ( float wu = 1.0 ; wu <= PARALLAX_STEPS ; wu ++ ) { if ( wt < wr ) { wr -= ws ; wd -= wc ; wt = texture2D ( u_normalmap0 , wd ) . a ; } } wc = wd + wc ; ws = texture2D ( u_normalmap0 , wc ) . a - ( wr + ws ) ; wt = wt - wr ; wr = wt / ( wt - ws ) ; wd = wr * wc + ( 1.0 - wr ) * wd ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","==","TEXTURE_COORDS_NORMAL"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"wa += wd - wb ;".split(" ")}]}}]},{type:"textline",b:["wb","=","wd",";"]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"wb += wd - wa ;".split(" ")}]}}]},{type:"textline",b:["wa","=","wd",";"]}]}}]},{type:"textline",
b:["}"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:[";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","==","TEXTURE_COORDS_NORMAL"],group:{type:"group",a:[{type:"textline",b:"vW = texture2D ( u_normalmap0 , wb ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vW = texture2D ( u_normalmap0 , wa ) ;".split(" ")}]}}]},{type:"textline",b:"wj = vW . rgb - 0.5 ; wj = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , wj , u_normal_factor ) ; wg = v_ * wj ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["wg","=","wi",";"]}]}}]},{type:"textline",b:"wg = normalize ( wg ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"wb = normalize ( u_view_matrix_frag * vec4 ( wg , 0.0 ) ) . st ; wb = wb * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:"wf = normalize ( jY ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","||","DYNAMIC_GRASS"],group:{type:"group",
a:[{type:"textline",b:"wj = jZ ; fB ( wj ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","||","DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"vW = vec4 ( wj , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["vW","=","u_diffuse_color",";"]}]}}]},{type:"textline",b:["wt","=","1.0",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO","==","TEXTURE_COORDS_NORMAL"],group:{type:"group",a:[{type:"textline",b:"vX = texture2D ( u_colormap0 , wb ) ;".split(" ")}]}},
{type:"elif",c:["TEXTURE_COLOR0_CO","==","TEXTURE_COORDS_UV_ORCO"],group:{type:"group",a:[{type:"textline",b:"vX = texture2D ( u_colormap0 , wa ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO"],group:{type:"group",a:[{type:"textline",b:"fB ( vX . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_STENCIL_ALPHA_MASK"],group:{type:"group",a:[{type:"textline",b:[";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR1_CO","==","TEXTURE_COORDS_NORMAL"],group:{type:"group",
a:[{type:"textline",b:"vY = texture2D ( u_colormap1 , wb ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vY = texture2D ( u_colormap1 , wa ) ;".split(" ")}]}}]},{type:"textline",b:"fB ( vY . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_STENCIL_ALPHA_MASK_CO","==","TEXTURE_COORDS_NORMAL"],group:{type:"group",a:[{type:"textline",b:"vZ = texture2D ( u_stencil0 , wb ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vZ = texture2D ( u_stencil0 , wa ) ;".split(" ")}]}}]},
{type:"textline",b:"vX = mix ( vX , vY , vZ . r ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_BLEND_TYPE","==","TEXTURE_BLEND_TYPE_MIX"],group:{type:"group",a:[{type:"textline",b:"vW . rgb = mix ( vW . rgb , vX . rgb , u_diffuse_color_factor ) ; ws = u_alpha_factor * vX . a ; ws += ( 1.0 - step ( 0.0 , ws ) ) ; vW . a = mix ( ws , 1.0 , u_diffuse_color . a ) ; wt = vX . a ;".split(" ")}]}},{type:"elif",c:["TEXTURE_BLEND_TYPE","==","TEXTURE_BLEND_TYPE_MULTIPLY"],group:{type:"group",
a:[{type:"textline",b:"vW . rgb *= mix ( vec3 ( 1.0 ) , vX . rgb , u_diffuse_color_factor ) ; vW . a = vX . a ; wt = vX . a ;".split(" ")}]}}]}]}}]},{type:"textline",b:"wi = u_diffuse_intensity * vW . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHADELESS"],group:{type:"group",a:[{type:"textline",b:["wh","=","wi",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wj = u_environment_energy * kK ( wg ) ; wj = u_ambient * wj ; wp = eF ( wi ) ; wk = u_emit * vW . rgb ; wl = u_specular_color ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXTURE_SPEC"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["ALPHA_AS_SPEC"],group:{type:"group",a:[{type:"textline",b:"wm = vec3 ( wt ) ;".split(" ")}]}},{type:"elif",c:["TEXTURE_SPEC_CO","==","TEXTURE_COORDS_NORMAL"],group:{type:"group",a:[{type:"textline",b:"wm = texture2D ( u_specmap0 , wb ) . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wm = texture2D ( u_specmap0 , wa ) . rgb ;".split(" ")}]}}]},{type:"textline",
b:"fB ( wm . rgb ) ; wl = mix ( wl , wm , u_specular_color_factor ) ;".split(" ")}]}}]},{type:"textline",b:"wr = u_specular_params [ 0 ] ; wc = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; wm = wr * wl ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS","==","0"],group:{type:"group",a:[{type:"textline",b:"gN wv = jB ( wk , wj , wi ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gN wv = jw ( wk , wj , wi , wm , jV , wg , wf , wc , u_diffuse_params , wp , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , 0.0 , vec4 ( 0.0 ) ) ;".split(" ")}]}}]},
{type:"textline",b:"wh = wv . a . rgb ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:"REFLECTION_TYPE == REFL_PLANE || REFLECTION_TYPE == REFL_CUBE".split(" "),group:{type:"group",a:[{type:"textline",b:"kt ( wh , wf , wg , u_reflect_factor ) ;".split(" ")}]}},{type:"elif",c:["REFLECTION_TYPE","==","REFL_MIRRORMAP"],group:{type:"group",a:[{type:"textline",b:"kt ( wh , wf , wg , 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["!","SHADELESS"],group:{type:"group",a:[{type:"textline",
b:"wh += wv . b ;".split(" ")}]}}]},{type:"textline",b:"wq = vW . a ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["!","SHADELESS"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WETTABLE"],group:{type:"group",a:[{type:"textline",b:"wh = max ( wh - sqrt ( 0.01 * - min ( wo , 0.0 ) ) , 0.5 * wh ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"textline",b:"jU ( wh , wo , u_time , wp , wg , u_sun_direction , we , u_sun_quaternion , jV , wn ) ;".split(" ")}]}}]}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["ALPHA_CLIP"],group:{type:"group",a:[{type:"textline",b:"if ( wq <= 0.5 ) discard ; wq = 1.0 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["!","SHADELESS","&&","!","NODES"],group:{type:"group",a:[{type:"textline",b:"wq += wv . a . a * wm . r * u_specular_alpha ;".split(" ")}]}}]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["!","NODES_GLOW"],group:{type:"group",a:[{type:"textline",b:["wq","=","1.0",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["!","NODES"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"wh = mix ( kH ( cp , wg . xz * u_refr_bump ) , wh , wq ) ; wq = 1.0 ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:"! DISABLE_FOG && ( ! PROCEDURAL_FOG || WATER_EFFECTS )".split(" "),group:{type:"group",a:[{type:"textline",b:"ws = clamp ( length ( u_sun_intensity ) + u_environment_energy , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:"wl = gl ( u_cube_fog , wf ) ; vY = vec4 ( wl , u_fog_color_density . a ) ; fB ( vY . rgb ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vY = u_fog_color_density ; vY . rgb *= ws ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"gB ( wh , wn , wf , u_cam_water_depth , u_underwater_fog_color_density , vY , wo , ws ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"gf ( wh , wn , vY ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SSAO_ONLY","&&","SHADOW_USAGE","==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",a:[{type:"textline",b:"wd = texture2DProj ( u_shadow_mask , cp ) . rg ; wt = wd . g ; wh = vec3 ( wt ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:"SSAO_ONLY && SHADOW_USAGE == SHADOW_MAPPING_OPAQUE && ! SHADELESS".split(" "),
group:{type:"group",a:[{type:"textline",b:"wh = vec3 ( dh . a ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["fD","(","wh",")",";"]},{type:"condition",a:[{type:"if",c:"ALPHA && ! ALPHA_CLIP || NODES_GLOW".split(" "),group:{type:"group",a:[{type:"textline",b:"fG ( wh , wq ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( wh , wq ) ; }".split(" ")}]};a["main.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"PRECISION",
b:["lowp"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:"! NODES || USE_NODE_MATERIAL || USE_NODE_MATERIAL_EXT || USE_NODE_GEOMETRY_NO || CAUSTICS || CALC_TBN_SPACE || WIND_BEND && MAIN_BEND_COL && DETAIL_BEND || USE_NODE_TEX_COORD_NO".split(" "),
group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","||","CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","||","DYNAMIC_GRASS","||","BILLBOARD"],group:{type:"group",a:[{type:"textline",
b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]},{type:"condition",a:[{type:"if",c:"! NODES || USE_NODE_MATERIAL || USE_NODE_MATERIAL_EXT || USE_NODE_GEOMETRY_NO || CAUSTICS || CALC_TBN_SPACE || USE_NODE_TEX_COORD_NO".split(" "),
group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal_next",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","||","CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["!","NODES"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR"],
group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_color",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["!","NODES","||","BILLBOARD"],group:{type:"group",
a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],
group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","NODES"],group:{type:"group",
a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_BLEND"],group:{type:"group",a:[{type:"textline",b:"uniform float u_normal_offset ; uniform mat4 u_v_light_matrix ; uniform mat4 u_b_light_matrix ; uniform mat4 u_p_light_matrix0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","||","USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"textline",b:["varying","vec3","jV",";"]},{type:"condition",
a:[{type:"if",c:"! NODES || USE_NODE_MATERIAL || USE_NODE_MATERIAL_EXT || USE_NODE_GEOMETRY_NO || CAUSTICS || CALC_TBN_SPACE || USE_NODE_TEX_COORD_NO".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec3","jW",";"]}]}}]},{type:"condition",a:[{type:"if",c:"NODES || ! DISABLE_FOG || ( TEXTURE_NORM_CO && PARALLAX ) || ( WATER_EFFECTS && CAUSTICS )".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec4","ck",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO",
"||","CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","jX",";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","NODES"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","jY",";"]},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","||","DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","jZ",";"]}]}}]}]}}]},{type:"condition",
a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_BLEND"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cl",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cm",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cn",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","co",
";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:"REFLECTION_TYPE == REFL_PLANE || SHADOW_USAGE == SHADOW_MAPPING_OPAQUE || REFRACTIVE || USE_NODE_B4W_REFRACTION".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec3","cp",";"]}]}}]},{type:"condition",a:[{type:"if",c:"REFRACTIVE && ( ! NODES || USE_NODE_B4W_REFRACTION )".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","float","j_",";"]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},
{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec4 wa , wb ; float wc , wd , we ; mat4 wf ; vec3 wg , wh , wi , wj , wk , wl , wm ; wg = a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:"CALC_TBN_SPACE || USE_NODE_MATERIAL || USE_NODE_MATERIAL_EXT || USE_NODE_GEOMETRY_NO || CAUSTICS || WIND_BEND && MAIN_BEND_COL && DETAIL_BEND || ! NODES".split(" "),
group:{type:"group",a:[{type:"textline",b:["wh","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wh = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:"CALC_TBN_SPACE || ! NODES && TEXTURE_NORM_CO == TEXTURE_COORDS_UV_ORCO".split(" "),group:{type:"group",a:[{type:"textline",b:"wi = vec3 ( a_tangent ) ; wj = a_tangent [ 3 ] * cross ( wh , wi ) ;".split(" ")}]}},{type:"elif",c:"! NODES && TEXTURE_NORM_CO == TEXTURE_COORDS_NORMAL".split(" "),group:{type:"group",
a:[{type:"textline",b:"wk = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; wl = normalize ( ( u_model_matrix * vec4 ( a_normal , 0.0 ) ) . xyz ) ; wk = wk - u_camera_eye ; wj = cross ( wk , wl ) ; wi = cross ( wl , wj ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wi = vec3 ( 0.0 ) ; wj = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"wg = mix ( wg , a_position_next , u_va_frame_factor ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:"! NODES || USE_NODE_MATERIAL || USE_NODE_MATERIAL_EXT || USE_NODE_GEOMETRY_NO || CAUSTICS || CALC_TBN_SPACE".split(" "),group:{type:"group",a:[{type:"textline",b:"wh = mix ( wh , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:"wk = vec3 ( a_tangent ) ; wl = a_tangent_next [ 3 ] * cross ( a_normal_next , wk ) ; wi = mix ( wi , wk , u_va_frame_factor ) ; wj = mix ( wj , wl , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"bv ( wg , wi , wj , wh ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","||","DYNAMIC_GRASS","||","BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["wk","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wk = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"d wn = fk ( wg , wi , wj , wh , wk , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"wl = ( u_model_matrix * vec4 ( wk , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","&&","!","STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"wf = ao ( u_camera_eye , wl , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wf = ai ( u_camera_eye , wl , u_view_matrix ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","&&","BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"wm = ( u_model_matrix * vec4 ( wk , 1.0 ) ) . xyz ; wf = wf * aa ( u_wind , u_time , u_jitter_amp , u_jitter_freq , wm ) ;".split(" ")}]}}]},{type:"textline",b:"d wn = av ( wg - wk , wk , wi , wj , wh , wf ) ; wn . b = wl ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"d wn = av ( wg , wk , wi , wj , wh , u_model_matrix ) ;".split(" ")}]}}]}]}}]},{type:"condition",
a:[{type:"if",c:["TEXTURE_NORM_CO","||","CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"wc = ( dot ( cross ( wn . e , wn . c ) , wn . d ) < 0.0 ) ? - 1.0 : 1.0 ; jX = vec4 ( wn . c , wc ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"cj ( wn . a , wn . b , wh ) ;".split(" ")}]}}]},{type:"textline",b:"jV = wn . a ;".split(" ")},{type:"condition",a:[{type:"if",c:"! NODES || USE_NODE_MATERIAL || USE_NODE_MATERIAL_EXT || USE_NODE_GEOMETRY_NO || CAUSTICS || CALC_TBN_SPACE || WIND_BEND && MAIN_BEND_COL && DETAIL_BEND".split(" "),
group:{type:"group",a:[{type:"textline",b:"jW = wn . e ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["!","NODES"],group:{type:"group",a:[{type:"textline",b:"jY = u_camera_eye - wn . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"a = ay ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"jZ = wn . f ;".split(" ")}]}},{type:"elif",c:["VERTEX_COLOR"],
group:{type:"group",a:[{type:"textline",b:["jZ","=","a_color",";"]}]}}]}]}}]},{type:"textline",b:"wa = u_view_matrix * vec4 ( wn . a , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:"NODES || ! DISABLE_FOG || ( TEXTURE_NORM_CO && PARALLAX ) || ( WATER_EFFECTS && CAUSTICS )".split(" "),group:{type:"group",a:[{type:"textline",b:["ck","=","wa",";"]}]}}]},{type:"textline",b:"wb = u_proj_matrix * wa ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",
b:"wb . xy += u_subpixel_jitter * wb . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",a:[{type:"textline",b:["fu","(","wb",")",";"]}]}},{type:"elif",c:["SHADOW_USAGE","==","SHADOW_MAPPING_BLEND"],group:{type:"group",a:[{type:"textline",b:"fu ( wn . a ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:"REFLECTION_TYPE == REFL_PLANE || SHADOW_USAGE == SHADOW_MAPPING_OPAQUE || REFRACTIVE || USE_NODE_B4W_REFRACTION".split(" "),
group:{type:"group",a:[{type:"textline",b:"wc = wb . x ; wd = wb . y ; we = wb . w ; cp . x = ( wc + we ) / 2.0 ; cp . y = ( wd + we ) / 2.0 ; cp . z = we ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:"REFRACTIVE && ( ! NODES || USE_NODE_B4W_REFRACTION )".split(" "),group:{type:"group",a:[{type:"textline",b:"j_ = - wa . z / u_view_max_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:["v_","(",")",";"]}]}}]},{type:"textline",b:["gl_Position",
"=","wb",";","}"]}]};a["particles_color.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"fog.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform float u_p_alpha_start ; uniform float u_p_alpha_end ; uniform vec4 u_fog_color_density ; varying float wa ; varying vec3 jZ ;".split(" ")},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","ck",
";"]}]}}]},{type:"textline",b:"void main ( ) { vec3 wb ; float wc ; wc = 2.0 * sqrt ( ( gl_PointCoord . x - 0.5 ) * ( gl_PointCoord . x - 0.5 ) + ( gl_PointCoord . y - 0.5 ) * ( gl_PointCoord . y - 0.5 ) ) ; wc = smoothstep ( u_p_alpha_start , u_p_alpha_end , wc ) ; wc = u_diffuse_color . a * wa * ( 1.0 - clamp ( wc , 0.0 , 1.0 ) ) ; wb = jZ * u_diffuse_color . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:"gf ( wb , length ( ck ) , u_fog_color_density ) ;".split(" ")}]}}]},
{type:"textline",b:["fD","(","wb",")",";"]},{type:"condition",a:[{type:"if",c:["ALPHA","&&","!","ALPHA_CLIP"],group:{type:"group",a:[{type:"textline",b:"fG ( wb , wc ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( wb , wc ) ; }".split(" ")}]};a["particles_color.glslv"]={type:"group",a:[{type:"var",name:"COLOR_RAMP_LENGTH",b:["0"]},{type:"var",name:"SIZE_RAMP_LENGTH",b:["0"]},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_p_delay ; attribute float a_p_lifetime ; attribute vec4 a_p_vels ;".split(" ")},
{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"uniform vec2 u_p_size_ramp [ SIZE_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"textline",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform vec3 u_p_wind ; uniform float u_p_max_lifetime ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_p_size ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","WORLD_SPACE"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"varying float wa ; varying vec3 jZ ; varying vec3 ck ;".split(" ")},{type:"include",file:"particles.glslv"},{type:"textline",b:"void main ( ) { float wO ; vec4 wP ; wb wQ ; wQ = wN ( ) ; wP = u_view_matrix * vec4 ( wQ . b , 1.0 ) ; gl_Position = u_proj_matrix * wP ; wa = wQ . c ; jZ = wQ . d ; ck = wP . xyz ; wO = u_height * u_proj_matrix [ 1 ] [ 1 ] * u_p_size / gl_Position . z ; gl_PointSize = wQ . a * wO ; }".split(" ")}]};
a["particles_texture.glslf"]={type:"group",a:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"lighting.glslf"},{type:"include",file:"fog.glslf"},{type:"var",name:"PARTICLES_SHADELESS",b:["0"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",
a:[{type:"if",c:["NUM_LIGHTS",">","0"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",
a:[{type:"textline",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","&&","SKY_TEXTURE"],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT","&&","SKY_COLOR"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; varying float wa ; varying vec3 jZ ; varying vec2 a ; varying vec3 jY ; varying vec3 jV ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","ck",";"]}]}}]},{type:"include",file:"environment.glslf"},{type:"textline",b:"void main ( ) { vec2 wO ; float wP ; vec3 wQ , wR , wS , wT , wU , wV ; vec4 wW , wX ; wW = u_diffuse_color ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"wX = texture2D ( u_sampler , a ) ; fB ( wX . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",
c:["TEXTURE_BLEND_TYPE","==","TEXTURE_BLEND_TYPE_MIX"],group:{type:"group",a:[{type:"textline",b:"wW . rgb = mix ( wW . rgb , wX . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{type:"elif",c:["TEXTURE_BLEND_TYPE","==","TEXTURE_BLEND_TYPE_MULTIPLY"],group:{type:"group",a:[{type:"textline",b:"wW . rgb *= mix ( vec3 ( 1.0 ) , wX . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},{type:"textline",b:"wW . a = wX . a ;".split(" ")}]}}]},{type:"textline",b:"wW . rgb *= jZ ; wQ = u_diffuse_intensity * wW . rgb ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","PARTICLES_SHADELESS"],group:{type:"group",a:[{type:"textline",b:"wR = u_emit * wW . rgb ; wS = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:"USE_ENVIRONMENT_LIGHT && ! SKY_TEXTURE && SKY_COLOR".split(" "),group:{type:"group",a:[{type:"textline",b:"wT = u_environment_energy * kK ( vec3 ( 0.0 ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wT = u_environment_energy * kK ( wS ) ;".split(" ")}]}}]},{type:"textline",
b:"wT = u_ambient * wT ; wP = u_specular_params [ 0 ] ; wO = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; wU = wP * u_specular_color ; wV = normalize ( jY ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",">","0"],group:{type:"group",a:[{type:"textline",b:"gN wY = jw ( wR , wT , wQ , wU , jV , wS , wV , wO , u_diffuse_params , 1.0 , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , 0.0 , vec4 ( 0.0 ) ) ;".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:"gN wY = jB ( wR , wT , wQ ) ;".split(" ")}]}}]},{type:"textline",b:"wU = wY . a . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["wU","=","wQ",";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:"gf ( wU , length ( ck ) , u_fog_color_density ) ;".split(" ")}]}}]},{type:"textline",b:"wP = wW . a * wa ; fD ( wU ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["ALPHA","&&",
"!","ALPHA_CLIP"],group:{type:"group",a:[{type:"textline",b:"fG ( wU , wP ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( wU , wP ) ; }".split(" ")}]};a["particles_texture.glslv"]={type:"group",a:[{type:"var",name:"BILLBOARD_ALIGN",b:["0"]},{type:"var",name:"COLOR_RAMP_LENGTH",b:["0"]},{type:"var",name:"SIZE_RAMP_LENGTH",b:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"define",name:"BILLBOARD_ALIGN_VIEW",b:["1"]},{type:"define",name:"BILLBOARD_ALIGN_XY",
b:["2"]},{type:"define",name:"BILLBOARD_ALIGN_YZ",b:["3"]},{type:"define",name:"BILLBOARD_ALIGN_ZX",b:["4"]},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_p_delay ; attribute float a_p_lifetime ; attribute vec4 a_p_vels ; attribute vec2 a_p_bb_vertex ;".split(" ")},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",c:["SIZE_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"uniform vec2 u_p_size_ramp [ SIZE_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"textline",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform vec3 u_p_wind ; uniform float u_p_max_lifetime ; uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ; uniform vec3 u_camera_eye ; uniform float u_p_size ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","WORLD_SPACE"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"varying float wa ; varying vec3 jZ ; varying vec2 a ; varying vec3 jY ; varying vec3 jV ;".split(" ")},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","ck",";"]}]}}]},{type:"include",file:"particles.glslv"},{type:"textline",b:"float wQ ( vec2 wO , vec2 wP ) { return ( atan ( wP . y , wP . x ) - atan ( wO . y , wO . x ) ) ; } void main ( ) { vec4 wR , wS , wT ; mat4 wU ; float wV ; wb wW ; wW = wN ( ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { wV = wW . e ; wU = N ( wW . b , u_view_matrix ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { wV = wW . e ; wU = x ( ) ; wU [ 3 ] = vec4 ( wW . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { wV = wW . e ; wU = B ( radians ( 90.0 ) ) ; wU [ 3 ] = vec4 ( wW . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { wV = wQ ( vec2 ( EPSILON , 1.0 ) , vec2 ( a_normal . x , a_normal . z ) ) + wW . e ; wU = z ( radians ( - 90.0 ) ) ; wU [ 3 ] = vec4 ( wW . b , 1.0 ) ; } wR = vec4 ( a_p_bb_vertex * 2.0 * wW . a * u_p_size , 0.0 , 1.0 ) ; wR = wU * D ( wV ) * wR ; wS = u_view_matrix * wR ; wT = u_proj_matrix * wS ; gl_Position = wT ; wa = wW . c ; jZ = wW . d ; a = a_p_bb_vertex + 0.5 ; jV = wR . xyz ; jY = u_camera_eye - wR . xyz ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["ck","=","wS",";"]}]}}]},{type:"textline",b:["}"]}]};a["procedural_skydome.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; varying vec3 wO ; const float wP = 0.99 ; const float wQ = 1.8 ; const int wR = 8 ; float wX ( vec3 wS , vec3 wT ) { float wU , wV , wW ; wU = dot ( wT , wT ) ; wV = 2.0 * dot ( wT , wS ) ; wW = dot ( wS , wS ) - 1.0 ; wU = wV * wV - 4.0 * wU * wW ; wU = sqrt ( wU ) ; wV = ( - wV - wU ) / 2.0 ; wU = wW / wV ; return wU ; } float xd ( float wY , float wZ ) { float w_ , xa , xb , xc ; w_ = 3.0 * ( 1.0 - wZ * wZ ) ; xa = 2.0 * ( 2.0 + wZ * wZ ) ; xb = 1.0 + wY * wY ; xc = pow ( 1.0 + wZ * wZ - 2.0 * wZ * wY , 1.5 ) ; xc = max ( xc , 0.00001 ) ; return ( w_ / xa ) * ( xb / xc ) ; } float xj ( vec3 xe , vec3 xf , float xg ) { vec3 xh ; float xi ; xi = dot ( xf , - xe ) ; if ( xi < 0.0 ) { return 1.0 ; } xh = xe + xi * xf ; if ( length ( xh ) < xg ) { return 0.0 ; } else if ( length ( xh ) >= xg ) { xh = normalize ( xh ) * xg - xe ; xi = acos ( dot ( normalize ( xh ) , xf ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( xi * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 xn ( float xk , vec3 xl , float xm ) { return xl - xl * pow ( u_sky_color , vec3 ( xm / xk ) ) ; } void main ( ) { float xo , xp , xq , xr , xs , xt , xu , xv , xw ; vec3 xx , xy , xz , xA , xB , xC , xD ; xx = normalize ( wO ) ; xy = u_sun_direction ; xo = dot ( xx , xy ) ; xp = xd ( xo , - 0.01 ) * u_rayleigh_brightness * xy . y ; xq = xd ( xo - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - xy . y ) ; xo = smoothstep ( 0.0 , 100.0 , xd ( xo , 0.9995 ) ) * u_spot_brightness ; xz = vec3 ( 0.0 , wP , 0.0 ) ; xr = wX ( xz , xx ) ; xs = xr / float ( wR ) ; xt = xj ( xz , xx , wP - 0.3 ) ; xA = vec3 ( 0.0 , 0.0 , 0.0 ) ; xB = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int xE = 0 ; xE < wR ; xE ++ ) { xu = xs * float ( xE ) ; xC = xz + xx * xu ; xv = xj ( xC , xy , wP - 0.2 ) ; xw = wX ( xC , xy ) ; xD = xn ( xw , vec3 ( wQ ) , u_scatter_strength ) * xv ; xA += xn ( sqrt ( xu ) , u_sky_color * xD , u_rayleigh_strength ) ; xB += xn ( xu , xD , u_mie_strength ) ; } xA = xA * xt * pow ( xr , u_rayleigh_collection_power ) / float ( wR ) ; xB = ( xB * xt * pow ( xr , u_mie_collection_power ) ) / float ( wR ) ; xB = vec3 ( xo * xB + xq * xB + xp * xA ) ; fD ( xB ) ; gl_FragColor = vec4 ( xB , 1.0 ) ; }".split(" ")}]};
a["procedural_skydome.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec3 a_position ; uniform mat4 u_cube_view_matrix ; varying vec3 wO ; void main ( ) { vec4 wP , wQ ; wP = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; wQ = u_cube_view_matrix * wP ; wO = wQ . xyz ; gl_Position = wP ; }".split(" ")}]};a["special_lens_flares.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform sampler2D u_sampler ; varying vec2 a ; void main ( ) { vec4 wP ; wP = texture2D ( u_sampler , a ) ; fD ( wP . rgb ) ; fG ( wP . rgb , wP . a ) ; gl_FragColor = wP ; }".split(" ")}]};
a["special_lens_flares.glslv"]={type:"group",a:[{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"define",name:"LIGHT_INDEX",b:["0"]},{type:"textline",b:"attribute float a_lf_dist ; attribute vec2 a_lf_bb_vertex ; attribute vec2 a_texcoord ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; varying vec2 a ; void main ( ) { vec2 wP ; float wQ ; vec4 wR ; vec3 wS ; a = a_texcoord ; wS = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; wR = u_proj_matrix * u_view_matrix * vec4 ( wS , 0.0 ) ; wR . x /= wR . w ; wR . y /= wR . w ; wR += 99999.0 * step ( wR . z , 0.0 ) ; wR += 100.0 * ( step ( 1.0 , abs ( wR . x ) ) + step ( 1.0 , abs ( wR . y ) ) ) ; wR . x = - a_lf_dist * wR . x ; wR . y = - a_lf_dist * wR . y ; wQ = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; wP = vec2 ( a_lf_bb_vertex . x / wQ , a_lf_bb_vertex . y ) ; if ( a_lf_dist > - 0.999 ) { const float wT = 1.9 ; wP *= ( 1.0 + wT * length ( wR . xy ) ) ; } gl_Position = vec4 ( wR . xy + wP , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["special_skydome.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"define",name:"INV_PI",b:["0.318309886"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"condition",a:[{type:"if",c:["WO_SKYTEX","||","PROCEDURAL_SKYDOME"],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky",";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","PROCEDURAL_SKYDOME","&&","WO_SKYTEX"],group:{type:"group",a:[{type:"include",file:"std_enums.glsl"},
{type:"include",file:"blending.glslf"},{type:"textline",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; vec3 yV ( vec3 yQ , vec3 yR , float yS , float yT ) { float yU ; yU = yS * yT ;".split(" ")},{type:"condition",a:[{type:"if",c:["BLENDTYPE","==","MTEX_BLEND"],group:{type:"group",a:[{type:"textline",b:"return xe ( yR , yQ , yU ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_ADD"],group:{type:"group",a:[{type:"textline",b:"return xi ( yQ , yR , yU ) ;".split(" ")}]}},
{type:"elif",c:["BLENDTYPE","==","MTEX_SUB"],group:{type:"group",a:[{type:"textline",b:"return xm ( yQ , yR , yU ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_MUL"],group:{type:"group",a:[{type:"textline",b:"return xr ( yQ , yR , yU ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_SCREEN"],group:{type:"group",a:[{type:"textline",b:"return xw ( yQ , yR , yU ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_OVERLAY"],group:{type:"group",a:[{type:"textline",b:"return xB ( yQ , yR , yU ) ;".split(" ")}]}},
{type:"elif",c:["BLENDTYPE","==","MTEX_DIFF"],group:{type:"group",a:[{type:"textline",b:"return xF ( yQ , yR , yU ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_DIV"],group:{type:"group",a:[{type:"textline",b:"return xJ ( yQ , yR , yU ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_DARK"],group:{type:"group",a:[{type:"textline",b:"return xN ( yQ , yR , yU ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_LIGHT"],group:{type:"group",a:[{type:"textline",b:"return xR ( yQ , yR , yU ) ;".split(" ")}]}},
{type:"elif",c:["BLENDTYPE","==","MTEX_BLEND_HUE"],group:{type:"group",a:[{type:"textline",b:"return xX ( yR , yQ , yU ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_BLEND_SAT"],group:{type:"group",a:[{type:"textline",b:"return yc ( yR , yQ , yU ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_BLEND_VAL"],group:{type:"group",a:[{type:"textline",b:"return yi ( yR , yQ , yU ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_BLEND_COLOR"],group:{type:"group",a:[{type:"textline",
b:"return yo ( yR , yQ , yU ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_SOFT_LIGHT"],group:{type:"group",a:[{type:"textline",b:"return yt ( yR , yQ , yU ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_LIN_LIGHT"],group:{type:"group",a:[{type:"textline",b:"return yx ( yR , yQ , yU ) ;".split(" ")}]}}]},{type:"textline",b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float zc ( float yW , float yX , float yY , float yZ ) { float y_ ; vec3 za , zb ; za = vec3 ( yW ) , zb = vec3 ( yX ) ; y_ = yY * yZ ;".split(" ")},
{type:"condition",a:[{type:"if",c:["BLENDTYPE","==","MTEX_BLEND"],group:{type:"group",a:[{type:"textline",b:"return xe ( zb , za , y_ ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_ADD"],group:{type:"group",a:[{type:"textline",b:"return xi ( za , zb , y_ ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_SUB"],group:{type:"group",a:[{type:"textline",b:"return xm ( za , zb , y_ ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_MUL"],group:{type:"group",a:[{type:"textline",
b:"return yD ( yW , yX , y_ , yZ ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_SCREEN"],group:{type:"group",a:[{type:"textline",b:"return yJ ( yW , yX , y_ , yZ ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_OVERLAY"],group:{type:"group",a:[{type:"textline",b:"return yP ( yW , yX , y_ , yZ ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_DIFF"],group:{type:"group",a:[{type:"textline",b:"return xF ( za , zb , y_ ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE",
"==","MTEX_DIV"],group:{type:"group",a:[{type:"textline",b:"return xJ ( za , zb , y_ ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_DARK"],group:{type:"group",a:[{type:"textline",b:"return xN ( za , zb , y_ ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_LIGHT"],group:{type:"group",a:[{type:"textline",b:"return xR ( za , zb , y_ ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_SOFT_LIGHT"],group:{type:"group",a:[{type:"textline",b:"return yt ( zb , za , y_ ) . x ;".split(" ")}]}},
{type:"elif",c:["BLENDTYPE","==","MTEX_LIN_LIGHT"],group:{type:"group",a:[{type:"textline",b:"return yx ( zb , za , y_ ) . x ;".split(" ")}]}}]},{type:"textline",b:["return","0.0",";","}"]}]}}]},{type:"condition",a:[{type:"if",c:["!","PROCEDURAL_SKYDOME"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","&&","!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_camera_eye_frag ; uniform vec3 u_sun_intensity ; uniform float u_environment_energy ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},
{type:"textline",b:["varying","vec3","wO",";"]},{type:"condition",a:[{type:"if",c:"! PROCEDURAL_SKYDOME && ( WO_SKYTEX || WO_SKYBLEND )".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"textline",b:"void main ( ) { vec4 zd ; float ze , zf , zg ; vec3 zh , zi , zj , zk , zl ; zi = normalize ( wO ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME"],group:{type:"group",a:[{type:"textline",b:"zh = textureCube ( u_sky , zi ) . rgb ;".split(" ")}]}},
{type:"elif",c:"! ( WO_SKYTEX || WO_SKYBLEND )".split(" "),group:{type:"group",a:[{type:"textline",b:"zh = u_horizon_color ; fD ( zh ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:[";"]},{type:"condition",a:[{type:"if",c:["WO_SKYPAPER"],group:{type:"group",a:[{type:"textline",b:"zj = vec3 ( a , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zj = vec3 ( wO . xy , 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:[";"]},{type:"condition",a:[{type:"if",
c:["WO_SKYBLEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WO_SKYPAPER"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WO_SKYREAL"],group:{type:"group",a:[{type:"textline",b:"ze = abs ( a . y ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"ze = ( a . y + 1.0 ) * 0.5 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zf = acos ( zi . y ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WO_SKYREAL"],group:{type:"group",
a:[{type:"textline",b:"ze = abs ( zf * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"ze = 1.0 - zf * INV_PI ;".split(" ")}]}}]}]}}]}]}}]},{type:"textline",b:"zk = u_horizon_color ; zl = u_zenith_color ;".split(" ")},{type:"condition",a:[{type:"if",c:["WO_SKYTEX"],group:{type:"group",a:[{type:"textline",b:"zf = 1.0 ; zd = textureCube ( u_sky , zi ) ; fB ( zd . rgb ) ; zf = zd . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["MTEX_RGBTOINT"],group:{type:"group",
a:[{type:"textline",b:"zf = dot ( zd . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["MTEX_NEGATIVE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["!","MTEX_RGBTOINT"],group:{type:"group",a:[{type:"textline",b:"zd = vec4 ( vec3 ( 1.0 ) - zd . rgb , zd . a ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zf = 1.0 - zf ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_HORIZ","||","WOMAP_ZENUP",
"||","WOMAP_ZENDOWN"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MTEX_RGBTOINT"],group:{type:"group",a:[{type:"textline",b:"zd = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zf = zd . a ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_HORIZ"],group:{type:"group",a:[{type:"textline",b:"zk = yV ( zd . rgb , zk , zf , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_ZENUP","||",
"WOMAP_ZENDOWN"],group:{type:"group",a:[{type:"textline",b:["zg","=","0.0",";"]},{type:"condition",a:[{type:"if",c:["WO_SKYREAL"],group:{type:"group",a:[{type:"textline",b:"if ( dot ( zj , vec3 ( 0.0 , 1.0 , 0.0 ) ) >= 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["WOMAP_ZENUP"],group:{type:"group",a:[{type:"textline",b:"zg = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:[";"]}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",
c:["WOMAP_ZENDOWN"],group:{type:"group",a:[{type:"textline",b:"else zg = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WOMAP_ZENUP"],group:{type:"group",a:[{type:"textline",b:"zg = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"elif",c:["WOMAP_ZENDOWN"],group:{type:"group",a:[{type:"textline",b:"zg = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{type:"textline",b:"if ( zg != 0.0 ) zl = yV ( zd . rgb , zl , zf , zg ) ;".split(" ")}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["WOMAP_BLEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["!","MTEX_RGBTOINT"],group:{type:"group",a:[{type:"textline",b:"zf = dot ( zd . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{type:"textline",b:"ze = zc ( u_sky_tex_dvar , ze , zf , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WO_SKYBLEND"],group:{type:"group",a:[{type:"textline",b:"zh = mix ( zk , zl , ze ) ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:["zh","=","zk",";"]}]}}]},{type:"textline",b:["fD","(","zh",")",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"fD ( zk ) ; fD ( zl ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WO_SKYBLEND"],group:{type:"group",a:[{type:"textline",b:"zh = mix ( zk , zl , ze ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["zh","=","zk",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:"WATER_EFFECTS && ! DISABLE_FOG && ! REFLECTION_PASS".split(" "),
group:{type:"group",a:[{type:"textline",b:"fB ( zh ) ; zg = u_camera_eye_frag . y - WATER_LEVEL ; zg = min ( - zg * 0.03 , 0.8 ) ; zf = clamp ( length ( u_sun_intensity ) + u_environment_energy , 0.0 , 1.0 ) ; zj = vec3 ( 0.0 ) ; zd = u_underwater_fog_color_density ; zd . rgb = mix ( zd . rgb , zj , min ( - zi . y + zg , 1.0 ) ) * zf ; ze = clamp ( sign ( zi . y - 0.05 * zg ) , 0.0 , 1.0 ) ; zh = mix ( zd . rgb , zh , ze ) ; fD ( zh ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( zh , 1.0 ) ; }".split(" ")}]};
a["special_skydome.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec3 a_position ; uniform mat4 u_sky_vp_inverse ; varying vec3 wO ;".split(" ")},{type:"condition",a:[{type:"if",c:"! PROCEDURAL_SKYDOME && ( WO_SKYTEX || WO_SKYBLEND )".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"textline",b:"void main ( ) { vec4 yQ , yR ; yQ = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; yR = u_sky_vp_inverse * yQ ; wO = yR . xyz ;".split(" ")},{type:"condition",
a:[{type:"if",c:"! PROCEDURAL_SKYDOME && ( WO_SKYTEX || WO_SKYBLEND )".split(" "),group:{type:"group",a:[{type:"textline",b:"a = a_position . xy ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","yQ",";","}"]}]};a["special_water.glslf"]={type:"group",a:[{type:"var",name:"ABSORB",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"SSS_STRENGTH",b:["6.0"]},{type:"var",name:"SSS_WIDTH",b:["0.0"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"include",file:"std_enums.glsl"},
{type:"include",file:"precision_statement.glslf"},{type:"include",file:"fog.glslf"},{type:"include",file:"procedural.glslf"},{type:"include",file:"lighting.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"math.glslv"},{type:"define",name:"REFL_BUMP",b:["0.001"]},{type:"define",name:"REFR_BUMP",b:["0.0005"]},{type:"textline",b:["uniform","float","u_time",";"]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","&&","SKY_TEXTURE"],group:{type:"group",
a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT","&&","SKY_COLOR"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",">","0"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",a:[{type:"if",c:"REFLECTION_TYPE == REFL_PLANE || REFRACTIVE || WATER_EFFECTS".split(" "),group:{type:"group",a:[{type:"textline",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",
a:[{type:"textline",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG","&&","PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform",
"sampler2D","u_refractmap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","==","REFL_PLANE"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","==","REFL_MIRRORMAP"],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",
";"]}]}}]},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_foam",";"]}]}}]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",
">","0"],group:{type:"group",a:[{type:"textline",b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","1"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_normalmap1_scale",";"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","2"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_normalmap2_scale",";"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","3"],group:{type:"group",
a:[{type:"textline",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","==","REFL_MIRRORMAP"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","float","u_reflect_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","||","!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_view_max_depth",
";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",
b:["uniform","float","u_refr_bump",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:"const float yQ = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{type:"textline",b:"varying vec3 jY ; varying vec3 jV ;".split(" ")},{type:"condition",a:[{type:"if",c:"( NUM_NORMALMAPS > 0 || FOAM ) && ! GENERATED_MESH".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],
group:{type:"group",a:[{type:"textline",b:["varying","vec3","jW",";"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0"],group:{type:"group",a:[{type:"textline",b:"varying vec3 jX ; varying vec3 yR ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","yS",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","yT",";"]}]}}]},{type:"condition",
a:[{type:"if",c:"SHORE_SMOOTHING || REFLECTION_TYPE == REFL_PLANE || REFRACTIVE".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec3","cp",";"]}]}}]},{type:"condition",a:[{type:"if",c:"SHORE_SMOOTHING || REFLECTION_TYPE == REFL_PLANE || REFRACTIVE || ! DISABLE_FOG".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","float","j_",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","yU",";"]}]}}]},
{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["REFRACTIVE","&&","SHORE_SMOOTHING","&&","USE_REFRACTION_CORRECTION"],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]},{type:"textline",b:"vec3 zf ( in vec2 yV , in vec3 yW , in vec3 yX , in vec3 yY , out float yZ ) { float y_ , za , zb ; vec2 zc ; vec3 zd , ze ; zd = reflect ( - yX , yW ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","==","REFL_PLANE"],group:{type:"group",a:[{type:"textline",
b:"zc = yV . xy + yW . xz * REFL_BUMP / j_ ; yZ = u_reflect_factor ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG","&&","WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"ze = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"ze = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"textline",b:"y_ = dot ( yX , yW ) ; yZ *= max ( 1.0 - 1.0 / y_ , 1.0 ) ; } else { ze = texture2D ( u_plane_reflection , zc ) . rgb ; fB ( ze ) ; }".split(" ")}]}},
{type:"elif",c:["REFLECTION_TYPE","==","REFL_MIRRORMAP"],group:{type:"group",a:[{type:"textline",b:"yZ = u_mirror_factor ; ze = yY * textureCube ( u_mirrormap , zd ) . rgb ; fB ( ze ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"yZ = u_reflect_factor ; ze = yY * vec3 ( 0.3 , 0.5 , 1.0 ) ; fB ( ze ) ;".split(" ")}]}}]},{type:"textline",b:"zd = normalize ( zd + yX ) ; y_ = 1.0 - dot ( yX , zd ) ; za = u_fresnel_params [ 3 ] ; zb = u_fresnel_params [ 2 ] ; za = za + ( 1.0 - za ) * pow ( y_ , zb ) ; yZ = min ( yZ * za , 1.0 ) ; return ze ; } void main ( ) { vec4 zg ; vec2 zh , zi , zj ; float zk , zl , zm , zn , zo , zp ; vec3 zq , zr , zs , zt , zu , zv , zw ; mat3 zx ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0"],group:{type:"group",a:[{type:"textline",b:"zx = mat3 ( jX , yR , jW ) ;".split(" ")}]}}]},{type:"textline",b:"zq = normalize ( jW ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0"],group:{type:"group",a:[{type:"textline",b:"zx = mat3 ( 1.0 , 0.0 , 0.0 , 0.0 , 0.0 , - 1.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"zq = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC","&&","FOAM"],group:{type:"group",a:[{type:"textline",b:"zk = jV . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0","||","FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"zh = vec2 ( yS . x , - yS . z ) + 0.5 ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"zh = vec2 ( jV . x , - jV . z ) + 0.5 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["zh","=","a",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0"],group:{type:"group",a:[{type:"textline",b:"zr = vec3 ( 0.0 ) ; zs = texture2D ( u_normalmap0 , zh * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; zr += zs ;".split(" ")},{type:"condition",a:[{type:"if",
c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"zt = vec3 ( 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NORM_FOAM0"],group:{type:"group",a:[{type:"textline",b:["zt","+=","zs",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","1"],group:{type:"group",a:[{type:"textline",b:"zs = texture2D ( u_normalmap0 , zh * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; zr += zs ;".split(" ")},{type:"condition",a:[{type:"if",
c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORM_FOAM1"],group:{type:"group",a:[{type:"textline",b:["zt","+=","zs",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","2"],group:{type:"group",a:[{type:"textline",b:"zs = texture2D ( u_normalmap0 , zh * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; zr += zs ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",
a:[{type:"if",c:["NORM_FOAM2"],group:{type:"group",a:[{type:"textline",b:["zt","+=","zs",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","3"],group:{type:"group",a:[{type:"textline",b:"zs = texture2D ( u_normalmap0 , zh * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; zr += zs ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORM_FOAM3"],group:{type:"group",
a:[{type:"textline",b:["zt","+=","zs",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"zs = zx * zt ; if ( ! g ( zs , vec3 ( 0.0 ) ) ) zs = normalize ( zs ) ; zt = mix ( zq , zs , 0.2 ) ; zt = normalize ( zt ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"zq = mix ( zq , normalize ( zx * zr ) , 0.3 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"zq = mix ( zq , normalize ( zx * zr ) , 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:"zq = normalize ( zq ) ;".split(" ")}]}}]},{type:"textline",b:"zs = normalize ( jY ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","==","REFL_PLANE","||","REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"zi = cp . xy / cp . z ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","||","!","DISABLE_FOG"],group:{type:"group",
a:[{type:"textline",b:"zl = j_ * u_view_max_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:"zm = u_diffuse_color . a ; zg = texture2DProj ( u_scene_depth , cp ) ; zn = fT ( zg ) ; zo = max ( zn - j_ , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"zj = zi + zq . xz * u_refr_bump / j_ ; zn = kz ( zn , zj , zi ) ; zn = max ( zn - j_ , 0.0 ) ; zn = u_view_max_depth / ABSORB * zn ; if ( u_cam_water_depth < 0.0 ) zp = 0.0 ; else zp = min ( zm * zn , 1.0 ) ; zn = u_view_max_depth / ABSORB * zo ; zm = min ( 15.0 * zm * u_view_max_depth * zo , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"zn = u_view_max_depth / ABSORB * zo ; if ( u_cam_water_depth > 0.0 ) zm = min ( zm * zn , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"zm *= min ( 5.0 * zl , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zm = u_diffuse_color . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"zp = 1.0 - zm ; zj = zi + zq . xz * u_refr_bump / j_ ;".split(" ")}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"zr = texture2D ( u_refractmap , zj ) . rgb ; fB ( zr ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"zn = pow ( min ( yT . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; zu = mix ( u_shallow_water_col , u_diffuse_color . rgb , zn ) ; zn = pow ( min ( yT . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; zu = mix ( u_shore_water_col , zu , zn ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"zu = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:"zn = max ( 1.0 - u_view_max_depth * zo , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zn = 1.0 - zm ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",
b:"zo = max ( zk / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"zv = normalize ( vec3 ( yT . r , 0.0 , yT . g ) ) ; zv = normalize ( mix ( vec3 ( 0.0 , 1.0 , 0.0 ) , zv , 0.8 ) ) ; zk = 1.25 * max ( dot ( zt , zv ) - 0.2 , 0.0 ) ; zk += max ( dot ( zt , vec3 ( 0.0 , - 1.0 , 0.0 ) ) , 0.0 ) ; zn += zk * ( 1.0 - yT . b ) ; zo *= ( 1.0 - 0.95 * pow ( yT . b , 0.1 ) ) ;".split(" ")}]}}]},{type:"textline",b:"zn += zo ; zn = min ( u_foam_factor * zn , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"zg = texture2D ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + zh * u_foam_scale ) ;".split(" ")}]}}]},{type:"textline",b:"zk = u_specular_params [ 0 ] ; zj = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; zv = zk * u_specular_color ; zt = u_environment_energy * kK ( zq ) ; zt = u_ambient * zt ; zt = zt + u_sun_intensity ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","==","REFL_PLANE"],group:{type:"group",a:[{type:"textline",b:"zw = zf ( zi , zq , zs , zt , zo ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"zw = zf ( vec2 ( 0.0 ) , zq , zs , zt , zo ) ;".split(" ")}]}}]},{type:"textline",b:"zu = u_diffuse_intensity * zu ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",">","0"],group:{type:"group",a:[{type:"textline",b:"gN zy = jw ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , zu , zv , jV , zq , zs , zj , u_diffuse_params , 1.0 , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , 0.0 , vec4 ( 0.0 ) ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"gN zy = jB ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , zu ) ;".split(" ")}]}}]},{type:"textline",b:"zu = zy . a . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"zk = max ( dot ( u_sun_direction , - jW ) + SSS_WIDTH , 0.0 ) * max ( dot ( - zs , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; zk = clamp ( SSS_STRENGTH * zk , 0.0 , 1.0 ) ; zu = mix ( zu , u_shallow_water_col , zk ) ; zu = mix ( zu , u_shore_water_col , zk ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"zu = mix ( zr , zu , zp ) ;".split(" ")}]}}]},{type:"textline",b:"zu = mix ( zu , zw , zo ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"zk = mix ( zg . g , zg . r , max ( 4.0 * ( zn - 0.75 ) , 0.0 ) ) ; zk = mix ( zg . b , zk , max ( 2.0 * zn - 1.0 , 0.0 ) ) ; zk = mix ( 0.0 , zk , zn ) ; zu = mix ( zu , zt , zk ) ;".split(" ")}]}}]},{type:"textline",
b:"zu += zy . b ;".split(" ")},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:"zv = gl ( u_cube_fog , zs ) ; zg = vec4 ( zv , u_fog_color_density . a ) ; fB ( zg . rgb ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["zg","=","u_fog_color_density",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",
b:"if ( u_cam_water_depth < 0.0 ) { gJ ( zu , zl , u_cam_water_depth , u_underwater_fog_color_density , clamp ( length ( u_sun_intensity ) + u_environment_energy , 0.0 , 1.0 ) ) ; } else { gf ( zu , zl , zg ) ; }".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gf ( zu , zl , zg ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["fD","(","zu",")",";"]},{type:"condition",a:[{type:"if",c:["!","REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"zm = max ( zm , zy . b . r ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:["zm","+=","zk",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"textline",b:"fG ( zu , zm ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"extension",b:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",b:"zq = fwidth ( yU ) ; zr = smoothstep ( vec3 ( 0.0 ) , zq * yQ , yU ) ; zp = min ( min ( zr . x , zr . y ) , zr . z ) ; zp = clamp ( zp , 0.0 , 1.0 ) ; zu = mix ( u_wireframe_edge_color , zu , zp ) ; zm = mix ( 1.0 , zm , zp ) ;".split(" ")}]}}]},
{type:"textline",b:"gl_FragColor = vec4 ( zu , zm ) ; }".split(" ")}]};a["special_water.glslv"]={type:"group",a:[{type:"var",name:"DIR_MIN_SHR_FAC",b:["0.0"]},{type:"var",name:"DIR_FREQ",b:["0.0"]},{type:"var",name:"DIR_NOISE_SCALE",b:["0.0"]},{type:"var",name:"DIR_NOISE_FREQ",b:["0.0"]},{type:"var",name:"DIR_MIN_NOISE_FAC",b:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_0",b:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_0",b:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_1",b:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_1",
b:["0.0"]},{type:"var",name:"DST_MIN_FAC",b:["0.0"]},{type:"var",name:"MAX_SHORE_DIST",b:["0.0"]},{type:"var",name:"PRECISION",b:["mediump"]},{type:"var",name:"SHORE_MAP_CENTER_X",b:["0.0"]},{type:"var",name:"SHORE_MAP_SIZE_X",b:["0.0"]},{type:"var",name:"SHORE_MAP_CENTER_Y",b:["0.0"]},{type:"var",name:"SHORE_MAP_SIZE_Y",b:["0.0"]},{type:"var",name:"WAVES_HOR_FAC",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"WAVES_LENGTH",b:["0.0"]},
{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"include",file:"procedural.glslf"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["!","GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_polyindex",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:"SHORE_SMOOTHING || REFLECTION_TYPE == REFL_PLANE || REFRACTIVE || ! DISABLE_FOG".split(" "),group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{type:"textline",b:"varying vec3 jY ; varying vec3 jV ;".split(" ")},{type:"condition",a:[{type:"if",c:"! GENERATED_MESH && ( NUM_NORMALMAPS > 0 || FOAM )".split(" "),
group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","jW",";"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0"],group:{type:"group",a:[{type:"textline",b:"varying vec3 jX ; varying vec3 yR ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","yS",";"]}]}}]}]}}]},{type:"condition",
a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","yT",";"]}]}}]},{type:"condition",a:[{type:"if",c:"SHORE_SMOOTHING || REFLECTION_TYPE == REFL_PLANE || REFRACTIVE".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec3","cp",";"]}]}}]},{type:"condition",a:[{type:"if",c:"SHORE_SMOOTHING || REFLECTION_TYPE == REFL_PLANE || REFRACTIVE || ! DISABLE_FOG".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","float","j_",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","yU",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"vec3 yZ ( in vec2 yQ ) { float yV ; vec4 yW ; vec2 yX ; yX = 0.5 + vec2 ( ( yQ . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , - ( yQ . y + SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; yW = texture2D ( u_shore_dist_map , yX ) ; const vec2 yY = vec2 ( 1.0 / 255.0 , 1.0 ) ; yV = dot ( yW . ba , yY ) ; yX = normalize ( yW . rg * 2.0 - 1.0 ) ; return vec3 ( yX , yV ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"define",name:"SMALL_WAVES_FAC",b:["0.3"]},{type:"textline",b:"void zk ( inout vec3 y_ , in float za , in vec3 zb ) { vec2 zc , zd , ze ; float zf , zg , zh , zi , zj ; zf = dc ( DST_NOISE_SCALE_0 * ( y_ . xz + DST_NOISE_FREQ_0 * za ) ) * dc ( DST_NOISE_SCALE_1 * ( y_ . zx - DST_NOISE_FREQ_1 * za ) ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",
a:[{type:"textline",b:"zg = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; zh = zb . b ; zi = sqrt ( zh ) ; zg = max ( zh , DIR_MIN_SHR_FAC ) * sin ( zi / zg + DIR_FREQ * za ) ; zj = max ( dc ( DIR_NOISE_SCALE * ( y_ . xz + DIR_NOISE_FREQ * za ) ) , DIR_MIN_NOISE_FAC ) ; zg *= zj ; zj = WAVES_HEIGHT * mix ( zg , zf , max ( zi , DST_MIN_FAC ) ) ; zc = zb . rg ; zi = WAVES_HOR_FAC * zg * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - zh ) , 0.0 ) ; zc = zi * zc ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"zj = WAVES_HEIGHT * zf ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"zd = 2.0 * ( y_ . xz - 0.1 * za ) ; ze = 1.3 * ( y_ . zx + 0.03 * za ) ; zg = cH ( 0.5 * zd ) . x + cH ( 0.5 * ze ) . x - 1.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"y_ . xz += zc ; zg *= zh ;".split(" ")}]}}]},{type:"textline",b:"zj += SMALL_WAVES_FAC * zg ;".split(" ")}]}}]},{type:"textline",
b:"y_ . y += zj ; }".split(" ")}]}}]},{type:"textline",b:"void main ( ) { vec4 zl , zm ; vec2 zn ; float zo , zp , zq ; vec3 zr , zs , zt , zu ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:"if ( a_polyindex == 0.0 ) yU = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) yU = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) yU = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["zr","=","a_position",";"]},
{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"zo = abs ( zr . y ) ; zn = u_camera_eye . xz - mod ( u_camera_eye . xz , zo ) ; zr . y = WATER_LEVEL ; zr . xz += zn ;".split(" ")}]}},{type:"elif",c:["NUM_NORMALMAPS",">","0","||","FOAM"],group:{type:"group",a:[{type:"textline",b:["a","=","a_texcoord",";"]}]}}]},{type:"textline",b:"d zv = av ( zr , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")},{type:"condition",
a:[{type:"if",c:["DYNAMIC","&&","GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"yS = zv . a ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"yT = yZ ( zv . a . xz ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"zp = length ( u_wind ) ; zq = u_time ; zq *= zp ;".split(" ")},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",
b:["zp","=","zo",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["zp","=","0.1",";"]}]}}]},{type:"textline",b:"zr = zv . a + vec3 ( zp , 0.0 , 0.0 ) ; zs = zv . a + vec3 ( 0.0 , 0.0 , zp ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"zt = yZ ( zr . xz ) ; zu = yZ ( zs . xz ) ; zk ( zr , zq , zt ) ; zk ( zs , zq , zu ) ; zk ( zv . a , zq , yT ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zk ( zr , zq , vec3 ( 0.0 ) ) ; zk ( zs , zq , vec3 ( 0.0 ) ) ; zk ( zv . a , zq , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"if ( a_position . y < 0.0 ) { zv . a . y = WATER_LEVEL - 1.0 ; zr . y = zv . a . y ; zs . y = zv . a . y ; }".split(" ")}]}}]},{type:"textline",b:"zt = normalize ( zr - zv . a ) ; zu = normalize ( zs - zv . a ) ; jW = normalize ( cross ( zu , zt ) ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0"],group:{type:"group",a:[{type:"textline",b:"jX = zu ; yR = cross ( jW , jX ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"zo = dot ( jW , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; zp = clamp ( 0.8 - zo , 0.0 , 1.0 ) ; jW = mix ( jW , vec3 ( 0.0 , 1.0 , 0.0 ) , zp ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:"jV = zv . a ; jY = u_camera_eye - zv . a ; zl = u_view_matrix * vec4 ( zv . a , 1.0 ) ; zm = u_proj_matrix * zl ;".split(" ")},{type:"condition",a:[{type:"if",c:"SHORE_SMOOTHING || REFLECTION_TYPE == REFL_PLANE || REFRACTIVE".split(" "),
group:{type:"group",a:[{type:"textline",b:"zq = zm . x ; zo = zm . y ; zp = zm . w ; cp . x = ( zq + zp ) / 2.0 ; cp . y = ( zo + zp ) / 2.0 ; cp . z = zp ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:"SHORE_SMOOTHING || REFLECTION_TYPE == REFL_PLANE || REFRACTIVE || ! DISABLE_FOG".split(" "),group:{type:"group",a:[{type:"textline",b:"j_ = - zl . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","zm",";","}"]}]};a["wireframe.glslf"]={type:"group",a:[{type:"define",
name:"WM_OPAQUE_WIREFRAME",b:["0"]},{type:"define",name:"WM_TRANSPARENT_WIREFRAME",b:["1"]},{type:"define",name:"WM_FRONT_BACK_VIEW",b:["2"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"condition",a:[{type:"if",c:["!","DEBUG_SPHERE"],group:{type:"group",a:[{type:"textline",b:"uniform int u_wireframe_mode ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{type:"textline",b:"varying vec3 yU ; const float yQ = 1.0 ;".split(" ")},{type:"condition",
a:[{type:"if",c:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE_DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"const vec3 yV = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"const vec3 yV = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"const vec3 yW = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 yX = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 yY = vec3 ( 1.0 , 1.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"void main ( ) { float yZ , y_ ; vec3 za , zb ; za = vec3 ( 0.0 ) ; yZ = 0.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"textline",b:"zb = sign ( yU - vec3 ( 0.02 * yQ ) ) ; if ( zb . x < 0.0 || zb . y < 0.0 || zb . z < 0.0 ) { za = yV ; yZ = 1.0 ; } else discard ;".split(" ")}]}},{type:"elif",c:["WIREFRAME_QUALITY","==","0"],group:{type:"group",a:[{type:"textline",b:"zb = sign ( yU - vec3 ( 0.02 * yQ ) ) ; if ( u_wireframe_mode == WM_OPAQUE_WIREFRAME ) { if ( zb . x < 0.0 || zb . y < 0.0 || zb . z < 0.0 ) za = u_wireframe_edge_color ; else za = yY ; yZ = 1.0 ; } else if ( u_wireframe_mode == WM_TRANSPARENT_WIREFRAME ) { if ( zb . x < 0.0 || zb . y < 0.0 || zb . z < 0.0 ) yZ = 1.0 ; else yZ = 0.0 ; za = u_wireframe_edge_color ; } else if ( u_wireframe_mode == WM_FRONT_BACK_VIEW ) { if ( zb . x < 0.0 || zb . y < 0.0 || zb . z < 0.0 ) za = u_wireframe_edge_color ; else if ( gl_FrontFacing ) za = yW ; else za = yX ; yZ = 1.0 ; }".split(" ")}]}},
{type:"elif",c:["WIREFRAME_QUALITY","==","1"],group:{type:"group",a:[{type:"extension",b:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",b:"zb = fwidth ( yU ) ; zb = smoothstep ( vec3 ( 0.0 ) , zb * yQ , yU ) ; y_ = min ( min ( zb . x , zb . y ) , zb . z ) ; y_ = clamp ( y_ , 0.0 , 1.0 ) ; if ( u_wireframe_mode == WM_OPAQUE_WIREFRAME ) { za = vec3 ( mix ( u_wireframe_edge_color , yY , y_ ) ) ; yZ = 1.0 ; } else if ( u_wireframe_mode == WM_TRANSPARENT_WIREFRAME ) { za = u_wireframe_edge_color ; yZ = mix ( 1.0 , 0.0 , y_ ) ; } else if ( u_wireframe_mode == WM_FRONT_BACK_VIEW ) { if ( gl_FrontFacing ) za = mix ( u_wireframe_edge_color , yW , y_ ) ; else za = mix ( u_wireframe_edge_color , yX , y_ ) ; yZ = 1.0 ; }".split(" ")}]}}]},
{type:"textline",b:["fD","(","za",")",";"]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"textline",b:"fG ( za , yZ ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( za , yZ ) ; }".split(" ")}]};a["wireframe.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_polyindex ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","DEBUG_SPHERE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","||","DYNAMIC_GRASS","||","BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",
a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","DEBUG_SPHERE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD","&&","BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS","||","BILLBOARD"],
group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],
group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},{type:"textline",
b:["varying","vec3","yU",";"]},{type:"condition",a:[{type:"if",c:["!","DEBUG_SPHERE"],group:{type:"group",a:[{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"include",file:"dynamic_grass.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec4 yQ ; mat4 yV ; vec3 yW , yX , yY , yZ , y_ ; if ( a_polyindex == 0.0 ) yU = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) yU = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) yU = vec3 ( 0.0 , 0.0 , 1.0 ) ; yW = a_position ; yX = a_normal ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"textline",b:"d za = av ( yW , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"yW = mix ( yW , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"yY = vec3 ( 0.0 ) ; yZ = vec3 ( 0.0 ) ; bv ( yW , yY , yZ , yX ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","||","DYNAMIC_GRASS","||","BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["yY","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"yY = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"d za = fk ( yW , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , yY , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"yZ = ( u_model_matrix * vec4 ( yY , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","&&","!","STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"yV = ao ( u_camera_eye , yZ , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"yV = ai ( u_camera_eye , yZ , u_view_matrix ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","&&","BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"y_ = ( u_model_matrix * vec4 ( yY , 1.0 ) ) . xyz ; yV = yV * aa ( u_wind , u_time , u_jitter_amp , u_jitter_freq , y_ ) ;".split(" ")}]}}]},{type:"textline",b:"d za = av ( yW - yY , yY , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , yV ) ; za . b = yZ ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"d za = av ( yW , yY , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"cj ( za . a , za . b , yX ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:"yQ = u_view_matrix * vec4 ( za . a , 1.0 ) ; gl_Position = u_proj_matrix * yQ ; }".split(" ")}]};a["postprocessing/anaglyph.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; varying vec2 a ; void main ( ) { vec4 yQ , yV ; yQ = texture2D ( u_sampler_left , a ) ; yV = texture2D ( u_sampler_right , a ) ; gl_FragColor = vec4 ( yQ [ 0 ] , yV [ 1 ] , yV [ 2 ] , yQ [ 3 ] + yV [ 3 ] ) ; }".split(" ")}]};
a["postprocessing/antialiasing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"AA_METHOD_PASS",b:["1"]},{type:"define",name:"AA_METHOD_FXAA_LIGHT",b:["2"]},{type:"define",name:"AA_METHOD_FXAA_QUALITY",b:["3"]},{type:"define",name:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{type:"define",name:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{type:"define",name:"FXAA_SPAN_MAX",b:["8.0"]},{type:"textline",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; varying vec2 a ; vec4 yX ( float yQ , float yV ) { vec2 yW ; yW = a + vec2 ( yQ , yV ) * u_texel_size ; return texture2D ( u_color , yW ) ; } float za ( vec4 yY ) { float yZ ; vec3 y_ ; y_ = vec3 ( 0.299 , 0.587 , 0.114 ) ; yZ = dot ( yY . rgb , y_ ) ; return yZ ; } vec4 zn ( ) { vec2 zb ; float zc , zd , ze , zf , zg , zh ; vec4 zi , zj , zk , zl , zm ; zi = yX ( - 1.0 , - 1.0 ) ; zj = yX ( 1.0 , - 1.0 ) ; zk = yX ( - 1.0 , 1.0 ) ; zl = yX ( 1.0 , 1.0 ) ; zm = yX ( 0.0 , 0.0 ) ; zc = za ( zi ) ; zd = za ( zj ) ; ze = za ( zk ) ; zf = za ( zl ) ; zg = za ( zm ) ; zh = min ( zg , min ( min ( zc , zd ) , min ( ze , zf ) ) ) ; zg = max ( zg , max ( max ( zc , zd ) , max ( ze , zf ) ) ) ; zb . x = - ( ( zc + zd ) - ( ze + zf ) ) ; zb . y = ( ( zc + ze ) - ( zd + zf ) ) ; zc = max ( ( zc + zd + ze + zf ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; zd = 1.0 / ( min ( abs ( zb . x ) , abs ( zb . y ) ) + zc ) ; zb = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , zb * zd ) ) * u_texel_size ; zi = 0.5 * ( texture2D ( u_color , a + zb * ( 1.0 / 3.0 - 0.5 ) ) + texture2D ( u_color , a + zb * ( 2.0 / 3.0 - 0.5 ) ) ) ; zj = zi * 0.5 + 0.25 * ( texture2D ( u_color , a + zb * - 0.5 ) + texture2D ( u_color , a + zb * 0.5 ) ) ; ze = za ( zj ) ; if ( ( ze < zh ) || ( ze > zg ) ) return zi ; else return zj ; }".split(" ")},
{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",b:["(","1.0","/","6.0",")"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["(","1.0","/","12.0",")"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",b:["(","3.0","/","4.0",")"]},{type:"textline",b:"vec4 zS ( ) { bool zo , zp , zq , zr , zs ; float zt , zu , zv , zw , zx , zy , zz , zA , zB , zC , zD , zE , zF , zG , zH ; vec4 zI , zJ , zK , zL , zM ; vec2 zN , zO , zP , zQ , zR ; zN . x = a . x ; zN . y = a . y ; zI = texture2D ( u_color , zN ) ; zJ = yX ( 0.0 , 1.0 ) ; zK = yX ( 1.0 , 0.0 ) ; zL = yX ( 0.0 , - 1.0 ) ; zM = yX ( - 1.0 , 0.0 ) ; zt = za ( zJ ) ; zu = za ( zK ) ; zv = za ( zL ) ; zw = za ( zM ) ; zx = za ( zI ) ; zy = max ( zt , zx ) ; zz = min ( zt , zx ) ; zy = max ( zu , zy ) ; zz = min ( zu , zz ) ; zA = max ( zv , zw ) ; zB = min ( zv , zw ) ; zA = max ( zA , zy ) ; zy = min ( zB , zz ) ; zB = zA * FXAA_QUALITY_EDGE_THRESHOLD ; zz = zA - zy ; zA = max ( FXAA_QUALITY_EDGE_THRESHOLD_MIN , zB ) ; zo = zz < zA ; if ( zo ) return zI ; zJ = yX ( - 1.0 , - 1.0 ) ; zK = yX ( 1.0 , 1.0 ) ; zL = yX ( 1.0 , - 1.0 ) ; zM = yX ( - 1.0 , 1.0 ) ; zy = za ( zJ ) ; zB = za ( zK ) ; zA = za ( zL ) ; zC = za ( zM ) ; zD = zv + zt ; zE = zw + zu ; zz = 1.0 / zz ; zF = zD + zE ; zD = ( - 2.0 * zx ) + zD ; zE = ( - 2.0 * zx ) + zE ; zG = zA + zB ; zA = zy + zA ; zH = ( - 2.0 * zu ) + zG ; zA = ( - 2.0 * zv ) + zA ; zy = zy + zC ; zC = zC + zB ; zB = ( abs ( zD ) * 2.0 ) + abs ( zH ) ; zD = ( abs ( zE ) * 2.0 ) + abs ( zA ) ; zH = ( - 2.0 * zw ) + zy ; zE = ( - 2.0 * zt ) + zC ; zA = abs ( zH ) + zB ; zC = abs ( zE ) + zD ; zH = zy + zG ; zB = u_texel_size . x ; zo = zA >= zC ; zE = zF * 2.0 + zH ; if ( ! zo ) zv = zw ; if ( ! zo ) zt = zu ; if ( zo ) zB = u_texel_size . y ; zD = ( zE * ( 1.0 / 12.0 ) ) - zx ; zy = zv - zx ; zG = zt - zx ; zA = zv + zx ; zC = zt + zx ; zp = abs ( zy ) >= abs ( zG ) ; zF = max ( abs ( zy ) , abs ( zG ) ) ; if ( zp ) zB = - zB ; zH = clamp ( abs ( zD ) * zz , 0.0 , 1.0 ) ; zO . x = zN . x ; zO . y = zN . y ; zP . x = ( ! zo ) ? 0.0 : u_texel_size . x ; zP . y = ( zo ) ? 0.0 : u_texel_size . y ; if ( ! zo ) zO . x += zB * 0.5 ; if ( zo ) zO . y += zB * 0.5 ; zQ . x = zO . x - zP . x ; zQ . y = zO . y - zP . y ; zR . x = zO . x + zP . x ; zR . y = zO . y + zP . y ; zw = ( ( - 2.0 ) * zH ) + 3.0 ; zu = za ( texture2D ( u_color , zQ ) ) ; zE = zH * zH ; zv = za ( texture2D ( u_color , zR ) ) ; if ( ! zp ) zA = zC ; zt = zF * 1.0 / 4.0 ; zy = zx - zA * 0.5 ; zG = zw * zE ; zp = zy < 0.0 ; zu -= zA * 0.5 ; zv -= zA * 0.5 ; zq = abs ( zu ) >= zt ; zr = abs ( zv ) >= zt ; if ( ! zq ) zQ . x -= zP . x * 1.5 ; if ( ! zq ) zQ . y -= zP . y * 1.5 ; zs = ( ! zq ) || ( ! zr ) ; if ( ! zr ) zR . x += zP . x * 1.5 ; if ( ! zr ) zR . y += zP . y * 1.5 ; if ( zs ) { if ( ! zq ) zu = za ( texture2D ( u_color , zQ . xy ) ) ; if ( ! zr ) zv = za ( texture2D ( u_color , zR . xy ) ) ; if ( ! zq ) zu = zu - zA * 0.5 ; if ( ! zr ) zv = zv - zA * 0.5 ; zq = abs ( zu ) >= zt ; zr = abs ( zv ) >= zt ; if ( ! zq ) zQ . x -= zP . x * 2.0 ; if ( ! zq ) zQ . y -= zP . y * 2.0 ; zs = ( ! zq ) || ( ! zr ) ; if ( ! zr ) zR . x += zP . x * 2.0 ; if ( ! zr ) zR . y += zP . y * 2.0 ; if ( zs ) { if ( ! zq ) zu = za ( texture2D ( u_color , zQ . xy ) ) ; if ( ! zr ) zv = za ( texture2D ( u_color , zR . xy ) ) ; if ( ! zq ) zu = zu - zA * 0.5 ; if ( ! zr ) zv = zv - zA * 0.5 ; zq = abs ( zu ) >= zt ; zr = abs ( zv ) >= zt ; if ( ! zq ) zQ . x -= zP . x * 2.0 ; if ( ! zq ) zQ . y -= zP . y * 2.0 ; zs = ( ! zq ) || ( ! zr ) ; if ( ! zr ) zR . x += zP . x * 2.0 ; if ( ! zr ) zR . y += zP . y * 2.0 ; if ( zs ) { if ( ! zq ) zu = za ( texture2D ( u_color , zQ . xy ) ) ; if ( ! zr ) zv = za ( texture2D ( u_color , zR . xy ) ) ; if ( ! zq ) zu = zu - zA * 0.5 ; if ( ! zr ) zv = zv - zA * 0.5 ; zq = abs ( zu ) >= zt ; zr = abs ( zv ) >= zt ; if ( ! zq ) zQ . x -= zP . x * 4.0 ; if ( ! zq ) zQ . y -= zP . y * 4.0 ; zs = ( ! zq ) || ( ! zr ) ; if ( ! zr ) zR . x += zP . x * 4.0 ; if ( ! zr ) zR . y += zP . y * 4.0 ; if ( zs ) { if ( ! zq ) zu = za ( texture2D ( u_color , zQ . xy ) ) ; if ( ! zr ) zv = za ( texture2D ( u_color , zR . xy ) ) ; if ( ! zq ) zu = zu - zA * 0.5 ; if ( ! zr ) zv = zv - zA * 0.5 ; zq = abs ( zu ) >= zt ; zr = abs ( zv ) >= zt ; if ( ! zq ) zQ . x -= zP . x * 2.0 ; if ( ! zq ) zQ . y -= zP . y * 2.0 ; if ( ! zr ) zR . x += zP . x * 2.0 ; if ( ! zr ) zR . y += zP . y * 2.0 ; } } } } zD = zN . x - zQ . x ; zz = zR . x - zN . x ; if ( ! zo ) zD = zN . y - zQ . y ; if ( ! zo ) zz = zR . y - zN . y ; zs = ( zu < 0.0 ) != zp ; zH = ( zz + zD ) ; zq = ( zv < 0.0 ) != zp ; zC = 1.0 / zH ; zr = zD < zz ; zF = min ( zD , zz ) ; zp = zr ? zs : zq ; zx = zG * zG ; zw = ( zF * ( - zC ) ) + 0.5 ; zE = zx * FXAA_QUALITY_SUBPIX ; zy = zp ? zw : 0.0 ; zA = max ( zy , zE ) ; if ( ! zo ) zN . x += zA * zB ; if ( zo ) zN . y += zA * zB ; return texture2D ( u_color , zN ) ; }".split(" ")},
{type:"define",name:"FXAA_CONSOLE_EDGE_SHARPNESS",b:["8.0"]},{type:"define",name:"FXAA_CONSOLE_EDGE_THRESHOLD",b:["0.125"]},{type:"define",name:"FXAA_CONSOLE_EDGE_THRESHOLD_MIN",b:["0.05"]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["AA_METHOD","==","AA_METHOD_PASS"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = texture2D ( u_color , a ) ;".split(" ")}]}},{type:"elif",c:["AA_METHOD","==","AA_METHOD_FXAA_LIGHT"],group:{type:"group",a:[{type:"textline",
b:"gl_FragColor = zn ( ) ;".split(" ")}]}},{type:"elif",c:["AA_METHOD","==","AA_METHOD_FXAA_QUALITY"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = zS ( ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , 1.0 , 0.0 , 1.0 ) * texture2D ( u_color , a ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; varying vec2 a ; void main ( ) { vec4 yQ ; vec2 yV , yW ; yV = vec2 ( 0.0 , 0.0 ) ; yW = u_texel_size ; yQ = texture2D ( u_color , a ) ; gl_FragColor = yQ * 0.0875447373698 ; yV += yW ; gl_FragColor += texture2D ( u_color , a + yV ) * 0.0858112354248 ; gl_FragColor += texture2D ( u_color , a - yV ) * 0.0858112354248 ; yV += yW ; gl_FragColor += texture2D ( u_color , a + yV ) * 0.0808139781061 ; gl_FragColor += texture2D ( u_color , a - yV ) * 0.0808139781061 ; yV += yW ; gl_FragColor += texture2D ( u_color , a + yV ) * 0.0731235112908 ; gl_FragColor += texture2D ( u_color , a - yV ) * 0.0731235112908 ; yV += yW ; gl_FragColor += texture2D ( u_color , a + yV ) * 0.0635705267419 ; gl_FragColor += texture2D ( u_color , a - yV ) * 0.0635705267419 ; yV += yW ; gl_FragColor += texture2D ( u_color , a + yV ) * 0.0530985673112 ; gl_FragColor += texture2D ( u_color , a - yV ) * 0.0530985673112 ; yV += yW ; gl_FragColor += texture2D ( u_color , a + yV ) * 0.0426125984122 ; gl_FragColor += texture2D ( u_color , a - yV ) * 0.0426125984122 ; yV += yW ; gl_FragColor += texture2D ( u_color , a + yV ) * 0.0328565115809 ; gl_FragColor += texture2D ( u_color , a - yV ) * 0.0328565115809 ; yV += yW ; gl_FragColor += texture2D ( u_color , a + yV ) * 0.0243407024472 ; gl_FragColor += texture2D ( u_color , a - yV ) * 0.0243407024472 ; gl_FragColor = max ( 0.7 * yQ , gl_FragColor ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; varying vec2 a ; void main ( ) { vec4 yQ , yV ; yQ = texture2D ( u_main , a ) ; yV = texture2D ( u_bloom , a ) ; yQ = yQ ; yQ += yV ; gl_FragColor = vec4 ( yQ . rgb , 1.0 ) ; }".split(" ")}]};a["postprocessing/compositing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"PI_4",
b:["0.785398163"]},{type:"textline",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; varying vec2 a ; void main ( ) { float yQ ; vec3 yV , yW ; vec4 yX ; yX = texture2D ( u_color , a ) ; yV = yX . rgb ; if ( u_brightness < 0.0 ) yV = yV * ( 1.0 + u_brightness ) ; else yV = yV + ( ( 1.0 - yV ) * u_brightness ) ; yV = ( yV - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * PI_4 ) ) + 0.5 ; yV *= u_exposure ; yW = vec3 ( 0.299 , 0.587 , 0.114 ) ; yQ = dot ( yV , yW ) ; yV = mix ( vec3 ( yQ ) , yV , u_saturation ) ; gl_FragColor = vec4 ( yV , yX . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; varying vec2 a ; void main ( ) { gl_FragColor = fP ( clamp ( za ( u_depth , a , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};a["postprocessing/dof.glslf"]=
{type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front ; uniform float u_dof_rear ; uniform vec2 u_camera_range ; varying vec2 a ; void main ( ) { float zb , zc ; vec4 zd , ze ; zd = texture2D ( u_sharp , a ) ; if ( u_dof_dist > 0.0 ) { zb = za ( u_depth , a , u_camera_range ) ; zb *= u_view_max_depth ; if ( zb < u_dof_dist ) zc = ( u_dof_dist - zb ) / u_dof_front ; else zc = ( zb - u_dof_dist ) / u_dof_rear ; zc = clamp ( zc , 0.0 , 1.0 ) ; ze = texture2D ( u_blurred , a ) ; gl_FragColor = mix ( zd , ze , zc ) ; } else gl_FragColor = zd ; }".split(" ")}]};
a["postprocessing/glow.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; varying vec2 a ; void main ( ) { float yQ ; vec4 zb , zc , zd ; zb = texture2D ( u_src_color , a ) ; zc = texture2D ( u_glow_mask_small , a ) ; zd = texture2D ( u_glow_mask_large , a ) ; gl_FragColor = zb ; if ( zd . a != 0.0 ) { yQ = u_glow_mask_large_coeff * zd . a ; yQ = clamp ( yQ , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , zd . rgb / zd . a , yQ ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , yQ ) ; } if ( zc . a != 0.0 ) { yQ = u_glow_mask_small_coeff * zc . a ; yQ = clamp ( yQ , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , zc . rgb / zc . a , yQ ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , yQ ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"include",file:"procedural.glslf"},{type:"include",file:"pack.glslf"},{type:"var",name:"STEPS_PER_PASS",b:["0.0"]},{type:"textline",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},{type:"condition",
a:[{type:"if",c:["DEPTH_RGBA"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_camera_range",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"varying float zb ; varying vec2 zc ;".split(" ")}]}}]}]}}]},{type:"textline",b:"varying vec2 a ; varying vec4 zd ; void main ( ) { vec4 ze ; float zf , zg , zh , zi , zj ; vec2 zk , zl , zm ; zk = ( zd . xy - a ) ; zf = length ( zk ) ; zk = u_radial_blur_step * zk / zf ; zg = zf / u_radial_blur_step ; zk *= min ( zg , STEPS_PER_PASS ) / STEPS_PER_PASS ; zg = max ( zg , STEPS_PER_PASS ) ; zl = a ; zh = 0.0 ; for ( float zn = 0.0 ; zn < STEPS_PER_PASS ; zn += 1.0 ) { if ( zn <= zg ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["DEPTH_RGBA"],group:{type:"group",a:[{type:"textline",b:"zi = za ( u_input , zl , u_camera_range ) ; zh += max ( ( 1.0 - pow ( zf , 0.3 ) ) * step ( 0.9 , zi ) , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"ze = texture2D ( u_input , zl ) ; zh += fT ( ze ) ;".split(" ")}]}}]},{type:"textline",b:"} zl += zk ; }".split(" ")},{type:"condition",a:[{type:"if",c:["DEPTH_RGBA","&&","WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",
b:"zm = a + zc ; zj = cH ( vec2 ( 2.5 * ( zm . x ) , 2.5 * ( zm . y ) + 1.0 * u_time ) ) . x + 0.75 * cH ( vec2 ( 5.0 * ( zm . x ) - 0.66 * u_time , 5.0 * ( zm . y ) + 0.66 * u_time ) ) . x + 0.5 * dc ( vec2 ( 7.5 * ( zm . x ) + 0.33 * u_time , 7.5 * ( zm . y ) - 0.33 * u_time ) ) ; zj *= clamp ( 1.2 - sqrt ( 0.2 * zf ) , 0.0 , 1.0 ) * zb ; zh = max ( zj , zh ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = fP ( zh / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]={type:"group",
a:[{type:"include",file:"math.glslv"},{type:"textline",b:"attribute vec2 a_bb_vertex ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEPTH_RGBA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ; varying float zb ; varying vec2 zc ;".split(" ")}]}}]}]}}]},{type:"textline",b:"varying vec2 a ; varying vec4 zd ; void main ( ) { float yQ , ze ; vec3 zf ; a = a_bb_vertex + 0.5 ; zf = normalize ( u_sun_direction ) ; zd = u_proj_matrix * u_view_matrix * vec4 ( zf , 0.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DEPTH_RGBA","&&","WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"if ( u_cam_water_depth < 0.0 ) { zb = 1.0 ; zf = vec3 ( 0.0 , 1.0 , 0.0 ) ; zf = j ( u_camera_quat , zf ) ; zf = normalize ( zf ) ; yQ = dot ( zf , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; ze = atan ( zf . x , zf . z ) ; zc = vec2 ( - ze , acos ( yQ ) ) ; } else { zb = 0.0 ; }".split(" ")}]}}]},{type:"textline",b:"zd . xy = 0.5 * ( zd . xy / zd . w + 1.0 ) ; zd += 99999.0 * step ( zd . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/god_rays_combine.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; varying vec2 a ; void main ( ) { float yQ ; vec3 ze ; vec4 zf ; zf = texture2D ( u_main , a ) ; ze = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; fB ( zf . rgb ) ; yQ = fT ( texture2D ( u_god_rays , a ) ) ; ze = zf . rgb + u_god_rays_intensity * vec3 ( yQ ) * ze ; fD ( ze ) ; gl_FragColor . rgb = ze ; gl_FragColor . a = zf . a ; }".split(" ")}]};
a["postprocessing/luminance.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_input ; varying vec2 a ; void main ( ) { float yQ ; vec4 ze ; ze = texture2D ( u_input , a ) ; yQ = dot ( ze . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; gl_FragColor = vec4 ( vec3 ( yQ ) , 1.0 ) ; }".split(" ")}]};a["postprocessing/luminance_av.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_input ; void main ( ) { float yQ , ze ; ze = 0.0 ; for ( float zf = 0.025 ; zf < 1.0 ; zf += 0.05 ) for ( float zg = 0.025 ; zg < 1.0 ; zg += 0.05 ) { yQ = max ( texture2D ( u_input , vec2 ( zf , zg ) ) . r , 0.01 ) ; ze += log ( yQ ) ; } ze = exp ( ze / 400.0 ) ; gl_FragColor = vec4 ( vec3 ( ze ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; varying vec2 a ; varying float ze ; void main ( ) { vec4 zf ; float zg , zh ; zg = texture2D ( u_average_lum , vec2 ( 0.5 ) ) . r ; zh = texture2D ( u_luminance , a ) . r ; zf = texture2D ( u_main , a ) ; zh = zh / zg ; zg = u_bloom_edge_lum ; gl_FragColor = zf * max ( zh - zg , 0.0 ) * ze ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec2 a_position ; uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; varying vec2 a ; varying float ze ; const vec3 yQ = vec3 ( 0.0 , 1.0 , 0.0 ) ; void zm ( in vec4 zf , in vec3 zg , out vec3 zh ) { float zi , zj , zk , zl ; zi = zf . w * zg . x + zf . y * zg . z - zf . z * zg . y ; zj = zf . w * zg . y + zf . z * zg . x - zf . x * zg . z ; zk = zf . w * zg . z + zf . x * zg . y - zf . y * zg . x ; zl = - zf . x * zg . x - zf . y * zg . y - zf . z * zg . z ; zh . x = zi * zf . w - zl * zf . x - zj * zf . z + zk * zf . y ; zh . y = zj * zf . w - zl * zf . y - zk * zf . x + zi * zf . z ; zh . z = zk * zf . w - zl * zf . z - zi * zf . y + zj * zf . x ; } void main ( ) { vec3 zn ; a = 2.0 * a_position ; zm ( u_camera_quat , yQ , zn ) ; ze = dot ( - zn , u_sun_direction ) * u_bloom_key ; ze *= max ( sign ( u_sun_direction . y ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; varying vec2 a ; float yQ = 0.0042 ; void main ( ) { vec4 zf , zg , zh , zi ; zf = texture2D ( u_mb_tex_curr , a ) ; zg = texture2D ( u_mb_tex_accum , a ) ; if ( length ( zf - zg ) > u_motion_blur_decay_threshold ) { zh = ( 1.0 - u_motion_blur_exp ) * zf + u_motion_blur_exp * zg ; zh = zh - zg ; zi = zf - zg ; zi = min ( max ( abs ( zh ) , vec4 ( yQ ) ) , abs ( zi ) ) * sign ( zh ) ; gl_FragColor = zg + zi ; } else { gl_FragColor = zf ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; varying vec2 a ; void main ( ) { vec3 yQ ; float zf ; vec4 zg , zh , zi ; zg = texture2D ( u_outline_src , a ) ; gl_FragColor = zg ; if ( u_draw_outline != 0.0 ) { zh = texture2D ( u_outline_mask , a ) ; zi = texture2D ( u_outline_mask_blurred , a ) ; zf = zi . a - zh . a ; if ( zf != 0.0 ) { zf = smoothstep ( 0.0 , 1.0 , zi . a ) ; if ( zh . a == 0.0 ) { yQ = u_outline_color ; fD ( yQ ) ; zi = vec4 ( clamp ( yQ , 0.0 , 1.0 ) , 1.0 ) ; gl_FragColor = mix ( zg , zi , zf ) ; } } } }".split(" ")}]};
a["postprocessing/postprocessing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"POST_EFFECT_NONE",b:["1"]},{type:"define",name:"POST_EFFECT_GRAYSCALE",b:["2"]},{type:"define",name:"POST_EFFECT_X_BLUR",b:["3"]},{type:"define",name:"POST_EFFECT_Y_BLUR",b:["4"]},{type:"define",name:"POST_EFFECT_X_EXTEND",b:["5"]},{type:"define",name:"POST_EFFECT_Y_EXTEND",b:["6"]},{type:"textline",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; varying vec2 a ; void main ( ) { vec2 yQ , zf ; vec4 zg ;".split(" ")},
{type:"condition",a:[{type:"if",c:["POST_EFFECT","==","POST_EFFECT_NONE"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = texture2D ( u_color , a ) ;".split(" ")}]}},{type:"elif",c:["POST_EFFECT","==","POST_EFFECT_GRAYSCALE"],group:{type:"group",a:[{type:"textline",b:"zg = texture2D ( u_color , a ) ; gl_FragColor . rgb = vec3 ( ( zg . r + zg . g + zg . b ) / 3.0 ) ; gl_FragColor . a = 1.0 ;".split(" ")}]}},{type:"elif",c:"POST_EFFECT == POST_EFFECT_X_BLUR || POST_EFFECT == POST_EFFECT_Y_BLUR".split(" "),
group:{type:"group",a:[{type:"textline",b:"yQ = vec2 ( 0.0 , 0.0 ) ; zf = u_texel_size ; zg = texture2D ( u_color , a ) ; gl_FragColor = zg * 0.2270270270 ; yQ += zf ; zg = texture2D ( u_color , a + yQ ) ; gl_FragColor += zg * 0.1945945946 ; zg = texture2D ( u_color , a - yQ ) ; gl_FragColor += zg * 0.1945945946 ; yQ += zf ; zg = texture2D ( u_color , a + yQ ) ; gl_FragColor += zg * 0.1216216216 ; zg = texture2D ( u_color , a - yQ ) ; gl_FragColor += zg * 0.1216216216 ; yQ += zf ; zg = texture2D ( u_color , a + yQ ) ; gl_FragColor += zg * 0.0540540541 ; zg = texture2D ( u_color , a - yQ ) ; gl_FragColor += zg * 0.0540540541 ; yQ += zf ; zg = texture2D ( u_color , a + yQ ) ; gl_FragColor += zg * 0.0162162162 ; zg = texture2D ( u_color , a - yQ ) ; gl_FragColor += zg * 0.0162162162 ;".split(" ")}]}},
{type:"elif",c:"POST_EFFECT == POST_EFFECT_X_GLOW_BLUR || POST_EFFECT == POST_EFFECT_Y_GLOW_BLUR".split(" "),group:{type:"group",a:[{type:"textline",b:"yQ = vec2 ( 0.0 , 0.0 ) ; zf = u_texel_size ; zg = texture2D ( u_color , a ) ; gl_FragColor = zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.152507 ; yQ += zf ; zg = texture2D ( u_color , a + yQ ) ; gl_FragColor += zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.141763 ; zg = texture2D ( u_color , a - yQ ) ; gl_FragColor += zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.141763 ; yQ += zf ; zg = texture2D ( u_color , a + yQ ) ; gl_FragColor += zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.113861 ; zg = texture2D ( u_color , a - yQ ) ; gl_FragColor += zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.113861 ; yQ += zf ; zg = texture2D ( u_color , a + yQ ) ; gl_FragColor += zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.079019 ; zg = texture2D ( u_color , a - yQ ) ; gl_FragColor += zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.079019 ; yQ += zf ; zg = texture2D ( u_color , a + yQ ) ; gl_FragColor += zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.047383 ; zg = texture2D ( u_color , a - yQ ) ; gl_FragColor += zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.047383 ; yQ += zf ; zg = texture2D ( u_color , a + yQ ) ; gl_FragColor += zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.024549 ; zg = texture2D ( u_color , a - yQ ) ; gl_FragColor += zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.024549 ; yQ += zf ; zg = texture2D ( u_color , a + yQ ) ; gl_FragColor += zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.01099 ; zg = texture2D ( u_color , a - yQ ) ; gl_FragColor += zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.01099 ; yQ += zf ; zg = texture2D ( u_color , a + yQ ) ; gl_FragColor += zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.00425 ; zg = texture2D ( u_color , a - yQ ) ; gl_FragColor += zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.00425 ; yQ += zf ; zg = texture2D ( u_color , a + yQ ) ; gl_FragColor += zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.00142 ; zg = texture2D ( u_color , a - yQ ) ; gl_FragColor += zg * ( 1.0 - step ( 0.0 , - zg . a ) ) * 0.00142 ; gl_FragColor = clamp ( gl_FragColor , 0.0 , 1.0 ) ;".split(" ")}]}},
{type:"elif",c:"POST_EFFECT == POST_EFFECT_X_EXTEND || POST_EFFECT == POST_EFFECT_Y_EXTEND".split(" "),group:{type:"group",a:[{type:"textline",b:"zf = u_texel_size ; zg = texture2D ( u_color , a ) ; gl_FragColor = zg ; if ( zg . a == 0.0 ) { zg = texture2D ( u_color , a + zf ) ; if ( zg . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , zg . a ) ; else { zg = texture2D ( u_color , a - zf ) ; if ( zg . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , zg . a ) ; } }".split(" ")}]}}]},{type:"textline",
b:["}"]}]};a["postprocessing/postprocessing.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec2 a_position ; varying vec2 a ; void main ( ) { a = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"pack.glslf"},{type:"define",name:"SMAA_RESOLVE",b:["1"]},{type:"define",name:"SMAA_EDGE_DETECTION",
b:["2"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{type:"define",name:"AA_METHOD_SMAA_LOW",b:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",b:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",b:["4"]},{type:"textline",b:["uniform","sampler2D","u_color",";"]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_RESOLVE"],group:{type:"group",a:[{type:"textline",
b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_NEIGHBORHOOD_BLENDING"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_blend",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_EDGE_DETECTION","&&","SMAA_PREDICATION"],group:{type:"group",a:[{type:"textline",
b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_BLENDING_WEIGHT_CALCULATION"],group:{type:"group",a:[{type:"textline",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},{type:"textline",b:"uniform vec2 u_texel_size ; varying vec2 a ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_NEIGHBORHOOD_BLENDING"],group:{type:"group",a:[{type:"textline",
b:["varying","vec4","zf",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"varying vec4 zg ; varying vec4 zh ; varying vec4 zi ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_BLENDING_WEIGHT_CALCULATION"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","zj",";"]}]}}]},{type:"condition",a:[{type:"if",c:["AA_METHOD","==","AA_METHOD_SMAA_LOW"],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.15"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",
b:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{type:"elif",c:["AA_METHOD","==","AA_METHOD_SMAA_MEDIUM"],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{type:"elif",c:["AA_METHOD","==","AA_METHOD_SMAA_HIGH"],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",
b:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{type:"define",name:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{type:"elif",c:["AA_METHOD","==","AA_METHOD_SMAA_ULTRA"],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.05"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["16"]},{type:"define",name:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_THRESHOLD",group:{type:"group",
a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_DEPTH_THRESHOLD",group:{type:"group",a:[{type:"define",name:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS_DIAG",group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_CORNER_ROUNDING",group:{type:"group",a:[{type:"define",name:"SMAA_CORNER_ROUNDING",
b:["25"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",group:{type:"group",a:[{type:"define",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION_THRESHOLD",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{type:"condition",
a:[{type:"ifndef",name:"SMAA_PREDICATION_SCALE",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION_STRENGTH",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_REPROJECTION",group:{type:"group",a:[{type:"define",name:"SMAA_REPROJECTION",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_REPROJECTION_WEIGHT_SCALE",group:{type:"group",
a:[{type:"define",name:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{type:"define",name:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{type:"define",name:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",
")"]},{type:"define",name:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{type:"define",name:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{type:"define",name:"SMAA_CORNER_ROUNDING_NORM",b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_EDGE_DETECTION"],group:{type:"group",a:[{type:"textline",b:"vec3 zp ( vec2 zk , sampler2D zl ) { float zm , zn , zo ; zm = texture2D ( zl , zk ) . r ; zn = texture2D ( zl , zg . xy ) . r ; zo = texture2D ( zl , zg . zw ) . r ; return vec3 ( zm , zn , zo ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_EDGE_DETECTION"],group:{type:"group",a:[{type:"textline",b:"vec2 zu ( vec2 zq , sampler2D zr ) { vec2 zs ; vec3 zt ; zt = zp ( zq , zr ) ; zs = abs ( zt . xx - zt . yz ) ; zs = step ( SMAA_PREDICATION_THRESHOLD , zs ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * zs ) ; }".split(" ")}]}}]},{type:"textline",b:"void zy ( bvec2 zv , inout vec2 zw , vec2 zx ) { if ( zv . x ) zw . x = zx . x ; if ( zv . y ) zw . y = zx . y ; } void zy ( bvec4 zz , inout vec4 zA , vec4 zB ) { zy ( zz . xy , zA . xy , zB . xy ) ; zy ( zz . zw , zA . zw , zB . zw ) ; } vec2 zD ( vec2 zC ) { return sign ( zC ) * floor ( abs ( zC ) + .5 ) ; } vec4 zD ( vec4 zE ) { return sign ( zE ) * floor ( abs ( zE ) + .5 ) ; }".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_EDGE_DETECTION"],group:{type:"group",a:[{type:"textline",b:"vec2 zR ( vec2 zF , sampler2D zG".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PREDICATION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","zH"]}]}}]},{type:"textline",b:") { vec4 zI ; float zJ , zK , zL , zM , zN ; vec3 zO ; vec2 zP , zQ ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PREDICATION"],group:{type:"group",a:[{type:"textline",b:"zP = zu ( zF , zH ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"zP = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{type:"textline",b:"zO = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; zJ = dot ( texture2D ( zG , zF ) . rgb , zO ) ; zK = dot ( texture2D ( zG , zg . xy ) . rgb , zO ) ; zL = dot ( texture2D ( zG , zg . zw ) . rgb , zO ) ; zI . xy = abs ( zJ - vec2 ( zK , zL ) ) ; zP = step ( zP , zI . xy ) ; if ( dot ( zP , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; zM = dot ( texture2D ( zG , zh . xy ) . rgb , zO ) ; zN = dot ( texture2D ( zG , zh . zw ) . rgb , zO ) ; zI . zw = abs ( zJ - vec2 ( zM , zN ) ) ; zQ = max ( zI . xy , zI . zw ) ; zJ = dot ( texture2D ( zG , zi . xy ) . rgb , zO ) ; zM = dot ( texture2D ( zG , zi . zw ) . rgb , zO ) ; zI . zw = abs ( vec2 ( zK , zL ) - vec2 ( zJ , zM ) ) ; zQ = max ( zQ . xy , zI . zw ) ; zN = max ( zQ . x , zQ . y ) ; zP . xy *= step ( zN , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * zI . xy ) ; return zP ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["!","SMAA_DISABLE_DIAG_DETECTION"],group:{type:"group",a:[{type:"textline",b:"vec2 zT ( vec2 zS ) { zS . r = zS . r * abs ( 5.0 * zS . r - 5.0 * 0.75 ) ; return zD ( zS ) ; } vec4 zT ( vec4 zU ) { zU . rb = zU . rb * abs ( 5.0 * zU . rb - 5.0 * 0.75 ) ; return zD ( zU ) ; } vec2 Ab ( sampler2D zV , vec2 zW , vec2 zX , out vec2 zY ) { vec3 zZ ; vec4 z_ ; z_ = vec4 ( zW , - 1.0 , 1.0 ) ; zZ = vec3 ( u_texel_size , 1.0 ) ; for ( int Aa = 0 ; Aa < SMAA_MAX_SEARCH_STEPS_DIAG ; Aa ++ ) { if ( z_ . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && z_ . w > 0.9 ) { z_ . xyz += zZ * vec3 ( zX , 1.0 ) ; zY = texture2D ( zV , z_ . xy , 0.0 ) . rg ; z_ . w = dot ( zY , vec2 ( 0.5 , 0.5 ) ) ; } } return z_ . zw ; } vec2 Aj ( sampler2D Ac , vec2 Ad , vec2 Ae , out vec2 Af ) { vec3 Ag ; vec4 Ah ; Ah = vec4 ( Ad , - 1.0 , 1.0 ) ; Ah . x += 0.25 * u_texel_size . x ; Ag = vec3 ( u_texel_size , 1.0 ) ; for ( int Ai = 0 ; Ai < SMAA_MAX_SEARCH_STEPS_DIAG ; Ai ++ ) { if ( Ah . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && Ah . w > 0.9 ) { Ah . xyz = Ag * vec3 ( Ae , 1.0 ) + Ah . xyz ; Af = texture2D ( Ac , Ah . xy , 0.0 ) . rg ; Af = zT ( Af ) ; Ah . w = dot ( Af , vec2 ( 0.5 , 0.5 ) ) ; } } return Ah . zw ; } vec2 Ap ( sampler2D Ak , vec2 Al , vec2 Am , float An ) { vec2 Ao ; Ao = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * Am + Al ; Ao = SMAA_AREATEX_PIXEL_SIZE * Ao + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; Ao . x += 0.5 ; Ao . y += SMAA_AREATEX_SUBTEX_SIZE * An ; return texture2D ( Ak , Ao , 0.0 ) . rg ; } vec2 AB ( sampler2D Aq , sampler2D Ar , vec2 As , vec2 At , vec4 Au ) { vec4 Av , Aw , Ax ; vec2 Ay , Az , AA ; Ay = vec2 ( 0.0 , 0.0 ) ; if ( At . r > 0.0 ) { Av . xz = Ab ( Aq , As , vec2 ( - 1.0 , 1.0 ) , Az ) ; Av . x += float ( Az . y > 0.9 ) ; } else Av . xz = vec2 ( 0.0 , 0.0 ) ; Av . yw = Ab ( Aq , As , vec2 ( 1.0 , - 1.0 ) , Az ) ; if ( Av . x + Av . y > 2.0 ) { Aw = vec4 ( - Av . x + 0.25 , Av . x , Av . y , - Av . y - 0.25 ) * u_texel_size . xyxy + As . xyxy ; Ax . xy = texture2D ( Aq , Aw . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; Ax . zw = texture2D ( Aq , Aw . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; Ax . yxwz = zT ( Ax . xyzw ) ; AA = vec2 ( 2.0 , 2.0 ) * Ax . xz + Ax . yw ; zy ( bvec2 ( step ( 0.9 , Av . zw ) ) , AA , vec2 ( 0.0 , 0.0 ) ) ; Ay += Ap ( Ar , Av . xy , AA , Au . z ) ; } Av . xz = Aj ( Aq , As , vec2 ( - 1 , - 1 ) , Az ) ; if ( texture2D ( Aq , As + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { Av . yw = Aj ( Aq , As , vec2 ( 1 , 1 ) , Az ) ; Av . y += float ( Az . y > 0.9 ) ; } else Av . yw = vec2 ( 0.0 , 0.0 ) ; if ( Av . x + Av . y > 2.0 ) { Aw = vec4 ( - Av . x , - Av . x , Av . y , Av . y ) * u_texel_size . xyxy + As . xyxy ; Ax . x = texture2D ( Aq , Aw . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; Ax . y = texture2D ( Aq , Aw . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; Ax . zw = texture2D ( Aq , Aw . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; AA = vec2 ( 2.0 , 2.0 ) * Ax . xz + Ax . yw ; zy ( bvec2 ( step ( 0.9 , Av . zw ) ) , AA , vec2 ( 0 , 0 ) ) ; Ay += Ap ( Ar , Av . xy , AA , Au . w ) . gr ; } return Ay ; }".split(" ")}]}}]},
{type:"textline",b:"float AH ( sampler2D AC , vec2 AD , float AE ) { vec2 AF , AG ; AF = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; AG = SMAA_SEARCHTEX_SIZE * vec2 ( AE , 1.0 ) ; AF += vec2 ( - 1.0 , 1.0 ) ; AG += vec2 ( 0.5 , - 0.5 ) ; AF *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; AG *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return texture2D ( AC , AF * AD + AG , 0.0 ) . r ; } float AP ( sampler2D AI , sampler2D AJ , vec2 AK , float AL ) { float AM ; vec2 AN ; AN = vec2 ( 0.0 , 1.0 ) ; for ( int AO = 0 ; AO < SMAA_MAX_SEARCH_STEPS ; AO ++ ) { if ( AK . x > AL && AN . g > 0.8281 && AN . r == 0.0 ) { AN = texture2D ( AI , AK , 0.0 ) . rg ; AK = - vec2 ( 2.0 , 0.0 ) * u_texel_size + AK ; } } AM = - ( 255.0 / 127.0 ) * AH ( AJ , AN , 0.0 ) + 3.25 ; return u_texel_size . x * AM + AK . x ; } float AX ( sampler2D AQ , sampler2D AR , vec2 AS , float AT ) { float AU ; vec2 AV ; AV = vec2 ( 0.0 , 1.0 ) ; for ( int AW = 0 ; AW < SMAA_MAX_SEARCH_STEPS ; AW ++ ) { if ( AS . x < AT && AV . g > 0.8281 && AV . r == 0.0 ) { AV = texture2D ( AQ , AS , 0.0 ) . rg ; AS = vec2 ( 2.0 , 0.0 ) * u_texel_size + AS ; } } AU = - ( 255.0 / 127.0 ) * AH ( AR , AV , 0.5 ) + 3.25 ; return - u_texel_size . x * AU + AS . x ; } float Be ( sampler2D AY , sampler2D AZ , vec2 A_ , float Ba ) { float Bb ; vec2 Bc ; Bc = vec2 ( 1.0 , 0.0 ) ; for ( int Bd = 0 ; Bd < SMAA_MAX_SEARCH_STEPS ; Bd ++ ) { if ( A_ . y > Ba && Bc . r > 0.8281 && Bc . g == 0.0 ) { Bc = texture2D ( AY , A_ , 0.0 ) . rg ; A_ = - vec2 ( 0.0 , 2.0 ) * u_texel_size + A_ ; } } Bb = - ( 255.0 / 127.0 ) * AH ( AZ , Bc . gr , 0.0 ) + 3.25 ; return u_texel_size . y * Bb + A_ . y ; } float Bm ( sampler2D Bf , sampler2D Bg , vec2 Bh , float Bi ) { float Bj ; vec2 Bk ; Bk = vec2 ( 1.0 , 0.0 ) ; for ( int Bl = 0 ; Bl < SMAA_MAX_SEARCH_STEPS ; Bl ++ ) { if ( Bh . y < Bi && Bk . r > 0.8281 && Bk . g == 0.0 ) { Bk = texture2D ( Bf , Bh , 0.0 ) . rg ; Bh = vec2 ( 0.0 , 2.0 ) * u_texel_size + Bh ; } } Bj = - ( 255.0 / 127.0 ) * AH ( Bg , Bk . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * Bj + Bh . y ; } vec2 Bt ( sampler2D Bn , vec2 Bo , float Bp , float Bq , float Br ) { vec2 Bs ; Bs = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * zD ( 4.0 * vec2 ( Bp , Bq ) ) + Bo ; Bs = SMAA_AREATEX_PIXEL_SIZE * Bs + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; Bs . y = SMAA_AREATEX_SUBTEX_SIZE * Br + Bs . y ; return texture2D ( Bn , Bs , 0.0 ) . rg ; } void BA ( sampler2D Bu , inout vec2 Bv , vec4 Bw , vec2 Bx ) { vec2 By , Bz ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","SMAA_DISABLE_CORNER_DETECTION"],group:{type:"group",a:[{type:"textline",b:"By = step ( Bx . xy , Bx . yx ) ; Bz = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * By ; Bz /= By . x + By . y ; By = vec2 ( 1.0 , 1.0 ) ; By . x -= Bz . x * texture2D ( Bu , Bw . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; By . x -= Bz . y * texture2D ( Bu , Bw . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; By . y -= Bz . x * texture2D ( Bu , Bw . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; By . y -= Bz . y * texture2D ( Bu , Bw . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; Bv *= clamp ( By , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"} void BH ( sampler2D BB , inout vec2 BC , vec4 BD , vec2 BE ) { vec2 BF , BG ;".split(" ")},{type:"condition",a:[{type:"if",c:["!","SMAA_DISABLE_CORNER_DETECTION"],group:{type:"group",a:[{type:"textline",b:"BF = step ( BE . xy , BE . yx ) ; BG = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * BF ; BG /= BF . x + BF . y ; BF = vec2 ( 1.0 , 1.0 ) ; BF . x -= BG . x * texture2D ( BB , BD . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; BF . x -= BG . y * texture2D ( BB , BD . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; BF . y -= BG . x * texture2D ( BB , BD . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; BF . y -= BG . y * texture2D ( BB , BD . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; BC *= clamp ( BF , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_BLENDING_WEIGHT_CALCULATION"],group:{type:"group",a:[{type:"textline",b:"vec4 BV ( vec2 BI , vec2 BJ , sampler2D BK , sampler2D BL , sampler2D BM , vec4 BN ) { float BO , BP ; vec3 BQ ; vec2 BR , BS , BT ; vec4 BU ; BU = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; BR = texture2D ( BK , BI ) . rg ; if ( BR . g > 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["!","SMAA_DISABLE_DIAG_DETECTION"],group:{type:"group",a:[{type:"textline",
b:"BU . rg = AB ( BK , BL , BI , BR , BN ) ; if ( BU . r == - BU . g ) {".split(" ")}]}}]},{type:"textline",b:"; BQ . x = AP ( BK , BM , zg . xy , zi . x ) ; BQ . y = zh . y ; BS . x = BQ . x ; BO = texture2D ( BK , BQ . xy , 0.0 ) . r ; BQ . z = AX ( BK , BM , zg . zw , zi . y ) ; BS . y = BQ . z ; BS = abs ( zD ( BS / u_texel_size . xx - BJ . xx ) ) ; BT = sqrt ( BS ) ; BP = texture2D ( BK , BQ . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; BU . rg = Bt ( BL , BT , BO , BP , BN . y ) ; BQ . y = BI . y ; BA ( BK , BU . rg , BQ . xyzy , BS ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","SMAA_DISABLE_DIAG_DETECTION"],group:{type:"group",a:[{type:"textline",b:"} else BR . r = 0.0 ;".split(" ")}]}}]},{type:"textline",b:"} if ( BR . r > 0.0 ) { ; BQ . y = Be ( BK , BM , zh . xy , zi . z ) ; BQ . x = zg . x ; BT . x = BQ . y ; BO = texture2D ( BK , BQ . xy , 0.0 ) . g ; BQ . z = Bm ( BK , BM , zh . zw , zi . w ) ; BT . y = BQ . z ; BT = abs ( zD ( BT / u_texel_size . yy - BJ . yy ) ) ; BS = sqrt ( BT ) ; BP = texture2D ( BK , BQ . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; BU . ba = Bt ( BL , BS , BO , BP , BN . x ) ; BQ . x = BI . x ; BH ( BK , BU . ba , BQ . xyxz , BT ) ; } return BU ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_NEIGHBORHOOD_BLENDING"],group:{type:"group",a:[{type:"textline",b:"vec4 Cg ( vec2 BW , sampler2D BX , sampler2D BY".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","BZ"]}]}}]},{type:"textline",b:") { bool B_ ; vec2 Ca , Cb , Cc ; vec4 Cd , Ce , Cf ; Cd . x = texture2D ( BY , zf . xy ) . a ; Cd . y = texture2D ( BY , zf . zw ) . g ; Cd . wz = texture2D ( BY , BW ) . xz ; if ( dot ( Cd , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { Ce = texture2D ( BX , BW , 0.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"Cf = texture2D ( BZ , a ) ; Ca = 2.0 * ga ( Cf ) - 1.0 ; Ce . a = sqrt ( 2.0 * length ( Ca ) ) ;".split(" ")}]}}]},{type:"textline",b:"return Ce ; } else { B_ = max ( Cd . x , Cd . z ) > max ( Cd . y , Cd . w ) ; Cf = vec4 ( 0.0 , Cd . y , 0.0 , Cd . w ) ; Ca = Cd . yw ; zy ( bvec4 ( B_ , B_ , B_ , B_ ) , Cf , vec4 ( Cd . x , 0.0 , Cd . z , 0.0 ) ) ; zy ( bvec2 ( B_ , B_ ) , Ca , Cd . xz ) ; Ca /= dot ( Ca , vec2 ( 1.0 , 1.0 ) ) ; Ce = Cf * vec4 ( u_texel_size , - u_texel_size ) + BW . xyxy ; Cd = Ca . x * texture2D ( BX , Ce . xy , 0.0 ) ; Cd += Ca . y * texture2D ( BX , Ce . zw , 0.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"Cf = texture2D ( BZ , Ce . xy ) ; Cb = 2.0 * ga ( Cf ) - 1.0 ; Cc = Ca . x * Cb ; Cf = texture2D ( BZ , Ce . zw ) ; Cb = 2.0 * ga ( Cf ) - 1.0 ; Cc += Ca . y * Cb ; Cd . a = sqrt ( 2.0 * length ( Cc ) ) ;".split(" ")}]}}]},{type:"textline",b:["return","Cd",";","}","}"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_RESOLVE"],group:{type:"group",a:[{type:"textline",b:"vec4 Cq ( vec2 Ch , sampler2D Ci , sampler2D Cj".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","Ck"]}]}}]},{type:"textline",b:") { float Cl ; vec2 Cm ; vec4 Cn , Co , Cp ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"Cn = texture2D ( Ck , a ) ; Cm = 2.0 * ga ( Cn ) - 1.0 ; Cn = texture2D ( Ci , Ch ) ; Co = texture2D ( Cj , Ch - Cm ) ; Cl = abs ( Cn . a * Cn . a - Co . a * Co . a ) / 2.0 ; Cl = 0.5 * clamp ( 1.0 - sqrt ( Cl ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; Cp = mix ( Cn , Co , Cl ) ; Cp . a = 1.0 ; return Cp ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"Cn = texture2D ( Ci , Ch ) ; Co = texture2D ( Cj , Ch ) ; return mix ( Cn , Co , 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:"void main ( ) { vec4 Cr ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_EDGE_DETECTION"],group:{type:"group",a:[{type:"textline",b:"Cr = vec4 ( zR ( a , u_color".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PREDICATION"],group:{type:"group",a:[{type:"textline",
b:[",","u_predication_tex"]}]}}]},{type:"textline",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},{type:"elif",c:["SMAA_PASS","==","SMAA_BLENDING_WEIGHT_CALCULATION"],group:{type:"group",a:[{type:"textline",b:"Cr = BV ( a , zj , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{type:"elif",c:["SMAA_PASS","==","SMAA_NEIGHBORHOOD_BLENDING"],group:{type:"group",a:[{type:"textline",b:"Cr = Cg ( a , u_color , u_blend".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],
group:{type:"group",a:[{type:"textline",b:[",","u_velocity_tex"]}]}}]},{type:"textline",b:[")",";"]}]}},{type:"elif",c:["SMAA_PASS","==","SMAA_RESOLVE"],group:{type:"group",a:[{type:"textline",b:"Cr = vec4 ( Cq ( a , u_color , u_color_prev".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","u_velocity_tex"]}]}}]},{type:"textline",b:[")",")",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Cr = texture2D ( u_color , a ) ;".split(" ")}]}}]},
{type:"textline",b:["gl_FragColor","=","Cr",";","}"]}]};a["postprocessing/smaa.glslv"]={type:"group",a:[{type:"define",name:"SMAA_EDGE_DETECTION",b:["1"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["2"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",b:["3"]},{type:"define",name:"AA_METHOD_SMAA_LOW",b:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",b:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",b:["4"]},{type:"textline",b:"attribute vec2 a_position ; uniform vec2 u_texel_size ; varying vec2 a ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_NEIGHBORHOOD_BLENDING"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","zf",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"varying vec4 zg ; varying vec4 zh ; varying vec4 zi ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_BLENDING_WEIGHT_CALCULATION"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","zj",";"]}]}}]},{type:"condition",a:[{type:"if",c:["AA_METHOD","==","AA_METHOD_SMAA_LOW"],
group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{type:"elif",c:["AA_METHOD","==","AA_METHOD_SMAA_MEDIUM"],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{type:"elif",c:["AA_METHOD","==","AA_METHOD_SMAA_HIGH"],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{type:"elif",c:["AA_METHOD","==","AA_METHOD_SMAA_ULTRA"],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{type:"condition",
a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_EDGE_DETECTION"],group:{type:"group",a:[{type:"textline",b:"void zk ( vec2 yQ ) { zg = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + yQ . xyxy ; zh = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + yQ . xyxy ; zi = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + yQ . xyxy ; }".split(" ")}]}},
{type:"elif",c:["SMAA_PASS","==","SMAA_BLENDING_WEIGHT_CALCULATION"],group:{type:"group",a:[{type:"textline",b:"void zn ( vec2 zl , out vec2 zm ) { zm = zl / u_texel_size ; zg = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + zl . xyxy ; zh = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + zl . xyxy ; zi = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( zg . xz , zh . yw ) ; }".split(" ")}]}},{type:"elif",c:["SMAA_PASS",
"==","SMAA_NEIGHBORHOOD_BLENDING"],group:{type:"group",a:[{type:"textline",b:"void zp ( vec2 zo ) { zf = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + zo . xyxy ; }".split(" ")}]}}]},{type:"textline",b:"void main ( ) { a = 2.0 * a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_EDGE_DETECTION"],group:{type:"group",a:[{type:"textline",b:["zk","(","a",")",";"]}]}},{type:"elif",c:["SMAA_PASS","==","SMAA_BLENDING_WEIGHT_CALCULATION"],group:{type:"group",a:[{type:"textline",
b:"zn ( a , zj ) ;".split(" ")}]}},{type:"elif",c:["SMAA_PASS","==","SMAA_NEIGHBORHOOD_BLENDING"],group:{type:"group",a:[{type:"textline",b:["zp","(","a",")",";"]}]}}]},{type:"textline",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},
{type:"include",file:"procedural.glslf"},{type:"define",name:"SSAO_QUALITY_8",b:["1"]},{type:"define",name:"SSAO_QUALITY_16",b:["2"]},{type:"define",name:"SSAO_QUALITY_24",b:["3"]},{type:"define",name:"SSAO_QUALITY_32",b:["4"]},{type:"textline",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; varying vec2 a ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; float zl ( in vec2 zk ) { return za ( u_depth , zk , u_camera_range ) ; } void main ( ) { vec3 zm , zn , zo ; float zp , zq , zr , zs , zt , zu , zv ; zp = texture2D ( u_color , a ) . r ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SSAO_WHITE"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( zp , 1.0 , 0.0 , 1.0 ) ; return ;".split(" ")}]}}]},{type:"textline",b:"zm = normalize ( 2.0 * texture2D ( u_ssao_special_tex , a * 0.25 / u_texel_size ) . rgb - 1.0 ) ; zq = zl ( a ) ; zr = zq * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_QUALITY","==","SSAO_QUALITY_8"],group:{type:"group",a:[{type:"textline",b:"const float zw = 8.0 ; const int zx = 1 ;".split(" ")}]}},
{type:"elif",c:["SSAO_QUALITY","==","SSAO_QUALITY_16"],group:{type:"group",a:[{type:"textline",b:"const float zw = 16.0 ; const int zx = 2 ;".split(" ")}]}},{type:"elif",c:["SSAO_QUALITY","==","SSAO_QUALITY_24"],group:{type:"group",a:[{type:"textline",b:"const float zw = 24.0 ; const int zx = 3 ;".split(" ")}]}},{type:"elif",c:["SSAO_QUALITY","==","SSAO_QUALITY_32"],group:{type:"group",a:[{type:"textline",b:"const float zw = 32.0 ; const int zx = 4 ;".split(" ")}]}}]},{type:"textline",b:"zs = u_ssao_radius_increase * 0.001 ; const float zy = 1.0 + 2.4 / zw ; zt = 0.0 ; for ( int zz = 0 ; zz < zx ; zz ++ ) for ( int zA = - 1 ; zA <= 1 ; zA += 2 ) for ( int zB = - 1 ; zB <= 1 ; zB += 2 ) for ( int zC = - 1 ; zC <= 1 ; zC += 2 ) { zn = reflect ( normalize ( vec3 ( zA , zB , zC ) ) , zm ) * ( zs *= zy ) ; zo = vec3 ( a , zr ) ; zo += vec3 ( zn . xy , zn . z * zr * 2.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"zo . z -= 1.4 * ( zo . z - zr ) * step ( zr , zo . z ) ;".split(" ")}]}}]},{type:"textline",b:"zu = zl ( zo . xy ) * ( u_camera_range . y - u_camera_range . x ) ; zv = clamp ( ( zr - zu ) / zu , 0.0 , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"zt += mix ( 1.0 , zv , step ( zu , zo . z ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"zt += mix ( step ( zo . z , zu ) , 0.5 , zv ) ;".split(" ")}]}}]},{type:"textline",b:"} zt = zt / zw ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"zt = clamp ( zt * zt + 0.6 * zt , 0.0 , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zt = clamp ( zt * zt + zt , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"zq = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * zq ) ; zt = mix ( 1.0 , zt , zq ) ; gl_FragColor = vec4 ( zp , zt , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/ssao_blur.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"include",file:"depth_fetch.glslf"}]}}]},{type:"textline",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; varying vec2 a ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",
a:[{type:"textline",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float zl ( in vec2 zk ) { return za ( u_depth , zk , u_camera_range ) ; }".split(" ")}]}}]},{type:"textline",b:"void main ( ) { vec2 zm , zn ; float zo , zp , zq , zr , zs , zt , zu ; zo = 0.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"zp = zl ( a ) ; zq = 0.0 ; zr = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},
{type:"textline",b:"zm = vec2 ( - 2.0 ) ; for ( int zv = 0 ; zv < 4 ; ++ zv ) { for ( int zw = 0 ; zw < 4 ; ++ zw ) { zn = ( zm + vec2 ( float ( zv ) , float ( zw ) ) ) * u_texel_size ; zs = texture2D ( u_ssao_mask , a + zn ) . g ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"zt = zl ( a + zn ) ; zu = 1.0 - clamp ( abs ( zt - zp ) * zr , 0.0 , 1.0 ) ; zo += zs * zu ; zq += zu ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:["zo","+=","zs",";"]}]}}]},{type:"textline",b:["}","}"]},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , a ) . r , zo / zq , 0.0 , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , a ) . r , zo / 16.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["postprocessing/velocity.glslf"]={type:"group",a:[{type:"include",
file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; varying vec2 a ; void main ( ) { vec2 yQ ; vec4 zk , zl ; float zm ; zm = texture2D ( u_depth , a ) . x ; zk = vec4 ( a * 2.0 - 1.0 , 2.0 * zm - 1.0 , 1.0 ) ; zl = u_view_proj_inverse * zk ; zl = zl / zl . w ; zl = u_view_proj_prev * zl ; zl /= zl . w ; yQ = ( zk . xy - zl . xy ) / 4.0 + 0.5 ; yQ = clamp ( yQ , 0.0 , 1.0 ) ; gl_FragColor = fP ( yQ ) ; }".split(" ")}]};
a["include/precision_statement.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","float",";"]}]};a["include/math.glslv"]={type:"group",a:[{type:"var",name:"EPSILON",b:["0.0001"]},{type:"textline",b:"float b = 0.0 ; float c = 1.0 ; struct d { vec3 a ; vec3 b ; vec3 c ; vec3 d ; vec3 e ; vec3 f ; } ; bool g ( vec3 e , vec3 f ) { return any ( lessThan ( abs ( e - f ) , vec3 ( EPSILON ) ) ) ; } vec3 j ( in vec4 h , in vec3 i ) { return i + 2.0 * cross ( h . xyz , cross ( h . xyz , i ) + h . w * i ) ; } vec4 l ( in vec4 k ) { return vec4 ( - k . xyz , k . w ) / dot ( k , k ) ; } vec3 q ( vec4 m , vec4 n , vec4 o ) { vec3 p ; p = o . xyz * m . w ; p = j ( n , p ) ; p += m . xyz * o . w ; return p ; } vec3 w ( vec4 r , vec4 s , vec4 t ) { vec4 u ; vec3 v ; v = t . xyz - r . xyz * t . w ; u = l ( s ) ; v = j ( u , v ) ; v /= r . w ; return v ; } mat4 x ( ) { return mat4 ( c , b , b , b , b , c , b , b , b , b , c , b , b , b , b , c ) ; } mat4 z ( float y ) { return mat4 ( c , b , b , b , b , cos ( y ) , sin ( y ) , b , b , - sin ( y ) , cos ( y ) , b , b , b , b , c ) ; } mat4 B ( float A ) { return mat4 ( cos ( A ) , b , - sin ( A ) , b , b , c , b , b , sin ( A ) , b , cos ( A ) , b , b , b , b , c ) ; } mat4 D ( float C ) { return mat4 ( cos ( C ) , sin ( C ) , b , b , - sin ( C ) , cos ( C ) , b , b , b , b , c , b , b , b , b , c ) ; } d F ( in d E ) { return d ( E . a , E . b , normalize ( E . c ) , normalize ( E . d ) , normalize ( E . e ) , E . f ) ; }".split(" ")}]};
a["include/to_world.glslv"]={type:"group",a:[{type:"define",name:"SKIN_SLERP",b:["0"]},{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"define",name:"MAX_BILLBOARD_ANGLE",b:["(","M_PI","/","4.0",")"]},{type:"textline",b:"const vec3 G = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:"BILLBOARD_SPHERICAL || ! BILLBOARD && ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW )".split(" "),group:{type:"group",a:[{type:"textline",b:"mat4 N ( vec3 H , mat4 I ) { vec3 J , L , M ; J = vec3 ( I [ 0 ] [ 0 ] , I [ 1 ] [ 0 ] , I [ 2 ] [ 0 ] ) ; L = vec3 ( I [ 0 ] [ 1 ] , I [ 1 ] [ 1 ] , I [ 2 ] [ 1 ] ) ; M = vec3 ( I [ 0 ] [ 2 ] , I [ 1 ] [ 2 ] , I [ 2 ] [ 2 ] ) ; L = cross ( M , J ) ; J = normalize ( J ) ; L = normalize ( L ) ; M = normalize ( M ) ; return mat4 ( vec4 ( J , 0.0 ) , vec4 ( L , 0.0 ) , vec4 ( M , 0.0 ) , vec4 ( H , 1.0 ) ) ; }".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 T ( vec3 O , vec3 P ) { vec3 Q , R , S ; Q = O - P ; Q . y = 0.0 ; R = cross ( G , Q ) ; S = cross ( Q , R ) ; R = normalize ( R ) ; S = normalize ( S ) ; Q = normalize ( Q ) ; return mat4 ( vec4 ( R , 0.0 ) , vec4 ( S , 0.0 ) , vec4 ( Q , 0.0 ) , vec4 ( P , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"mat4 aa ( in vec3 U , float V , float W , float X , vec3 Y ) { float Z , _ ; Z = fract ( length ( Y ) / 0.17 ) ; _ = X + Z / 10.0 ; Z = Z ; if ( X != 0.0 ) Z /= X ; U *= 1.0 + 0.5 * sin ( V ) ; _ = length ( U ) * W * sin ( 2.0 * 3.14 * V * _ + Z ) ; return D ( _ ) ; }".split(" ")}]}}]},
{type:"textline",b:"mat4 ai ( in vec3 ab , in vec3 ac , in mat4 ad ) { vec3 ae ; float af , ag ; mat4 ah ;".split(" ")},{type:"condition",a:[{type:"if",c:"BILLBOARD_SPHERICAL || ! BILLBOARD && ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW )".split(" "),group:{type:"group",a:[{type:"textline",b:"ah = N ( ac , ad ) ;".split(" ")}]}},{type:"elif",c:["BILLBOARD_RANDOM"],group:{type:"group",a:[{type:"textline",b:"af = fract ( ( ac . x * 1.43 + ac . y * 0.123 + ac . z * 6.1 ) ) ; af = 2.0 * M_PI * af ; ae = normalize ( vec3 ( ad [ 0 ] [ 2 ] , 0.0 , ad [ 2 ] [ 2 ] ) ) ; ag = acos ( ae [ 2 ] ) ; if ( ae [ 0 ] < 0.0 ) ag = 2.0 * M_PI - ag ; ag = ag - af ; if ( ag < 0.0 ) ag = 2.0 * M_PI + ag ; af = af ; if ( ag <= MAX_BILLBOARD_ANGLE ) af += ag ; else if ( ag <= M_PI - MAX_BILLBOARD_ANGLE ) af += MAX_BILLBOARD_ANGLE * ( 2.0 * ag - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( ag <= M_PI + MAX_BILLBOARD_ANGLE ) af += ag - M_PI ; else if ( ag <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) af += MAX_BILLBOARD_ANGLE * ( 2.0 * ag - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else af += ag - 2.0 * M_PI ; ah = B ( af ) ; ah [ 3 ] = vec4 ( ac , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"ah = T ( ab , ac ) ;".split(" ")}]}}]},{type:"textline",b:["return","ah",";","}"]},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","&&","!","STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"mat4 ao ( in vec3 aj , in vec3 ak , in mat4 al , mat4 am ) { mat4 an ; an = ai ( aj , ak , al ) ; am [ 3 ] = vec4 ( 0.0 , 0.0 , 0.0 , 1.0 ) ; an = an * am ; return an ; }".split(" ")}]}}]},{type:"textline",b:"d av ( in vec3 ap , in vec3 aq , in vec3 ar , in vec3 as , in vec3 at , in mat4 au ) { ap = ( au * vec4 ( ap , 1.0 ) ) . xyz ; aq = ( au * vec4 ( aq , 1.0 ) ) . xyz ; ar = ( au * vec4 ( ar , 0.0 ) ) . xyz ; as = ( au * vec4 ( as , 0.0 ) ) . xyz ; at = ( au * vec4 ( at , 0.0 ) ) . xyz ; return F ( d ( ap , aq , ar , as , at , vec3 ( 0.0 ) ) ) ; }".split(" ")}]};
a["include/scale_texcoord.glslv"]={type:"group",a:[{type:"textline",b:"vec2 ay ( vec2 aw , vec3 ax ) { return ( aw + 0.5 ) * ax . xy - 0.5 ; }".split(" ")}]};a["include/skin.glslv"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"vec4 aF ( in vec4 az , in vec4 aA , in float aB ) { float aC , aD , aE ; aC = az [ 0 ] * aA [ 0 ] + az [ 1 ] * aA [ 1 ] + az [ 2 ] * aA [ 2 ] + az [ 3 ] * aA [ 3 ] ; if ( aC < 0.0 ) { aA *= - 1.0 ; aC = - aC ; } if ( abs ( aC ) >= 1.0 ) return az ; aD = acos ( aC ) ; aC = sqrt ( 1.0 - aC * aC ) ; if ( abs ( aC ) < 0.001 ) return vec4 ( az * 0.5 + aA * 0.5 ) ; aE = sin ( ( 1.0 - aB ) * aD ) / aC ; aD = sin ( aB * aD ) / aC ; return az * aE + aA * aD ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"vec3 aR ( in vec3 aG , in vec4 aH , in vec4 aI , in vec4 aJ , in vec4 aK , in float aL ) { vec3 aM , aN , aO ; vec4 aP , aQ ;".split(" ")},{type:"condition",a:[{type:"if",c:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"aP = aF ( aH , aI , aL ) ; aQ = mix ( aJ , aK , aL ) ; aM = j ( aP , aG ) ; aM = aM * aQ . w + aQ . xyz ; return aM ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"aN = q ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( aG , 1.0 ) ) ; aO = j ( aH , aN ) ; aN = j ( aI , aN ) ; aO = aO * aJ . w + aJ . xyz ; aN = aN * aK . w + aK . xyz ; aM = mix ( aO , aN , aL ) ; return w ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( aM , 1.0 ) ) ;".split(" ")}]}}]},{type:"textline",b:"} vec3 a_ ( in vec3 aS , in vec4 aT , in vec4 aU , in float aV ) { vec4 aW ; vec3 aX , aY , aZ ; aX = q ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( aS , 0.0 ) ) ;".split(" ")},{type:"condition",a:[{type:"if",
c:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"aW = aF ( aT , aU , aV ) ; aY = j ( aW , aX ) ; return w ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( aY , 0.0 ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"aZ = j ( aT , aX ) ; aX = j ( aU , aX ) ; aY = mix ( aZ , aX , aV ) ; return w ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( aY , 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 aR ( in vec3 ba , in vec4 bb , in vec4 bc ) { vec3 bd ; bd = q ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( ba , 1.0 ) ) ; bd = j ( bb , bd ) ; bd = bd * bc . w + bc . xyz ; return w ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( bd , 1.0 ) ) ; } vec3 a_ ( in vec3 be , in vec4 bf ) { vec3 bg ; bg = q ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( be , 0.0 ) ) ; bg = j ( bf , bg ) ; return w ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( bg , 0.0 ) ) ; }".split(" ")}]}}]},
{type:"textline",b:"void bv ( inout vec3 bh , inout vec3 bi , inout vec3 bj , inout vec3 bk ) { int bl , bm ; vec4 bn ; vec3 bo , bp , bq , br ; float bs , bt ;".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:["bs","=","u_frame_factor",";"]}]}}]},{type:"textline",b:"if ( a_influence . y > 0.0 ) { bo = vec3 ( 0.0 , 0.0 , 0.0 ) ; bp = vec3 ( 0.0 , 0.0 , 0.0 ) ; bq = vec3 ( 0.0 , 0.0 , 0.0 ) ; br = vec3 ( 0.0 , 0.0 , 0.0 ) ; bn = a_influence ; for ( int bu = 0 ; bu < 4 ; bu ++ ) { bl = int ( bn [ bu ] ) ; bt = fract ( bn [ bu ] ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"bo += bt * aR ( bh , u_quatsb [ bl ] , u_quatsa [ bl ] , u_transb [ bl ] , u_transa [ bl ] , bs ) ; bp += bt * a_ ( bi , u_quatsb [ bl ] , u_quatsa [ bl ] , bs ) ; bq += bt * a_ ( bj , u_quatsb [ bl ] , u_quatsa [ bl ] , bs ) ; br += bt * a_ ( bk , u_quatsb [ bl ] , u_quatsa [ bl ] , bs ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"bo += bt * aR ( bh , u_quatsb [ bl ] , u_transb [ bl ] ) ; bp += bt * a_ ( bi , u_quatsb [ bl ] ) ; bq += bt * a_ ( bj , u_quatsb [ bl ] ) ; br += bt * a_ ( bk , u_quatsb [ bl ] ) ;".split(" ")}]}}]},
{type:"textline",b:"} bh = bo ; bi = bp ; bj = bq ; bk = br ; } if ( ! ( a_influence . y > 0.0 ) ) { bm = int ( a_influence [ 0 ] - 1.0 ) ; if ( bm > - 1 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"bh = aR ( bh , u_quatsb [ bm ] , u_quatsa [ bm ] , u_transb [ bm ] , u_transa [ bm ] , bs ) ; bi = a_ ( bi , u_quatsb [ bm ] , u_quatsa [ bm ] , bs ) ; bj = a_ ( bj , u_quatsb [ bm ] , u_quatsa [ bm ] , bs ) ; bk = a_ ( bk , u_quatsb [ bm ] , u_quatsa [ bm ] , bs ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"bh = aR ( bh , u_quatsb [ bm ] , u_transb [ bm ] ) ; bi = a_ ( bi , u_quatsb [ bm ] ) ; bj = a_ ( bj , u_quatsb [ bm ] ) ; bk = a_ ( bk , u_quatsb [ bm ] ) ;".split(" ")}]}}]},{type:"textline",b:["}","}","}"]}]}}]}]};a["include/wind_bending.glslv"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"void bG ( inout vec3 bw , in vec3 bx , in float by , in float bz , in float bA , in vec3 bB , in float bC ) { vec3 bD ; float bE , bF ; bE = length ( bx ) ; bF = bz * ( 1.0 + 0.1 * fract ( bE ) ) ; bF = by * bC * ( 1.0 + sin ( 2.0 * 3.14 * bA * bF + bE ) ) ; bE = ( bw . y - bx . y ) * abs ( bF ) ; bE += 1.0 ; bE *= bE ; bE = bE * bE - bE ; bD = bw ; bD . xz += bB . xz * bE * sign ( bF ) ; bD = bD - bx ; if ( all ( equal ( bD , vec3 ( 0.0 ) ) ) ) bw = bx ; else { bE = length ( bw - bx ) ; bw = bx + normalize ( bD ) * bE ; } }".split(" ")},
{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"vec4 bI ( vec4 bH ) { return bH * bH * ( 3.0 - 2.0 * bH ) ; } vec4 bK ( vec4 bJ ) { return abs ( fract ( bJ + 0.5 ) * 2.0 - 1.0 ) ; } vec4 bM ( vec4 bL ) { return bI ( bK ( bL ) ) ; } void cc ( inout vec3 bN , in float bO , in vec3 bP , in vec3 bQ , in vec3 bR , in float bS , in float bT , in float bU , in vec3 bV ) { vec3 bW ; vec4 bX ; vec2 bY , bZ ; float b_ , ca , cb ; b_ = dot ( bR , vec3 ( 1.0 ) ) ; ca = b_ + bV . g ; cb = dot ( bN , vec3 ( bV . g ) ) ; bY = ( bO + vec2 ( cb , ca ) ) ; bX = ( ( fract ( ( bY . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( bQ ) * bS ; bX = bM ( bX ) ; bZ = bX . xz + bX . yw ; bZ . y = 0.5 - bZ . y ; bW = bZ . xyx * bV . rbr * vec3 ( bT * bP . x , bU , bT * bP . z ) ; bN += bW ; }".split(" ")}]}}]},
{type:"textline",b:"void cj ( inout vec3 cd , inout vec3 ce , in vec3 cf ) { vec3 cg , ch , ci ; cg = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:"ch = ce ; ci = a_emitter_center ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"ch = cd ; ci = ce ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"cc ( ch , u_time , cf , cg , ci , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail ) ;".split(" ")}]}}]},{type:"textline",b:"bG ( ch , ci , au_wind_bending_amp , au_wind_bending_freq , u_time , cg , a_bending_col_main ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"bG ( ch , ci , au_wind_bending_amp , au_wind_bending_freq , u_time , cg , 1.0 ) ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:"cd += ch - ce ; ce = ch ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"cd = ch ; ce = ci ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]}]};a["include/std_enums.glsl"]={type:"group",a:[{type:"define",name:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{type:"define",name:"TEXTURE_COORDS_NORMAL",b:["2"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MULTIPLY",
b:["2"]},{type:"define",name:"SHADOW_SRC_NONE",b:["1"]},{type:"define",name:"SHADOW_SRC_DEPTH",b:["2"]},{type:"define",name:"SHADOW_SRC_MASK",b:["3"]},{type:"define",name:"SHADOW_DST_NONE",b:["1"]},{type:"define",name:"SHADOW_DST_DEPTH",b:["2"]},{type:"define",name:"SHADOW_DST_MASK",b:["3"]},{type:"define",name:"NO_SHADOWS",b:["1"]},{type:"define",name:"SHADOW_CASTING",b:["2"]},{type:"define",name:"SHADOW_MASK_GENERATION",b:["3"]},{type:"define",name:"SHADOW_MAPPING_OPAQUE",b:["4"]},{type:"define",
name:"SHADOW_MAPPING_BLEND",b:["5"]},{type:"define",name:"SPECULAR_PHONG",b:["1"]},{type:"define",name:"SPECULAR_COOKTORR",b:["2"]},{type:"define",name:"SPECULAR_WARDISO",b:["3"]},{type:"define",name:"SPECULAR_BLINN",b:["4"]},{type:"define",name:"DIFFUSE_LAMBERT",b:["1"]},{type:"define",name:"DIFFUSE_OREN_NAYAR",b:["2"]},{type:"define",name:"DIFFUSE_FRESNEL",b:["3"]},{type:"define",name:"DIFFUSE_MINNAERT",b:["4"]},{type:"define",name:"DIFFUSE_TOON",b:["5"]},{type:"define",name:"MAPPING_TYPE_TEXTURE",
b:["0.0"]},{type:"define",name:"MAPPING_TYPE_POINT",b:["1.0"]},{type:"define",name:"MAPPING_TYPE_VECTOR",b:["2.0"]},{type:"define",name:"MAPPING_TYPE_NORMAL",b:["3.0"]},{type:"define",name:"MTEX_BLEND",b:["0"]},{type:"define",name:"MTEX_ADD",b:["1"]},{type:"define",name:"MTEX_SUB",b:["2"]},{type:"define",name:"MTEX_MUL",b:["3"]},{type:"define",name:"MTEX_SCREEN",b:["4"]},{type:"define",name:"MTEX_OVERLAY",b:["5"]},{type:"define",name:"MTEX_DIFF",b:["6"]},{type:"define",name:"MTEX_DIV",b:["7"]},{type:"define",
name:"MTEX_DARK",b:["8"]},{type:"define",name:"MTEX_LIGHT",b:["9"]},{type:"define",name:"MTEX_BLEND_HUE",b:["10"]},{type:"define",name:"MTEX_BLEND_SAT",b:["11"]},{type:"define",name:"MTEX_BLEND_VAL",b:["12"]},{type:"define",name:"MTEX_BLEND_COLOR",b:["13"]},{type:"define",name:"MTEX_SOFT_LIGHT",b:["14"]},{type:"define",name:"MTEX_LIN_LIGHT",b:["15"]},{type:"define",name:"REFL_NONE",b:["0"]},{type:"define",name:"REFL_MIRRORMAP",b:["1"]},{type:"define",name:"REFL_PLANE",b:["2"]},{type:"define",name:"REFL_CUBE",
b:["3"]}]};a["include/procedural.glslf"]={type:"group",a:[{type:"textline",b:"float cq = 0.0 ; float cr = 1.0 ; vec4 ct ( vec4 cs ) { return cs - floor ( cs * ( cr / 289.0 ) ) * 289.0 ; } vec3 ct ( vec3 cu ) { return cu - floor ( cu * ( cr / 289.0 ) ) * 289.0 ; } vec2 ct ( vec2 cv ) { return cv - floor ( cv * ( cr / 289.0 ) ) * 289.0 ; } vec4 cx ( vec4 cw ) { return cw - floor ( cw * ( cr / 7.0 ) ) * 7.0 ; } vec4 cz ( vec4 cy ) { return ct ( ( 34.0 * cy + 5.0 ) * cy ) ; }".split(" ")},{type:"define",
name:"K",b:["0.142857142857"]},{type:"define",name:"K2",b:["0.0714285714285"]},{type:"define",name:"JITTER",b:["0.7"]},{type:"textline",b:"vec2 cH ( vec2 cA ) { vec4 cB , cC , cD , cE ; vec2 cF , cG ; cF = ct ( floor ( cA ) ) ; cG = fract ( cA ) ; cB = cG . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; cC = cG . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; cD = cz ( cF . x + vec4 ( cq , cr , cq , cr ) ) ; cD = cz ( cD + cF . y + vec4 ( cq , cq , cr , cr ) ) ; cE = cx ( cD ) * K + K2 ; cD = cx ( floor ( cD * K ) ) * K + K2 ; cB = cB + JITTER * cE ; cE = cC + JITTER * cD ; cC = cB * cB + cE * cE ;".split(" ")},
{type:"condition",a:[{type:"if",c:["1"],group:{type:"group",a:[{type:"textline",b:"cC . xy = min ( cC . xy , cC . zw ) ; cC . x = min ( cC . x , cC . y ) ; return cC . xx ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"cC . xy = ( cC . x < cC . y ) ? cC . xy : cC . yx ; cC . xz = ( cC . x < cC . z ) ? cC . xz : cC . zx ; cC . xw = ( cC . x < cC . w ) ? cC . xw : cC . wx ; cC . y = min ( cC . y , cC . z ) ; cC . y = min ( cC . y , cC . w ) ; return sqrt ( cC . xy ) ;".split(" ")}]}}]},
{type:"textline",b:"} mat3 cQ ( vec2 cI , float cJ ) { vec4 cK , cL , cM , cN ; vec2 cO , cP ; cO = ct ( floor ( cI ) ) ; cP = fract ( cI ) ; cK = cP . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; cL = cP . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; cM = cz ( cO . x + vec4 ( cq , cr , cq , cr ) ) ; cM = cz ( cM + cO . y + vec4 ( cq , cq , cr , cr ) ) ; cN = cx ( cM ) * K + K2 ; cM = cx ( floor ( cM * K ) ) * K + K2 ; cK = cK + JITTER * cN ; cN = cL + JITTER * cM ; cL = cK * cK + cN * cN ; cK += cJ ; cN += cJ ; cM = cK * cK + cN * cN ; cK += cJ ; cN += cJ ; cK = cK * cK + cN * cN ; cL . xy = min ( cL . xy , cL . zw ) ; cL . x = min ( cL . x , cL . y ) ; cM . xy = min ( cM . xy , cM . zw ) ; cM . x = min ( cM . x , cM . y ) ; cK . xy = min ( cK . xy , cK . zw ) ; cK . x = min ( cK . x , cK . y ) ; return mat3 ( cL . xx , cq , cM . xx , cq , cK . xx , cq ) ; } vec3 cS ( vec3 cR ) { return ct ( ( ( cR * 34.0 ) + cr ) * cR ) ; } float dc ( vec2 cT ) { vec3 cU , cV , cW , cX ; vec4 cY ; vec2 cZ , c_ , da ; const vec4 db = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; cZ = floor ( cT + dot ( cT , db . yy ) ) ; c_ = cT - cZ + dot ( cZ , db . xx ) ; da = ( c_ . x > c_ . y ) ? vec2 ( cr , cq ) : vec2 ( cq , cr ) ; cY = c_ . xyxy + db . xxzz ; cY . xy -= da ; cZ = ct ( cZ ) ; cU = cS ( cS ( cZ . y + vec3 ( cq , da . y , cr ) ) + cZ . x + vec3 ( cq , da . x , cr ) ) ; cV = max ( 0.5 - vec3 ( dot ( c_ , c_ ) , dot ( cY . xy , cY . xy ) , dot ( cY . zw , cY . zw ) ) , cq ) ; cV = cV * cV ; cV = cV * cV ; cU = 2.0 * fract ( cU * db . www ) - cr ; cW = abs ( cU ) - 0.5 ; cX = floor ( cU + 0.5 ) ; cU = cU - cX ; cV *= 1.79284291400159 - 0.85373472095314 * ( cU * cU + cW * cW ) ; cX . x = cU . x * c_ . x + cW . x * c_ . y ; cX . yz = cU . yz * cY . xz + cW . yz * cY . yw ; return 130.0 * dot ( cV , cX ) ; } vec2 dg ( vec2 dd ) { float de , df ; de = dot ( dd , vec2 ( 12.9898 , 78.233 ) ) ; df = dot ( dd , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; de = fract ( sin ( de ) * 43758.5453 ) * 2.0 - cr ; df = fract ( sin ( df ) * 43758.5453 ) * 2.0 - cr ; return vec2 ( de , df ) ; }".split(" ")}]};
a["include/shadow.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"CSM_BLEND_BETWEEN_CASCADES",b:["1.0"]},{type:"var",name:"CSM_FADE_LAST_CASCADE",b:["1.0"]},{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",a:[{type:"textline",b:["vec4","dh",";"]}]}}]},{type:"condition",a:[{type:"if",c:"SHADOW_USAGE == SHADOW_MASK_GENERATION || SHADOW_USAGE == SHADOW_MAPPING_BLEND".split(" "),
group:{type:"group",a:[{type:"textline",b:"const float di = 0.1 ; const float dj = 0.1 ; const float dk = - 0.01 ; const float dl = 0.05 ; mat4 dm = mat4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 , 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 , - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 , - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; mat4 dn = mat4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 , - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 , - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 , - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ; bool dr ( vec2 dp , float dq ) { return all ( lessThanEqual ( dp , vec2 ( 1.0 + dq ) ) ) && all ( greaterThanEqual ( dp , vec2 ( 0.0 - dq ) ) ) ; } float dD ( vec3 ds , PRECISION sampler2D dt , float du ) { vec2 dv , dw ; mat2 dx ; float dy , dz , dA ;".split(" ")},
{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:"if ( ds . z > u_perspective_cast_far_bound ) return 1.0 ;".split(" ")}]}}]},{type:"textline",b:"; ds . z = clamp ( ds . z , 0.0 , 1.0 ) ; dy = 0.0 ; dz = dg ( ds . xy ) . x * M_PI ; dA = cos ( dz ) ; dz = sin ( dz ) ; dx = mat2 ( dA , dz , - dz , dA ) ; for ( int dB = 0 ; dB < 4 ; dB ++ ) for ( int dC = 0 ; dC < 4 ; dC ++ ) { dw . x = dm [ dB ] [ dC ] ; dw . y = dn [ dB ] [ dC ] ; dw = dx * dw ; dv = ds . xy + dw * du / SHADOW_TEX_RES ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"if ( ! dr ( dv , dk ) ) dy += 1.0 ; else".split(" ")}]}}]},{type:"textline",b:"dy += step ( ds . z , texture2D ( dt , dv ) . r ) ; } dy /= 16.0 ; return clamp ( dy , 0.0 , 1.0 ) ; } float dU ( vec3 dE , PRECISION sampler2D dF , vec3 dG , PRECISION sampler2D dH , float dI , float dJ , float dK ) { vec2 dL , dM ; mat2 dN ; float dO , dP , dQ , dR ; dE . z = clamp ( dE . z , 0.0 , 1.0 ) ; dG . z = clamp ( dG . z , 0.0 , 1.0 ) ; dO = 0.0 ; dP = 0.0 ; dQ = dg ( dE . xy ) . x * M_PI ; dR = cos ( dQ ) ; dQ = sin ( dQ ) ; dN = mat2 ( dR , dQ , - dQ , dR ) ; for ( int dS = 0 ; dS < 4 ; dS ++ ) for ( int dT = 0 ; dT < 4 ; dT ++ ) { dM . x = dm [ dS ] [ dT ] ; dM . y = dn [ dS ] [ dT ] ; dM = dN * dM ; dL = dE . xy + dM * dI / SHADOW_TEX_RES ; dO += step ( dE . z , texture2D ( dF , dL ) . r ) ; dL = dG . xy + dM * dJ / SHADOW_TEX_RES ; dP += step ( dG . z , texture2D ( dH , dL ) . r ) ; } dO = mix ( dO , dP , dK ) ; dO /= 16.0 ; return clamp ( dO , 0.0 , 1.0 ) ; } float dY ( vec2 dV ) { float dW , dX ; dW = min ( dV . x , dV . y ) ; dX = min ( 1.0 - dV . x , 1.0 - dV . y ) ; return min ( dW , dX ) ; } float ea ( float dZ , float d_ ) { if ( d_ >= 0.0 && d_ <= dj ) dZ = ( dZ - 1.0 ) / dj * d_ + 1.0 ; return dZ ; } float el ( vec3 eb , vec3 ec , PRECISION sampler2D ed , PRECISION sampler2D ee , float ef , float eg , float eh , float ei ) { float ej , ek ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_BLEND_BETWEEN_CASCADES"],group:{type:"group",a:[{type:"textline",b:"ek = dY ( eb . xy ) ; if ( - ei > eh && ek >= 0.0 && ek <= di && dr ( ec . xy , 0.0 ) ) { ek = 1.0 - ek / di ; ej = dU ( eb , ed , ec , ee , ef , eg , ek ) ; } else".split(" ")}]}}]},{type:"textline",b:"ej = dD ( eb , ed , ef ) ; return ej ; } float et ( vec3 em , PRECISION sampler2D en , float eo , float ep , float eq ) { float er , es ; er = dD ( em , en , eo ) ;".split(" ")},{type:"condition",
a:[{type:"if",c:["CSM_FADE_LAST_CASCADE"],group:{type:"group",a:[{type:"textline",b:"if ( - eq > ep ) { es = dY ( em . xy ) ; er = ea ( er , es ) ; }".split(" ")}]}}]},{type:"textline",b:"return er ; } float eA ( float eu ) { vec3 ev , ew , ex , ey ; float ez ; ez = 1.0 ; ev = cl . xyz / cl . w ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"ew = cm . xyz / cm . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",
a:[{type:"textline",b:"ex = cn . xyz / cn . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"ey = co . xyz / co . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"if ( dr ( ev . xy , 0.0 ) ) { ez = el ( ev , ew , u_shadow_map0 , u_shadow_map1 , u_pcf_blur_radii [ 0 ] , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 0 ] , eu ) ; }".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"if ( dr ( ev . xy , dl ) ) { ez = et ( ev , u_shadow_map0 , u_pcf_blur_radii [ 0 ] , u_csm_center_dists [ 0 ] , eu ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"else { if ( dr ( ew . xy , 0.0 ) ) {".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"ez = el ( ew , ex , u_shadow_map1 , u_shadow_map2 , u_pcf_blur_radii [ 1 ] , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 1 ] , eu ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"ez = et ( ew , u_shadow_map1 , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 1 ] , eu ) ;".split(" ")}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"else { if ( dr ( ex . xy , 0.0 ) ) {".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"ez = el ( ex , ey , u_shadow_map2 , u_shadow_map3 , u_pcf_blur_radii [ 2 ] , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 2 ] , eu ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"ez = et ( ex , u_shadow_map2 , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 2 ] , eu ) ;".split(" ")}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"else { if ( dr ( ey . xy , 0.0 ) ) ez = et ( ey , u_shadow_map3 , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 3 ] , eu ) ; }".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",
b:["return","ez",";","}"]}]}}]},{type:"textline",b:"float eF ( inout vec3 eB ) { float eC ; vec3 eD ; vec2 eE ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",a:[{type:"textline",b:"eE = texture2DProj ( u_shadow_mask , cp ) . rg ; eD = vec3 ( eE . r ) ; eC = eE . g ; dh = vec4 ( eD , eC ) ; eB *= dh . a ; return dh . r ;".split(" ")}]}},{type:"elif",c:"SHADOW_USAGE == SHADOW_MASK_GENERATION || SHADOW_USAGE == SHADOW_MAPPING_BLEND".split(" "),
group:{type:"group",a:[{type:"textline",b:"return eA ( ck . z ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["return","1.0",";"]}]}}]},{type:"textline",b:["}"]}]};a["include/dynamic_grass.glslv"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"vec2 eK ( vec3 eG , float eH , vec2 eI ) { vec2 eJ ; eJ = vec2 ( ( eG . x - eI . x ) / eH , - ( eG . z - eI . y ) / eH ) ; return fract ( eJ ) ; } vec2 eO ( vec2 eL , float eM , vec2 eN ) { return vec2 ( eL . x * eM , - eL . y * eM ) + eN ; } d eP ( ) { return d ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; } d fk ( vec3 eQ , vec3 eR , vec3 eS , vec3 eT , vec3 eU , PRECISION sampler2D eV , sampler2D eW , vec3 eX , float eY , vec3 eZ , vec4 e_ , mat4 fa ) { mat4 fb ; vec4 fc ; vec2 fd , fe , ff ; float fg , fh ; vec3 fi ; fi = j ( e_ , vec3 ( 0.0 , - 1.0 , 0.0 ) ) ; fg = - fi . x ; fh = - fi . z ; fd = vec2 ( eZ . x + eY * ( - 1.0 - fg ) / 2.0 , eZ . z + eY * ( 1.0 - fh ) / 2.0 ) ; fe = eK ( eU , eY , fd ) ; fg = eY / 2.0 ; ff = abs ( eO ( fe - vec2 ( 0.5 ) , eY , vec2 ( 0.0 ) ) ) ; fh = fg * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( ff ) > fh ) return eP ( ) ; fg = eY / eX . z ; ff = ( fe - vec2 ( 0.5 ) ) * fg + vec2 ( 0.5 ) ; fi = fi * ( eY / eX . z - 1.0 ) / 2.0 ; ff . x += fi . x ; ff . y -= fi . z ; fc = texture2D ( eW , ff ) ; fh = fc . r ; if ( fh < u_scale_threshold ) return eP ( ) ; fg = eX . y - eX . x ; fg = eX . y - texture2D ( eV , ff ) . r * fg ; ff = eQ . xz - eU . xz ; eU . xz = eO ( fe , eY , fd ) ; eU . y = fg ; eQ . xz = eU . xz + ff ; eQ . y *= fh ; eQ . y += fg ; fi = fc . gba ;".split(" ")},
{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"eQ -= eU ; fb = ai ( eZ , eU , fa ) ; d fj = av ( eQ , eU , eR , eS , eT , fb ) ; fj . b = eU ; fj . f = fi ; return F ( fj ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return F ( d ( eQ , eU , eR , eS , eT , fi ) ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]}]};a["include/shadow.glslv"]={type:"group",a:[{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"condition",a:[{type:"if",
c:"SHADOW_USAGE == SHADOW_MASK_GENERATION || SHADOW_USAGE == SHADOW_MAPPING_BLEND".split(" "),group:{type:"group",a:[{type:"textline",b:"vec4 fq ( mat4 fl , vec4 fm ) { vec4 fn ; float fo ; vec2 fp ; fp = ( fl * u_v_light_matrix [ 3 ] ) . xy ; fo = SHADOW_TEX_RES / 2.0 ; fp = floor ( fp * fo + 0.5 ) / fo - fp ; fn = fl * fm ; fn . xy += fp ; fn = u_b_light_matrix * fn ; return fn ; } void fu ( vec3 fr ) { vec4 fs ; vec3 ft ; ft = ( u_model_matrix * vec4 ( a_normal , 0.0 ) ) . xyz ; fs = u_v_light_matrix * vec4 ( fr + u_normal_offset * ft , 1.0 ) ; cl = fq ( u_p_light_matrix0 , fs ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"cm = fq ( u_p_light_matrix1 , fs ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"cn = fq ( u_p_light_matrix2 , fs ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"co = fq ( u_p_light_matrix3 , fs ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}},{type:"elif",c:["SHADOW_USAGE",
"==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",a:[{type:"textline",b:"void fu ( vec4 fv ) { float fw , fx , fy ; fw = fv . x ; fx = fv . y ; fy = fv . w ; cp . x = ( fw + fy ) / 2.0 ; cp . y = ( fx + fy ) / 2.0 ; cp . z = fy ; }".split(" ")}]}}]}]};a["include/gamma.glslf"]={type:"group",a:[{type:"define",name:"GAMMA",b:["1"]},{type:"define",name:"PREMULTIPLY_ALPHA",b:["1"]},{type:"textline",b:"void fB ( inout vec3 fA ) {".split(" ")},{type:"condition",a:[{type:"if",c:["GAMMA"],group:{type:"group",
a:[{type:"textline",b:"fA = max ( vec3 ( 0.0 ) , fA ) ; fA = pow ( fA , vec3 ( 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",b:"} void fD ( inout vec3 fC ) {".split(" ")},{type:"condition",a:[{type:"if",c:["GAMMA"],group:{type:"group",a:[{type:"textline",b:"fC = max ( vec3 ( 0.0 ) , fC ) ; fC = pow ( fC , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",b:"} void fG ( inout vec3 fE , in float fF ) {".split(" ")},{type:"condition",a:[{type:"if",c:["PREMULTIPLY_ALPHA"],group:{type:"group",a:[{type:"textline",
b:"fE = fE * fF ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["include/pack.glslf"]={type:"group",a:[{type:"textline",b:"float fJ = 255.0 ; float fK = 0.0 ; float fL = 1.0 ; vec4 fP ( const in float fM ) { vec4 fN , fO ; fN = vec4 ( fJ * fJ * fJ , fJ * fJ , fJ , fL ) ; fO = vec4 ( fK , fL / fJ , fL / fJ , fL / fJ ) ; fN = fract ( fM * fN ) ; fN -= fN . xxyz * fO ; return fN ; } float fT ( const in vec4 fQ ) { vec4 fR ; float fS ; fR = vec4 ( fL / ( fJ * fJ * fJ ) , fL / ( fJ * fJ ) , fL / fJ , fL ) ; fS = dot ( fQ , fR ) ; return fS ; } vec4 fP ( const in vec2 fU ) { vec4 fV ; vec2 fW , fX ; fW = vec2 ( fJ , fL ) ; fX = vec2 ( fK , fL / fJ ) ; fV = fract ( fU . xxyy * fW . xyxy ) ; fV -= fV . xxzz * fX . xyxy ; if ( fU . r == fL ) fV . rg = vec2 ( fK , fL ) ; if ( fU . g == fL ) fV . ba = vec2 ( fK , fL ) ; return fV ; } vec2 ga ( const in vec4 fY ) { vec2 fZ , f_ ; f_ = vec2 ( fL / fJ , fL ) ; fZ . r = dot ( fY . rg , f_ ) ; fZ . g = dot ( fY . ba , f_ ) ; return fZ ; }".split(" ")}]};
a["include/fog.glslf"]={type:"group",a:[{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"textline",b:"void gf ( inout vec3 gb , in float gc , in vec4 gd ) { float ge ; ge = gd . w * gc ; ge = exp ( - ge * ge ) ; ge = clamp ( ge , 0.0 , 1.0 ) ; gb = mix ( gd . rgb , gb , ge ) ; }".split(" ")},{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:"vec3 gl ( in mat4 gg , in vec3 gh ) { vec3 gi , gj , gk ; gi = mix ( gg [ 0 ] . rgb , gg [ 1 ] . rgb , max ( sign ( gh . x ) , 0.0 ) ) ; gj = mix ( gg [ 2 ] . rgb , gg [ 3 ] . rgb , max ( sign ( gh . z ) , 0.0 ) ) ; gk = vec3 ( gg [ 0 ] . a , gg [ 1 ] . a , gg [ 2 ] . a ) ; gi = mix ( gi , gj , abs ( gh . z ) ) ; gi = mix ( gi , gk , abs ( gh . y ) ) ; return gi ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"void gn ( inout float gm ) { gm -= 0.5 ; gm = 4.0 * ( gm * gm * gm ) + 0.5 ; } void gB ( inout vec3 go , in float gp , in vec3 gq , in float gr , in vec4 gs , in vec4 gt , in float gu , in float gv ) { vec3 gw , gx ; float gy , gz , gA ; gy = gt . w * gp ; gy = exp ( - gy * gy ) ; gy = clamp ( gy , 0.0 , 1.0 ) ; gz = max ( gq . y , 0.0 ) ; gp = max ( gp - max ( gr / gz , 0.0 ) , 0.0 ) ; gA = gs . w * gp ; gA = 1.0 - gA ; gA = max ( gA , 0.0 ) ; gn ( gA ) ; gA += max ( gu - 0.5 , 0.0 ) ; if ( gA < gy ) { gw = vec3 ( 0.0 , 0.02 , 0.05 ) ; gx = gs . rgb ; gr = clamp ( - gr * 0.03 , 0.0 , 0.8 ) ; gx = mix ( gx , gw , min ( gz , 1.0 ) ) ; gx = mix ( gx , vec3 ( 0.0 ) , gr ) * gv ; go = mix ( gx , go , gA ) ; } if ( gA >= gy ) { go = mix ( gt . rgb , go , gy ) ; } } void gJ ( inout vec3 gC , in float gD , in float gE , in vec4 gF , in float gG ) { vec3 gH ; float gI ; gI = gF . w * gD ; gI = 1.0 - gI ; gI = clamp ( gI , 0.0 , 1.0 ) ; gn ( gI ) ; gE = clamp ( - gE * 0.03 , 0.0 , 0.8 ) ; gH = mix ( gF . rgb , vec3 ( 0.0 ) , gE ) * gG ; gC = mix ( gH , gC , gI ) ; }".split(" ")}]}}]}]};
a["include/lighting.glslf"]={type:"group",a:[{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"var",name:"NUM_LFACTORS",b:["0"]},{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"textline",
b:"float gK = 0.0 ; float gL = 1.0 ; float gM = 0.5 ; struct gN { vec4 a ; vec3 b ; } ;".split(" ")},{type:"condition",a:[{type:"if",c:"SPECULAR_SHADER == SPECULAR_PHONG || SPECULAR_SHADER == SPECULAR_COOKTORR".split(" "),group:{type:"group",a:[{type:"textline",b:"float gV ( vec3 gO , vec3 gP , vec3 gQ , float gR , float gS ) { float gT ; vec3 gU ; gU = normalize ( gO + gP ) ; gT = ( gL - gR ) * max ( dot ( gQ , gU ) , gK ) + gR ; return pow ( gT , gS ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["SPECULAR_SHADER","==","SPECULAR_WARDISO"],group:{type:"group",a:[{type:"textline",b:"float he ( vec3 gW , vec3 gX , vec3 gY , float gZ ) { float g_ , ha , hb , hc ; vec3 hd ; hd = normalize ( gW + gX ) ; g_ = max ( dot ( gY , hd ) , 0.001 ) ; ha = max ( dot ( gY , gX ) , 0.01 ) ; hb = max ( dot ( gY , gW ) , 0.01 ) ; g_ = tan ( acos ( g_ ) ) ; hc = max ( gZ , 0.001 ) ; return hb * ( gL / ( 4.0 * M_PI * hc * hc ) ) * ( exp ( - ( g_ * g_ ) / ( hc * hc ) ) / ( sqrt ( ha * hb ) ) ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SPECULAR_SHADER","==","SPECULAR_TOON"],group:{type:"group",a:[{type:"textline",b:"float hm ( vec3 hf , vec3 hg , vec3 hh , float hi , float hj ) { float hk ; vec3 hl ; hl = normalize ( hf + hg ) ; hk = acos ( dot ( hl , hh ) ) ; if ( hk < hi ) return gL ; else if ( hk >= hi + hj || hj == gK ) return gK ; else return gL - ( hk - hi ) / hj ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SPECULAR_SHADER","==","SPECULAR_BLINN"],group:{type:"group",a:[{type:"textline",
b:"float hz ( vec3 hn , vec3 ho , vec3 hp , float hq , float hr , float hs ) { float ht , hu , hv , hw , hx ; vec3 hy ; if ( hq < 1.0 || hr == gK ) return gK ; else { if ( hr < 100.0 ) hr = sqrt ( 1.0 / hr ) ; else hr = 10.0 / hr ; hy = normalize ( ho + hn ) ; ht = ( gL - hs ) * max ( dot ( hp , hy ) , gK ) + hs ; if ( ht < gK ) return gK ; else { hu = max ( dot ( hp , ho ) , 0.01 ) ; hv = dot ( hp , hn ) ; if ( hv <= 0.01 ) return gK ; else { hw = max ( dot ( ho , hy ) , 0.01 ) ; hx = gL ; hu = ( 2.0 * ht * hu ) / hw ; hv = ( 2.0 * ht * hv ) / hw ; hx = min ( min ( hx , hu ) , hv ) ; hu = sqrt ( pow ( hq , 2.0 ) + pow ( hw , 2.0 ) - gL ) ; hv = pow ( hu - hw , 2.0 ) / pow ( hu + hw , 2.0 ) * ( gL + pow ( hw * ( hu + hw ) - gL , 2.0 ) / pow ( hw * ( hu - hw ) + gL , 2.0 ) ) ; hu = acos ( ht ) ; return max ( hv * hx * exp ( - pow ( hu , 2.0 ) / ( 2.0 * pow ( hr , 2.0 ) ) ) , gK ) ; } } } }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","==","DIFFUSE_OREN_NAYAR"],group:{type:"group",a:[{type:"textline",b:"float hN ( float hA , vec3 hB , vec3 hC , vec3 hD , float hE ) { vec3 hF , hG ; float hH , hI , hJ , hK , hL , hM ; if ( hE > gK ) { hH = max ( dot ( hB , hD ) , gK ) ; hI = hE * hE ; hJ = gL - gM * ( hI / ( hI + 0.33 ) ) ; hF = hC - hA * hB ; hG = hD - hH * hB ; if ( length ( hF ) == gK || length ( hG ) == gK || abs ( hA ) > gL || abs ( hH ) > gL ) return hA * hJ ; else { hK = acos ( hA ) ; hH = acos ( hH ) ; hF = normalize ( hF ) ; hG = normalize ( hG ) ; hL = max ( hK , hH ) ; hM = min ( hK , hH ) ; hM *= 0.95 ; hK = max ( dot ( hF , hG ) , gK ) ; hH = 0.45 * ( hI / ( hI + 0.09 ) ) ; return hA * ( hJ + ( hH * hK * sin ( hL ) * tan ( hM ) ) ) ; } } }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","==","DIFFUSE_MINNAERT"],group:{type:"group",a:[{type:"textline",b:"float hT ( float hO , vec3 hP , vec3 hQ , float hR ) { float hS ; hS = max ( dot ( hP , hQ ) , gK ) ; if ( hR <= gL ) return hO * pow ( max ( hS * hO , 0.1 ) , hR - gL ) ; else return hO * pow ( 1.0001 - hS , hR - gL ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","==","DIFFUSE_TOON"],group:{type:"group",a:[{type:"textline",b:"float hY ( float hU , float hV , float hW ) { float hX ; hX = acos ( hU ) ; if ( hX < hV ) return gL ; else if ( hX > ( hV + hW ) || hW == gK ) return gK ; else return gL - ( ( hX - hV ) / hW ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","==","DIFFUSE_FRESNEL"],group:{type:"group",a:[{type:"textline",b:"float ic ( float hZ , float h_ , float ia ) { float ib ; if ( h_ == gK ) { return gL ; } else { ib = gL + abs ( hZ ) ; ib = ia + ( gL - ia ) * pow ( ib , h_ ) ; return clamp ( ib , gK , gL ) ; } }".split(" ")}]}}]},{type:"textline",b:"void il ( vec3 id , vec3 ie , vec3 ig , vec2 ih , const float ii , out float ij ) { float ik ; ik = ( gL - ii ) * dot ( id , ie ) + ii ; ij = ik ; if ( ii == gM ) return ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","==","DIFFUSE_FRESNEL"],group:{type:"group",a:[{type:"textline",b:"ij = ic ( ik , ih [ 0 ] , ih [ 1 ] ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","==","DIFFUSE_OREN_NAYAR"],group:{type:"group",a:[{type:"textline",b:"ij = hN ( ik , id , ie , ig , ih [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","==","DIFFUSE_MINNAERT"],group:{type:"group",a:[{type:"textline",
b:"ij = hT ( ik , id , ig , ih [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","==","DIFFUSE_TOON"],group:{type:"group",a:[{type:"textline",b:"ij = hY ( ik , ih [ 0 ] , ih [ 1 ] ) ;".split(" ")}]}}]},{type:"textline",b:"ij = max ( ij , gK ) ;".split(" ")}]}}]},{type:"textline",b:"} void it ( vec3 im , vec3 io , vec3 ip , float iq , vec2 ir , out float is ) {".split(" ")},{type:"condition",a:[{type:"if",c:"SPECULAR_SHADER == SPECULAR_PHONG || SPECULAR_SHADER == SPECULAR_COOKTORR".split(" "),
group:{type:"group",a:[{type:"textline",b:"is = gV ( im , io , ip , iq , ir [ 0 ] ) ;".split(" ")}]}},{type:"elif",c:["SPECULAR_SHADER","==","SPECULAR_WARDISO"],group:{type:"group",a:[{type:"textline",b:"is = he ( im , io , ip , ir [ 0 ] ) ;".split(" ")}]}},{type:"elif",c:["SPECULAR_SHADER","==","SPECULAR_TOON"],group:{type:"group",a:[{type:"textline",b:"is = hm ( im , io , ip , ir [ 0 ] , ir [ 1 ] ) ;".split(" ")}]}},{type:"elif",c:["SPECULAR_SHADER","==","SPECULAR_BLINN"],group:{type:"group",a:[{type:"textline",
b:"is = hz ( im , io , ip , ir [ 0 ] , ir [ 1 ] , iq ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["is","=","gK",";"]}]}}]},{type:"textline",b:"} void iP ( vec3 iu , vec3 iv , vec3 iw , vec2 ix , vec4 iy , vec3 iz , vec3 iA , vec3 iB , inout gN iC , float iD , vec2 iE , vec2 iF , float iG ) { float iH , iI , iJ , iK , iL , iM , iN , iO ; iH = gK ; if ( ix . r != gK ) il ( iw , iv , iu , iE , iG , iH ) ; iI = gK ; if ( ix . g != gK ) it ( iv , iu , iw , iG , iF , iI ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_TRANSLUCENCY"],group:{type:"group",a:[{type:"textline",b:"if ( dot ( iv , iw ) * dot ( iu , iw ) < gK ) { iJ = iy . x ; iK = iy . y ; iL = iy . z ; iM = iy . w ; iN = clamp ( abs ( dot ( iv , iw ) ) , gK , gL ) ; iO = clamp ( dot ( iu , - iv ) , gK , gL ) ; iO = pow ( iO , iK ) ; iC . a += iD * vec4 ( iB * iN * pow ( iz , vec3 ( iJ ) ) , gL ) ; iC . a += iL * mix ( vec4 ( iz , gL ) , vec4 ( gL ) , iM ) * iD * vec4 ( iB * iN * vec3 ( iO ) , gL ) ; } else { iC . b += iB * iA * iI ; iC . a += vec4 ( iB * iz * iH , iI ) ; }".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"iC . b += iB * iA * iI ; iC . a += vec4 ( iB * iz * iH , iI ) ;".split(" ")}]}}]},{type:"textline",b:["}"]},{type:"lamp",name:"POINT",f:[{type:"textline",b:"jr = jc [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ; jj = i_ [ LAMP_IND ] ; jk = jb [ LAMP_IND ] ; jf = gK ;".split(" ")},{type:"textline",b:"jk = jk ; if ( bool ( LAMP_SHADOW_MAP_IND ) ) jk *= iZ ; jj = jj - iU ;".split(" ")},{type:"textline",b:"jg = length ( jj ) ; jk *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + jg * jg ) ; jj = normalize ( jj ) ; iP ( iW , jj , iV , jr , je , iS , iT , jk , jv , jd , iY , iX , jf ) ;".split(" ")}]},
{type:"lamp",name:"SPOT",f:[{type:"textline",b:"js = jc [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ; jl = i_ [ LAMP_IND ] ; jm = jb [ LAMP_IND ] ; jn = ja [ LAMP_IND ] ; jg = gK ;".split(" ")},{type:"textline",b:"jm = jm ; if ( bool ( LAMP_SHADOW_MAP_IND ) ) jm *= iZ ; jl = jl - iU ;".split(" ")},{type:"textline",b:"jh = length ( jl ) ; jm *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + jh * jh ) ; jl = normalize ( jl ) ;".split(" ")},{type:"textline",b:"jh = dot ( jl , jn ) ; jh *= smoothstep ( gK , gL , ( jh - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; jm *= jh ; iP ( iW , jl , iV , js , je , iS , iT , jm , jv , jd , iY , iX , jg ) ;".split(" ")}]},
{type:"lamp",name:"SUN",f:[{type:"textline",b:"jt = jc [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ; jn = jb [ LAMP_IND ] ; jo = ja [ LAMP_IND ] ; jh = gK ;".split(" ")},{type:"textline",b:"jn = jn ; if ( bool ( LAMP_SHADOW_MAP_IND ) ) jn *= iZ ; iP ( iW , jo , iV , jt , je , iS , iT , jn , jv , jd , iY , iX , jh ) ;".split(" ")}]},{type:"lamp",name:"HEMI",f:[{type:"textline",b:"ju = jc [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ; jp = jb [ LAMP_IND ] ; jq = ja [ LAMP_IND ] ; ji = gM ;".split(" ")},
{type:"textline",b:"jp = jp ; if ( bool ( LAMP_SHADOW_MAP_IND ) ) jp *= iZ ; iP ( iW , jq , iV , ju , je , iS , iT , jp , jv , jd , iY , iX , ji ) ;".split(" ")}]},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",">","0"],group:{type:"group",a:[{type:"textline",b:"gN jw ( vec3 iQ , vec3 iR , vec3 iS , vec3 iT , vec3 iU , vec3 iV , vec3 iW , vec2 iX , vec2 iY , float iZ , vec3 i_ [ NUM_LIGHTS ] , vec3 ja [ NUM_LIGHTS ] , vec3 jb [ NUM_LIGHTS ] , vec4 jc [ NUM_LFACTORS ] , float jd , vec4 je ) { float jf , jg , jh , ji ; vec3 jj , jk , jl , jm , jn , jo , jp , jq ; vec2 jr , js , jt , ju ; gN jv ; jv . a = vec4 ( iQ + iS * iR , gK ) ; jv . b = vec3 ( gK ) ;".split(" ")},
{type:"lamps_main"},{type:"textline",b:["return","jv",";","}"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gN jB ( vec3 jx , vec3 jy , vec3 jz ) { gN jA ; jA . a = vec4 ( jx + jz * jy , gK ) ; jA . b = vec3 ( gK ) ; return jA ; }".split(" ")}]}}]}]};a["include/caustics.glslf"]={type:"group",a:[{type:"var",name:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{type:"var",name:"CAUST_SCALE",b:["0.0"]},{type:"var",name:"CAUST_BRIGHT",b:["0.0"]},{type:"define",name:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},
{type:"textline",b:"void jU ( inout vec3 jC , float jD , float jE , float jF , vec3 jG , vec3 jH , vec3 jI , vec4 jJ , vec3 jK , float jL ) { mat3 jM ; float jN , jO , jP , jQ ; vec2 jR ; vec3 jS ; vec4 jT ; if ( jL > CAUSTICS_VIEW_DISTANCE ) return ; jT = jJ ; jS = jK + jG ; jS . xz = 10.0 * sin ( 0.1 * jS . xz ) ; jS = jS + 2.0 * cross ( - jT . xyz , cross ( - jT . xyz , jS ) + jT . w * jS ) ; jR = jS . xz ; jS = jH ; jN = max ( dot ( jG , jS ) , 0.0 ) ; jO = 0.025 ; jR . s += 0.5 * sin ( dot ( jK + jE , vec3 ( 1.0 ) ) ) ; jR . t += 0.7 * ( - sin ( dot ( jK - jE , vec3 ( - 0.7 ) ) ) ) ; jR . st += 0.23 * cos ( 4.0 * jD - CAUST_SPEED . x * jE ) ; jR . st += 3.0 * sin ( jD - 0.3 * CAUST_SPEED . y * jE ) ; jP = CAUST_SCALE * ( 1.0 + max ( 0.1 * jD , 0.0 ) ) ; jM = cQ ( ( jR / jP ) , jO ) ; jP = ( jM * vec3 ( 1.0 , 0.0 , 0.0 ) ) . x ; jO = ( jM * vec3 ( 0.0 , 1.0 , 0.0 ) ) . x ; jQ = ( jM * vec3 ( 0.0 , 0.0 , 1.0 ) ) . x ; jS = CAUST_BRIGHT * vec3 ( jP , jO , jQ ) ; jP = jF * jN ; jO = max ( sign ( jD ) , 0.0 ) ; jP = min ( jP + 0.5 * sign ( - jG . y ) * jO , 1.0 ) ; jP *= 1.0 - jO * ( 0.1 * jD ) ; jS *= jP ; jS *= jS ; jQ = min ( - jD + 10.0 , 1.0 ) ; jC += max ( ( 2.0 * jI * jS ) * jQ , 0.0 ) ; }".split(" ")}]};
a["include/mirror.glslf"]={type:"group",a:[{type:"condition",a:[{type:"if",c:"REFLECTION_TYPE == REFL_PLANE || REFLECTION_TYPE == REFL_CUBE || REFLECTION_TYPE == REFL_MIRRORMAP".split(" "),group:{type:"group",a:[{type:"define",name:"REFL_BUMP",b:["0.1"]},{type:"textline",b:"float kg ( in vec3 ka , vec3 kb , float kc , float kd ) { float ke ; vec3 kf ; kf = normalize ( kb + ka ) ; ke = 1.0 - dot ( ka , kf ) ; ke = kd + ( 1.0 - kd ) * pow ( ke , kc ) ; return ke ; } void kt ( inout vec3 kh , vec3 ki , vec3 kj , float kk ) { vec2 kl , km ; float kn , ko , kp ; vec3 kq , kr , ks ; kq = reflect ( - ki , kj ) ; kn = u_fresnel_params [ 2 ] ; ko = u_fresnel_params [ 3 ] ; kp = 1.0 ; if ( kn != 0.0 ) kp = kg ( ki , kq , kn , ko ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","==","REFL_CUBE"],group:{type:"group",a:[{type:"textline",b:"kr = textureCube ( u_cube_reflection , kq ) . xyz ;".split(" ")}]}},{type:"elif",c:["REFLECTION_TYPE","==","REFL_PLANE"],group:{type:"group",a:[{type:"textline",b:"ks = u_refl_plane . xyz * dot ( kj , u_refl_plane . xyz ) ; ks = kj - ks ; kl = ( u_view_matrix_frag * vec4 ( ks , 0.0 ) ) . xy ; km = cp . xy / cp . z ; km += kl * REFL_BUMP ; kr = texture2D ( u_plane_reflection , km ) . rgb ;".split(" ")}]}},
{type:"elif",c:["REFLECTION_TYPE","==","REFL_MIRRORMAP"],group:{type:"group",a:[{type:"textline",b:"kr = textureCube ( u_mirrormap , kq ) . xyz ; kk = u_mirror_factor ;".split(" ")}]}}]},{type:"textline",b:"fB ( kr . rgb ) ; kh = mix ( kh , kr , kk * kp ) ; }".split(" ")}]}}]}]};a["include/refraction.glslf"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_REFRACTION_CORRECTION"],group:{type:"group",a:[{type:"textline",
b:"float kz ( in float ku , inout vec2 kv , in vec2 kw ) { float kx ; vec4 ky ; ky = texture2D ( u_scene_depth , kv ) ; kx = fT ( ky ) ; if ( kx < j_ ) { kv = kw ; return ku ; } else { return kx ; } return ku ; }".split(" ")}]}}]},{type:"textline",b:"vec3 kH ( in vec3 kA , in vec2 kB ) { vec3 kC ; float kD ; vec4 kE ; vec2 kF , kG ; kF = kA . xy / kA . z ; kG = kF + kB ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_REFRACTION_CORRECTION"],group:{type:"group",a:[{type:"textline",b:"kE = texture2DProj ( u_scene_depth , kA ) ; kD = fT ( kE ) ; kz ( kD , kG , kF ) ;".split(" ")}]}}]},
{type:"textline",b:"kC = texture2D ( u_refractmap , kG ) . rgb ; fB ( kC ) ; return kC ; }".split(" ")}]}}]}]};a["include/environment.glslf"]={type:"group",a:[{type:"textline",b:"vec3 kK ( vec3 kI ) { float kJ ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SKY_TEXTURE"],group:{type:"group",a:[{type:"textline",b:"return textureCube ( u_sky_texture , kI ) . rgb ;".split(" ")}]}},{type:"elif",c:["SKY_COLOR"],group:{type:"group",
a:[{type:"textline",b:"kJ = 0.5 * kI . y + 0.5 ; return mix ( u_horizon_color , u_zenith_color , kJ ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["include/nodes.glslf"]={type:"group",a:[{type:"var",name:"MAPPING_TRS_MATRIX",b:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",b:["vec3","(","0.0",
")"]},{type:"var",name:"MAPPING_TRANSLATION",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",b:["0.0"]},{type:"var",name:"RGB_IND",b:["0"]},{type:"var",name:"VALUE_IND",b:["0"]},{type:"var",name:"LAMP_INDEX",b:["0"]},{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_OR","||","USE_NODE_TEX_COORD_GE"],group:{type:"group",a:[{type:"textline",b:["varying","vec3",
"kL",";"]}]}}]},{type:"textline",b:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; vec3 kM = vec3 ( ZERO_VALUE_NODES ) ; vec3 kN = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:"vec3 kR ( in vec3 kO , in float kP ) { vec3 kQ ; kQ = kM ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_REFRACTION"],group:{type:"group",a:[{type:"textline",b:"kQ = kH ( cp , kO . xz * kP ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"kQ = texture2D ( u_refractmap , cp . xy / cp . z ) . rgb ; fB ( kQ ) ;".split(" ")}]}}]},{type:"textline",b:["return","kQ",";","}"]}]}}]},{type:"condition",a:[{type:"if",c:"USE_NODE_HUE_SAT || USE_NODE_MIX_RGB_HUE || USE_NODE_MIX_RGB_SATURATION || USE_NODE_MIX_RGB_VALUE || USE_NODE_MIX_RGB_COLOR || USE_NODE_SEPHSV".split(" "),group:{type:"group",a:[{type:"textline",b:"vec3 kW ( vec3 kS ) { float kT , kU ; vec4 kV ; kV = vec4 ( ZERO_VALUE_NODES , - UNITY_VALUE_NODES / 3.0 , 2.0 / 3.0 , - UNITY_VALUE_NODES ) ; kV = mix ( vec4 ( kS . bg , kV . wz ) , vec4 ( kS . gb , kV . xy ) , step ( kS . b , kS . g ) ) ; kV = mix ( vec4 ( kV . xyw , kS . r ) , vec4 ( kS . r , kV . yzx ) , step ( kV . x , kS . r ) ) ; kT = kV . x - min ( kV . w , kV . y ) ; kU = 1.0e-10 ; return vec3 ( abs ( kV . z + ( kV . w - kV . y ) / ( 6.0 * kT + kU ) ) , kT / ( kV . x + kU ) , kV . x ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:"USE_NODE_HUE_SAT || USE_NODE_MIX_RGB_HUE || USE_NODE_MIX_RGB_SATURATION || USE_NODE_MIX_RGB_VALUE || USE_NODE_MIX_RGB_COLOR || USE_NODE_COMBHSV".split(" "),group:{type:"group",a:[{type:"textline",b:"vec3 k_ ( vec3 kX ) { vec3 kY ; vec4 kZ ; kZ = vec4 ( UNITY_VALUE_NODES , 2.0 / 3.0 , UNITY_VALUE_NODES / 3.0 , 3.0 ) ; kY = abs ( fract ( vec3 ( kX . r , kX . r , kX . r ) + kZ . xyz ) * 6.0 - kZ . www ) ; return kX . b * mix ( kZ . xxx , clamp ( kY - kZ . xxx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) , kX . g ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_UV","||","USE_NODE_B4W_PARALLAX","||","USE_NODE_UV_MERGED"],group:{type:"group",a:[{type:"textline",b:"vec3 lb ( vec2 la ) { return vec3 ( la * 2.0 - vec2 ( UNITY_VALUE_NODES , UNITY_VALUE_NODES ) , ZERO_VALUE_NODES ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_TEXTURE_COLOR","||","USE_NODE_TEXTURE_NORMAL","||","USE_NODE_B4W_PARALLAX"],group:{type:"group",a:[{type:"textline",b:"vec2 ld ( vec3 lc ) { return vec2 ( lc . xy * 0.5 + vec2 ( 0.5 , 0.5 ) ) ; }".split(" ")}]}}]},
{type:"node",name:"CAMERA",g:[{type:"node_out",name:"me",qualifier:["vec3"],e:!0},{type:"node_out",name:"mf",qualifier:["float"],e:!0},{type:"node_out",name:"mg",qualifier:["float"],e:!0}],f:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_me"],f:[{type:"textline",b:"me = normalize ( lL . xyz ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_mf"],f:[{type:"textline",b:"mf = abs ( lL . z ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_mg"],
f:[{type:"textline",b:"mg = length ( lL . xyz ) ;".split(" ")}]}]}]},{type:"node",name:"COMBRGB",g:[{type:"node_in",name:"mh",qualifier:["float"],e:!1},{type:"node_in",name:"mi",qualifier:["float"],e:!1},{type:"node_in",name:"mj",qualifier:["float"],e:!1},{type:"node_out",name:"mk",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"mk = vec3 ( mh , mi , mj ) ;".split(" ")}]},{type:"node",name:"COMBHSV",g:[{type:"node_in",name:"ml",qualifier:["float"],e:!1},{type:"node_in",name:"mm",qualifier:["float"],
e:!1},{type:"node_in",name:"mn",qualifier:["float"],e:!1},{type:"node_out",name:"mo",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"mo = k_ ( vec3 ( ml , mm , mn ) ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_UV",g:[{type:"node_out",name:"mp",qualifier:["vec3"],e:!1},{type:"node_param",name:"le",qualifier:["varying","vec2"]}],f:[{type:"textline",b:"mp = lb ( le ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_OR",g:[{type:"node_out",name:"mq",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"mq = 2.0 * clamp ( kL , 0.0 , 1.0 ) - kN ;".split(" ")}]},
{type:"node",name:"GEOMETRY_VC",g:[{type:"node_out",name:"mr",qualifier:["vec3"],e:!1},{type:"node_param",name:"lf",qualifier:["varying","vec3"]}],f:[{type:"textline",b:["mr","=","lf",";"]}]},{type:"node",name:"GEOMETRY_VC1",g:[{type:"node_out",name:"ms",qualifier:["float"],e:!1},{type:"node_param",name:"lg",qualifier:["varying","float"]}],f:[{type:"textline",b:["ms","=","lg",";"]}]},{type:"node",name:"GEOMETRY_VC2",g:[{type:"node_out",name:"mt",qualifier:["float"],e:!1},{type:"node_out",name:"mu",
qualifier:["float"],e:!1},{type:"node_param",name:"lh",qualifier:["varying","vec2"]}],f:[{type:"textline",b:"mt = lh [ 0 ] ; mu = lh [ 1 ] ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC3",g:[{type:"node_out",name:"mv",qualifier:["float"],e:!1},{type:"node_out",name:"mw",qualifier:["float"],e:!1},{type:"node_out",name:"mx",qualifier:["float"],e:!1},{type:"node_param",name:"li",qualifier:["varying","vec3"]}],f:[{type:"textline",b:"mv = li [ 0 ] ; mw = li [ 1 ] ; mx = li [ 2 ] ;".split(" ")}]},{type:"node",
name:"GEOMETRY_NO",g:[{type:"node_out",name:"my",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["my","=","lP",";"]}]},{type:"node",name:"GEOMETRY_FB",g:[{type:"node_out",name:"mz",qualifier:["float"],e:!1}],f:[{type:"textline",b:"mz = ( gl_FrontFacing ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"GEOMETRY_VW",g:[{type:"node_out",name:"mA",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["mA","=","lr",";"]}]},{type:"node",name:"GEOMETRY_LO",g:[{type:"node_out",name:"mB",
qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"mB [ 0 ] = lL [ 0 ] ; mB [ 1 ] = lL [ 1 ] ; mB [ 2 ] = lL [ 2 ] ;".split(" ")}]},{type:"node",name:"GEOMETRY_GL",g:[{type:"node_out",name:"mC",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"mC = vec3 ( lQ . r , - lQ . b , lQ . g ) ;".split(" ")}]},{type:"node",name:"HUE_SAT",g:[{type:"node_in",name:"mD",qualifier:["float"],e:!1},{type:"node_in",name:"mE",qualifier:["float"],e:!1},{type:"node_in",name:"mF",qualifier:["float"],e:!1},{type:"node_in",
name:"mG",qualifier:["float"],e:!1},{type:"node_in",name:"mH",qualifier:["vec3"],e:!1},{type:"node_out",name:"mI",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lO = kW ( mH ) ; lO [ 0 ] += ( mD - 0.5 ) ; if ( lO [ 0 ] > UNITY_VALUE_NODES ) lO [ 0 ] -= UNITY_VALUE_NODES ; else if ( lO [ 0 ] < ZERO_VALUE_NODES ) lO [ 0 ] += UNITY_VALUE_NODES ; lO *= vec3 ( UNITY_VALUE_NODES , mE , mF ) ; lO = mix ( kN , mix ( kM , lO , step ( kM , lO ) ) , step ( lO , kN ) ) ; mI = mix ( mH , k_ ( lO ) , mG ) ;".split(" ")}]},
{type:"node",name:"INVERT",g:[{type:"node_in",name:"mJ",qualifier:["float"],e:!1},{type:"node_in",name:"mK",qualifier:["vec3"],e:!1},{type:"node_out",name:"mL",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"mL = mix ( mK , kN - mK , mJ ) ;".split(" ")}]},{type:"node",name:"LAMP",g:[{type:"node_out",name:"mM",qualifier:["vec3"],e:!0},{type:"node_out",name:"mN",qualifier:["vec3"],e:!1},{type:"node_out",name:"mO",qualifier:["float"],e:!1},{type:"node_out",name:"mP",qualifier:["float"],e:!0}],f:[{type:"node_condition",
a:[{type:"node_if",c:["USE_OUT_mM"],f:[{type:"textline",b:"mM = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{type:"textline",b:"lM = u_lamp_light_factors [ LAMP_INDEX ] ; lR = u_lamp_light_directions [ LAMP_INDEX ] ; lS = u_lamp_light_positions [ LAMP_INDEX ] ; lC = lM . z ; if ( lC != - UNITY_VALUE_NODES ) {".split(" ")},{type:"textline",b:"mN = lS - jV ; mO = length ( mN ) ; mN = normalize ( mN ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_mP"],f:[{type:"textline",
b:"mP = lC / ( lC + mO * mO ) ; lC = lM . x ; lD = lM . y ; if ( lC > - UNITY_VALUE_NODES ) { lE = dot ( mN , lR ) ; lE *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( lE - lC ) / lD ) ; mP *= lE ; }".split(" ")}]}]},{type:"textline",b:["}","else","{"]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_mN"],f:[{type:"textline",b:["mN","=","lR",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_mO"],f:[{type:"textline",b:"mO = length ( lS - jV ) ;".split(" ")}]}]},{type:"node_condition",
a:[{type:"node_if",c:["USE_OUT_mP"],f:[{type:"textline",b:["mP","=","UNITY_VALUE_NODES",";"]}]}]},{type:"textline",b:["}"]}]},{type:"node",name:"NORMAL",g:[{type:"node_in",name:"mQ",qualifier:["vec3"],e:!1},{type:"node_out",name:"mR",qualifier:["vec3"],e:!0},{type:"node_out",name:"mS",qualifier:["float"],e:!0},{type:"node_param",name:"lj",qualifier:["vec3"]}],f:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_mR"],f:[{type:"textline",b:["mR","=","lj",";"]}]}]},{type:"node_condition",a:[{type:"node_if",
c:["USE_OUT_mS"],f:[{type:"textline",b:"mS = - dot ( mQ , lj ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_VECTOR_VIEW",g:[{type:"node_in",name:"mT",qualifier:["vec3"],e:!1},{type:"node_out",name:"mU",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"mU = - ( u_view_matrix_frag * vec4 ( mT , ZERO_VALUE_NODES ) ) . xyz ;".split(" ")}]},{type:"node",name:"BSDF_ANISOTROPIC",g:[{type:"node_in",name:"mV",qualifier:["vec3"],e:!1},{type:"node_in",name:"mW",qualifier:["float"],e:!1},{type:"node_in",name:"mX",
qualifier:["float"],e:!1},{type:"node_in",name:"mY",qualifier:["float"],e:!1},{type:"node_in",name:"mZ",qualifier:["vec3"],e:!1},{type:"node_in",name:"m_",qualifier:["vec3"],e:!1},{type:"node_out",name:"na",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["na","=","mV",";"]},{type:"textline",b:"mW ; mX ; mY ; mZ ; m_ ;".split(" ")}]},{type:"node",name:"BSDF_DIFFUSE",g:[{type:"node_in",name:"nb",qualifier:["vec3"],e:!1},{type:"node_in",name:"nc",qualifier:["float"],e:!1},{type:"node_in",name:"nd",
qualifier:["vec3"],e:!1},{type:"node_out",name:"ne",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["ne","=","nb",";"]},{type:"textline",b:["nc",";","nd",";"]}]},{type:"node",name:"BSDF_GLASS",g:[{type:"node_in",name:"nf",qualifier:["vec3"],e:!1},{type:"node_in",name:"ng",qualifier:["float"],e:!1},{type:"node_in",name:"nh",qualifier:["float"],e:!1},{type:"node_in",name:"ni",qualifier:["vec3"],e:!1},{type:"node_out",name:"nj",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["nj","=","nf",";"]},{type:"textline",
b:"ng ; nh ; ni ;".split(" ")}]},{type:"node",name:"BSDF_GLOSSY",g:[{type:"node_in",name:"nk",qualifier:["vec3"],e:!1},{type:"node_in",name:"nl",qualifier:["float"],e:!1},{type:"node_in",name:"nm",qualifier:["vec3"],e:!1},{type:"node_out",name:"nn",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["nn","=","nk",";"]},{type:"textline",b:["nl",";","nm",";"]}]},{type:"node",name:"BSDF_HAIR",g:[{type:"node_in",name:"no",qualifier:["vec3"],e:!1},{type:"node_in",name:"np",qualifier:["float"],e:!1},{type:"node_in",
name:"nq",qualifier:["float"],e:!1},{type:"node_in",name:"nr",qualifier:["float"],e:!1},{type:"node_out",name:"ns",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["ns","=","no",";"]},{type:"textline",b:"np ; nq ; nr ;".split(" ")}]},{type:"node",name:"BSDF_TRANSPARENT",g:[{type:"node_in",name:"nt",qualifier:["vec3"],e:!1},{type:"node_out",name:"nu",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["nu","=","nt",";"]}]},{type:"node",name:"BSDF_TRANSLUCENT",g:[{type:"node_in",name:"nv",qualifier:["vec3"],
e:!1},{type:"node_in",name:"nw",qualifier:["vec3"],e:!1},{type:"node_out",name:"nx",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["nx","=","nv",";"]},{type:"textline",b:["nw",";"]}]},{type:"node",name:"BSDF_REFRACTION",g:[{type:"node_in",name:"ny",qualifier:["vec3"],e:!1},{type:"node_in",name:"nz",qualifier:["float"],e:!1},{type:"node_in",name:"nA",qualifier:["float"],e:!1},{type:"node_in",name:"nB",qualifier:["vec3"],e:!1},{type:"node_out",name:"nC",qualifier:["vec3"],e:!1}],f:[{type:"textline",
b:"nC [ 0 ] = nC [ 1 ] = nC [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:"ny ; nz ; nA ; nB ;".split(" ")}]},{type:"node",name:"BSDF_TOON",g:[{type:"node_in",name:"nD",qualifier:["vec3"],e:!1},{type:"node_in",name:"nE",qualifier:["float"],e:!1},{type:"node_in",name:"nF",qualifier:["float"],e:!1},{type:"node_in",name:"nG",qualifier:["vec3"],e:!1},{type:"node_out",name:"nH",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["nH","=","nD",";"]},{type:"textline",b:"nE ; nF ; nG ;".split(" ")}]},
{type:"node",name:"BSDF_VELVET",g:[{type:"node_in",name:"nI",qualifier:["vec3"],e:!1},{type:"node_in",name:"nJ",qualifier:["float"],e:!1},{type:"node_in",name:"nK",qualifier:["vec3"],e:!1},{type:"node_out",name:"nL",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["nL","=","nI",";"]},{type:"textline",b:["nJ",";","nK",";"]}]},{type:"node",name:"SUBSURFACE_SCATTERING",g:[{type:"node_in",name:"nM",qualifier:["vec3"],e:!1},{type:"node_in",name:"nN",qualifier:["float"],e:!1},{type:"node_in",name:"nO",
qualifier:["vec3"],e:!1},{type:"node_in",name:"nP",qualifier:["float"],e:!1},{type:"node_in",name:"nQ",qualifier:["float"],e:!1},{type:"node_in",name:"nR",qualifier:["vec3"],e:!1},{type:"node_out",name:"nS",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"nS [ 0 ] = nS [ 1 ] = nS [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:"nM ; nO ; nP ; nQ ; nR ; nN ;".split(" ")}]},{type:"node",name:"EMISSION",g:[{type:"node_in",name:"nT",qualifier:["vec3"],e:!1},{type:"node_in",name:"nU",qualifier:["float"],
e:!1},{type:"node_out",name:"nV",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["nV","=","nT",";"]},{type:"textline",b:["nU",";"]}]},{type:"node",name:"AMBIENT_OCCLUSION",g:[{type:"node_in",name:"nW",qualifier:["vec3"],e:!1},{type:"node_out",name:"nX",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"nX [ 0 ] = nX [ 1 ] = nX [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["nW",";"]}]},{type:"node",name:"HOLDOUT",g:[{type:"node_out",name:"nY",qualifier:["vec3"],e:!1}],f:[{type:"textline",
b:"nY [ 0 ] = nY [ 1 ] = nY [ 2 ] = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"VOLUME_ABSORPTION",g:[{type:"node_in",name:"nZ",qualifier:["vec3"],e:!1},{type:"node_in",name:"n_",qualifier:["float"],e:!1},{type:"node_out",name:"oa",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"oa [ 0 ] = oa [ 1 ] = oa [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["nZ",";","n_",";"]}]},{type:"node",name:"VOLUME_SCATTER",g:[{type:"node_in",name:"ob",qualifier:["vec3"],e:!1},{type:"node_in",
name:"oc",qualifier:["float"],e:!1},{type:"node_in",name:"od",qualifier:["float"],e:!1},{type:"node_out",name:"oe",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"oe [ 0 ] = oe [ 1 ] = oe [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:"ob ; oc ; od ;".split(" ")}]},{type:"node",name:"BUMP",g:[{type:"node_in",name:"of",qualifier:["float"],e:!1},{type:"node_in",name:"og",qualifier:["float"],e:!1},{type:"node_in",name:"oh",qualifier:["float"],e:!1},{type:"node_in",name:"oi",qualifier:["vec3"],
e:!1},{type:"node_out",name:"oj",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["oj","=","oi",";"]},{type:"textline",b:"of ; og ; oh ;".split(" ")}]},{type:"node",name:"NORMAL_MAP",g:[{type:"node_in",name:"ok",qualifier:["float"],e:!1},{type:"node_in",name:"ol",qualifier:["vec3"],e:!1},{type:"node_out",name:"om",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["om","=","ol",";"]},{type:"textline",b:["ok",";"]}]},{type:"node",name:"VECT_TRANSFORM",g:[{type:"node_in",name:"on",qualifier:["vec3"],
e:!1},{type:"node_out",name:"oo",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"oo [ 0 ] = oo [ 1 ] = oo [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["on",";"]}]},{type:"node",name:"BLACKBODY",g:[{type:"node_in",name:"op",qualifier:["float"],e:!1},{type:"node_out",name:"oq",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"oq [ 0 ] = oq [ 1 ] = oq [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["op",";"]}]},{type:"node",name:"WAVELENGTH",g:[{type:"node_in",name:"or",qualifier:["float"],
e:!1},{type:"node_out",name:"os",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"os [ 0 ] = os [ 1 ] = os [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["or",";"]}]},{type:"node",name:"SEPXYZ",g:[{type:"node_in",name:"ot",qualifier:["vec3"],e:!1},{type:"node_out",name:"ou",qualifier:["float"],e:!1},{type:"node_out",name:"ov",qualifier:["float"],e:!1},{type:"node_out",name:"ow",qualifier:["float"],e:!1}],f:[{type:"textline",b:"ou = ot [ 0 ] ; ov = ot [ 1 ] ; ow = ot [ 2 ] ;".split(" ")}]},
{type:"node",name:"COMBXYZ",g:[{type:"node_in",name:"ox",qualifier:["float"],e:!1},{type:"node_in",name:"oy",qualifier:["float"],e:!1},{type:"node_in",name:"oz",qualifier:["float"],e:!1},{type:"node_out",name:"oA",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"oA [ 0 ] = ox ; oA [ 1 ] = oy ; oA [ 2 ] = oz ;".split(" ")}]},{type:"node",name:"BRIGHTCONTRAST",g:[{type:"node_in",name:"oB",qualifier:["vec3"],e:!1},{type:"node_in",name:"oC",qualifier:["float"],e:!1},{type:"node_in",name:"oD",qualifier:["float"],
e:!1},{type:"node_out",name:"oE",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lC = UNITY_VALUE_NODES + oD ; lD = oC - oD * 0.5 ; oE [ 0 ] = max ( lC * oB [ 0 ] + lD , ZERO_VALUE_NODES ) ; oE [ 1 ] = max ( lC * oB [ 1 ] + lD , ZERO_VALUE_NODES ) ; oE [ 2 ] = max ( lC * oB [ 2 ] + lD , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LIGHT_FALLOFF",g:[{type:"node_in",name:"oF",qualifier:["float"],e:!1},{type:"node_in",name:"oG",qualifier:["float"],e:!1},{type:"node_out",name:"oH",qualifier:["float"],
e:!1},{type:"node_out",name:"oI",qualifier:["float"],e:!1},{type:"node_out",name:"oJ",qualifier:["float"],e:!1}],f:[{type:"textline",b:"oH = oI = oJ = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["oF",";","oG",";"]}]},{type:"node",name:"TEX_IMAGE",g:[{type:"node_in",name:"oK",qualifier:["vec3"],e:!1},{type:"node_out",name:"oL",qualifier:["vec3"],e:!1},{type:"node_out",name:"oM",qualifier:["float"],e:!1}],f:[{type:"textline",b:"oL [ 0 ] = oL [ 1 ] = oL [ 2 ] = ZERO_VALUE_NODES ; oM = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",b:["oK",";"]}]},{type:"node",name:"TEX_ENVIRONMENT",g:[{type:"node_in",name:"oN",qualifier:["vec3"],e:!1},{type:"node_out",name:"oO",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"oO [ 0 ] = oO [ 1 ] = oO [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["oN",";"]}]},{type:"node",name:"TEX_SKY",g:[{type:"node_in",name:"oP",qualifier:["vec3"],e:!1},{type:"node_out",name:"oQ",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"oQ [ 0 ] = oQ [ 1 ] = oQ [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:["oP",";"]}]},{type:"node",name:"TEX_NOISE",g:[{type:"node_in",name:"oR",qualifier:["vec3"],e:!1},{type:"node_in",name:"oS",qualifier:["float"],e:!1},{type:"node_in",name:"oT",qualifier:["float"],e:!1},{type:"node_in",name:"oU",qualifier:["float"],e:!1},{type:"node_out",name:"oV",qualifier:["vec3"],e:!1},{type:"node_out",name:"oW",qualifier:["float"],e:!1}],f:[{type:"textline",b:"oV [ 0 ] = oV [ 1 ] = oV [ 2 ] = ZERO_VALUE_NODES ; oW = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",
b:"oR ; oS ; oT ; oU ;".split(" ")}]},{type:"node",name:"TEX_WAVE",g:[{type:"node_in",name:"oX",qualifier:["vec3"],e:!1},{type:"node_in",name:"oY",qualifier:["float"],e:!1},{type:"node_in",name:"oZ",qualifier:["float"],e:!1},{type:"node_in",name:"o_",qualifier:["float"],e:!1},{type:"node_in",name:"pa",qualifier:["float"],e:!1},{type:"node_out",name:"pb",qualifier:["vec3"],e:!1},{type:"node_out",name:"pc",qualifier:["float"],e:!1}],f:[{type:"textline",b:"pb [ 0 ] = pb [ 1 ] = pb [ 2 ] = ZERO_VALUE_NODES ; pc = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",b:"oX ; oY ; oZ ; o_ ; pa ;".split(" ")}]},{type:"node",name:"TEX_VORONOI",g:[{type:"node_in",name:"pd",qualifier:["vec3"],e:!1},{type:"node_in",name:"pe",qualifier:["float"],e:!1},{type:"node_out",name:"pf",qualifier:["vec3"],e:!1},{type:"node_out",name:"pg",qualifier:["float"],e:!1}],f:[{type:"textline",b:"pf [ 0 ] = pf [ 1 ] = pf [ 2 ] = ZERO_VALUE_NODES ; pg = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:["pd",";","pe",";"]}]},{type:"node",name:"TEX_MUSGRAVE",g:[{type:"node_in",
name:"ph",qualifier:["vec3"],e:!1},{type:"node_in",name:"pi",qualifier:["float"],e:!1},{type:"node_in",name:"pj",qualifier:["float"],e:!1},{type:"node_in",name:"pk",qualifier:["float"],e:!1},{type:"node_in",name:"pl",qualifier:["float"],e:!1},{type:"node_in",name:"pm",qualifier:["float"],e:!1},{type:"node_in",name:"pn",qualifier:["float"],e:!1},{type:"node_out",name:"po",qualifier:["vec3"],e:!1},{type:"node_out",name:"pp",qualifier:["float"],e:!1}],f:[{type:"textline",b:"po [ 0 ] = po [ 1 ] = po [ 2 ] = ZERO_VALUE_NODES ; pp = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",b:"ph ; pi ; pj ; pk ; pl ; pm ; pn ;".split(" ")}]},{type:"node",name:"TEX_GRADIENT",g:[{type:"node_in",name:"pq",qualifier:["vec3"],e:!1},{type:"node_out",name:"pr",qualifier:["vec3"],e:!1},{type:"node_out",name:"ps",qualifier:["float"],e:!1}],f:[{type:"textline",b:"pr [ 0 ] = pr [ 1 ] = pr [ 2 ] = ZERO_VALUE_NODES ; ps = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:["pq",";"]}]},{type:"node",name:"TEX_MAGIC",g:[{type:"node_in",name:"pt",qualifier:["vec3"],e:!1},{type:"node_in",
name:"pu",qualifier:["float"],e:!1},{type:"node_in",name:"pv",qualifier:["float"],e:!1},{type:"node_out",name:"pw",qualifier:["vec3"],e:!1},{type:"node_out",name:"px",qualifier:["float"],e:!1}],f:[{type:"textline",b:"pw [ 0 ] = pw [ 1 ] = pw [ 2 ] = ZERO_VALUE_NODES ; px = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"pt ; pu ; pv ;".split(" ")}]},{type:"node",name:"TEX_CHECKER",g:[{type:"node_in",name:"py",qualifier:["vec3"],e:!1},{type:"node_in",name:"pz",qualifier:["vec3"],e:!1},{type:"node_in",
name:"pA",qualifier:["vec3"],e:!1},{type:"node_in",name:"pB",qualifier:["float"],e:!1},{type:"node_out",name:"pC",qualifier:["vec3"],e:!1},{type:"node_out",name:"pD",qualifier:["float"],e:!1}],f:[{type:"textline",b:"pC [ 0 ] = pC [ 1 ] = pC [ 2 ] = ZERO_VALUE_NODES ; pD = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"py ; pz ; pA ; pB ;".split(" ")}]},{type:"node",name:"TEX_BRICK",g:[{type:"node_in",name:"pE",qualifier:["vec3"],e:!1},{type:"node_in",name:"pF",qualifier:["vec3"],e:!1},{type:"node_in",
name:"pG",qualifier:["vec3"],e:!1},{type:"node_in",name:"pH",qualifier:["vec3"],e:!1},{type:"node_in",name:"pI",qualifier:["float"],e:!1},{type:"node_in",name:"pJ",qualifier:["float"],e:!1},{type:"node_in",name:"pK",qualifier:["float"],e:!1},{type:"node_in",name:"pL",qualifier:["float"],e:!1},{type:"node_in",name:"pM",qualifier:["float"],e:!1},{type:"node_out",name:"pN",qualifier:["vec3"],e:!1},{type:"node_out",name:"pO",qualifier:["float"],e:!1}],f:[{type:"textline",b:"pN [ 0 ] = pN [ 1 ] = pN [ 2 ] = ZERO_VALUE_NODES ; pO = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",b:"pE ; pF ; pG ; pH ; pI ; pJ ; pK ; pL ; pM ;".split(" ")}]},{type:"node",name:"ADD_SHADER",g:[{type:"node_in",name:"pP",qualifier:["vec3"],e:!1},{type:"node_in",name:"pQ",qualifier:["vec3"],e:!1},{type:"node_out",name:"pR",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"pR = clamp ( pP + pQ , kM , kN ) ;".split(" ")}]},{type:"node",name:"MIX_SHADER",g:[{type:"node_in",name:"pS",qualifier:["float"],e:!1},{type:"node_in",name:"pT",qualifier:["vec3"],e:!1},{type:"node_in",name:"pU",
qualifier:["vec3"],e:!1},{type:"node_out",name:"pV",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lE = clamp ( pS , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; pV = lE * pT + ( UNITY_VALUE_NODES - lE ) * pU ;".split(" ")}]},{type:"node",name:"UV_MERGED",g:[{type:"node_out",name:"pW",qualifier:["vec3"],e:!1},{type:"node_out",name:"pX",qualifier:["vec3"],e:!1},{type:"node_param",name:"lk",qualifier:["varying","vec2"]}],f:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pW"],f:[{type:"textline",
b:"pW = lb ( lk ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pX"],f:[{type:"textline",b:"pX = vec3 ( lk , ZERO_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"TEX_COORD_UV",g:[{type:"node_out",name:"pY",qualifier:["vec3"],e:!1},{type:"node_param",name:"ll",qualifier:["varying","vec2"]}],f:[{type:"textline",b:"pY = vec3 ( ll , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_NO",g:[{type:"node_out",name:"pZ",qualifier:["vec3"],e:!1}],f:[{type:"textline",
b:["pZ","=","lP",";"]}]},{type:"node",name:"TEX_COORD_GE",g:[{type:"node_out",name:"p_",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"p_ = abs ( kL ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_OB",g:[{type:"node_out",name:"qa",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"qa [ 0 ] = qa [ 1 ] = qa [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_CA",g:[{type:"node_out",name:"qb",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"qb [ 0 ] = lL [ 0 ] ; qb [ 1 ] = lL [ 1 ] ; qb [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"TEX_COORD_WI",g:[{type:"node_out",name:"qc",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"qc [ 0 ] = qc [ 1 ] = qc [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_RE",g:[{type:"node_out",name:"qd",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"qd [ 0 ] = qd [ 1 ] = qd [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"UVMAP",g:[{type:"node_out",name:"qe",qualifier:["vec3"],e:!1},{type:"node_param",name:"lm",qualifier:["varying","vec2"]}],
f:[{type:"textline",b:"qe = vec3 ( lm , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"PARTICLE_INFO",g:[{type:"node_out",name:"qf",qualifier:["float"],e:!1},{type:"node_out",name:"qg",qualifier:["float"],e:!1},{type:"node_out",name:"qh",qualifier:["float"],e:!1},{type:"node_out",name:"qi",qualifier:["vec3"],e:!1},{type:"node_out",name:"qj",qualifier:["float"],e:!1},{type:"node_out",name:"qk",qualifier:["vec3"],e:!1},{type:"node_out",name:"ql",qualifier:["vec3"],e:!1}],f:[{type:"textline",
b:"qf = ZERO_VALUE_NODES ; qg = ZERO_VALUE_NODES ; qh = ZERO_VALUE_NODES ; qi = vec3 ( ZERO_VALUE_NODES ) ; qj = ZERO_VALUE_NODES ; qk = qi ; ql = qi ;".split(" ")}]},{type:"node",name:"HAIR_INFO",g:[{type:"node_out",name:"qm",qualifier:["float"],e:!1},{type:"node_out",name:"qn",qualifier:["float"],e:!1},{type:"node_out",name:"qo",qualifier:["float"],e:!1},{type:"node_out",name:"qp",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"qm = ZERO_VALUE_NODES ; qn = ZERO_VALUE_NODES ; qo = ZERO_VALUE_NODES ; qp = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"OBJECT_INFO",g:[{type:"node_out",name:"qq",qualifier:["vec3"],e:!1},{type:"node_out",name:"qr",qualifier:["float"],e:!1},{type:"node_out",name:"qs",qualifier:["float"],e:!1},{type:"node_out",name:"qt",qualifier:["float"],e:!1}],f:[{type:"textline",b:"qr = ZERO_VALUE_NODES ; qs = ZERO_VALUE_NODES ; qt = ZERO_VALUE_NODES ; qq = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"WIREFRAME",g:[{type:"node_in",name:"qu",qualifier:["float"],e:!1},{type:"node_out",name:"qv",
qualifier:["float"],e:!1}],f:[{type:"textline",b:["qv","=","qu",";"]}]},{type:"node",name:"TANGENT",g:[{type:"node_out",name:"qw",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"qw = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LAYER_WEIGHT",g:[{type:"node_in",name:"qx",qualifier:["float"],e:!1},{type:"node_in",name:"qy",qualifier:["vec3"],e:!1},{type:"node_out",name:"qz",qualifier:["float"],e:!1},{type:"node_out",name:"qA",qualifier:["float"],e:!1}],f:[{type:"textline",b:"qz = qA = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:["qy",";","qx",";"]}]},{type:"node",name:"LIGHT_PATH",g:[{type:"node_out",name:"qB",qualifier:["float"],e:!1},{type:"node_out",name:"qC",qualifier:["float"],e:!1},{type:"node_out",name:"qD",qualifier:["float"],e:!1},{type:"node_out",name:"qE",qualifier:["float"],e:!1},{type:"node_out",name:"qF",qualifier:["float"],e:!1},{type:"node_out",name:"qG",qualifier:["float"],e:!1},{type:"node_out",name:"qH",qualifier:["float"],e:!1},{type:"node_out",name:"qI",qualifier:["float"],e:!1},{type:"node_out",
name:"qJ",qualifier:["float"],e:!1},{type:"node_out",name:"qK",qualifier:["float"],e:!1}],f:[{type:"textline",b:"qB = qC = qD = ZERO_VALUE_NODES ; qE = qF = qG = ZERO_VALUE_NODES ; qH = qH = qJ = qK = ZERO_VALUE_NODES ; qI = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"ATTRIBUTE",g:[{type:"node_out",name:"qL",qualifier:["vec3"],e:!1},{type:"node_out",name:"qM",qualifier:["vec3"],e:!1},{type:"node_out",name:"qN",qualifier:["float"],e:!1}],f:[{type:"textline",b:"qL = qM = vec3 ( ZERO_VALUE_NODES ) ; qN = ZERO_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"SCRIPT",g:[],f:[]},{type:"node",name:"CURVE_VEC",g:[{type:"node_in",name:"qO",qualifier:["float"],e:!1},{type:"node_in",name:"qP",qualifier:["vec3"],e:!1},{type:"node_out",name:"qQ",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["qQ","=","qP",";"]},{type:"textline",b:["qO",";"]}]},{type:"node",name:"CURVE_RGB",g:[{type:"node_in",name:"qR",qualifier:["float"],e:!1},{type:"node_in",name:"qS",qualifier:["vec3"],e:!1},{type:"node_out",name:"qT",qualifier:["vec3"],e:!1}],f:[{type:"textline",
b:["qT","=","qS",";"]},{type:"textline",b:["qR",";"]}]},{type:"node",name:"VALTORGB",g:[{type:"node_in",name:"qU",qualifier:["float"],e:!1},{type:"node_out",name:"qV",qualifier:["vec3"],e:!1},{type:"node_out",name:"qW",qualifier:["float"],e:!1}],f:[{type:"textline",b:"qV [ 0 ] = qV [ 1 ] = qV [ 2 ] = clamp ( qU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; qW = qV [ 0 ] ;".split(" ")}]},{type:"node",name:"MAPPING",g:[{type:"node_in",name:"qX",qualifier:["vec3"],e:!1},{type:"node_out",name:"qY",qualifier:["vec3"],
e:!1}],f:[{type:"textline",b:["qY","=","qX",";"]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_TRS_MATRIX",f:[{type:"textline",b:"qY = ( MAPPING_TRS_MATRIX * vec4 ( qY , UNITY_VALUE_NODES ) ) . xyz ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_SCALE",f:[{type:"textline",b:"qY = qY * MAPPING_SCALE ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_TRANSLATION",f:[{type:"textline",b:"qY = qY + MAPPING_TRANSLATION ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_MIN_CLIP",f:[{type:"textline",b:"qY = max ( qY , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_MAX_CLIP",f:[{type:"textline",b:"qY = min ( qY , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["MAPPING_IS_NORMAL"],f:[{type:"textline",b:"qY = normalize ( qY ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ADD",g:[{type:"node_in",name:"qZ",qualifier:["float"],
e:!1},{type:"node_in",name:"q_",qualifier:["float"],e:!1},{type:"node_out",name:"ra",qualifier:["float"],e:!1}],f:[{type:"textline",b:"ra = qZ + q_ ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"ra = clamp ( ra , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SUBTRACT",g:[{type:"node_in",name:"rb",qualifier:["float"],e:!1},{type:"node_in",name:"rc",qualifier:["float"],e:!1},{type:"node_out",name:"rd",qualifier:["float"],
e:!1}],f:[{type:"textline",b:"rd = rb - rc ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"rd = clamp ( rd , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MULTIPLY",g:[{type:"node_in",name:"re",qualifier:["float"],e:!1},{type:"node_in",name:"rf",qualifier:["float"],e:!1},{type:"node_out",name:"rg",qualifier:["float"],e:!1}],f:[{type:"textline",b:"rg = re * rf ;".split(" ")},{type:"node_condition",a:[{type:"node_if",
c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"rg = clamp ( rg , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_DIVIDE",g:[{type:"node_in",name:"rh",qualifier:["float"],e:!1},{type:"node_in",name:"ri",qualifier:["float"],e:!1},{type:"node_out",name:"rj",qualifier:["float"],e:!1}],f:[{type:"textline",b:"rj = ( ri != ZERO_VALUE_NODES ) ? rh / ri : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"rj = clamp ( rj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_SINE",g:[{type:"node_in",name:"rk",qualifier:["float"],e:!1},{type:"node_in",name:"rl",qualifier:["float"],e:!1},{type:"node_out",name:"rm",qualifier:["float"],e:!1}],f:[{type:"textline",b:"rm = sin ( rk ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"rm = clamp ( rm , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["rl",";"]}]},{type:"node",name:"MATH_COSINE",g:[{type:"node_in",name:"rn",
qualifier:["float"],e:!1},{type:"node_in",name:"ro",qualifier:["float"],e:!1},{type:"node_out",name:"rp",qualifier:["float"],e:!1}],f:[{type:"textline",b:"rp = cos ( rn ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"rp = clamp ( rp , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["ro",";"]}]},{type:"node",name:"MATH_TANGENT",g:[{type:"node_in",name:"rq",qualifier:["float"],e:!1},{type:"node_in",name:"rr",qualifier:["float"],
e:!1},{type:"node_out",name:"rs",qualifier:["float"],e:!1}],f:[{type:"textline",b:"rs = tan ( rq ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"rs = clamp ( rs , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["rr",";"]}]},{type:"node",name:"MATH_ARCSINE",g:[{type:"node_in",name:"rt",qualifier:["float"],e:!1},{type:"node_in",name:"ru",qualifier:["float"],e:!1},{type:"node_out",name:"rv",qualifier:["float"],e:!1}],
f:[{type:"textline",b:"rv = ( rt <= UNITY_VALUE_NODES && rt >= - UNITY_VALUE_NODES ) ? asin ( rt ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"rv = clamp ( rv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["ru",";"]}]},{type:"node",name:"MATH_ARCCOSINE",g:[{type:"node_in",name:"rw",qualifier:["float"],e:!1},{type:"node_in",name:"rx",qualifier:["float"],e:!1},{type:"node_out",name:"ry",qualifier:["float"],
e:!1}],f:[{type:"textline",b:"ry = ( rw <= UNITY_VALUE_NODES && rw >= - UNITY_VALUE_NODES ) ? acos ( rw ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"ry = clamp ( ry , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["rx",";"]}]},{type:"node",name:"MATH_ARCTANGENT",g:[{type:"node_in",name:"rz",qualifier:["float"],e:!1},{type:"node_in",name:"rA",qualifier:["float"],e:!1},{type:"node_out",name:"rB",
qualifier:["float"],e:!1}],f:[{type:"textline",b:"rB = atan ( rz ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"rB = clamp ( rB , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["rA",";"]}]},{type:"node",name:"MATH_POWER",g:[{type:"node_in",name:"rC",qualifier:["float"],e:!1},{type:"node_in",name:"rD",qualifier:["float"],e:!1},{type:"node_out",name:"rE",qualifier:["float"],e:!1}],f:[{type:"textline",b:"if ( rC < ZERO_VALUE_NODES || rC == ZERO_VALUE_NODES && rD == ZERO_VALUE_NODES ) rE = ZERO_VALUE_NODES ; else rE = pow ( rC , rD ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"rE = clamp ( rE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_LOGARITHM",g:[{type:"node_in",name:"rF",qualifier:["float"],e:!1},{type:"node_in",name:"rG",qualifier:["float"],e:!1},{type:"node_out",name:"rH",qualifier:["float"],e:!1}],f:[{type:"textline",b:"rH = ( rF > ZERO_VALUE_NODES && rG > ZERO_VALUE_NODES ) ? log2 ( rF ) / log2 ( rG ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"rH = clamp ( rH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MINIMUM",g:[{type:"node_in",name:"rI",qualifier:["float"],e:!1},{type:"node_in",name:"rJ",qualifier:["float"],e:!1},{type:"node_out",name:"rK",qualifier:["float"],e:!1}],f:[{type:"textline",b:"rK = min ( rI , rJ ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"rK = clamp ( rK , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_MAXIMUM",g:[{type:"node_in",name:"rL",qualifier:["float"],e:!1},{type:"node_in",name:"rM",qualifier:["float"],e:!1},{type:"node_out",name:"rN",qualifier:["float"],e:!1}],f:[{type:"textline",b:"rN = max ( rL , rM ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"rN = clamp ( rN , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ROUND",g:[{type:"node_in",name:"rO",qualifier:["float"],e:!1},
{type:"node_in",name:"rP",qualifier:["float"],e:!1},{type:"node_out",name:"rQ",qualifier:["float"],e:!1}],f:[{type:"textline",b:"rQ = floor ( rO + 0.5 ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"rQ = clamp ( rQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["rP",";"]}]},{type:"node",name:"MATH_LESS_THAN",g:[{type:"node_in",name:"rR",qualifier:["float"],e:!1},{type:"node_in",name:"rS",qualifier:["float"],e:!1},
{type:"node_out",name:"rT",qualifier:["float"],e:!1}],f:[{type:"textline",b:"rT = ( rR < rS ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"rT = clamp ( rT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_GREATER_THAN",g:[{type:"node_in",name:"rU",qualifier:["float"],e:!1},{type:"node_in",name:"rV",qualifier:["float"],e:!1},{type:"node_out",name:"rW",qualifier:["float"],
e:!1}],f:[{type:"textline",b:"rW = ( rU > rV ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"rW = clamp ( rW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MODULO",g:[{type:"node_in",name:"rX",qualifier:["float"],e:!1},{type:"node_in",name:"rY",qualifier:["float"],e:!1},{type:"node_out",name:"rZ",qualifier:["float"],e:!1}],f:[{type:"textline",b:"rZ = abs ( rY ) > 0.000001 ? mod ( rX , rY ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"rZ = clamp ( rZ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ABSOLUTE",g:[{type:"node_in",name:"r_",qualifier:["float"],e:!1},{type:"node_in",name:"sa",qualifier:["float"],e:!1},{type:"node_out",name:"sb",qualifier:["float"],e:!1}],f:[{type:"textline",b:"sb = abs ( r_ ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"sb = clamp ( sb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},
{type:"textline",b:["sa",";"]}]},{type:"node",name:"MIX_RGB_MIX",g:[{type:"node_in",name:"sc",qualifier:["float"],e:!1},{type:"node_in",name:"sd",qualifier:["vec3"],e:!1},{type:"node_in",name:"se",qualifier:["vec3"],e:!1},{type:"node_out",name:"sf",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lE = clamp ( sc , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; sf = mix ( sd , se , lE ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"sf = clamp ( sf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_ADD",g:[{type:"node_in",name:"sg",qualifier:["float"],e:!1},{type:"node_in",name:"sh",qualifier:["vec3"],e:!1},{type:"node_in",name:"si",qualifier:["vec3"],e:!1},{type:"node_out",name:"sj",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lE = clamp ( sg , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; sj = mix ( sh , sh + si , lE ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"sj = clamp ( sj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_MULTIPLY",g:[{type:"node_in",name:"sk",qualifier:["float"],e:!1},{type:"node_in",name:"sl",qualifier:["vec3"],e:!1},{type:"node_in",name:"sm",qualifier:["vec3"],e:!1},{type:"node_out",name:"sn",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lE = clamp ( sk , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; sn = mix ( sl , sl * sm , lE ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"sn = clamp ( sn , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SUBTRACT",g:[{type:"node_in",name:"so",qualifier:["float"],e:!1},{type:"node_in",name:"sp",qualifier:["vec3"],e:!1},{type:"node_in",name:"sq",qualifier:["vec3"],e:!1},{type:"node_out",name:"sr",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lE = clamp ( so , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; sr = mix ( sp , sp - sq , lE ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"sr = clamp ( sr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SCREEN",g:[{type:"node_in",name:"ss",qualifier:["float"],e:!1},{type:"node_in",name:"st",qualifier:["vec3"],e:!1},{type:"node_in",name:"su",qualifier:["vec3"],e:!1},{type:"node_out",name:"sv",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lE = clamp ( ss , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lF = UNITY_VALUE_NODES - lE ; sv = kN - ( vec3 ( lF ) + lE * ( kN - su ) ) * ( kN - st ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",
b:"sv = clamp ( sv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIVIDE",g:[{type:"node_in",name:"sw",qualifier:["float"],e:!1},{type:"node_in",name:"sx",qualifier:["vec3"],e:!1},{type:"node_in",name:"sy",qualifier:["vec3"],e:!1},{type:"node_out",name:"sz",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lF = clamp ( sw , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lE = UNITY_VALUE_NODES - lF ; sy += step ( sy , kM ) ; sz = lE * sx + lF * sx / sy ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"sz = clamp ( sz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIFFERENCE",g:[{type:"node_in",name:"sA",qualifier:["float"],e:!1},{type:"node_in",name:"sB",qualifier:["vec3"],e:!1},{type:"node_in",name:"sC",qualifier:["vec3"],e:!1},{type:"node_out",name:"sD",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lE = clamp ( sA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; sD = mix ( sB , abs ( sB - sC ) , lE ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"sD = clamp ( sD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DARKEN",g:[{type:"node_in",name:"sE",qualifier:["float"],e:!1},{type:"node_in",name:"sF",qualifier:["vec3"],e:!1},{type:"node_in",name:"sG",qualifier:["vec3"],e:!1},{type:"node_out",name:"sH",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lF = clamp ( sE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; sH = min ( sF . rgb , sG . rgb * lF ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"sH = clamp ( sH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LIGHTEN",g:[{type:"node_in",name:"sI",qualifier:["float"],e:!1},{type:"node_in",name:"sJ",qualifier:["vec3"],e:!1},{type:"node_in",name:"sK",qualifier:["vec3"],e:!1},{type:"node_out",name:"sL",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lE = clamp ( sI , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; sL = max ( sJ . rgb , sK . rgb * lE ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"sL = clamp ( sL , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_OVERLAY",g:[{type:"node_in",name:"sM",qualifier:["float"],e:!1},{type:"node_in",name:"sN",qualifier:["vec3"],e:!1},{type:"node_in",name:"sO",qualifier:["vec3"],e:!1},{type:"node_out",name:"sP",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lF = clamp ( sM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lR = vec3 ( UNITY_VALUE_NODES - lF ) ; sP = mix ( sN * ( lR + 2.0 * lF * sO ) , kN - ( lR + 2.0 * lF * ( kN - sO ) ) * ( kN - sN ) , step ( 0.5 , sN ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"sP = clamp ( sP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DODGE",g:[{type:"node_in",name:"sQ",qualifier:["float"],e:!1},{type:"node_in",name:"sR",qualifier:["vec3"],e:!1},{type:"node_in",name:"sS",qualifier:["vec3"],e:!1},{type:"node_out",name:"sT",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lE = clamp ( sQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lS = kN - lE * sS ; lR = clamp ( sR / lS , 0.0 , 1.0 ) ; sT = mix ( mix ( lR , kN , step ( lS , kM ) ) , sR , step ( sR , kM ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"sT = clamp ( sT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_BURN",g:[{type:"node_in",name:"sU",qualifier:["float"],e:!1},{type:"node_in",name:"sV",qualifier:["vec3"],e:!1},{type:"node_in",name:"sW",qualifier:["vec3"],e:!1},{type:"node_out",name:"sX",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lF = clamp ( sU , 0.0 , 1.0 ) ; lR = vec3 ( 1.0 - lF ) ; lS = lR + lF * sW ; lR = clamp ( kN - ( kN - sV ) / lS , 0.0 , 1.0 ) ; sX = mix ( lR , kM , step ( lS , kM ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"sX = clamp ( sX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_HUE",g:[{type:"node_in",name:"sY",qualifier:["float"],e:!1},{type:"node_in",name:"sZ",qualifier:["vec3"],e:!1},{type:"node_in",name:"s_",qualifier:["vec3"],e:!1},{type:"node_out",name:"ta",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lE = clamp ( sY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; ta = sZ ; lS = kW ( s_ ) ; if ( lS . y != ZERO_VALUE_NODES ) { lR = kW ( ta ) ; lR . x = lS . x ; lT = k_ ( lR ) ; ta = mix ( ta , lT , lE ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"ta = clamp ( ta , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SATURATION",g:[{type:"node_in",name:"tb",qualifier:["float"],e:!1},{type:"node_in",name:"tc",qualifier:["vec3"],e:!1},{type:"node_in",name:"td",qualifier:["vec3"],e:!1},{type:"node_out",name:"te",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lF = clamp ( tb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lE = UNITY_VALUE_NODES - lF ; te = tc ; lS = kW ( te ) ; if ( lS . y != ZERO_VALUE_NODES ) { lT = kW ( td ) ; lS . y = lE * lS . y + lF * lT . y ; te = k_ ( lS ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"te = clamp ( te , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_VALUE",g:[{type:"node_in",name:"tf",qualifier:["float"],e:!1},{type:"node_in",name:"tg",qualifier:["vec3"],e:!1},{type:"node_in",name:"th",qualifier:["vec3"],e:!1},{type:"node_out",name:"ti",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lE = clamp ( tf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lF = UNITY_VALUE_NODES - lE ; lT = kW ( tg ) ; lU = kW ( th ) ; lT . z = lF * lT . z + lE * lU . z ; ti = k_ ( lT ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"ti = clamp ( ti , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_COLOR",g:[{type:"node_in",name:"tj",qualifier:["float"],e:!1},{type:"node_in",name:"tk",qualifier:["vec3"],e:!1},{type:"node_in",name:"tl",qualifier:["vec3"],e:!1},{type:"node_out",name:"tm",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lF = clamp ( tj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; tm = tk ; lV = kW ( tl ) ; if ( lV . y != ZERO_VALUE_NODES ) { lU = kW ( tm ) ; lU . x = lV . x ; lU . y = lV . y ; lW = k_ ( lU ) ; tm = mix ( tm , lW , lF ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"tm = clamp ( tm , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SOFT_LIGHT",g:[{type:"node_in",name:"tn",qualifier:["float"],e:!1},{type:"node_in",name:"to",qualifier:["vec3"],e:!1},{type:"node_in",name:"tp",qualifier:["vec3"],e:!1},{type:"node_out",name:"tq",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lE = clamp ( tn , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lF = UNITY_VALUE_NODES - lE ; lV = tp + to - tp * to ; tq = to * ( vec3 ( lF ) + vec3 ( lE ) * ( ( kN - to ) * tp + lV ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"tq = clamp ( tq , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LINEAR_LIGHT",g:[{type:"node_in",name:"tr",qualifier:["float"],e:!1},{type:"node_in",name:"ts",qualifier:["vec3"],e:!1},{type:"node_in",name:"tt",qualifier:["vec3"],e:!1},{type:"node_out",name:"tu",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"lF = clamp ( tr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; tu = ts + lF * ( 2.0 * tt - kN ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"tu = clamp ( tu , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"OUTPUT",g:[{type:"node_in",name:"tv",qualifier:["vec3"],e:!1},{type:"node_in",name:"tw",qualifier:["float"],e:!1}],f:[{type:"textline",b:"ls = tv ; lw = tw ;".split(" ")}]},{type:"node",name:"MATERIAL",g:[{type:"node_in",name:"tx",qualifier:["vec3"],e:!1},{type:"node_in",name:"ty",qualifier:["float"],e:!1},{type:"node_in",
name:"tz",qualifier:["vec3"],e:!1},{type:"node_in",name:"tA",qualifier:["vec3"],e:!0},{type:"node_out",name:"tB",qualifier:["vec3"],e:!0},{type:"node_out",name:"tC",qualifier:["float"],e:!0},{type:"node_out",name:"tD",qualifier:["vec3"],e:!0},{type:"node_param",name:"ln",qualifier:["const","vec2"]},{type:"node_param",name:"lo",qualifier:["const","vec3"]}],f:[{type:"textline",b:"lW = clamp ( tx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",b:"lV = lo [ 0 ] * clamp ( tz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_NORMAL"],f:[{type:"textline",b:"lX = normalize ( tA ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",b:["lX","=","lP",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["!","SHADELESS_MAT","&&","!","NODES_GLOW"],f:[{type:"textline",b:"lY = lz * lW ;".split(" ")},{type:"textline",b:"lZ = lB * u_environment_energy * kK ( lX ) ; lE = eF ( lW ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["NUM_LIGHTS",">","0"],f:[{type:"textline",
b:"lx = vec2 ( ln [ 0 ] , ln [ 1 ] ) ;".split(" ")},{type:"textline",b:"ly = vec2 ( lo [ 1 ] , lo [ 2 ] ) ; md = jw ( lY , lZ , lW , lV , lQ , lX , lr , ly , lx , lE , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , ZERO_VALUE_NODES , vec4 ( ZERO_VALUE_NODES ) ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",b:"md = jB ( lY , lZ , lW ) ;".split(" ")}]}]},{type:"textline",b:["lv","=","lE",";"]}]},{type:"node_else",f:[{type:"textline",b:"md . a = vec4 ( lW , ZERO_VALUE_NODES ) ; md . b = kM ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_tB"],f:[{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_DIFFUSE"],f:[{type:"textline",b:"tB = md . a . rgb ;".split(" ")}]},{type:"node_else",f:[{type:"textline",b:["tB","=","kM",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",b:"tB += md . b ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_tC"],f:[{type:"textline",b:"tC = clamp ( ty , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",b:"tC += md . a . a * lV . r * lA ; tC = clamp ( tC , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_tD"],f:[{type:"textline",b:["tD","=","lX",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",b:"lt = md . b ;".split(" ")}]},{type:"node_else",f:[{type:"textline",b:["lt","=","kM",";"]}]}]},{type:"textline",
b:["lu","=","lX",";"]}]},{type:"node",name:"MATERIAL_EXT",g:[{type:"node_in",name:"tE",qualifier:["vec3"],e:!1},{type:"node_in",name:"tF",qualifier:["float"],e:!1},{type:"node_in",name:"tG",qualifier:["vec3"],e:!1},{type:"node_in",name:"tH",qualifier:["vec3"],e:!0},{type:"node_in",name:"tI",qualifier:["float"],e:!1},{type:"node_in",name:"tJ",qualifier:["float"],e:!1},{type:"node_in",name:"tK",qualifier:["vec4"],e:!1},{type:"node_in",name:"tL",qualifier:["float"],e:!1},{type:"node_in",name:"tM",qualifier:["float"],
e:!1},{type:"node_out",name:"tN",qualifier:["vec3"],e:!0},{type:"node_out",name:"tO",qualifier:["float"],e:!0},{type:"node_out",name:"tP",qualifier:["vec3"],e:!0},{type:"node_out",name:"tQ",qualifier:["vec3"],e:!0},{type:"node_out",name:"tR",qualifier:["vec3"],e:!0},{type:"node_param",name:"lp",qualifier:["const","vec2"]},{type:"node_param",name:"lq",qualifier:["const","vec3"]}],f:[{type:"textline",b:"lV = clamp ( tE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",b:"l_ = lq [ 0 ] * clamp ( tG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_NORMAL"],f:[{type:"textline",b:"ma = normalize ( tH ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",b:["ma","=","lP",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["!","SHADELESS_MAT","&&","!","NODES_GLOW"],f:[{type:"textline",b:"lF = eF ( lV ) ;".split(" ")},{type:"textline",b:"mb = tI * lV ;".split(" ")},{type:"textline",b:"mc = lB * u_environment_energy * kK ( ma ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",
c:["NUM_LIGHTS",">","0"],f:[{type:"textline",b:"ly = vec2 ( lp [ 0 ] , lp [ 1 ] ) ; lx = vec2 ( lq [ 1 ] , lq [ 2 ] ) ; md = jw ( mb , mc , lV , l_ , lQ , ma , lr , lx , ly , lF , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , tJ , tK ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",b:"md = jB ( mb , mc , lV ) ;".split(" ")}]}]},{type:"textline",b:["lv","=","lF",";"]}]},{type:"node_else",f:[{type:"textline",b:"md . a = vec4 ( lV , ZERO_VALUE_NODES ) ; md . b = kM ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_tN"],f:[{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_DIFFUSE"],f:[{type:"textline",b:"tN = md . a . rgb ;".split(" ")}]},{type:"node_else",f:[{type:"textline",b:["tN","=","kM",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["REFLECTION_TYPE","!=","REFL_NONE"],f:[{type:"textline",b:"kt ( tN , lr , ma , tL ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",b:"tN += md . b ;".split(" ")}]}]}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_tO"],f:[{type:"textline",b:"tO = clamp ( tF , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",b:"tO += md . a . a * l_ . r * tM ; tO = clamp ( tO , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_tP"],f:[{type:"textline",b:["tP","=","ma",";"]}]}]},{type:"node_condition",a:[{type:"node_if",
c:["USE_OUT_tQ"],f:[{type:"textline",b:"tQ = md . a . rgb ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_tR"],f:[{type:"textline",b:"tR = md . b ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",b:"lt = md . b ;".split(" ")}]},{type:"node_else",f:[{type:"textline",b:["lt","=","kM",";"]}]}]},{type:"textline",b:["lu","=","ma",";"]}]},{type:"node",name:"RGB",g:[{type:"node_out",name:"tS",qualifier:["vec3"],e:!1}],f:[{type:"textline",
b:"tS = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{type:"node",name:"RGBTOBW",g:[{type:"node_in",name:"tT",qualifier:["vec3"],e:!1},{type:"node_out",name:"tU",qualifier:["float"],e:!1}],f:[{type:"textline",b:"tU = tT . r * 0.35 + tT . g * 0.45 + tT . b * 0.2 ;".split(" ")}]},{type:"node",name:"SEPRGB",g:[{type:"node_in",name:"tV",qualifier:["vec3"],e:!1},{type:"node_out",name:"tW",qualifier:["float"],e:!0},{type:"node_out",name:"tX",qualifier:["float"],e:!0},{type:"node_out",name:"tY",qualifier:["float"],
e:!0}],f:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_tW"],f:[{type:"textline",b:"tW = tV . r ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_tX"],f:[{type:"textline",b:"tX = tV . g ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_tY"],f:[{type:"textline",b:"tY = tV . b ;".split(" ")}]}]}]},{type:"node",name:"SEPHSV",g:[{type:"node_in",name:"tZ",qualifier:["vec3"],e:!1},{type:"node_out",name:"t_",qualifier:["float"],e:!0},{type:"node_out",
name:"ua",qualifier:["float"],e:!0},{type:"node_out",name:"ub",qualifier:["float"],e:!0}],f:[{type:"textline",b:"l_ = kW ( tZ ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_t_"],f:[{type:"textline",b:"t_ = l_ . r ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ua"],f:[{type:"textline",b:"ua = l_ . g ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ub"],f:[{type:"textline",b:"ub = l_ . b ;".split(" ")}]}]}]},{type:"node",name:"SQUEEZE",
g:[{type:"node_in",name:"uc",qualifier:["float"],e:!1},{type:"node_in",name:"ud",qualifier:["float"],e:!1},{type:"node_in",name:"ue",qualifier:["float"],e:!1},{type:"node_out",name:"uf",qualifier:["float"],e:!1}],f:[{type:"textline",b:"uf = UNITY_VALUE_NODES / ( UNITY_VALUE_NODES + pow ( 2.71828183 , - ( ( uc - ue ) * ud ) ) ) ;".split(" ")}]},{type:"node",name:"GAMMA",g:[{type:"node_in",name:"ug",qualifier:["vec3"],e:!1},{type:"node_in",name:"uh",qualifier:["float"],e:!1},{type:"node_out",name:"ui",
qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"ui = max ( kM , ug ) ; ui = pow ( ui , vec3 ( uh ) ) ;".split(" ")}]},{type:"node",name:"B4W_SRGB_TO_LINEAR",g:[{type:"node_in",name:"uj",qualifier:["vec3"],e:!1},{type:"node_out",name:"uk",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"uk = max ( kM , uj ) ; uk = pow ( uk , vec3 ( 2.2 ) ) ;".split(" ")}]},{type:"node",name:"B4W_LINEAR_TO_SRGB",g:[{type:"node_in",name:"ul",qualifier:["vec3"],e:!1},{type:"node_out",name:"um",qualifier:["vec3"],e:!1}],
f:[{type:"textline",b:"um = max ( kM , ul ) ; um = pow ( um , vec3 ( UNITY_VALUE_NODES / 2.2 ) ) ;".split(" ")}]},{type:"node",name:"TEXTURE_EMPTY",g:[{type:"node_out",name:"un",qualifier:["vec3"],e:!1},{type:"node_out",name:"uo",qualifier:["vec3"],e:!1},{type:"node_out",name:"up",qualifier:["float"],e:!1}],f:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_up"],f:[{type:"textline",b:"un [ 2 ] = un [ 1 ] = un [ 0 ] = 0.0 ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_up"],
f:[{type:"textline",b:"uo [ 2 ] = uo [ 1 ] = uo [ 0 ] = 0.0 ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_up"],f:[{type:"textline",b:["up","=","0.0",";"]}]}]}]},{type:"node",name:"TEXTURE_ENVIRONMENT",g:[{type:"node_in",name:"uq",qualifier:["vec3"],e:!1},{type:"node_out",name:"ur",qualifier:["vec3"],e:!0},{type:"node_out",name:"us",qualifier:["float"],e:!0},{type:"node_param",name:"node_TEXTURE_ENVIRONMENT_var_texture",qualifier:["uniform","samplerCube"]}],f:[{type:"textline",
b:"lM = textureCube ( node_TEXTURE_ENVIRONMENT_var_texture , uq ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ur"],f:[{type:"textline",b:"ur = lM . xyz ; fB ( ur ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_us"],f:[{type:"textline",b:"us = lM . w ;".split(" ")}]}]}]},{type:"node",name:"TEXTURE_COLOR",g:[{type:"node_in",name:"ut",qualifier:["vec3"],e:!0},{type:"node_in",name:"uu",qualifier:["vec3"],e:!0},{type:"node_in",name:"uv",qualifier:["vec3"],
e:!0},{type:"node_in",name:"uw",qualifier:["vec3"],e:!0},{type:"node_out",name:"ux",qualifier:["vec3"],e:!0},{type:"node_out",name:"uy",qualifier:["float"],e:!0},{type:"node_out",name:"uz",qualifier:["vec3"],e:!0},{type:"node_out",name:"uA",qualifier:["float"],e:!0},{type:"node_out",name:"uB",qualifier:["vec3"],e:!0},{type:"node_out",name:"uC",qualifier:["float"],e:!0},{type:"node_out",name:"uD",qualifier:["vec3"],e:!0},{type:"node_out",name:"uE",qualifier:["float"],e:!0},{type:"node_param",name:"node_TEXTURE_COLOR_var_texture",
qualifier:["uniform","sampler2D"]}],f:[{type:"textline",b:"lM = texture2D ( node_TEXTURE_COLOR_var_texture , ld ( ut ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ux"],f:[{type:"textline",b:"ux = lM . xyz ; fB ( ux ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_uy"],f:[{type:"textline",b:"uy = lM . w ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv2"],f:[{type:"textline",b:"lM = texture2D ( node_TEXTURE_COLOR_var_texture , ld ( uu ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_uz"],f:[{type:"textline",b:"uz = lM . xyz ; fB ( uz ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_uA"],f:[{type:"textline",b:"uA = lM . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv3"],f:[{type:"textline",b:"lM = texture2D ( node_TEXTURE_COLOR_var_texture , ld ( uv ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_uB"],f:[{type:"textline",b:"uB = lM . xyz ; fB ( uB ) ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_uC"],f:[{type:"textline",b:"uC = lM . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv4"],f:[{type:"textline",b:"lM = texture2D ( node_TEXTURE_COLOR_var_texture , ld ( uw ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_uD"],f:[{type:"textline",b:"uD = lM . xyz ; fB ( uD ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_uE"],f:[{type:"textline",b:"uE = lM . w ;".split(" ")}]}]}]}]}]},
{type:"node",name:"TEXTURE_NORMAL",g:[{type:"node_in",name:"uF",qualifier:["vec3"],e:!0},{type:"node_in",name:"uG",qualifier:["vec3"],e:!0},{type:"node_in",name:"uH",qualifier:["vec3"],e:!0},{type:"node_in",name:"uI",qualifier:["vec3"],e:!0},{type:"node_out",name:"uJ",qualifier:["vec3"],e:!0},{type:"node_out",name:"uK",qualifier:["float"],e:!0},{type:"node_out",name:"uL",qualifier:["vec3"],e:!0},{type:"node_out",name:"uM",qualifier:["float"],e:!0},{type:"node_out",name:"uN",qualifier:["vec3"],e:!0},
{type:"node_out",name:"uO",qualifier:["float"],e:!0},{type:"node_out",name:"uP",qualifier:["vec3"],e:!0},{type:"node_out",name:"uQ",qualifier:["float"],e:!0},{type:"node_param",name:"node_TEXTURE_NORMAL_var_texture",qualifier:["uniform","sampler2D"]}],f:[{type:"textline",b:"lM = texture2D ( node_TEXTURE_NORMAL_var_texture , ld ( uF ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_uJ"],f:[{type:"textline",b:"uJ = normalize ( lN * ( lM . xyz - 0.5 ) ) ;".split(" ")}]}]},{type:"node_condition",
a:[{type:"node_if",c:["USE_OUT_uK"],f:[{type:"textline",b:"uK = lM . w ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv2"],f:[{type:"textline",b:"lM = texture2D ( node_TEXTURE_NORMAL_var_texture , ld ( uG ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_uL"],f:[{type:"textline",b:"uL = normalize ( lN * ( lM . xyz - 0.5 ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_uM"],f:[{type:"textline",b:"uM = lM . w ;".split(" ")}]}]}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_uv3"],f:[{type:"textline",b:"lM = texture2D ( node_TEXTURE_NORMAL_var_texture , ld ( uH ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_uN"],f:[{type:"textline",b:"uN = normalize ( lN * ( lM . xyz - 0.5 ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_uO"],f:[{type:"textline",b:"uO = lM . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv4"],f:[{type:"textline",b:"lM = texture2D ( node_TEXTURE_NORMAL_var_texture , ld ( uI ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_uP"],f:[{type:"textline",b:"uP = normalize ( lN * ( lM . xyz - 0.5 ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_uQ"],f:[{type:"textline",b:"uQ = lM . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"VALUE",g:[{type:"node_out",name:"uR",qualifier:["float"],e:!1}],f:[{type:"textline",b:"uR = u_node_values [ VALUE_IND ] ;".split(" ")}]},{type:"node",name:"VECT_MATH_ADD",g:[{type:"node_in",name:"uS",qualifier:["vec3"],
e:!1},{type:"node_in",name:"uT",qualifier:["vec3"],e:!1},{type:"node_out",name:"uU",qualifier:["vec3"],e:!1},{type:"node_out",name:"uV",qualifier:["float"],e:!0}],f:[{type:"textline",b:"uU = uS + uT ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_uV"],f:[{type:"textline",b:"uV = ( abs ( uU [ 0 ] ) + abs ( uU [ 1 ] ) + abs ( uU [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_SUBTRACT",g:[{type:"node_in",name:"uW",qualifier:["vec3"],e:!1},{type:"node_in",name:"uX",
qualifier:["vec3"],e:!1},{type:"node_out",name:"uY",qualifier:["vec3"],e:!1},{type:"node_out",name:"uZ",qualifier:["float"],e:!0}],f:[{type:"textline",b:"uY = uW - uX ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_uZ"],f:[{type:"textline",b:"uZ = ( abs ( uY [ 0 ] ) + abs ( uY [ 1 ] ) + abs ( uY [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_AVERAGE",g:[{type:"node_in",name:"u_",qualifier:["vec3"],e:!1},{type:"node_in",name:"va",qualifier:["vec3"],e:!1},{type:"node_out",
name:"vb",qualifier:["vec3"],e:!1},{type:"node_out",name:"vc",qualifier:["float"],e:!0}],f:[{type:"textline",b:"vb = u_ + va ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_vc"],f:[{type:"textline",b:"vc = length ( vb ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_vb"],f:[{type:"textline",b:"vb = normalize ( vb ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_DOT_PRODUCT",g:[{type:"node_in",name:"vd",qualifier:["vec3"],e:!1},{type:"node_in",name:"ve",
qualifier:["vec3"],e:!1},{type:"node_out",name:"vf",qualifier:["vec3"],e:!1},{type:"node_out",name:"vg",qualifier:["float"],e:!0}],f:[{type:"textline",b:["vf","=","kM",";"]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_vg"],f:[{type:"textline",b:"vg = dot ( vd , ve ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_CROSS_PRODUCT",g:[{type:"node_in",name:"vh",qualifier:["vec3"],e:!1},{type:"node_in",name:"vi",qualifier:["vec3"],e:!1},{type:"node_out",name:"vj",qualifier:["vec3"],e:!1},{type:"node_out",
name:"vk",qualifier:["float"],e:!0}],f:[{type:"textline",b:"vj = cross ( vh , vi ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_vk"],f:[{type:"textline",b:"vk = length ( vj ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_NORMALIZE",g:[{type:"node_in",name:"vl",qualifier:["vec3"],e:!1},{type:"node_in",name:"vm",qualifier:["vec3"],e:!1},{type:"node_out",name:"vn",qualifier:["vec3"],e:!1},{type:"node_out",name:"vo",qualifier:["float"],e:!0}],f:[{type:"textline",b:"vn = normalize ( vl ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_vo"],f:[{type:"textline",b:"vo = length ( vl ) ;".split(" ")}]}]},{type:"textline",b:["vm",";"]}]},{type:"node",name:"B4W_REFLECT",g:[{type:"node_in",name:"vp",qualifier:["vec3"],e:!1},{type:"node_in",name:"vq",qualifier:["vec3"],e:!1},{type:"node_out",name:"vr",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"vr = reflect ( - vp , vq ) ;".split(" ")}]},{type:"node",name:"B4W_PARALLAX",g:[{type:"node_in",name:"vs",qualifier:["vec3"],e:!1},{type:"node_in",
name:"vt",qualifier:["float"],e:!1},{type:"node_in",name:"vu",qualifier:["const","float"],e:!1},{type:"node_in",name:"vv",qualifier:["const","float"],e:!1},{type:"node_out",name:"vw",qualifier:["vec3"],e:!1},{type:"node_param",name:"node_B4W_PARALLAX_var_texture",qualifier:["uniform","sampler2D"]}],f:[{type:"textline",b:"lG = length ( lL ) ; if ( lG < vv ) { lx = ld ( vs ) ; lH = clamp ( 0.5 * ( vv - lG ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lH = vt * lH ;".split(" ")},{type:"textline",b:"l_ = normalize ( lr * lN ) ;".split(" ")},
{type:"textline",b:"lI = UNITY_VALUE_NODES / vu ;".split(" ")},{type:"textline",b:"ly = l_ . xy * lH / ( vu * l_ . z ) ; lJ = UNITY_VALUE_NODES ; lK = texture2D ( node_B4W_PARALLAX_var_texture , lx ) . a ;".split(" ")},{type:"textline",b:"for ( float vx = 1.0 ; vx <= vu ; vx ++ ) { if ( lK < lJ ) { lJ -= lI ; lx -= ly ; lK = texture2D ( node_B4W_PARALLAX_var_texture , lx ) . a ; } }".split(" ")},{type:"textline",b:"ly = lx + ly ; lI = texture2D ( node_B4W_PARALLAX_var_texture , ly ) . a - ( lJ + lI ) ; lJ = lK - lJ ; lJ = lJ / ( lJ - lI ) ;".split(" ")},
{type:"textline",b:"lx = lJ * ly + ( UNITY_VALUE_NODES - lJ ) * lx ; vw = lb ( lx ) ; } else vw = vs ;".split(" ")}]},{type:"node",name:"B4W_CLAMP",g:[{type:"node_in",name:"vy",qualifier:["vec3"],e:!1},{type:"node_out",name:"vz",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"vz = clamp ( vy , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"B4W_REFRACTION",g:[{type:"node_in",name:"vA",qualifier:["vec3"],e:!1},{type:"node_in",name:"vB",qualifier:["float"],e:!1},{type:"node_out",
name:"vC",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"vC = kR ( vA , vB ) ;".split(" ")}]},{type:"node",name:"B4W_TRANSLUCENCY",g:[{type:"node_in",name:"vD",qualifier:["float"],e:!1},{type:"node_in",name:"vE",qualifier:["float"],e:!1},{type:"node_in",name:"vF",qualifier:["float"],e:!1},{type:"node_in",name:"vG",qualifier:["float"],e:!1},{type:"node_in",name:"vH",qualifier:["float"],e:!1},{type:"node_out",name:"vI",qualifier:["float"],e:!0},{type:"node_out",name:"vJ",qualifier:["vec4"],e:!0}],
f:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_vI"],f:[{type:"textline",b:["vI","=","vD",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_vJ"],f:[{type:"textline",b:"vJ = vec4 ( vE , vF , vG , vH ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_TIME",g:[{type:"node_out",name:"vK",qualifier:["float"],e:!1}],f:[{type:"textline",b:["vK","=","u_time",";"]}]},{type:"node",name:"B4W_SMOOTHSTEP",g:[{type:"node_in",name:"vL",qualifier:["float"],e:!1},{type:"node_in",name:"vM",qualifier:["float"],
e:!1},{type:"node_in",name:"vN",qualifier:["float"],e:!1},{type:"node_out",name:"vO",qualifier:["float"],e:!1}],f:[{type:"textline",b:"vO = smoothstep ( vM , vN , vL ) ;".split(" ")}]},{type:"node",name:"B4W_GLOW_OUTPUT",g:[{type:"node_in",name:"vP",qualifier:["vec3"],e:!1},{type:"node_in",name:"vQ",qualifier:["float"],e:!1}],f:[{type:"textline",b:"ls = vP ; lw = vQ ;".split(" ")}]},{type:"node",name:"B4W_VECTOSCAL",g:[{type:"node_in",name:"vR",qualifier:["vec3"],e:!1},{type:"node_out",name:"vS",
qualifier:["float"],e:!1}],f:[{type:"textline",b:"vS = ( vR . r + vR . g + vR . b ) / 3.0 ;".split(" ")}]},{type:"node",name:"B4W_SCALTOVEC",g:[{type:"node_in",name:"vT",qualifier:["float"],e:!1},{type:"node_out",name:"vU",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"vU [ 0 ] = vT ; vU [ 1 ] = vT ; vU [ 2 ] = vT ;".split(" ")}]},{type:"nodes_global"},{type:"textline",b:"void vV ( in vec3 lr , out vec3 ls , out vec3 lt , out vec3 lu , out float lv , out float lw ) { vec2 lx , ly ; float lz , lA , lB , lC , lD , lE , lF , lG , lH , lI , lJ , lK ; vec4 lL , lM ; mat3 lN ; vec3 lO , lP , lQ , lR , lS , lT , lU , lV , lW , lX , lY , lZ , l_ , ma , mb , mc ;".split(" ")},
{type:"condition",a:[{type:"if",c:"USE_NODE_MATERIAL || USE_NODE_MATERIAL_EXT || USE_NODE_GEOMETRY_NO || CAUSTICS || CALC_TBN_SPACE || USE_NODE_TEX_COORD_NO".split(" "),group:{type:"group",a:[{type:"textline",b:["lO","=","jW",";"]},{type:"condition",a:[{type:"if",c:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",a:[{type:"textline",b:"if ( gl_FrontFacing ) lO = lO ; else lO = - lO ;".split(" ")}]}}]},{type:"textline",b:"lP = normalize ( lO ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],
group:{type:"group",a:[{type:"textline",b:"lQ = cross ( lO , jX . xyz ) * jX . w ; lN = mat3 ( jX . xyz , lQ , lO ) ; lN = lN ;".split(" ")}]}}]},{type:"textline",b:"lQ = jV ; lL = ck ; lz = u_emit ; lA = u_specular_alpha ; lB = u_ambient ; gN md ;".split(" ")},{type:"nodes_main"},{type:"textline",b:["}"]}]};a["include/nodes.glslv"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_OR","||","USE_NODE_TEX_COORD_GE"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_orco_tex_coord ; varying vec3 kL ;".split(" ")}]}}]},
{type:"node",name:"TEX_COORD_UV",g:[{type:"node_param",name:"node_TEX_COORD_UV_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"ll",qualifier:["varying","vec2"]}],f:[{type:"textline",b:["ll","=","node_TEX_COORD_UV_var_a_uv",";"]}]},{type:"node",name:"UV_MERGED",g:[{type:"node_param",name:"node_UV_MERGED_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"lk",qualifier:["varying","vec2"]}],f:[{type:"textline",b:["lk","=","node_UV_MERGED_var_a_uv",";"]}]},{type:"node",
name:"UVMAP",g:[{type:"node_param",name:"node_UVMAP_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"lm",qualifier:["varying","vec2"]}],f:[{type:"textline",b:["lm","=","node_UVMAP_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_UV",g:[{type:"node_param",name:"node_GEOMETRY_UV_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"le",qualifier:["varying","vec2"]}],f:[{type:"textline",b:["le","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_VC",g:[{type:"node_param",
name:"node_GEOMETRY_VC_var_a_vertex_color",qualifier:["attribute","vec3"]},{type:"node_param",name:"vW",qualifier:["varying","vec3"]}],f:[{type:"textline",b:["vW","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC1",g:[{type:"node_param",name:"node_GEOMETRY_VC1_var_a_vertex_color",qualifier:["attribute","float"]},{type:"node_param",name:"vX",qualifier:["varying","float"]}],f:[{type:"textline",b:["vX","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC2",
g:[{type:"node_param",name:"node_GEOMETRY_VC2_var_a_vertex_color",qualifier:["attribute","vec2"]},{type:"node_param",name:"vY",qualifier:["varying","vec2"]}],f:[{type:"textline",b:["vY","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC3",g:[{type:"node_param",name:"node_GEOMETRY_VC3_var_a_vertex_color",qualifier:["attribute","vec3"]},{type:"node_param",name:"vZ",qualifier:["varying","vec3"]}],f:[{type:"textline",b:["vZ","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},
{type:"nodes_global"},{type:"textline",b:["void","v_","(",")","{"]},{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_OR","||","USE_NODE_TEX_COORD_GE"],group:{type:"group",a:[{type:"textline",b:["kL","=","a_orco_tex_coord",";"]}]}}]},{type:"nodes_main"},{type:"textline",b:["}"]}]};a["include/particles.glslv"]={type:"group",a:[{type:"var",name:"EPSILON",b:["0.0001"]},{type:"textline",b:"struct wb { float a ; vec3 b ; float c ; vec3 d ; float e ; } ;".split(" ")},{type:"condition",a:[{type:"if",
c:["SIZE_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"void wh ( inout float wc , float wd , vec2 we , vec2 wf ) { float wg ; wg = wf . x - we . x ; wg = ( wd - we . x ) / wg ; wc = mix ( wc , wf . y , clamp ( wg , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"void wn ( inout vec3 wi , float wj , vec4 wk , vec4 wl ) { float wm ; wm = wl . x - wk . x ; wm = ( wj - wk . x ) / wm ; wi = mix ( wi , wl . yzw , clamp ( wm , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"float wt ( float wo , float wp , vec2 wq [ SIZE_RAMP_LENGTH ] ) { float wr , ws ; wr = wo / wp ; ws = wq [ 0 ] . y ;".split(" ")},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",">","1"],group:{type:"group",a:[{type:"textline",b:"wh ( ws , wr , wq [ 0 ] , wq [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",">","2"],group:{type:"group",a:[{type:"textline",
b:"wh ( ws , wr , wq [ 1 ] , wq [ 2 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",">","3"],group:{type:"group",a:[{type:"textline",b:"wh ( ws , wr , wq [ 2 ] , wq [ 3 ] ) ;".split(" ")}]}}]},{type:"textline",b:["return","ws",";","}"]}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"vec3 wz ( float wu , float wv , vec4 ww [ COLOR_RAMP_LENGTH ] ) { vec3 wx ; float wy ; wy = wu / wv ; wx = ww [ 0 ] . yzw ;".split(" ")},
{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",">","1"],group:{type:"group",a:[{type:"textline",b:"wn ( wx , wy , ww [ 0 ] , ww [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",">","2"],group:{type:"group",a:[{type:"textline",b:"wn ( wx , wy , ww [ 1 ] , ww [ 2 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",">","3"],group:{type:"group",a:[{type:"textline",b:"wn ( wx , wy , ww [ 2 ] , ww [ 3 ] ) ;".split(" ")}]}}]},{type:"textline",
b:["return","wx",";","}"]}]}}]},{type:"textline",b:"float wH ( float wA , float wB , float wC , float wD ) { float wE , wF , wG ; wE = max ( 0.01 , min ( wB , wC ) ) ; wF = max ( 0.01 , min ( wB , wD ) ) ; wG = wB - wF ; wE = clamp ( wA / wE , 0.0 , 1.0 ) - step ( wG , wA ) * ( wA - wG ) / wF ; return wE ; } wb wN ( ) { vec3 wI , wJ ; float wK , wL ; wb wM ; if ( u_p_cyclic == 1 ) { wK = mod ( u_p_time , u_p_length ) - a_p_delay ; if ( wK < 0.0 ) wK += u_p_length ; } if ( u_p_cyclic != 1 ) { wK = u_p_time - a_p_delay ; } if ( wK < 0.0 || wK >= a_p_lifetime ) { wM . a = 0.0001 ; wM . b = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( wK < 0.0 || wK >= a_p_lifetime ) ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["WORLD_SPACE"],group:{type:"group",a:[{type:"textline",b:"wI = a_position ; wJ = a_normal ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wI = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; wJ = ( u_model_matrix * vec4 ( a_normal , 0.0 ) ) . xyz ;".split(" ")}]}}]},{type:"textline",b:"wI += u_p_nfactor * wK * wJ ; wI += a_p_vels . xyz * wK ; wI . y -= u_p_gravity * wK * wK / 2.0 ; wL = max ( u_p_mass , EPSILON ) ; wI += ( u_p_wind / wL ) * wK * wK / 2.0 ; wM . b = wI ; wM . e = a_p_vels . w * wK ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"wM . a = wt ( wK , u_p_max_lifetime , u_p_size_ramp ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wM . a = 1.0 ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"wM . d = wz ( wK , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wM . d = vec3 ( 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"wM . c = wH ( wK , a_p_lifetime , u_p_fade_in , u_p_fade_out ) ; } return wM ; }".split(" ")}]};a["include/blending.glslf"]={type:"group",a:[{type:"textline",b:"float wP = 0.0 ; float wQ = 1.0 ; vec3 wR = vec3 ( wP ) ; vec3 wS = vec3 ( wQ ) ; vec3 wX ( vec3 wT ) { float wU , wV ; vec4 wW ; wW = vec4 ( wP , - wQ / 3.0 , 2.0 / 3.0 , - wQ ) ; wW = mix ( vec4 ( wT . bg , wW . wz ) , vec4 ( wT . gb , wW . xy ) , step ( wT . b , wT . g ) ) ; wW = mix ( vec4 ( wW . xyw , wT . r ) , vec4 ( wT . r , wW . yzx ) , step ( wW . x , wT . r ) ) ; wU = wW . x - min ( wW . w , wW . y ) ; wV = 1.0e-10 ; return vec3 ( abs ( wW . z + ( wW . w - wW . y ) / ( 6.0 * wU + wV ) ) , wU / ( wW . x + wV ) , wW . x ) ; } vec3 xa ( vec3 wY ) { vec3 wZ ; vec4 w_ ; w_ = vec4 ( wQ , 2.0 / 3.0 , wQ / 3.0 , 3.0 ) ; wZ = abs ( fract ( vec3 ( wY . r , wY . r , wY . r ) + w_ . xyz ) * 6.0 - w_ . www ) ; return wY . b * mix ( w_ . xxx , clamp ( wZ - w_ . xxx , wP , wQ ) , wY . g ) ; } vec3 xe ( vec3 xb , vec3 xc , float xd ) { return mix ( xb , xc , xd ) ; } vec3 xi ( vec3 xf , vec3 xg , float xh ) { return xh * xf + xg ; } vec3 xm ( vec3 xj , vec3 xk , float xl ) { return xk - xl * xj ; } vec3 xr ( vec3 xn , vec3 xo , float xp ) { float xq ; xq = wQ - xp ; return ( vec3 ( xq ) + xp * xn ) * xo ; } vec3 xw ( vec3 xs , vec3 xt , float xu ) { vec3 xv ; xv = vec3 ( wQ - xu ) ; return wS - ( xv + xu * ( wS - xs ) ) * ( wS - xt ) ; } vec3 xB ( vec3 xx , vec3 xy , float xz ) { vec3 xA ; xA = vec3 ( wQ - xz ) ; return mix ( xy * ( xA + 2.0 * xz * xx ) , wS - ( xA + 2.0 * xz * ( wS - xx ) ) * ( wS - xy ) , step ( 0.5 , xy ) ) ; } vec3 xF ( vec3 xC , vec3 xD , float xE ) { return mix ( xD , abs ( xC - xD ) , xE ) ; } vec3 xJ ( vec3 xG , vec3 xH , float xI ) { return mix ( xH , xH / ( xG + step ( xG , wR ) ) , xI ) ; } vec3 xN ( vec3 xK , vec3 xL , float xM ) { return mix ( xL , min ( xK , xL ) , xM ) ; } vec3 xR ( vec3 xO , vec3 xP , float xQ ) { return max ( xQ * xO , xP ) ; } vec3 xX ( vec3 xS , vec3 xT , float xU ) { vec3 xV , xW ; xV = wX ( xT ) ; if ( xV . y != wP ) { xW = wX ( xS ) ; xV = xa ( vec3 ( xV . x , xW . yz ) ) ; return mix ( xS , xV , xU ) ; } return xS ; } vec3 yc ( vec3 xY , vec3 xZ , float x_ ) { vec3 ya , yb ; ya = wX ( xY ) ; if ( ya . y != wP ) { yb = wX ( xZ ) ; return xa ( vec3 ( ya . x , mix ( ya . y , yb . y , x_ ) , ya . z ) ) ; } return xY ; } vec3 yi ( vec3 yd , vec3 ye , float yf ) { vec3 yg , yh ; yg = wX ( yd ) ; yh = wX ( ye ) ; return xa ( vec3 ( yg . xy , mix ( yg . z , yh . z , yf ) ) ) ; } vec3 yo ( vec3 yj , vec3 yk , float yl ) { vec3 ym , yn ; ym = wX ( yk ) ; if ( ym . y != wP ) { yn = wX ( yj ) ; ym = xa ( vec3 ( ym . xy , yn . z ) ) ; return mix ( yj , ym , yl ) ; } return yj ; } vec3 yt ( vec3 yp , vec3 yq , float yr ) { vec3 ys ; ys = wS - ( wS - yq ) * ( wS - yp ) ; return mix ( yp , ( ( wS - yp ) * yq * yp ) + yp * ys , yr ) ; } vec3 yx ( vec3 yu , vec3 yv , float yw ) { return yu + yw * ( 2.0 * yv - wQ ) ; } float yD ( float yy , float yz , float yA , float yB ) { float yC ; yC = wQ - yB ; return ( yC + yA * yy ) * yz ; } float yJ ( float yE , float yF , float yG , float yH ) { float yI ; yI = wQ - yH ; return wQ - ( yI + yG * ( wQ - yE ) ) * ( wQ - yF ) ; } float yP ( float yK , float yL , float yM , float yN ) { float yO ; yO = wQ - yN ; return mix ( yL * ( yO + 2.0 * yM * yK ) , wQ - ( yO + 2.0 * yM * ( wQ - yK ) ) * ( wQ - yL ) , step ( 0.5 , yL ) ) ; }".split(" ")}]};
a["include/depth_fetch.glslf"]={type:"group",a:[{type:"textline",b:"float za ( in sampler2D yV , in vec2 yW , in vec2 yX ) { float yY , yZ , y_ ; yY = texture2D ( yV , yW ) . r ; yZ = yX . x ; y_ = yX . y ; yY = 2.0 * yZ / ( yZ + y_ - ( 2.0 * yY - 1.0 ) * ( y_ - yZ ) ) ; return yY ; }".split(" ")}]}};b4w.module.animation=function(a,p){var b=p("__animation"),d=p("__constraints");p("__physics");var c=p("__print"),e=p("__util");a.SLOT_0=b.SLOT_0;a.SLOT_1=b.SLOT_1;a.SLOT_2=b.SLOT_2;a.SLOT_3=b.SLOT_3;a.SLOT_4=b.SLOT_4;a.SLOT_5=b.SLOT_5;a.SLOT_6=b.SLOT_6;a.SLOT_7=b.SLOT_7;a.SLOT_ALL=b.SLOT_ALL;a.OBJ_ANIM_TYPE_NONE=b.OBJ_ANIM_TYPE_NONE;a.OBJ_ANIM_TYPE_ARMATURE=b.OBJ_ANIM_TYPE_ARMATURE;a.OBJ_ANIM_TYPE_OBJECT=b.OBJ_ANIM_TYPE_OBJECT;a.OBJ_ANIM_TYPE_VERTEX=b.OBJ_ANIM_TYPE_VERTEX;a.OBJ_ANIM_TYPE_SOUND=b.OBJ_ANIM_TYPE_SOUND;
a.OBJ_ANIM_TYPE_PARTICLES=b.OBJ_ANIM_TYPE_PARTICLES;a.OBJ_ANIM_TYPE_MATERIAL=b.OBJ_ANIM_TYPE_MATERIAL;a.AB_CYCLIC=b.AB_CYCLIC;a.AB_FINISH_RESET=b.AB_FINISH_RESET;a.AB_FINISH_STOP=b.AB_FINISH_STOP;var f=new Float32Array(4);a.is_animated=function(a){return b.is_animated(a)};a.get_actions=function(){c.error("get_actions() deprecated, use get_anim_names() instead");for(var a=[],d=b.mq(),e=0;e<d.length;e++)a.push(b.YA(d[e].name));return a};a.get_current_action=function(b,d){c.error("get_current_action() deprecated, use get_current_anim_name() instead");
return a.get_current_anim_name(b,d)};a.get_anim_names=function(a){return b.bk(a)?b.get_anim_names(a):[]};a.get_current_anim_name=function(a,c){if(!b.is_animated(a))return null;c=c||b.SLOT_0;return b.Rx(a,c)};a.apply=function(a,d,e){if(e>b.SLOT_7)c.error("Can't apply animation to slot "+e+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{e=e||b.SLOT_0;if(b.is_animated(a)){var f=b.get_slot_num_by_anim(a,d);if(-1!=f&&f!=e){c.error('Animation "'+d+'" is already applied to object "'+
a.name+'" (slot "'+f+'").');return}}b.aC(a,d)?b.apply(a,d,e):c.error('No fcurves in action "'+d+'"')}};a.remove=function(a){b.remove(a)};a.remove_slot_animation=function(a,c){b.is_animated(a)&&(c=c||b.SLOT_0,b.remove_slot_animation(a,c))};a.apply_def=function(a){b.apply_def(a)};a.play=function(a,d,e){b.is_animated(a)?(e=e||b.SLOT_0,b.play(a,d,e),b.update_object_animation(a,0,e,!0)):c.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,c){b.is_animated(a)&&(c=c||b.SLOT_0,b.stop(a,
c))};a.is_play=function(a,c){if(!b.is_animated(a))return!1;c=c||b.SLOT_0;return b.is_play(a,c)};a.set_current_frame_float=function(b,d,e){c.error("set_current_frame_float() deprecated, use set_frame() instead");a.set_frame(b,d,e)};a.get_current_frame_float=function(b,d){c.error("get_current_frame_float() deprecated, use get_frame() instead");return a.get_frame(b,d)};a.set_frame=function(a,c,d){b.is_animated(a)&&(d=d||b.SLOT_0,b.set_current_frame_float(a,c,d),b.update_object_animation(a,0,d,!0))};
a.get_frame=function(a,c){if(!b.is_animated(a))return 0;c=c||b.SLOT_0;return b.get_current_frame_float(a,c)};a.set_speed=function(a,c,d){b.is_animated(a)&&(d=d||b.SLOT_0,b.set_speed(a,c||1,d))};a.get_speed=function(a,c){if(!b.is_animated(a))return 0;c=c||b.SLOT_0;return a.D[c]?b.get_speed(a,c):0};a.get_frame_range=function(a,d){c.error("get_frame_range() deprecated, use get_anim_start_frame() and get_anim_length() instead");if(b.is_animated(a)){d=d||b.SLOT_0;var e=a.D[d];if(e)return[e.start,e.start+
e.length]}return null};a.get_anim_start_frame=function(a,c){return b.is_animated(a)&&(c=c||b.SLOT_0,a.D[c])?b.get_anim_start_frame(a,c):-1};a.get_anim_length=function(a,c){return b.is_animated(a)&&(c=c||b.SLOT_0,a.D[c])?b.get_anim_length(a,c):-1};a.cyclic=function(d,e,f){c.error("cyclic() deprecated, use set_behavior() instead");a.set_behavior(d,e?b.AB_CYCLIC:b.AB_FINISH_RESET,f)};a.is_cyclic=function(a,d){c.error("is_cyclic() deprecated, use get_behavior() instead");if(!b.is_animated(a))return!1;
d=d||b.SLOT_0;return b.is_cyclic(a,d)};a.set_behavior=function(a,c,d){b.is_animated(a)&&(d=d||b.SLOT_0,b.set_behavior(a,c,d))};a.get_behavior=function(a,c){if(!b.is_animated(a))return null;c=c||b.SLOT_0;return b.get_behavior(a,c)};a.apply_smoothing=function(a,c,d,e){e=e||b.SLOT_0;b.is_animated(a)&&b.apply_smoothing(a,c,d,e)};a.update_object_animation=function(a,c,d,e){b.is_animated(a)&&(d=d||b.SLOT_0,b.update_object_animation(a,c||0,d,e||!1))};a.frame_to_sec=function(a){return b.frame_to_sec(a)};
a.get_bone_translation=function(a,b,c){if(!e.is_armature(a))return null;c||(c=new Float32Array(3));d.Vx(a,b,!1,f,null);c[0]=f[0];c[1]=f[1];c[2]=f[2];return c};a.get_first_armature_object=function(a){return e.is_mesh(a)?b.get_first_armature_object(a):null};a.get_slot_num_by_anim=function(a,c){return b.is_animated(a)&&c?b.get_slot_num_by_anim(a,c):null};a.get_anim_type=function(a,c){return b.is_animated(a)?b.get_anim_type(a,c):null};a.apply_to_first_empty_slot=function(a,c){return b.apply_to_first_empty_slot(a,
c)};a.get_skel_mix_factor=function(a){return a.d.Ae};a.set_skel_mix_factor=function(a,d,f){e.is_armature(a)?(d=Math.min(Math.max(d,0),1),a.d.Ae!=d&&b.set_skel_mix_factor(a,d,f||0)):c.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.anchors=function(a,p){var b=p("__anchors");p("__print");a.attach_move_cb=b.attach_move_cb;a.detach_move_cb=b.detach_move_cb;a.is_anchor=b.is_anchor;a.get_element_id=b.get_element_id};b4w.module.assets=function(a,p){var b=p("__assets");a.AT_ARRAYBUFFER=b.AT_ARRAYBUFFER;a.AT_JSON=b.AT_JSON;a.AT_TEXT=b.AT_TEXT;a.AT_AUDIOBUFFER=b.AT_AUDIOBUFFER;a.AT_IMAGE_ELEMENT=b.AT_IMAGE_ELEMENT;a.AT_AUDIO_ELEMENT=b.AT_AUDIO_ELEMENT;a.enqueue=function(a,c,e){b.enqueue(a,c,e)}};b4w.module.camera=function(a,p){function b(a,b){if(c.is_camera(a))return b||(b=new Float32Array(3)),m.copy(a.d.h,b),b;g.error("get_eye(): Wrong object")}function d(a,b){c.is_target_camera(a)?(m.copy(b,a.d.Lb),q.u(a),f.sync_transform(a)):g.error("set_pivot(): Wrong object or camera move style")}var c=p("__camera");p("__config");var e=p("__container"),f=p("__physics"),g=p("__print"),k=p("__constraints"),q=p("__transform"),h=p("__util"),m=p("vec3"),u=p("vec4");p("quat");var n=p("mat3"),w=p("mat4"),x=
new Float32Array(2),B=new Float32Array(3),y=new Float32Array(3),r=new Float32Array(4),A=new Float32Array(9);a.MS_STATIC=c.MS_STATIC;a.MS_ANIMATION=c.MS_STATIC;a.MS_TARGET_CONTROLS=c.MS_TARGET_CONTROLS;a.MS_EYE_CONTROLS=c.MS_EYE_CONTROLS;a.MS_HOVER_CONTROLS=c.MS_HOVER_CONTROLS;a.is_camera=c.is_camera;a.is_target_camera=c.is_target_camera;a.is_eye_camera=c.is_eye_camera;a.is_hover_camera=c.is_hover_camera;a.set_move_style=function(a,d){if(!c.is_camera(a))return g.error("set_move_style(): Wrong object"),
!1;if(d!=c.MS_STATIC&&d!=c.MS_EYE_CONTROLS&&d!=c.MS_HOVER_CONTROLS&&d!=c.MS_TARGET_CONTROLS)return g.error("set_move_style(): Wrong camera move style"),!1;a.d.ua=d;a.d.Rb=null;a.d.fd=null;a.d.xb=null;a.d.Ua=!1;c.Dy(a);switch(d){case c.MS_TARGET_CONTROLS:var e=b(a,B),k=h.quat_to_dir(a.d.quat,h.AXIS_MY,y),e=m.scaleAndAdd(e,k,10,k);m.copy(e,a.d.Lb)}q.u(a);f.sync_transform(a);return!0};a.get_move_style=function(a){return c.is_camera(a)?c.get_move_style(a):(g.error("get_move_style(): Wrong object"),null)};
a.set_velocity_params=function(a,b){if(!c.is_target_camera(a)&&!c.is_eye_camera(a)&&!c.is_hover_camera(a))return g.error("set_velocity_params(): Wrong object or camera move style"),null;var d=a.d;d.mo=h.clamp(b[0],0,Infinity);d.lo=h.clamp(b[1],0,Infinity);d.no=h.clamp(b[2],0,1)};a.get_velocity_params=function(a,b){if(!c.is_target_camera(a)&&!c.is_eye_camera(a)&&!c.is_hover_camera(a))return g.error("get_velocity_params(): Wrong object or camera move style"),null;b||(b=new Float32Array(3));var d=a.d;
b[0]=d.mo;b[1]=d.lo;b[2]=d.no;return b};a.set_look_at=function(a,b,d,e){var g=a.d;c.rx(b,d,e,g.h,g.quat);q.u(a);f.sync_transform(a)};a.get_eye=b;a.set_pivot=d;a.set_trans_pivot=function(a,b,d){c.is_target_camera(a)?(m.copy(b,a.d.h),m.copy(d,a.d.Lb),q.u(a),f.sync_transform(a)):g.error("set_trans_pivot(): Wrong object or camera move style")};a.get_pivot=function(a,b){if(c.is_target_camera(a))return b||(b=new Float32Array(3)),m.copy(a.d.Lb,b),b;g.error("get_pivot(): Wrong object or camera move style")};
a.rotate_pivot=function(b,c,d){g.error("rotate_pivot() deprecated, use rotate_camera() or rotate_target_camera() instead");a.rotate_target_camera(b,c,d)};a.move_pivot=function(a,b,d){if(c.is_target_camera(a)){var e=a.d;if(e.ft){var h=n.fromMat4(e.T,A),k=m.subtract(e.h,e.Lb,y);B[0]=b;B[1]=0;B[2]=d;m.scale(B,m.len(k),B);m.transformMat3(B,h,B);m.add(e.Lb,B,e.Lb);m.add(e.h,B,e.h);q.u(a);f.sync_transform(a)}}else g.error("move_pivot(): wrong object")};a.rotate_hover_cam=function(b,c){g.error("rotate_hover_cam() deprecated, use rotate_camera() or rotate_hover_camera() instead");
a.rotate_hover_camera(b,c,0)};a.get_hover_cam_angle=function(a){g.error("get_hover_cam_angle() deprecated, use get_camera_angles() instead");return c.is_hover_camera(a)?-c.get_camera_angles(a,x)[1]:(g.error("get_hover_cam_angle(): wrong object or camera move style"),null)};a.set_hover_cam_angle=function(a,b){g.error("set_hover_cam_angle() deprecated, use rotate_camera() or rotate_hover_camera() instead");if(c.is_hover_camera(a))if(a.d.Ua){var d=c.get_camera_angles(a,x);(d=-b-d[1])&&c.rotate_hover_camera(a,
0,d);q.u(a);f.sync_transform(a)}else g.error("set_hover_cam_angle(): distance/hover_angle limits are not defined or disabled");else g.error("set_hover_cam_angle(): wrong object or camera move style")};a.get_hover_angle_limits=function(a,b){if(c.is_hover_camera(a))return a.d.xb?(b||(b=new Float32Array(2)),b[0]=a.d.xb.Oa,b[1]=a.d.xb.Za):g.error("get_hover_angle_limits(): camera hasn't angle limits"),b;g.error("get_hover_angle_limits(): wrong object")};a.get_cam_dist_limits=function(a,b){if(c.is_hover_camera(a)||
c.is_target_camera(a))return a.d.Ua?(b||(b=new Float32Array(2)),b[0]=a.d.Gf,b[1]=a.d.Xd):g.error("get_cam_dist_limits(): camera hasn't distance limits"),b;g.error("get_cam_dist_limits(): wrong object")};a.translate_hover_cam_v=function(b,c){g.error("translate_hover_cam_v() deprecated, use hover_cam_set_translation() instead");a.hover_cam_set_translation(b,c)};a.hover_cam_set_translation=function(a,b){if(c.is_hover_camera(a)){var d=a.d;if(d.Ua){var e=m.subtract(b,d.h,B);m.add(e,d.Sb,d.Sb)}q.set_translation(a,
b);q.u(a);f.sync_transform(a)}else g.error("hover_cam_set_translation(): wrong object")};a.set_hover_pivot=function(a,b){if(c.is_hover_camera(a)){var d=a.d;if(d.Ua&&d.xb){var e=m.subtract(b,d.Sb,B),e=m.add(e,d.h,e);q.set_translation(a,e)}m.copy(b,d.Sb);q.u(a);f.sync_transform(a)}else g.error("set_hover_pivot(): Wrong object or camera move style")};a.get_hover_cam_pivot=function(a,b){if(!c.is_hover_camera(a))return g.error("get_hover_cam_pivot(): wrong object"),null;b||(b=new Float32Array(3));m.copy(a.d.Sb,
b);return b};a.has_distance_limits=function(a){return c.is_target_camera(a)||c.is_hover_camera(a)?a.d.Ua:(g.error("has_distance_limits(): wrong object"),null)};a.apply_vertical_limits=function(a,b,d,e){switch(c.get_move_style(a)){case c.MS_TARGET_CONTROLS:case c.MS_EYE_CONTROLS:e|=q.SPACE_WORLD;break;case c.MS_HOVER_CONTROLS:if(b>d){g.error("apply_vertical_limits(): wrong vertical limits");return}break;default:g.error("apply_vertical_limits(): wrong object");return}a.d.fd={Oa:b,Za:d};c.Ez(a,e==q.SPACE_LOCAL);
q.u(a);f.sync_transform(a)};a.clear_vertical_limits=function(a){a.d.fd=null};a.apply_horizontal_limits=function(a,b,d,e){switch(c.get_move_style(a)){case c.MS_TARGET_CONTROLS:case c.MS_EYE_CONTROLS:e|=q.SPACE_WORLD;break;case c.MS_HOVER_CONTROLS:if(b>d){g.error("apply_horizontal_limits(): wrong horizontal limits");return}break;default:g.error("apply_horizontal_limits(): wrong object");return}a.d.Rb={left:b,right:d};c.Az(a,e==q.SPACE_LOCAL);q.u(a);f.sync_transform(a)};a.clear_horizontal_limits=function(a){a.d.Rb=
null};a.get_horizontal_limits=function(a,b){if(!c.is_target_camera(a)&&!c.is_eye_camera(a)&&!c.is_hover_camera(a))return g.error("get_horizontal_limits(): wrong object"),null;var d=a.d;b=b||new Float32Array(2);return d.Rb?(b[0]=d.Rb.left,b[1]=d.Rb.right,b):null};a.has_horizontal_limits=function(a){if(c.is_target_camera(a)||c.is_eye_camera(a)||c.is_hover_camera(a))return Boolean(a.d.Rb);g.error("has_horizontal_limits(): wrong object")};a.apply_hover_angle_limits=function(a,b,d){c.is_hover_camera(a)?
b<d?g.error("apply_hover_angle_limits(): wrong hover angle limits"):(b=h.angle_wrap_periodic(b,-Math.PI,Math.PI),d=h.angle_wrap_periodic(d,-Math.PI,Math.PI),b=h.clamp(b,-Math.PI/2,0),d=h.clamp(d,-Math.PI/2,0),a.d.xb={Oa:b,Za:d},c.Cy(a),q.u(a),f.sync_transform(a)):g.error("apply_hover_angle_limits(): wrong object")};a.clear_hover_angle_limits=function(a){c.is_hover_camera(a)?a.d.xb=null:g.error("clear_hover_angle_limits(): wrong object")};a.apply_distance_limits=function(a,b,d){if(c.is_target_camera(a)||
c.is_hover_camera(a))if(b>d)g.error("apply_distance_limits(): wrong distance limits");else{var e=a.d;e.Ua=!0;e.Xd=b;e.Gf=d;q.u(a);f.sync_transform(a)}else g.error("apply_distance_limits(): wrong object")};a.clear_distance_limits=function(a){c.is_target_camera(a)||c.is_hover_camera(a)?a.d.Ua=!1:g.error("clear_distance_limits(): wrong object")};a.set_eye_params=function(b,c,d){g.error("set_eye_params() deprecated, use rotate_camera() or rotate_eye_camera() instead");a.rotate_eye_camera(b,c,Math.PI/
2-d)};a.is_look_up=function(a){h.quat_to_dir(a.d.quat,h.AXIS_MY,B);return 0<=B[1]?!0:!1};a.rotate_camera=function(b,d,e,h,k){switch(a.get_move_style(b)){case c.MS_STATIC:break;case c.MS_TARGET_CONTROLS:c.rotate_target_camera(b,d,e,h,k);break;case c.MS_EYE_CONTROLS:c.rotate_eye_camera(b,d,e,h,k);break;case c.MS_HOVER_CONTROLS:c.rotate_hover_camera(b,d,e,h,k);break;default:g.error("rotate_camera(): Wrong object")}q.u(b);f.sync_transform(b)};a.rotate_target_camera=function(a,b,d,e,h){c.is_target_camera(a)?
(c.rotate_target_camera(a,b,d,e,h),q.u(a),f.sync_transform(a)):g.error("rotate_target_camera(): wrong object")};a.rotate_eye_camera=function(a,b,d,e,h){c.is_eye_camera(a)?(c.rotate_eye_camera(a,b,d,e,h),q.u(a),f.sync_transform(a)):g.error("rotate_eye_camera(): wrong object")};a.rotate_hover_camera=function(a,b,d,e,h){c.is_hover_camera(a)?(c.rotate_hover_camera(a,b,d,e,h),q.u(a),f.sync_transform(a)):g.error("rotate_hover_camera(): wrong object")};a.rotate=function(b,c,d){g.error("rotate() deprecated, use rotate_camera() or rotate_eye_camera() instead");
a.rotate_eye_camera(b,c,-d)};a.get_camera_angles=function(a,b){b||(b=new Float32Array(2));c.get_camera_angles(a,b);return b};a.get_camera_angles_char=function(a,b){b||(b=new Float32Array(2));c.get_camera_angles_char(a,b);return b};a.get_angles=function(a,b){g.error("get_angles() deprecated, use get_camera_angles() instead");b||(b=new Float32Array(2));c.get_angles(a,b);return b};a.set_stereo_distance=function(a,b){for(var d=a.d.G,e=0;e<d.length;e++){var f=d[e];f.type!=c.ub&&f.type!=c.Bb||c.rA(f,b,
f.Ad)}};a.get_stereo_distance=function(a){a=a.d.G;for(var b=0;b<a.length;b++){var d=a[b];if(d.type==c.ub||d.type==c.Bb)return d.Xi}return 0};a.is_underwater=function(a){g.error("is_underwater() deprecated, always returns false");return a.d.Ys};a.translate_view=function(a,b,d,e){a=a.d.G;for(var f=0;f<a.length;f++){var g=a[f];g.ec||c.$e(g,g.wa);var h=B;h[0]=-b;h[1]=-d;h[2]=0;w.translate(g.sa,h,g.sa);w.rotateZ(g.sa,e,g.sa);w.multiply(g.sa,g.ma,g.Ed);c.np(g);c.Cl(g)}};a.get_fov=function(a){return h.Bk(a.d.G[0].sc)};
a.set_fov=function(a,b){for(var d=a.d.G,e=0;e<d.length;e++){var f=d[e];f.sc=h.Xw(b);f.ec||c.$e(f,f.wa);w.multiply(f.sa,f.ma,f.Ed);c.np(f);c.Cl(f)}};a.correct_up=function(a,b){b||(b=h.AXIS_Y);k.correct_up(a,b)};a.zoom_object=function(a,b){if(c.is_target_camera(a)){q.get_object_center(b,!1,B);d(a,B);q.u(a);var e=q.get_object_size(b),h=c.Qx(a)/2,e=e/Math.sin(h),h=q.qz(a,B);q.move_local(a,0,e-h,0);q.u(a);f.sync_transform(a)}else g.error("zoom_object(): wrong object")};a.set_ortho_scale=function(b,d){if(c.is_camera(b)&&
a.is_ortho_camera(b)){var e=b.d;if(c.is_target_camera(b)){var f=m.dist(e.h,e.Lb);e.ah=d/2*e.$g/f}else c.is_hover_camera(b)&&a.has_distance_limits(b)?(f=m.distance(e.h,e.Sb),e.ah=d/2*e.$g/f):b.d.G[0].top=d/2;c.GB(b)}else g.error("set_ortho_scale(): wrong object")};a.get_ortho_scale=function(b){if(c.is_camera(b)&&a.is_ortho_camera(b))return 2*b.d.G[0].top;g.error("get_ortho_scale(): wrong object")};a.is_ortho_camera=function(a){if(c.is_camera(a))return a.d.G[0].type==c.Hc;g.error("is_ortho_camera(): wrong object")};
a.calc_ray=function(a,b,d,f){f||(f=new Float32Array(3));var h=a.d.G[0];switch(h.type){case c.Hb:case c.Jd:case c.ub:case c.Bb:var k=Math.tan(h.sc*Math.PI/360),n=k*h.wa;b=e.El(b,d,x,h);r[0]=(2*b[0]/h.width-1)*n;r[1]=-1;r[2]=(2*b[1]/h.height-1)*k;r[3]=0;u.transformMat4(r,a.d.T,r);f[0]=r[0];f[1]=r[1];f[2]=r[2];m.normalize(f,f);return f;default:return g.error("Non-compatible camera"),f}};a.project_point=function(a,b,d){d||(d=new Float32Array(2));return c.project_point(a,b,d)}};b4w.module.config=function(a,p){var b=p("__config");a.P_LOW=b.P_LOW;a.P_HIGH=b.P_HIGH;a.P_ULTRA=b.P_ULTRA;a.P_CUSTOM=b.P_CUSTOM;a.set=b.set;a.get=b.get;a.reset=b.reset;a.get_std_assets_path=b.get_std_assets_path};b4w.module.controls=function(a,p){var b=p("__controls"),d=p("__print");a.CT_CONTINUOUS=b.CT_CONTINUOUS;a.CT_TRIGGER=b.CT_TRIGGER;a.CT_SHOT=b.CT_SHOT;a.CT_LEVEL=b.CT_LEVEL;a.KEY_BACKSPACE=8;a.KEY_TAB=9;a.KEY_ENTER=13;a.KEY_SHIFT=16;a.KEY_CTRL=17;a.KEY_ALT=18;a.KEY_PAUSE=19;a.KEY_CAPSLOCK=20;a.KEY_ESC=27;a.KEY_SPACE=32;a.KEY_LEFT=37;a.KEY_UP=38;a.KEY_RIGHT=39;a.KEY_DOWN=40;a.KEY_1=49;a.KEY_2=50;a.KEY_3=51;a.KEY_4=52;a.KEY_5=53;a.KEY_6=54;a.KEY_7=55;a.KEY_8=56;a.KEY_9=57;a.KEY_A=65;a.KEY_B=66;a.KEY_C=
67;a.KEY_D=68;a.KEY_E=69;a.KEY_F=70;a.KEY_G=71;a.KEY_H=72;a.KEY_I=73;a.KEY_J=74;a.KEY_K=75;a.KEY_L=76;a.KEY_M=77;a.KEY_N=78;a.KEY_O=79;a.KEY_P=80;a.KEY_Q=81;a.KEY_R=82;a.KEY_S=83;a.KEY_T=84;a.KEY_U=85;a.KEY_V=86;a.KEY_W=87;a.KEY_X=88;a.KEY_Y=89;a.KEY_Z=90;a.KEY_NUM0=96;a.KEY_NUM1=97;a.KEY_NUM2=98;a.KEY_NUM3=99;a.KEY_NUM4=100;a.KEY_NUM5=101;a.KEY_NUM6=102;a.KEY_NUM7=103;a.KEY_NUM8=104;a.KEY_NUM9=105;a.KEY_DEC_POINT=110;a.KEY_SEMI_COLON=186;a.KEY_EQUAL_SIGN=187;a.KEY_COMMA=188;a.KEY_DASH=189;a.KEY_PERIOD=
190;a.KEY_FORWARD_SLASH=191;a.KEY_GRAVE_ACCENT=192;a.KEY_LEFT_SQ_BRACKET=219;a.KEY_BACK_SLASH=220;a.KEY_RIGHT_SQ_BRACKET=221;a.KEY_SINGLE_QUOTE=222;a.PL_SINGLE_TOUCH_MOVE=b.PL_SINGLE_TOUCH_MOVE;a.PL_MULTITOUCH_MOVE_ZOOM=b.PL_MULTITOUCH_MOVE_ZOOM;a.PL_MULTITOUCH_MOVE_PAN=b.PL_MULTITOUCH_MOVE_PAN;a.create_custom_sensor=b.create_custom_sensor;a.create_keyboard_sensor=b.create_keyboard_sensor;a.create_collision_sensor=function(a,d,f){return b.create_collision_sensor(a,d||"ANY",f||!1)};a.create_collision_impulse_sensor=
b.create_collision_impulse_sensor;a.create_ray_sensor=function(a,d,f,g,k,q,h){return b.create_ray_sensor(a,d,f,g||"ANY",k||!1,q||!1,h||!1)};a.create_mouse_click_sensor=b.create_mouse_click_sensor;a.create_mouse_wheel_sensor=b.create_mouse_wheel_sensor;a.create_mouse_move_sensor=b.create_mouse_move_sensor;a.create_touch_move_sensor=b.create_touch_move_sensor;a.create_touch_zoom_sensor=b.create_touch_zoom_sensor;a.create_motion_sensor=b.create_motion_sensor;a.create_vertical_velocity_sensor=b.create_vertical_velocity_sensor;
a.create_gyro_angles_sensor=b.create_gyro_angles_sensor;a.create_gyro_delta_sensor=b.create_gyro_delta_sensor;a.create_timer_sensor=function(a,d){return b.create_timer_sensor(a,d||!1)};a.reset_timer_sensor=b.reset_timer_sensor;a.create_elapsed_sensor=b.create_elapsed_sensor;a.create_timeline_sensor=b.create_timeline_sensor;a.create_selection_sensor=function(a,d){return b.create_selection_sensor(a,d||!1)};a.set_custom_sensor=function(a,d){b.eA(a,d)};a.get_custom_sensor=function(a){return a.value};
a.get_sensor_value=b.get_sensor_value;a.get_sensor_payload=b.get_sensor_payload;a.create_sensor_manifold=function(a,d,f,g,k,q,h){k=k||b.Np;b.create_sensor_manifold(a,d,f,g,k,q,void 0===h?null:h)};a.create_kb_sensor_manifold=function(a,d,f,g,k,q){g=b.create_keyboard_sensor(g);b.create_sensor_manifold(a,d,f,[g],b.Np,k,void 0===q?null:q)};a.check_sensor_manifolds=function(a){return b.check_sensor_manifold(a,null)};a.check_sensor_manifold=b.check_sensor_manifold;a.remove_sensor_manifolds=function(a){d.error("remove_sensor_manifolds() deprecated, use remove_sensor_manifold() instead");
b.remove_sensor_manifold(a,null)};a.remove_sensor_manifold=b.remove_sensor_manifold;a.reset=b.reset;a.register_keyboard_events=b.register_keyboard_events;a.register_mouse_events=function(a,d,f){b.register_mouse_events(a,d,!!f)};a.register_wheel_events=b.register_wheel_events;a.register_touch_events=b.register_touch_events;a.register_device_orientation=b.register_device_orientation;a.unregister_keyboard_events=b.unregister_keyboard_events;a.unregister_mouse_events=b.unregister_mouse_events;a.unregister_wheel_events=
b.unregister_wheel_events;a.unregister_touch_events=b.unregister_touch_events;a.unregister_device_orientation=b.unregister_device_orientation};b4w.module.constraints=function(a,p){var b=p("__camera"),d=p("__constraints"),c=p("__physics"),e=p("__print"),f=p("__transform");a.append_stiff=function(a,b,e,h,m){m=m||1;b instanceof Array&&2==b.length?d.So(a,b[0],b[1],e,h,m):d.To(a,b,e,h,m);f.u(a);c.sync_transform(a)};a.append_semi_stiff=function(a,b,e,h){d.bv(a,b,e,h);f.u(a);c.sync_transform(a)};a.append_semi_stiff_cam=function(a,k,q,h,m,p,n,w){if(!b.is_eye_camera(a))return e.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented."),
null;d.av(a,k,q,h,m,p,n,w);f.u(a);c.sync_transform(a)};a.append_semi_soft_cam=function(a,k,q,h){if(!b.is_eye_camera(a))return e.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented."),null;if(!h||0>h)h=.25;d.$u(a,k,q,h);f.u(a);c.sync_transform(a)};a.append_stiff_trans=function(a,b,e){d.cv(a,b,e);f.u(a);c.sync_transform(a)};a.append_copy_trans=function(a,b,e){d.Wu(a,b,e);f.u(a);c.sync_transform(a)};a.append_stiff_trans_rot=function(a,b,e,h){d.dv(a,b,e,h);f.u(a);
c.sync_transform(a)};a.append_track=function(a,b){3==b.length?d.gv(a,b):d.fv(a,b);f.u(a);c.sync_transform(a)};a.append_follow=function(a,b,e,h){3==b.length?d.Yu(a,b,e,h):d.Xu(a,b,e,h);f.u(a);c.sync_transform(a)};a.append_stiff_viewport=function(a,b,e){d.append_stiff_viewport(a,b,e);f.u(a);c.sync_transform(a)};a.remove=function(a){a.Wa&&d.remove(a)};a.get_parent=d.get_parent};b4w.module.container=function(a,p){var b=p("__container"),d=p("__print");a.get_canvas=b.get_canvas;a.get_container=b.get_container;a.insert_to_container=function(a,e){2!=arguments.length?d.error("insert_to_container(): two arguments required"):a&&e&&b.insert_to_container(a,e)};a.set_canvas_offsets=b.set_canvas_offsets;a.update_canvas_offsets=b.update_canvas_offsets;a.client_to_canvas_coords=b.client_to_canvas_coords;a.force_offsets_updating=b.force_offsets_updating};b4w.module.data=function(a,p){var b=p("__data");p("__print");p("__util");a.load=b.load;a.unload=function(a){b.unload(a|0)};a.set_debug_resources_root=b.set_debug_resources_root;a.is_primary_loaded=b.is_primary_loaded;a.load_and_add_new=b.load;a.cleanup=a.unload};b4w.module.debug=function(a,p){p("__batch");p("__config");var b=p("__controls"),d=p("__debug"),c=p("__physics"),e=p("__print"),f=p("__scenegraph"),g=p("__scenes"),k=p("__shaders"),q=p("__sfx"),h=p("__textures"),m=p("__util"),u=p("vec3");a.physics_stats=function(){c.Tw()};a.physics_id=function(a){e.log("O",c.tx(a));for(var b=c.Px().m.p,d=0;d<b.length;d++){var f=b[d];f.Sa.S==a&&e.log("B",f)}};a.visible_objects=function(){for(var a=g.get_active(),b=g.Ia(a,"MESH",g.DATA_ID_ALL),a=g.ca(a,"MAIN_OPAQUE").p,
c=0;c<b.length;c++){var d=b[c],f=d.d;if("DYNAMIC"==f.type)for(var h=0;h<a.length;h++){var k=a[h];if(k.Xa&&k.td==f){e.log(d.name,d);break}}}};a.object_info=function(a){for(var b=g.get_active(),c=g.Ia(b,"MESH",g.DATA_ID_ALL),d=0;d<c.length;d++){var f=c[d];if(f.name==a){e.log("Object",f);for(var h=g.xm(b),k=0;k<h.length;k++){for(var m=h[k],q=m.p,p=[],l=0;l<q.length;l++)q[l].td==f.d&&p.push(q[l]);e.log("Subscene "+m.type,p)}}}};a.objects_stat=function(){var a=g.get_active();console.log("Armatures: "+
g.Ia(a,"ARMATURE",g.DATA_ID_ALL).length);console.log("Cameras: "+g.Ia(a,"CAMERA",g.DATA_ID_ALL).length);console.log("Curves: "+g.Ia(a,"CURVE",g.DATA_ID_ALL).length);console.log("Empties: "+g.Ia(a,"EMPTY",g.DATA_ID_ALL).length);console.log("Lamps: "+g.Ia(a,"LAMP",g.DATA_ID_ALL).length);console.log("Meshes: "+g.Ia(a,"MESH",g.DATA_ID_ALL).length);console.log("Speakers: "+g.Ia(a,"SPEAKER",g.DATA_ID_ALL).length)};a.num_vertices=function(){for(var a=0,b=g.get_active(),b=[g.ca(b,"MAIN_OPAQUE"),g.ca(b,"MAIN_BLEND")],
c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.p,e=0;e<d.length;e++){var f=d[e].B;f&&(a+=f.num_vertices)}}return a};a.num_triangles=function(){for(var a=0,b=g.get_active(),b=[g.ca(b,"MAIN_OPAQUE"),g.ca(b,"MAIN_BLEND")],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.p,e=0;e<d.length;e++){var f=d[e].B;f&&(a+=f.num_triangles)}}return a};a.num_draw_calls=function(){var a=g.get_active(),a=[g.ca(a,"MAIN_OPAQUE"),g.ca(a,"MAIN_BLEND")];return a[0].p.length+a[1].p.length};a.num_shaders=function(){return m.qd(k.pq())};
a.geometry_stats=function(){for(var a=g.get_active(),b=g.xm(a),a={},c=0;c<b.length;c++){var d=b[c];if("SINK"!=d.type&&"WIREFRAME"!=d.type)for(var e=d.p,f=0;f<e.length;f++){var h=e[f].B,k=e[f].td;h&&("COLOR_PICKING"!=d.type&&"OUTLINE_MASK"!=d.type||k.ok||k.nk)&&(a[h.id]=h)}}var e=d=c=b=0,m;for(m in a)h=a[m],h=h.R,h.Lj&&(d++,e+=h.Lj/1048576),b++,c+=h.Mp/1048576;return{vbo_number:b,vbo_memory:c,ibo_number:d,ibo_memory:e}};a.num_textures=function(){for(var a=[],b=0,c=g.get_active(),c=[g.ca(c,"MAIN_OPAQUE"),
g.ca(c,"MAIN_BLEND")],d=0;d<c.length;d++){var e=c[d];if(e)for(var e=e.p,f=0;f<e.length;f++){var h=e[f].B;if(h)for(var h=h.L,k=0;k<h.length;k++){var m=h[k];if("IMAGE"===m.source||"ENVIRONMENT_MAP"===m.source){var q=m.Va;-1===a.indexOf(q)&&(a.push(q),m=m.width*m.height*4/1048576/m.Ol,m*=1.3333,b+=m)}}}}return{number:a.length,memory:b}};a.num_render_targets=function(){for(var a=[],b=0,c=g.get_active(),c=g.xm(c),d=0;d<c.length;d++){var e=c[d];if("SINK"!=e.type){var f=e.i,k=[f.eb,f.Lc];k.push.apply(k,
e.Bd);for(e=0;e<k.length;e++){var m=k[e];h.xi(m)&&-1==a.indexOf(m)&&(a.push(m),b+=f.width*f.height*h.ny(m))}}}return{number:a.length,memory:b/1024/1024}};a.make_camera_frustum_shot=function(){var a=g.get_active();(a=g.ca(a,"MAIN_OPAQUE"))&&g.kr(a.i,a,[1,1,0])};a.make_light_frustum_shot=function(){var a=g.get_active(),b=g.ca(a,"MAIN_OPAQUE"),a=g.cB(a,["SHADOW_CAST"]);if(b)for(var c=0;c<a.length;c++){var d=a[c],e;switch(c){case 0:e=[1,0,0];break;case 1:e=[0,1,0];break;case 2:e=[0,0,1];break;default:e=
[1,0,1]}g.kr(d.i,b,e)}};a.scenegraph_to_dot=function(){for(var a=g.ri(),b=0;b<a.length;b++)e.log("\n"+f.Qw(g.zm(a[b])))};a.scenes_to_dot=function(){};a.controls_info=b.debug;a.object_distance=function(a,b){return u.dist(a.d.h,b.d.h)};a.msg=d.msg;a.fbmsg=d.fbmsg;a.print_telemetry=d.print_telemetry;a.plot_telemetry=d.plot_telemetry;a.fbres=function(a,b){function c(){d.fbmsg("FBRES",a());setTimeout(c,b)}b||(b=16);c()};a.assert_constants=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,
1]),c=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),e=new Float32Array([0,0,1]),f=new Float32Array([-1,0,0]),g=new Float32Array([0,-1,0]),h=new Float32Array([0,0,-1]);if(!m.De(a,m.Ju))throw"Wrong VEC3_IDENT";if(!m.De(b,m.Du))throw"Wrong QUAT4_IDENT";if(!m.De(c,m.AXIS_X))throw"Wrong AXIS_X";if(!m.De(d,m.AXIS_Y))throw"Wrong AXIS_Y";if(!m.De(e,m.AXIS_Z))throw"Wrong AXIS_Z";if(!m.De(f,m.AXIS_MX))throw"Wrong AXIS_MX";if(!m.De(g,m.AXIS_MY))throw"Wrong AXIS_MY";if(!m.De(h,m.AXIS_MZ))throw"Wrong AXIS_MZ";
};a.mute_music=function(){for(var a=q.get_speaker_objects(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==q.Bm(c)&&q.mute(c,!0)}};a.check_finite=function(a){d.check_finite(a)};a.set_debug_params=function(a){var b=g.get_active();if(b=g.ca(b,"WIREFRAME"))"string"==typeof a.wireframe_mode&&g.xA(b,a.wireframe_mode),"object"==typeof a.wireframe_edge_color&&g.wA(b,a.wireframe_edge_color);else throw"Wireframe subscene not found.";};a.get_error_quantity=function(){return e.by()};a.get_warning_quantity=
function(){return e.sy()};a.clear_errors_warnings=function(){return e.clear_errors_warnings()}};b4w.module.geometry=function(a,p){var b=p("__batch"),d=p("__geometry"),c=p("__print"),e=p("__renderer");a.extract_vertex_array=function(a,e,k){if(!d.si(a))return c.error("Wrong object:",a.name),null;if(a=b.ba(a,e,"MAIN")||b.ba(a,e,"NODES")){if((e=a.R)&&e.Ub&&e.Ub[k])return d.nx(e,k);c.error("Attribute not found:"+k);return null}c.error("Wrong material:",e);return null};a.extract_index_array=function(a,e){if(!d.si(a))return c.error("Wrong object:",a.name),null;var k=b.ba(a,e,"MAIN")||b.ba(a,e,"NODES");
if(k){if((k=k.R)&&k.Ub)return k.Oe;c.error("Buffer data not found");return null}c.error("Wrong material:",e);return null};a.update_vertex_array=function(a,e,k,q){var h=["MAIN","NODES","DEPTH","COLOR_ID"];if(d.si(a))for(var m=0;m<h.length;m++){var p=b.ba(a,e,h[m]);p&&(p=p.R)&&p.Ub&&p.Ub[k]&&d.Rk(p,k,0,q)}else c.error("Wrong object:",a.name)};a.override_geometry=function(a,g,k,q,h){var m=["MAIN","NODES","DEPTH","COLOR_ID"];if(d.si(a))if(k instanceof Uint16Array||k instanceof Uint32Array)if(q instanceof
Float32Array)for(var p=0;p<m.length;p++){var n=b.ba(a,g,m[p]);if(n){var w=n.R;if(w){d.xB(w,n.Zd,k);var x=0,B;for(B in w.Ub)var y=w.Ub[B],x=x+q.length/3*y.sd;w.ed=new Float32Array(x);var x=w.ed,r=0;for(B in w.Ub)switch(y=w.Ub[B],B){case "a_position":x.set(q,r);y.offset=r;y.length=q.length;r+=y.length;break;case "a_normal":var A;h&&(A=d.mp(k,q,q));var t=d.kp(k,q,A);x.set(t,r);y.offset=r;y.length=q.length;r+=y.length;break;case "a_tangent":y.offset=r;y.length=q.length/3*y.sd;for(var t=new Float32Array(y.length),
F=0;F<t.length;F+=4)t[F]=1,t[F+3]=1;x.set(t,r);r+=y.length;break;default:y.offset=r,y.length=q.length/3*y.sd,t=new Float32Array(y.length),x.set(t,r),r+=y.length}d.bt(w);e.Uo(n);(n=b.rc(a,n))&&n.R&&(n.R=w)}}}else c.error("Wrong positions_array type");else c.error("Wrong ibo_array type");else c.error("Wrong object:",a.name)};a.set_shape_key_value=function(a,b,e){if(!d.check_shape_keys(a))return c.error("Wrong object:",a.name),null;if(!d.Lq(a,b))return c.error("Wrong key name:",b),null;d.mv(a,b,parseFloat(e))};
a.check_shape_keys=function(a){return d.check_shape_keys(a)};a.get_shape_keys_names=function(a){return d.check_shape_keys(a)?d.get_shape_keys_names(a):(c.error("Wrong object:",a.name),null)};a.get_shape_key_value=function(a,b){return d.check_shape_keys(a)?d.Lq(a,b)?d.get_shape_key_value(a,b):(c.error("Wrong key name:",b),null):(c.error("Wrong object:",a.name),null)}};b4w.module.hud=function(a,p){var b=p("__hud");p("__print");a.draw_mixer_strip=b.draw_mixer_strip;a.plot_array=b.plot_array};b4w.module.lights=function(a,p){function b(a){for(var b=f.get_active(),d=f.Ia(b,"LAMP",f.DATA_ID_ALL),m=0;m<d.length;m++){var p=d[m];if("SUN"==p.na.type){var u=p;break}}if(!u)return c.error("There is no sun on the scene"),null;"number"==typeof a.hor_position&&"number"==typeof a.vert_position&&(d=(90-a.vert_position)/180*Math.PI,m=u.d,g.set_rotation_euler(u,[d,(180-a.hor_position)/180*Math.PI,0]),a=new Float32Array(3),k.quat_to_dir(m.quat,k.AXIS_Y,a),m=q.length(m.h),q.copy(a,h),q.scale(h,m,h),g.set_translation(u,
h),g.u(u),a=u.na,a.Tp&&(p=u.data.energy,m=b.world.light_settings.environment_energy,d=Math.cos(Math.abs(d)),p*=Math.max(Math.min(3*d,1),0),d=Math.max(d,.1)*m,e.ms(a,p),f.set_environment_colors(b,d,null,null)),f.ug(u,b))}function d(a){if(e.Rm(a))return a.na.type;c.error("get_light_type(): Wrong object");return!1}var c=p("__print"),e=p("__lights"),f=p("__scenes");p("__batch");var g=p("__transform"),k=p("__util"),q=p("vec3"),h=new Float32Array(3),m,u=60;a.get_lamps=function(a){var b=f.get_active(),b=
f.Ia(b,"LAMP",f.DATA_ID_ALL);if(!a)return b;for(var c=[],d=0;d<b.length;d++){var e=b[d];e.na.type===a&&c.push(e)}return c};a.get_sun_params=function(){for(var a=f.get_active(),a=f.Ia(a,"LAMP",f.DATA_ID_ALL),b=null,c=0;c<a.length;c++){var d=a[c];if("SUN"==d.na.type){b=d;break}}return b?(b=b.na.direction,a=180*Math.atan2(b[2],b[0])/Math.PI+90,180<a&&(a-=360),b=180*Math.atan2(b[1],Math.sqrt(b[0]*b[0]+b[2]*b[2]))/Math.PI,c={},c.hor_position=a,c.vert_position=b,c):null};a.set_sun_params=b;a.set_day_time=
function(a){for(var d=f.get_active(),d=f.Ia(d,"LAMP",f.DATA_ID_ALL),e=0;e<d.length;e++){var g=d[e];if("SUN"==g.na.type){var h=g;break}}if(!h)return c.error("There is no sun on the scene"),null;h=-Math.cos(a/12*Math.PI)*u;d={};d.hor_position=12>a?15*a:15*(a-24);d.vert_position=h;b(d)};a.set_date=function(a){(m=a.getDate())?1582==m&&10==a.nE&&4<a.Pw&&15>a.Pw&&c.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):c.error("There is no year 0 in the Julian system!")};a.set_max_sun_angle=
function(a){u=Math.min(Math.max(a,0),90)};a.get_light_params=function(a){if(e.Rm(a))var b=a.na;else return c.error("get_light_params(): Wrong object"),!1;if(a=d(a))switch(a){case "SPOT":var f={light_type:a,light_color:b.color,light_energy:b.Ie,light_spot_blend:b.sg,light_spot_size:b.dd,light_distance:b.distance};break;case "POINT":f={light_type:a,light_color:b.color,light_energy:b.Ie,light_distance:b.distance};break;default:f={light_type:a,light_color:b.color,light_energy:b.Ie}}return f?f:!1};a.get_light_type=
d;a.set_light_params=function(a,b){if(e.Rm(a))var d=a.na;else return c.error("set_light_params(): Wrong object"),!1;var g=f.get_active();"number"==typeof b.light_energy&&(e.ms(d,b.light_energy),f.ug(a,g));"object"==typeof b.light_color&&(e.lA(d,b.light_color),f.ug(a,g));"number"==typeof b.light_spot_blend&&(e.nA(d,b.light_spot_blend),f.ug(a,g));"number"==typeof b.light_spot_size&&(e.oA(d,b.light_spot_size),f.ug(a,g));"number"==typeof b.light_distance&&(e.mA(d,b.light_distance),f.ug(a,g));f.rB()}};b4w.module.material=function(a,p){function b(a,b){for(var c=a.n,d=0;d<c.length;d++){var e=c[d];if(-1<e.Pc.indexOf(b))return"MAIN"==e.type}return!1}function d(a,b){var c=e.ba(a,b,"MAIN");return Boolean(c&&c.ic[0])}function c(a,b){var c=e.ba(a,b,"MAIN");return Boolean(c&&c.ic[1])}var e=p("__batch"),f=p("__config"),g=p("__print"),k=p("__objects"),q=p("__shaders");p("__util");p("vec4");var h=f.o,m="u_colormap0 u_colormap1 u_stencil0 u_specmap u_normalmap0 u_mirrormap".split(" ");a.inherit_material=function(a,
b,c,d){if(k.ti(c)&&k.ti(a)){for(var f=["MAIN","DEPTH","COLOR_ID"],h=!1,q=0;q<f.length;q++){var p=f[q],t=e.ba(a,b,p),F=e.ba(c,d,p);if(t&&F){var h=!0,C=e.rc(c,d,p);"MAIN"==p&&(e.ns(F,t),C&&e.ns(C,t));for(p=0;p<F.Gb.length;p++){var l=F.Gb[p];if(-1!==m.indexOf(l)){var H=t.Gb.indexOf(l);-1!==H&&(F.L[p]=t.L[H],C&&(l=C.Gb.indexOf(l),-1!==l&&(C.L[l]=t.L[H])))}}}}h||g.error("Wrong objects for inheriting material!")}else g.error("Wrong or batched object(s)")};a.get_materials_names=function(a){var b=[];a=a.n;
for(var c=0;c<a.length;c++)for(var d=0;d<a[c].Pc.length;d++)-1==b.indexOf(a[c].Pc[d])&&b.push(a[c].Pc[d]);return b};a.set_diffuse_color=function(a,b,c){var d=e.ba(a,b,"MAIN");d?(d.Mc.set(c),(a=e.rc(a,b,"MAIN"))&&a.Mc.set(c)):g.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_color=function(a,b){var c=e.ba(a,b,"MAIN");if(c){var d=new Float32Array(4);d.set(c.Mc);return d}g.error('Couldn\'t get property "diffuse_color"!')};a.set_diffuse_intensity=function(a,b,c){var d=e.ba(a,b,"MAIN");
if(d){if(d.Ge=c,a=e.rc(a,b,"MAIN"))a.Ge=c}else g.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_intensity=function(a,b){var c=e.ba(a,b,"MAIN");if(c)return c.Ge;g.error('Couldn\'t get property "diffuse_intensity"!')};a.set_specular_color=function(a,b,c){var d=e.ba(a,b,"MAIN");d?(d.yd.set(c),(a=e.rc(a,b,"MAIN"))&&a.yd.set(c)):g.error('Couldn\'t set property "specular_color"!')};a.get_specular_color=function(a,b){var c=e.ba(a,b,"MAIN");if(c){var d=Array(3);d[0]=c.yd[0];d[1]=c.yd[1];
d[2]=c.yd[2];return d}g.error('Couldn\'t get property "specular_color"!')};a.set_specular_intensity=function(a,b,c){d(a,b)||g.error('Property "specular_intensity" is missing!');e.ba(a,b,"MAIN").ic[0]=c;(a=e.rc(a,b,"MAIN"))&&(a.ic[0]=c)};a.get_specular_intensity=function(a,b){d(a,b)||g.error('Property "specular_intensity" is missing!');return e.ba(a,b,"MAIN").ic[0]};a.check_specular_intensity=d;a.set_specular_hardness=function(a,b,d){c(a,b)||g.error('Property "specular_hardness" is missing!');e.ba(a,
b,"MAIN").ic[1]=d;(a=e.rc(a,b,"MAIN"))&&(a.ic[1]=d)};a.get_specular_hardness=function(a,b){c(a,b)||g.error('Property "specular_hardness" is missing!');return e.ba(a,b,"MAIN").ic[1]};a.check_specular_hardness=c;a.set_emit_factor=function(a,b,c){var d=e.ba(a,b,"MAIN");if(d){if(d.$d=c,a=e.rc(a,b,"MAIN"))a.$d=c}else g.error('Couldn\'t set property "emit_factor"!')};a.get_emit_factor=function(a,b){var c=e.ba(a,b,"MAIN");if(c)return c.$d;g.error('Couldn\'t get property "emit_factor"!')};a.set_ambient_factor=
function(a,b,c){var d=e.ba(a,b,"MAIN");if(d){if(d.Md=c,a=e.rc(a,b,"MAIN"))a.Md=c}else g.error('Couldn\'t set property "ambient_factor"!')};a.get_ambient_factor=function(a,b){var c=e.ba(a,b,"MAIN");if(c)return c.Md;g.error('Couldn\'t get property "ambient_factor"!')};a.set_diffuse_color_factor=function(a,b,c){var d=e.ba(a,b,"MAIN");if(d){if(d.Fe=c,a=e.rc(a,b,"MAIN"))a.Fe=c}else g.error('Couldn\'t set property "diffuse_color_factor"!')};a.get_diffuse_color_factor=function(a,b){var c=e.ba(a,b,"MAIN");
if(c)return c.Fe;g.error('Couldn\'t get property "diffuse_color_factor"!')};a.set_alpha_factor=function(a,b,c){var d=e.ba(a,b,"MAIN");if(d){if(d.ze=c,a=e.rc(a,b,"MAIN"))a.ze=c}else g.error('Couldn\'t set property "alpha_factor"!')};a.get_alpha_factor=function(a,b){var c=e.ba(a,b,"MAIN");if(c)return c.ze;g.error('Couldn\'t get property "alpha_factor"!')};a.get_material_extended_params=function(a,c){if(!a||!c)return g.error("missing arguments in get_material_params"),null;if(!b(a,c))return null;var d=
e.ba(a,c,"MAIN");if(!d)return null;var f={};"MAIN"==d.type&&(f.og=d.og,f.yD=d.Yc[2],f.zD=5*(1-d.Yc[3]),f.kg=d.kg,f.uE=e.wb(d,"PARALLAX_STEPS")[1]);return f};a.get_water_material_params=function(a,c){if(!a||!c)return g.error("missing arguments in get_water_material_params"),null;if(!b(a,c))return null;var d=e.ba(a,c,"MAIN");if(!d||!d.of)return null;if(!d)return g.error("material not found"),null;var f={};if("MAIN"==d.type){if(h.sh){var k=f.shallow_water_col=Array(3);k[0]=d.shallow_water_col[0];k[1]=
d.shallow_water_col[1];k[2]=d.shallow_water_col[2];k=f.shore_water_col=Array(3);k[0]=d.shore_water_col[0];k[1]=d.shore_water_col[1];k[2]=d.shore_water_col[2];f.shallow_water_col_fac=d.shallow_water_col_fac;f.shore_water_col_fac=d.shore_water_col_fac}f.foam_factor=d.foam_factor;f.norm_uv_velocity=d.Oh;f.absorb_factor=e.wb(d,"ABSORB")[1];f.sss_strength=e.wb(d,"SSS_STRENGTH")[1];f.sss_width=e.wb(d,"SSS_WIDTH")[1];f.dst_noise_scale0=e.wb(d,"DST_NOISE_SCALE_0")[1];f.dst_noise_scale1=e.wb(d,"DST_NOISE_SCALE_1")[1];
f.dst_noise_freq0=e.wb(d,"DST_NOISE_FREQ_0")[1];f.dst_noise_freq1=e.wb(d,"DST_NOISE_FREQ_1")[1];f.dir_min_shore_fac=e.wb(d,"DIR_MIN_SHR_FAC")[1];f.dir_freq=e.wb(d,"DIR_FREQ")[1];f.dir_noise_scale=e.wb(d,"DIR_NOISE_SCALE")[1];f.dir_noise_freq=e.wb(d,"DIR_NOISE_FREQ")[1];f.dir_min_noise_fac=e.wb(d,"DIR_MIN_NOISE_FAC")[1];f.dst_min_fac=e.wb(d,"DST_MIN_FAC")[1];f.waves_hor_fac=e.wb(d,"WAVES_HOR_FAC")[1]}return f};a.set_material_extended_params=function(a,c,d){if(a&&c&&d){if(!b(a,c))return g.error("setting material params is not possible"),
null;var f=e.ba(a,c,"MAIN");if(f){var h=[f];(f=e.rc(a,c,"MAIN"))&&h.push(f);for(a=0;a<h.length;a++)f=h[a],"number"==typeof d.material_reflectivity&&(f.og=d.material_reflectivity),"number"==typeof d.material_fresnel&&(f.Yc[2]=d.material_fresnel),"number"==typeof d.material_fresnel_factor&&(f.Yc[3]=1-d.material_fresnel_factor/5),"number"==typeof d.material_parallax_scale&&(f.kg=d.material_parallax_scale),"number"==typeof d.material_parallax_steps&&(c=q.t(parseFloat(d.material_parallax_steps)),e.ja(f,
"PARALLAX_STEPS",c),e.rb(f,!0))}else g.error("material not found")}else g.error("missing arguments in set_material_params")};a.set_water_material_params=function(a,c,d){if(!a||!c||!d)return g.error("missing arguments in set_water_material_params"),null;if(!b(a,c))return g.error("setting water material params is not possible"),null;var f=e.ba(a,c,"MAIN");if(!f)return g.error("material not found"),null;var k=[f];(f=e.rc(a,c,"MAIN"))&&k.push(f);for(a=0;a<k.length;a++)f=k[a],h.sh&&("object"==typeof d.shallow_water_col&&
f.shallow_water_col.set(d.shallow_water_col),"number"==typeof d.shallow_water_col_fac&&(f.shallow_water_col_fac=d.shallow_water_col_fac),"object"==typeof d.shore_water_col&&f.shore_water_col.set(d.shore_water_col),"number"==typeof d.shore_water_col_fac&&(f.shore_water_col_fac=d.shore_water_col_fac)),h.shore_smoothing&&f.so&&("boolean"==typeof d.shore_smoothing&&(d.shore_smoothing?e.ja(f,"SHORE_SMOOTHING",1):e.ja(f,"SHORE_SMOOTHING",0)),"number"==typeof d.absorb_factor&&(c=q.t(parseFloat(d.absorb_factor)),
e.ja(f,"ABSORB",c))),"number"==typeof d.foam_factor&&h.Tg&&(f.foam_factor=d.foam_factor),"number"==typeof d.norm_uv_velocity&&(f.Oh=d.norm_uv_velocity),h.water_dynamic&&f.water_dynamic&&("boolean"==typeof d.water_dynamic&&(d.water_dynamic?e.ja(f,"DYNAMIC",1):e.ja(f,"DYNAMIC",0)),"number"==typeof d.waves_height&&(c=q.t(parseFloat(d.waves_height)),e.ja(f,"WAVES_HEIGHT",c)),"number"==typeof d.waves_length&&(c=q.t(parseFloat(d.waves_length)),e.ja(f,"WAVES_LENGTH",c)),"number"==typeof d.sss_strength&&
(c=q.t(parseFloat(d.sss_strength)),e.ja(f,"SSS_STRENGTH",c)),"number"==typeof d.sss_width&&(c=q.t(parseFloat(d.sss_width)),e.ja(f,"SSS_WIDTH",c)),"number"==typeof d.dst_noise_scale0&&(c=q.t(parseFloat(d.dst_noise_scale0)),e.ja(f,"DST_NOISE_SCALE_0",c)),"number"==typeof d.dst_noise_scale1&&(c=q.t(parseFloat(d.dst_noise_scale1)),e.ja(f,"DST_NOISE_SCALE_1",c)),"number"==typeof d.dst_noise_freq0&&(c=q.t(parseFloat(d.dst_noise_freq0)),e.ja(f,"DST_NOISE_FREQ_0",c)),"number"==typeof d.dst_noise_freq1&&(c=
q.t(parseFloat(d.dst_noise_freq1)),e.ja(f,"DST_NOISE_FREQ_1",c)),"number"==typeof d.dir_min_shore_fac&&(c=q.t(parseFloat(d.dir_min_shore_fac)),e.ja(f,"DIR_MIN_SHR_FAC",c)),"number"==typeof d.dir_freq&&(c=q.t(parseFloat(d.dir_freq)),e.ja(f,"DIR_FREQ",c)),"number"==typeof d.dir_noise_scale&&(c=q.t(parseFloat(d.dir_noise_scale)),e.ja(f,"DIR_NOISE_SCALE",c)),"number"==typeof d.dir_noise_freq&&(c=q.t(parseFloat(d.dir_noise_freq)),e.ja(f,"DIR_NOISE_FREQ",c)),"number"==typeof d.dir_min_noise_fac&&(c=q.t(parseFloat(d.dir_min_noise_fac)),
e.ja(f,"DIR_MIN_NOISE_FAC",c)),"number"==typeof d.dst_min_fac&&(c=q.t(parseFloat(d.dst_min_fac)),e.ja(f,"DST_MIN_FAC",c)),"number"==typeof d.waves_hor_fac&&(c=q.t(parseFloat(d.waves_hor_fac)),e.ja(f,"WAVES_HOR_FAC",c))),e.rb(f,!0);return!0}};b4w.module.particles=function(a,p){var b=p("__particles"),d=p("__print");a.set_size=function(a,e,f){b.Yg(a)?b.set_size(a,e,f):d.error('"',a.name,'" has no particle systems')};a.set_normal_factor=function(a,e,f){b.Yg(a)?b.set_normal_factor(a,e,f):d.error('"',a.name,'" has no particle systems')};a.set_factor=function(a,e,f){b.Yg(a)?(f=Math.min(f,1),f=Math.max(f,0),b.set_factor(a,e,f)):d.error('"',a.name,'" has no particle systems')}};b4w.module.physics=function(a,p){var b=p("__physics"),d=p("__print"),c=p("__util");a.CM_WALK=0;a.CM_RUN=1;a.CM_CLIMB=2;a.CM_FLY=3;a.enable_simulation=function(a){b.has_physics(a)?b.enable_simulation(a):d.error("No physics for object "+a.name)};a.disable_simulation=function(a){b.has_physics(a)?b.disable_simulation(a):d.error("No physics for object "+a.name)};a.has_physics=function(a){return b.has_physics(a)};a.has_simulated_physics=function(a){return b.has_simulated_physics(a)};a.has_dynamic_physics=
function(a){return b.has_dynamic_physics(a)};a.set_gravity=function(a,c){b.has_physics(a)?b.set_gravity(a,c):d.error("No physics for object "+a.name)};a.set_damping=function(a,c,g){b.has_physics(a)?b.C("set_damping",a.m.S,c,g):d.error("No physics for object "+a.name)};a.reset_damping=function(a){if(b.has_physics(a)){var c=a.game;b.C("set_damping",a.m.S,c.damping,c.rotation_damping)}else d.error("No physics for object "+a.name)};a.set_transform=function(a,c,g){b.has_physics(a)?b.set_transform.apply(this,
arguments):d.error("No physics for object "+a.name)};a.sync_transform=function(a){b.has_physics(a)?b.sync_transform(a):d.error("No physics for object "+a.name)};a.apply_velocity=function(a){b.has_physics(a)?b.apply_velocity.apply(this,arguments):d.error("No physics for object "+a.name)};a.apply_velocity_world=function(a){b.has_physics(a)?b.apply_velocity_world.apply(this,arguments):d.error("No physics for object "+a.name)};a.apply_force=function(a,c,g,k){b.has_physics(a)?b.apply_force.apply(this,
arguments):d.error("No physics for object "+a.name)};a.apply_torque=function(a,c,g,k){b.has_physics(a)?b.apply_torque.apply(this,arguments):d.error("No physics for object "+a.name)};a.vehicle_throttle=function(a,f){b.has_physics(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||d.error("Wrong object"),b.vehicle_throttle(a,c.clamp(f,-1,1))):d.error("No physics for object "+a.name)};a.vehicle_throttle_inc=function(a,f,g){if(b.has_physics(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||d.error("Wrong object");
f=c.clamp(f,0,1);var k=a.k.Sg;-1==g||1==g?k=Math.max(-1,Math.min(k+g*f,1)):0==g&&0<=k?(k-=f,k=Math.max(0,k)):0==g&&0>k?(k+=f,k=Math.min(0,k)):d.error("Wrong steering direction");b.vehicle_throttle(a,c.clamp(k,-1,1))}else d.error("No physics for object "+a.name)};a.vehicle_steer=function(a,f){b.has_physics(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||d.error("Wrong object"),b.vehicle_steer(a,c.clamp(f,-1,1))):d.error("No physics for object "+a.name)};a.vehicle_steer_inc=function(a,f,g){if(b.has_physics(a)){b.is_vehicle_chassis(a)||
b.is_vehicle_hull(a)||d.error("Wrong object");f=c.clamp(f,0,1);var k=a.k.zh;-1==g||1==g?k=Math.max(-1,Math.min(k+g*f,1)):0==g&&0<=k?(k-=f,k=Math.max(0,k)):0==g&&0>k?(k+=f,k=Math.min(0,k)):d.error("Wrong steering direction");b.vehicle_steer(a,c.clamp(k,-1,1))}else d.error("No physics for object "+a.name)};a.vehicle_brake=function(a,f){b.has_physics(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||d.error("Wrong object"),b.vehicle_brake(a,c.clamp(f,0,1))):d.error("No physics for object "+a.name)};
a.vehicle_brake_inc=function(a,f){if(b.has_physics(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||d.error("Wrong object");f=c.clamp(f,-1,1);var g=a.k.Yh;b.vehicle_brake(a,c.clamp(g+g*f,0,1))}else d.error("No physics for object "+a.name)};a.is_vehicle_chassis=function(a){return b.is_vehicle_chassis(a)};a.is_vehicle_hull=function(a){return b.is_vehicle_hull(a)};a.get_vehicle_name=function(a){if(!b.has_physics(a))return d.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.b4w_vehicle_settings.name;
d.error("Wrong object");return null};a.get_vehicle_throttle=function(a){if(!b.has_physics(a))return d.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.k.Sg;d.error("Wrong object")};a.get_vehicle_steering=function(a){if(!b.has_physics(a))return d.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.k.zh;d.error("Wrong object")};a.get_vehicle_brake=function(a){if(!b.has_physics(a))return d.error("No physics for object "+
a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.k.Yh;d.error("Wrong object")};a.get_vehicle_speed=function(a){if(!b.has_physics(a))return d.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return b.get_vehicle_speed(a);d.error("Wrong object")};a.is_character=function(a){return b.is_character(a)};a.set_character_move_dir=function(a,c,g){b.has_physics(a)?b.set_character_move_dir(a,c,g):d.error("No physics for object "+a.name)};a.set_character_move_type=
function(a,c){b.has_physics(a)?b.set_character_move_type(a,c):d.error("No physics for object "+a.name)};a.set_character_walk_velocity=function(a,c){b.has_physics(a)?b.set_character_walk_velocity(a,c):d.error("No physics for object "+a.name)};a.set_character_run_velocity=function(a,c){b.has_physics(a)?b.set_character_run_velocity(a,c):d.error("No physics for object "+a.name)};a.set_character_fly_velocity=function(a,c){b.has_physics(a)?b.set_character_fly_velocity(a,c):d.error("No physics for object "+
a.name)};a.character_jump=function(a){b.has_physics(a)?b.character_jump(a):d.error("No physics for object "+a.name)};a.character_rotation_inc=function(a,c,g){b.has_physics(a)?b.character_rotation_inc(a,c,g):d.error("No physics for object "+a.name)};a.set_character_rotation_quat=function(a,c){b.has_physics(a)?b.set_character_rotation_quat(a,c):d.error("No physics for object "+a.name)};a.set_character_rotation=function(a,c,g){b.has_physics(a)?b.set_character_rotation(a,c,g):d.error("No physics for object "+
a.name)};a.set_character_rotation_v=function(a,c){b.has_physics(a)?b.set_character_rotation_v(a,c):d.error("No physics for object "+a.name)};a.set_character_rotation_h=function(a,c){b.has_physics(a)?b.set_character_rotation_h(a,c):d.error("No physics for object "+a.name)};a.append_collision_test=function(a,c,g,k){b.has_physics(a)?b.append_collision_test(a,c,g,k||!1):d.error("No physics for object "+a.name)};a.remove_collision_test=function(a,c){b.has_physics(a)?b.remove_collision_test(a,c):d.error("No physics for object "+
a.name)};a.apply_collision_impulse_test=function(a,c){b.has_physics(a)?b.apply_collision_impulse_test(a,c):d.error("No physics for object "+a.name)};a.clear_collision_impulse_test=function(a){b.has_physics(a)?b.clear_collision_impulse_test(a):d.error("No physics for object "+a.name)};a.append_ray_test=function(a,c,d,k,q,h){return b.append_ray_test(a,c,d,k,q,h||!1,!1,!1,!1)};a.append_ray_test_ext=function(a,c,d,k,q,h,m,p,n){return b.append_ray_test(a,c,d,k,q,h||!1,m||!1,p||!1,n||!1)};a.remove_ray_test=
function(a){b.Uq(a)?b.remove_ray_test(a):d.error("Wrong ray test ID")};a.change_ray_test_from_to=function(a,c,g){b.Uq(a)?b.change_ray_test_from_to(a,c,g):d.error("Wrong ray test ID")};a.apply_constraint=function(a,c,g,k,q,h,m,p,n,w){b.has_physics(c)&&b.has_physics(q)?b.apply_constraint(a,c,g,k,q,h,m,p,n,w):d.error("Wrong objects")};a.clear_constraint=function(a){b.has_physics(a)&&b.yy(a)?b.clear_constraint(a):d.error("Wrong object")};a.pull_to_constraint_pivot=function(a,c,g,k,q,h){b.has_physics(a)&&
b.has_physics(k)?b.pull_to_constraint_pivot(a,c,g,k,q,h):d.error("Wrong objects")}};b4w.module.rgb=function(a,p){p("__print");var b=p("__util"),d=new Float32Array(3);a.create=function(){return new Float32Array(3)};a.from_values=function(a,b,d){var g=new Float32Array(3);g[0]=a;g[1]=b;g[2]=d;return g};a.set=function(a,b,d,g){g[0]=a;g[1]=b;g[2]=d;return g};a.css_to_rgb=function(a,d,f,g){g=g||new Float32Array(3);g[0]=a/255;g[1]=d/255;g[2]=f/255;b.Hs(g,g);return g};a.rgb_to_css=function(a){a=b.$m(a,d);return[Math.round(255*a[0]),Math.round(255*a[1]),Math.round(255*a[2])]};a.rgb_to_css_hex=
function(a){function e(a){a=Math.round(255*a).toString(16);return 1==a.length?"0"+a:a}a=b.$m(a,d);return"#"+e(a[0])+e(a[1])+e(a[2])}};
b4w.module.rgba=function(a,p){p("__print");var b=p("__util"),d=new Float32Array(3);a.create=function(){var a=new Float32Array(4);a[3]=1;return a};a.from_values=function(a,b,d,g){var k=new Float32Array(4);k[0]=a;k[1]=b;k[2]=d;k[3]=g;return k};a.set=function(a,b,d,g,k){k[0]=a;k[1]=b;k[2]=d;k[3]=g;return k};a.css_to_rgba=function(a,d,f,g,k){k=k||new Float32Array(4);k[0]=a/255;k[1]=d/255;k[2]=f/255;k[3]=g;b.Hs(k,k);return k};a.rgba_to_css=function(a){var e=b.$m(a,d);return[Math.round(255*e[0]),Math.round(255*
e[1]),Math.round(255*e[2]),a[3]]}};b4w.module.scenes=function(a,p){var b=p("__batch"),d=p("__camera"),c=p("__graph"),e=p("__objects"),f=p("__print"),g=p("__physics"),k=p("__scenes"),q=p("__util");a.DATA_ID_ALL=k.DATA_ID_ALL;a.set_active=function(a){var b=k.ri();k.set_active(q.keysearch("name",a,b))};a.get_active=function(){return k.ga()?k.get_active().name:""};a.get_scenes=function(){for(var a=k.ri(),b=[],c=0;c<a.length;c++)b.push(a[c].name);return b};a.get_active_camera=function(){if(k.ga())return k.Rj(k.get_active());f.error("No active scene");
return!1};a.get_object_by_name=function(a,b){var c=k.rd(k.sf,a,b|0);if(c)return c;f.error("get object "+a+": not found")};a.get_object_by_dupli_name=function(a,b,c){if(a=k.rd(k.$k,a,b,c|0))return a;f.error("get object "+b+": not found")};a.get_object_by_dupli_name_list=function(a,b){var c=k.rd(k.al,a,b|0);if(c)return c;f.error("get object "+a+": not found")};a.get_object_data_id=function(a){return k.get_object_data_id(a)};a.pick_object=k.pick_object;a.outlining_is_enabled=function(a){return a&&a.d&&
a.d.Fb};a.set_outline_intensity=function(a,b){a&&a.d&&a.d.Fb?a.d.$c=b:f.error("set_outline_intensity(): wrong object")};a.get_outline_intensity=function(a){if(a&&a.d&&a.d.Fb)return a.d.$c;f.error("get_outline_intensity(): wrong object")};a.apply_outline_anim=function(a,b,c,d){a&&a.d&&a.d.Fb?k.apply_outline_anim(a,b,c,d):f.error("apply_outline_anim(): wrong object")};a.apply_outline_anim_def=function(a){if(a&&a.d&&a.d.Fb){var b=a.d.Ei;k.apply_outline_anim(a,b.pk,b.qk,b.rk)}else f.error("apply_outline_anim_def(): wrong object")};
a.clear_outline_anim=function(a){a&&a.d&&a.d.Fb?k.clear_outline_anim(a):f.error("clear_outline_anim(): wrong object")};a.set_outline_color=k.set_outline_color;a.get_outline_color=function(a){var b=k.get_active();if(b=k.ca(b,"OUTLINE"))return a=a||new Float32Array(3),a.set(b.Ue),a};a.set_glow_intensity=function(b,c){f.error("set_glow_intensity() deprecated, use set_outline_intensity() instead");a.set_outline_intensity(b,c)};a.get_glow_intensity=function(b){f.error("get_glow_intensity() deprecated, use get_outline_intensity() instead");
a.get_outline_intensity(b)};a.apply_glow_anim=function(b,c,d,e){f.error("apply_glow_anim() deprecated, use apply_outline_anim() instead");a.apply_outline_anim(b,c,d,e)};a.apply_glow_anim_def=function(b){f.error("apply_glow_anim_def() deprecated, use apply_outline_anim_def() instead");a.apply_outline_anim_def(b)};a.clear_glow_anim=function(b){f.error("clear_glow_anim() deprecated, use clear_outline_anim() instead");a.clear_outline_anim(b)};a.set_glow_color=function(b){f.error("set_glow_color() deprecated, use set_outline_color() instead");
a.set_outline_color(b)};a.get_glow_color=function(b){f.error("get_glow_color() deprecated, use get_outline_color() instead");a.get_outline_color(b)};a.get_shadow_params=function(){if(!k.ga())return f.error("No active scene"),!1;var a=k.get_active(),b=k.ca(a,"SHADOW_CAST");if(!b)return null;var c=a.d.wd,d=k.ca(a,"MAIN_OPAQUE"),e=k.ca(a,"DEPTH"),g={};g.csm_resolution=c.csm_resolution;g.self_shadow_polygon_offset=b.self_shadow_polygon_offset;e&&(g.self_shadow_normal_offset=e.self_shadow_normal_offset);
g.enable_csm=c.enable_csm;g.csm_num=c.csm_num;g.csm_first_cascade_border=c.csm_first_cascade_border;g.first_cascade_blur_radius=c.first_cascade_blur_radius;g.csm_last_cascade_border=c.csm_last_cascade_border;g.last_cascade_blur_radius=c.last_cascade_blur_radius;g.fade_last_cascade=c.fade_last_cascade;g.blend_between_cascades=c.blend_between_cascades;c.enable_csm?(g.csm_borders=k.Zx(a,d.i),g.blur_radii=new Float32Array(c.csm_num),g.blur_radii.set(d.i.xk.subarray(0,c.csm_num))):(g.csm_borders=null,
g.blur_radii=null);return g};a.set_shadow_params=function(a){if(!k.ga())return f.error("No active scene"),!1;var e=k.get_active();"number"==typeof a.self_shadow_polygon_offset&&c.O(e.d.fb,function(b,c){"SHADOW_CAST"===c.type&&(c.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var g=k.ca(e,"DEPTH");g&&("number"==typeof a.self_shadow_normal_offset&&(g.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(g.pcf_blur_radius=a.pcf_blur_radius));var n=k.ca(e,
"MAIN_BLEND");n&&("number"==typeof a.self_shadow_normal_offset&&(n.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(n.pcf_blur_radius=a.pcf_blur_radius),n.ia=!0);n=e.d.wd;"number"==typeof a.csm_first_cascade_border&&(n.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(n.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(n.csm_last_cascade_border=a.csm_last_cascade_border);
"number"==typeof a.last_cascade_blur_radius&&(n.last_cascade_blur_radius=a.last_cascade_blur_radius);if(g){for(var q=g.p,p=0;p<q.length;p++){var B=q[p];B.td.Yb&&(B=B.B,b.nl(B,n),b.rb(B))}g.ia=!0}g=e.camera.d.G;for(p=0;p<g.length;p++)d.ho(g[p],n);k.Fn(e)};a.get_environment_colors=function(){if(!k.ga())return f.error("No active scene"),!1;var a=k.get_active();return k.get_environment_colors(a)};a.set_environment_colors=function(a,b,c){if(!k.ga())return f.error("No active scene"),!1;var d=k.get_active();
k.set_environment_colors(d,parseFloat(a),b,c)};a.get_fog_color_density=function(a){if(!k.ga())return f.error("No active scene"),!1;var b=k.get_active();return k.get_fog_color_density(b,a)};a.set_fog_color_density=function(a){if(!k.ga())return f.error("No active scene"),!1;var b=k.get_active();k.set_fog_color_density(b,a)};a.get_ssao_params=function(){if(!k.ga())return f.error("No active scene"),!1;var a=k.get_active();return k.get_ssao_params(a)};a.set_ssao_params=function(a){if(!k.ga())return f.error("No active scene"),
!1;var b=k.get_active();k.set_ssao_params(b,a)};a.get_color_correction_params=function(){if(!k.ga())return f.error("No active scene"),null;var a=k.get_active(),a=k.ca(a,"COMPOSITING");if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.set_color_correction_params=function(a){if(!k.ga())return f.error("No active scene"),null;var b=k.get_active(),b=k.ca(b,"COMPOSITING");if(!b)return null;"number"==typeof a.brightness&&
(b.brightness=a.brightness);"number"==typeof a.contrast&&(b.contrast=a.contrast);"number"==typeof a.exposure&&(b.exposure=a.exposure);"number"==typeof a.saturation&&(b.saturation=a.saturation);b.ia=!0};a.get_sky_params=function(){if(!k.ga())return f.error("No active scene"),!1;var a=k.get_active();return k.get_sky_params(a)};a.set_sky_params=function(a){if(!k.ga())return f.error("No active scene"),!1;var b=k.get_active();k.set_sky_params(b,a)};a.get_dof_params=function(){if(!k.ga())return f.error("No active scene"),
!1;var a=k.get_active();return k.ca(a,"DOF")?k.get_dof_params(a):null};a.set_dof_params=function(a){if(!k.ga())return f.error("No active scene"),!1;var b=k.get_active();k.set_dof_params(b,a)};a.get_god_rays_params=function(){if(!k.ga())return f.error("No active scene"),!1;var a=k.get_active();return k.ca(a,"GOD_RAYS")?k.get_god_rays_params(a):null};a.set_god_rays_params=function(a){if(!k.ga())return f.error("No active scene"),!1;var b=k.get_active();k.set_god_rays_params(b,a)};a.get_bloom_params=
function(){if(!k.ga())return f.error("No active scene"),!1;var a=k.get_active();return k.ca(a,"BLOOM")?k.get_bloom_params(a):null};a.set_bloom_params=function(a){if(!k.ga())return f.error("No active scene"),!1;var b=k.get_active();k.set_bloom_params(b,a)};a.get_glow_material_params=function(){if(!k.ga())return f.error("No active scene"),!1;var a=k.get_active();return k.ca(a,"GLOW_COMBINE")?k.get_glow_material_params(a):null};a.set_glow_material_params=function(a){if(!k.ga())return f.error("No active scene"),
!1;var b=k.get_active();k.set_glow_material_params(b,a)};a.get_wind_params=function(){return k.get_wind_params()};a.set_wind_params=function(a){if(!k.ga())return f.error("No active scene"),!1;var b=k.get_active();k.set_wind_params(b,a)};a.get_water_surface_level=k.get_water_surface_level;a.set_water_params=function(a){if(!k.ga())return f.error("No active scene"),!1;var b=k.get_active();k.set_water_params(b,a)};a.get_water_mat_params=function(a){if(!k.ga())return f.error("No active scene"),!1;var b=
k.get_active();k.get_water_mat_params(b,a)};a.update_scene_materials_params=function(){if(!k.ga())return f.error("No active scene"),!1;var a=k.get_active();k.dt(a)};a.hide_object=function(a){e.ti(a)||q.ck(a)?k.hide_object(a):f.error("show/hide is only supported for dynamic meshes/empties")};a.show_object=function(a){e.ti(a)||q.ck(a)?k.show_object(a):f.error("show/hide is only supported for dynamic meshes/empties")};a.is_hidden=function(a){if(e.ti(a)||q.ck(a))return k.is_hidden(a);f.error("show/hide is only supported for dynamic meshes/empties");
return!1};a.is_visible=function(a){return a.d.is_visible};a.check_object=function(a){return k.ga()?k.check_object(a,k.get_active()):(f.error("No active scene"),!1)};a.check_object_by_name=function(a,b){return k.rd(k.sf,a,b|0)?!0:!1};a.check_object_by_dupli_name=function(a,b,c){return k.rd(k.$k,a,b,c|0)?!0:!1};a.check_object_by_dupli_name_list=function(a,b){return k.rd(k.al,a,b|0)?!0:!1};a.get_all_objects=function(a,b){var c=k.get_active();a||(a="ALL");b||0===b||(b=k.DATA_ID_ALL);return k.Ia(c,a,b)};
a.get_object_name=function(a){return a?a.name:(f.error("Wrong object name"),"")};a.get_object_type=function(a){return a&&a.type?a.type:(f.error("Wrong object"),"UNDEFINED")};a.get_object_dg_parent=function(a){return a.za};a.get_object_children=function(a){return a.Ic.slice(0)};a.get_first_character=function(){for(var a=k.Ia(k.get_active(),"MESH",k.DATA_ID_ALL),b=0;b<a.length;b++){var c=a[b];if(g.is_character(c))return c}return null};a.get_shore_dist=function(a,b){b||0===b||(b=1);return k.get_shore_dist(a,
b)};a.get_cam_water_depth=function(){return k.get_cam_water_depth()};a.get_type_mesh_object=function(a){return"MESH"==a.type?a.d.type:null};a.get_meta_tags=function(){if(!k.ga())return f.error("No active scene"),!1;var a=k.get_active();return k.get_meta_tags(a)};a.append_object=function(a){if(!a.d.Pm)return f.error('object "'+a.name+'" has been created not by coping.'),!1;var b=a.name;if(k.rd(k.sf,a.name,0))for(var c=1;;){b=a.name+(3>String(c).length?"."+("000"+String(c)).slice(-3):"."+String(c));
if(!k.rd(k.sf,b,0)){a.name=b;f.error('object "'+a.name+'" already exists. Name was replaced by "'+b+'".');break}c++}k.append_object(k.get_active(),a,!0)};a.remove_object=function(a){k.remove_object(a)||f.error('object "'+a.name+'" was not copied.')};a.marker_frame=function(a){var b=k.get_active();if(b.timeline_markers&&a in b.timeline_markers)return k.marker_frame(b,a);f.error('"'+a+'" marker not found.');return 0};a.get_mb_params=function(){var a=k.get_active();return(a=k.ca(a,"MOTION_BLUR"))?{mb_factor:a.mb_factor,
mb_decay_threshold:a.mb_decay_threshold}:null};a.set_mb_params=function(a){var b=k.get_active();(b=k.ca(b,"MOTION_BLUR"))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=a.mb_decay_threshold),"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):f.error("The motion blur subscene doesn't exist.")}};b4w.module.sfx=function(a,p){var b=p("__scenes"),d=p("__sfx"),c=p("__print");a.play=function(a,b,c){d.play(a,b,c)};a.play_def=function(a){d.play_def(a)};a.is_play=function(a){return d.is_play(a)};a.speaker_play=function(a,b,g,k){c.error("speaker_play() deprecated, use play() or play_def() instead");d.cyclic(a,b);k&&d.playrate(a,k);d.play(a,0,g)};a.speaker_stop=function(a){c.error("speaker_stop() deprecated, use stop() instead");d.stop(a)};a.stop=function(a){d.stop(a)};a.pause=function(a){d.KA(a)};
a.resume=function(a){d.MA(a)};a.speaker_playback_rate=function(a,b){c.error("speaker_playback_rate() deprecated, use playrate() instead");d.playrate(a,b)};a.playrate=function(a,b){d.playrate(a,b)};a.get_playrate=function(a){return d.get_playrate(a)};a.cyclic=function(a,b){d.cyclic(a,b)};a.is_cyclic=function(a){return d.is_cyclic(a)};a.listener_reset_speed=function(a,b){d.listener_reset_speed(a,b)};a.speaker_reset_speed=function(a,b,c){d.speaker_reset_speed(a,b,c)};a.get_volume=function(a){return a&&
"object"===typeof a?d.get_volume(a):d.fy()};a.set_volume=function(a,b){a&&"object"===typeof a?d.set_volume(a,b):d.pA(b)};a.mute=function(a,b){a&&"object"===typeof a?d.mute(a,b):d.jz(b)};a.is_muted=function(a){return a&&"object"===typeof a?d.is_muted(a):d.Oy()};a.get_speaker_objects=function(){return d.get_speaker_objects().slice(0)};a.get_speakers=function(){c.error("get_speakers() deprecated, use get_speaker_objects() instead");return a.get_speaker_objects()};a.check_active_speakers=d.check_active_speakers;
a.set_compressor_params=function(a){d.set_compressor_params(b.get_active(),a)};a.get_compressor_params=function(){return d.get_compressor_params(b.get_active())};a.duck=function(a,b,c){a&&"object"===typeof a?d.duck(a,b,c):d.dx(b,c)};a.unduck=function(a){a&&"object"===typeof a?d.unduck(a):d.qB()};a.apply_playlist=d.apply_playlist;a.clear_playlist=d.clear_playlist;a.detect_audio_container=d.detect_audio_container;a.detect_video_container=d.detect_video_container;a.set_positional_params=d.set_positional_params;
a.get_positional_params=d.get_positional_params;a.set_filter_params=d.set_filter_params;a.get_filter_params=d.get_filter_params;a.get_filter_freq_response=d.get_filter_freq_response;a.get_duration=function(a){if(a&&d.fe(a))return d.get_duration(a);c.error('Object "'+(a?a.name:void 0)+'" is not a valid speaker')}};b4w.module.shaders=function(a,p){function b(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ /))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[e];break;default:a+=b[e]}b.ALU_OPS=a;b.TEX_OPS=c;return b}function d(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);
c.send(b);if(200==c.status)return c.responseText;throw"Error POST XHR: "+c.status;}function c(a){for(var b=k.ri(),c=0;c<b.length;c++)for(var d=k.Ia(b[c],"MESH",k.DATA_ID_ALL),e=0;e<d.length;e++){var f=d[e];if(f.n)for(var g=0;g<f.n.length;g++){var q=f.n[g];if(q.Xb==a&&q.Pc.length)return q.Pc}}return null}function e(a){a.sort(function(a,b){return b.tm.ALU_OPS-a.tm.ALU_OPS});for(var b=0;b<a.length;b++){var d=a[b],e=d.tm,g=d.gC,k=c(d.Nw),k=k?"\t\t("+k.join(", ")+")":"\t\t(NA)";f.groupCollapsed("FRAG --\x3e",
"ALU",e.ALU_OPS,"TEX",e.TEX_OPS,"\t\tVERT --\x3e","ALU",g.ALU_OPS,"TEX",g.TEX_OPS,k);f.groupCollapsed("directives");for(var k=d.pb.He,q=0;q<k.length;q++){var p=k[q];f.log(p[0],p[1])}f.groupEnd();f.groupCollapsed("vert src");f.log(d.fC);f.groupEnd();f.groupCollapsed("vert stats");for(var r in g)"ALU_OPS"!=r&&"TEX_OPS"!=r&&f.log(r,g[r]);f.groupEnd();f.groupCollapsed("frag src");f.log(d.Bx);f.groupEnd();f.groupCollapsed("frag stats");for(r in e)"ALU_OPS"!=r&&"TEX_OPS"!=r&&f.log(r,e[r]);f.groupEnd();
f.groupEnd()}}p("__config");var f=p("__print"),g=p("__extensions"),k=p("__scenes"),q=p("__shaders");p("__util");a.report_repeatful_compilation=function(){var a=q.Rw(),b=0,c;for(c in a){var d=a[c],e=d.count;1<e&&f.log(e-1,d.CE,d.TD);b+=e-1}f.log("TOTAL OVERHEAD:",b);return"OK"};a.analyze=function(a){var c=q.pq(),k=0,n;for(n in c)a&&-1===n.indexOf(a)||k++;var k="of "+k+" analyzing...",p={};for(n in c)if(!a||-1!==n.indexOf(a)){var x=c[n],B;var y=x.po;B=x.hq;var r=g.qq();if(r){y=r.getTranslatedShaderSource(y);
B=r.getTranslatedShaderSource(B);var r=d("/nvidia_vert",y),A=b(r),t=d("/nvidia_frag",B),F=b(t);B={fC:y,OE:r,gC:A,Bx:B,xD:t,tm:F}}else f.error("WEBGL_debug_shaders not found (run Chrome with --enable-privileged-webgl-extensions)"),B=void 0;r=x.pb;y=r.bj+" + "+r.mi;B.Nw=x;B.pb=r;x=p[y]=p[y]||[];x.push(B);f.log(k)}for(y in p)f.group("%c"+y,"color: #800"),x=p[y],e(x),f.groupEnd()}};b4w.module.textures=function(a,p){var b=p("__textures"),d=p("__print");a.get_canvas_texture_context=function(a,e){e||(e=0);var f=b.Wx(a,e);if(f)return f;d.error('Canvas texture with ID "'+a+'" not found!')};a.update_canvas_texture_context=function(a,e){e||(e=0);b.AB(a,e)||d.error('Canvas texture with ID "'+a+'" not found!')};a.play_video=function(a,e){e||(e=0);b.play_video(a,e)||d.error('Texture with name "'+a+'" not found!')};a.pause_video=function(a,e){e||(e=0);b.pause_video(a,e)||d.error('Texture with name "'+
a+'" not found!')};a.reset_video=function(a,e){e||(e=0);b.reset_video(a,e)||d.error('Texture with name "'+a+'" not found!')}};b4w.module.time=function(a,p){var b=p("__time");a.set_timeout=b.set_timeout;a.clear_timeout=b.clear_timeout;a.get_timeline=b.get_timeline;a.animate=b.animate};b4w.module.transform=function(a,p){var b=p("__print"),d=p("__physics"),c=p("__transform"),e=p("__util"),f=p("__objects"),g=new Float32Array(3),k=new Float32Array(4);a.SPACE_LOCAL=c.SPACE_LOCAL;a.SPACE_WORLD=c.SPACE_WORLD;a.set_translation=function(a,e,k,p){f.cc(a)?(g[0]=e,g[1]=k,g[2]=p,c.set_translation(a,g),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_v=function(a,e){f.cc(a)?(c.set_translation(a,e),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.set_translation_rel=function(a,h,k,p,n){f.cc(a)?(g[0]=h,g[1]=k,g[2]=p,e.transform_vec3(g,1,n.d.quat,n.d.h,g),c.set_translation(a,g),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_translation=function(a,b){b||(b=new Float32Array(3));c.get_translation(a,b);return b};a.set_rotation=function(a,e,g,p,n){f.cc(a)?(k[0]=e,k[1]=g,k[2]=p,k[3]=n,c.set_rotation(a,k),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.set_rotation_quat=function(){b.error("set_rotation_quat() deprecated, use set_rotation() instead");return a.set_rotation};a.set_rotation_v=function(a,e){f.cc(a)?(c.set_rotation(a,e),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_quat_v=function(){b.error("set_rotation_quat_v() deprecated, use set_rotation_v() instead");return a.set_rotation_v};a.get_rotation=function(a,b){b||(b=new Float32Array(4));c.get_rotation(a,b);return b};a.get_rotation_quat=
function(){b.error("get_rotation_quat() deprecated, use get_rotation() instead");return a.get_rotation};a.set_rotation_euler=function(a,e,k,p){f.cc(a)?(g[0]=e,g[1]=k,g[2]=p,c.set_rotation_euler(a,g),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_v=function(a,e){f.cc(a)?(c.set_rotation_euler(a,e),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale=function(a,d){f.cc(a)?(c.set_scale(a,d),c.u(a)):b.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.get_scale=function(a){return c.get_scale(a)};a.empty_reset_transform=function(a){if("EMPTY"!=a.type)return b.error("Wrong object: "+a.name),!1;for(var e=0;e<a.Ic.length;e++)if(!f.cc(a.Ic[e])){b.error('Wrong object: "'+a.Ic[e].name+'" is not dynamic.');return}c.set_translation(a,[0,0,0]);c.set_rotation(a,[0,0,0,1]);c.set_scale(a,1);c.u(a);d.sync_transform(a)};a.get_object_size=function(a){return e.is_mesh(a)?c.get_object_size(a):(b.error("Wrong object: "+a.name),0)};
a.get_object_center=function(a,d,f){return e.is_mesh(a)?c.get_object_center(a,d,f):(b.error("Wrong object: "+a.name),null)};a.move_local=function(a,e,g,k){f.cc(a)?(c.move_local(a,e,g,k),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_object_bounding_box=function(a){return c.get_object_bounding_box(a)};a.get_tsr=function(a,d){d||(d=new Float32Array(8));if(f.cc(a))return c.get_tsr(a,d),d;b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_tsr=function(a,
e){f.cc(a)?(c.set_tsr(a,e),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.distance=function(a,b){return c.distance(a,b)}};b4w.module.tsr=function(a,p){p("__print");var b=p("__tsr");a.create=b.create;a.from_values=b.from_values;a.copy=b.copy;a.identity=b.identity;a.create_sep=b.create_sep;a.set_sep=b.set_sep;a.set_trans=b.set_trans;a.set_scale=b.set_scale;a.set_transcale=b.set_transcale;a.set_quat=b.set_quat;a.get_trans_view=b.get_trans_view;a.get_scale=b.get_scale;a.get_quat_view=b.get_quat_view;a.invert=b.invert;a.to_mat4=function(a,c){c||(c=new Float32Array(16));b.to_mat4(a,c);return c};a.from_mat4=b.from_mat4;a.multiply=
b.multiply;a.transform_vec3=b.transform_vec3;a.transform_vec3_inv=b.transform_vec3_inv;a.transform_vectors=b.transform_vectors;a.transform_dir_vectors=b.transform_dir_vectors;a.transform_dir_vec3=b.transform_dir_vec3;a.transform_tangents=b.transform_tangents;a.translate=b.translate;a.interpolate=b.interpolate};b4w.module.util=function(a,p){var b=p("__print"),d=p("__util"),c=p("vec3");p("mat4");a.AXIS_X=new Float32Array([1,0,0]);a.AXIS_Y=new Float32Array([0,1,0]);a.AXIS_Z=new Float32Array([0,0,1]);a.AXIS_MX=new Float32Array([-1,0,0]);a.AXIS_MY=new Float32Array([0,-1,0]);a.AXIS_MZ=new Float32Array([0,0,-1]);a.f32=function(a){return new Float32Array(a||0)};a.assert=d.assert;a.keyfind=d.keyfind;a.keysearch=d.keysearch;a.matrix_to_quat=function(a){return d.matrix_to_quat(a)};a.euler_to_quat=function(a,b){b||
(b=new Float32Array(4));return d.euler_to_quat(a,b)};a.quat_to_euler=function(a,b){b||(b=new Float32Array(3));return d.quat_to_euler(a,b)};a.sign=d.sign;a.clamp=d.clamp;a.quat_to_dir=d.quat_to_dir;a.ground_project_quat=function(a,b){return d.quat_project(a,d.AXIS_MY,d.AXIS_Y,d.AXIS_MZ,b)};a.cam_quat_to_mesh_quat=function(a,b){return d.cam_quat_to_mesh_quat(a,b)};a.quat_project=function(a,f,g,k,p){return 0!=c.dot(g,k)?(b.error("Wrong in-plane direction"),null):d.quat_project(a,f,g,k,p)};a.hash_code=
d.hash_code;a.smooth=d.smooth;a.smooth_v=d.smooth_v;a.is_vector=d.is_vector;a.correct_cam_quat_up=d.correct_cam_quat_up;a.quat_to_angle_axis=d.quat_to_angle_axis;a.random_from_array=d.random_from_array;a.xz_direction=d.xz_direction;a.line_plane_intersect=d.line_plane_intersect;a.is_mesh=d.is_mesh;a.is_armature=d.is_armature;a.angle_wrap_0_2pi=d.angle_wrap_0_2pi;a.angle_wrap_periodic=d.angle_wrap_periodic;a.smooth_step=d.smooth_step};"object"==typeof module&&module.hm&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,p){var b=p("__version");a.version=b.version;a.version_str=b.version_str;a.type=b.type;a.date=b.date;a.date_str=b.date_str};"object"==typeof module&&module.hm&&b4w.module.version(exports);b4w.module.objects=function(a,p){var b=p("__objects"),d=p("__print"),c=p("__util"),e=p("__scenes"),f=p("__geometry");a.get_meta_tags=function(a){if(a&&a.b4w_object_tags)return b.get_meta_tags(a)};a.copy=function(a,k,p){return c.is_mesh(a)?a.Io?(d.error('object "'+a.name+'" is meta-object.'),!1):b.cc(a)?f.si(a)||f.check_shape_keys(a)||!p?-1==e.Ia(e.get_active(),"MESH",e.DATA_ID_ALL).indexOf(a)?(d.error('object "'+a.name+'" does not belong to the active scene.'),!1):b.copy(a,k||"",p):(d.error('object "'+
a.name+'" has not dynamic geometry for deep copying.'),!1):(d.error('object "'+a.name+'" is not dynamic.'),!1):(d.error('object "'+a.name+'" is not of type "MESH".'),!1)};a.set_nodemat_value=function(a,e,f){if(!c.is_mesh(a))return d.error('The type of the object "'+a.name+'" is not "MESH".'),null;e=e.join("%join%");var h=b.oy(a,e);null!=h?a.d.he[h]=f:d.error('The Value node "'+e+'" was not found in the object "'+a.name+'".')};a.set_nodemat_rgb=function(a,e,f,h,m){if(!c.is_mesh(a))return d.error('The type of the object "'+
a.name+'" is not "MESH".'),null;e=e.join("%join%");var p=b.iy(a,e);null!=p?(a.d.tc[p]=f,a.d.tc[p+1]=h,a.d.tc[p+2]=m):d.error('The RGB node "'+e+'" was not found in the object "'+a.name+'".')}};b4w.module.main=function(a,p){function b(){}function d(){}function c(){}function e(){window.performance||(y.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(y.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});O.os(0)}function f(a,b){a.addEventListener("webglcontextlost",function(a){a.preventDefault();y.error("WebGL context lost");k()},!1);C.bd(b);var c=C.wq();c&&y.log("%cRENDERER INFO:","color: #00a",
b.getParameter(c.UNMASKED_VENDOR_WEBGL)+", "+b.getParameter(c.UNMASKED_RENDERER_WEBGL));P.bd(b);l.bd(b);L.bd(b);G.bd(b);F.bd(b);t.yA(a);r.init(a);z.qs(a.width,a.height,1);N.init();d=u();h()}function g(){b=function(){}}function k(){q()||(Z=performance.now()/1E3,N.pause(),I.pause(),L.pause(),n.pause())}function q(){return la<Z}function h(){U(h);var a=performance.now()/1E3;v||(v=a);var b=a-v;if(!(b<1/ga.Zc)){for(var c=O.get_timeline(),e=0;e<V.length;e++)V[e](c,b);q()||(la>v&&(b-=la-Math.max(Z,v)),c+=
b,O.os(c),F.update(),K.update(),t.update(),m(c,b),d(b));v=a}}function m(a,c){t.is_primary_loaded()&&(H.reset(),W.update(c),J.update(a,c),N.update(a,c),c&&w.update(c),t.is_primary_loaded()&&(I.update(a,c),t.is_primary_loaded()&&(b(c,a),t.is_primary_loaded()&&(A.update(a,c),t.is_primary_loaded()&&(n.update(),z.update(a,c),n.NB(),ha&&(ha(ja.toDataURL()),ha=null))))))}function u(){var a=60,b=0,d=ga.fq,e=ga.vx;return function(f){f<1/ga.Zc||(a=X.smooth(1/f,a,f,d),f=I.dy(),b=(b+1)%e,0==b&&c(Math.round(a),
f))}}var n=p("__anchors"),w=p("__animation"),x=p("__compat"),B=p("__config"),y=p("__print"),r=p("__container"),A=p("__controls"),t=p("__data"),F=p("__debug"),C=p("__extensions"),l=p("__geometry"),H=p("__hud"),J=p("__nla"),K=p("__assets"),I=p("__physics"),P=p("__renderer"),z=p("__scenes"),N=p("__sfx"),G=p("__shaders"),L=p("__textures"),O=p("__time"),W=p("__transform"),X=p("__util"),Y=p("__version"),R=B.context,ga=B.o,ja=null,qa=null,v=0,Z=0,la=0,V=[],ha=null,ea=["webgl","experimental-webgl"],pa=null,
U=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/ga.Zc)}}();a.init=function(a,b){B.qA();y.uA(ga.console_verbose);var c=Y.version_str()+" "+Y.type()+" ("+Y.date_str()+")";y.log("%cINIT ENGINE","color: #00a",c);if(!window.WebGLRenderingContext)return null;e();ja=a;x.jv();for(var c=null,d=0;d<ea.length;d++){var g=ea[d];try{c=a.getContext(g,
R)}catch(h){}if(c)break}if(!c)return null;pa=c;f(ja,c);B.lv();x.kA(c);ga.Lm&&(a.style["touch-action"]="none");y.log("%cSET PRECISION:","color: #00a",ga.precision);b?(H.init(b),qa=b):(B.o.show_hud_debug_info=!1,B.cd.jk=!1);return c};a.set_check_gl_errors=function(a){F.set_check_gl_errors(a)};a.resize=function(a,b,c){!1!==c&&(ja.style.width=a+"px",ja.style.height=b+"px",qa&&(qa.style.width=a+"px",qa.style.height=b+"px"));qa&&(qa.width=a,qa.height=b,H.Ih());if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||
navigator.userAgent.match(/iPod/i))ga.canvas_resolution_factor=1;c=Math.floor(a*ga.canvas_resolution_factor);b=Math.floor(b*ga.canvas_resolution_factor);ga.allow_hidpi&&1<window.devicePixelRatio&&(c*=window.devicePixelRatio,b*=window.devicePixelRatio);ja.width=c;ja.height=b;if(c>pa.drawingBufferWidth||b>pa.drawingBufferHeight){y.warn("Canvas size exceeds platform limits, downscaling");var d=Math.min(pa.drawingBufferWidth/c,pa.drawingBufferHeight/b);c*=d;b*=d;ja.width=c;ja.height=b}z.qs(c,b,c/a);z.ga()&&
W.u(z.get_active().camera);m(O.get_timeline(),0);t.EB(ja.width,ja.height)};a.set_fps_callback=function(a){c=a};a.clear_fps_callback=function(){c=function(){}};a.set_render_callback=function(a){b=a};a.clear_render_callback=function(){g()};a.global_timeline=function(){return O.get_timeline()};a.redraw=function(){y.error("redraw() deprecated");m(O.get_timeline(),0)};a.pause=k;a.resume=function(){q()&&(la=performance.now()/1E3,N.resume(),I.resume(),L.play(!0),n.resume())};a.is_paused=q;a.reset=function(){t.unload(0);
qa=ja=null;la=Z=v=0;c=function(){};d=function(){};b=function(){};V.length=0;pa=null;O.reset()};a.canvas_data_url=function(a){ha=a};a.get_canvas_elem=function(){return ja};a.detect_mobile=function(){return x.detect_mobile()};a.append_loop_cb=function(a){for(var b=0;b<V.length;b++)if(V[b]==a)return;V.push(a)};a.remove_loop_cb=function(a){for(var b=0;b<V.length;b++)if(V[b]==a){V.splice(b,1);break}}};b4w.module.nla=function(a,p){var b=p("__nla"),d=p("__time"),c=p("__print"),e=p("__util");a.set_frame=function(a){a=e.clamp(a,b.get_frame_start(),b.get_frame_end());b.check_nla_scripts()?c.error("The active scene is using NLA script."):b.set_frame(a,d.get_timeline())};a.get_frame=function(){return b.get_frame(d.get_timeline())};a.stop=function(){b.check_nla_scripts()?c.error("The active scene is using NLA script."):b.WA()};a.play=function(a){b.check_nla_scripts()?c.error("The active scene is using NLA script."):
b.yz(a)};a.is_play=function(){return b.is_play()};a.get_frame_start=function(){return b.get_frame_start()};a.get_frame_end=function(){return b.get_frame_end()};a.check_nla=function(){return b.check_nla()};a.check_nla_scripts=function(){return b.check_nla_scripts()};a.set_range=function(a,d){b.check_nla_scripts()?c.error("The active scene is using NLA script."):(d=parseFloat(d)||b.get_frame_end(),a=parseFloat(a)||b.get_frame_end(),d=e.clamp(d,b.get_frame_start(),b.get_frame_end()),a=e.clamp(a,b.get_frame_start(),
d),b.set_range(a,d))};a.reset_range=function(){b.check_nla_scripts()?c.error("The active scene is using NLA script."):b.reset_range()};a.set_cyclic=function(a){b.check_nla_scripts()?c.error("The active scene is using NLA script."):b.set_cyclic(a)};a.clear_callback=function(){b.check_nla_scripts()?c.error("The active scene is using NLA script."):b.clear_callback()}};
